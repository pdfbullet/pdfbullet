const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-BwyNz2w0.js","assets/useFavorites-DZmySRTE.js","assets/useWorkflows-Doyhkf-K.js","assets/react-Ckhrjn13.js","assets/ToolPage-D2vKHn6-.js","assets/useSignature-Cp5fx6a8.js","assets/html2canvas.esm-B0tyYwQk.js","assets/useSignedDocuments-lzX-OArI.js","assets/useLastTasks-B37YhwAc.js","assets/AboutPage-LQ8wBZ68.js","assets/BlogPage-BTgUaOkw.js","assets/BlogPostPage-DJ3LB65F.js","assets/ContactPage-DpBNNG_h.js","assets/LoginPage-B_kRHxSu.js","assets/SignUpPage-DcUMoK7Q.js","assets/DeveloperPage-C9OuG6yH.js","assets/FaqPage-B9oU0kdy.js","assets/SitemapPage-BN7GUX2J.js","assets/InvoiceGeneratorPage-D2SP2KF-.js","assets/jspdf.es.min-B5HUDEX9.js","assets/RichTextEditor-DZVi7kS0.js","assets/CVGeneratorPage-DhKzPsBr.js","assets/LessonPlanCreatorPage-D12dAxUP.js","assets/index-3sRqm52h.js","assets/AIQuestionGeneratorPage-WwxudB7p.js","assets/ImageGeneratorPage-_JPTBUQF.js","assets/PricingPage-CLydEL4d.js","assets/ApiPricingPage-84S0nyt9.js","assets/PremiumFeaturePage-Vmv4IFUW.js","assets/PaymentPage-BhUebUmf.js","assets/DeveloperAccessPage-D3DI3fI4.js","assets/AdminDashboardPage-DPWEMh55.js","assets/HowToUsePage-DUkf25dz.js","assets/EducationPage-CZQITu9Y.js","assets/BusinessPage-Cd8XkXyM.js","assets/PrivacyPolicyPage-BUKeTlij.js","assets/TermsOfServicePage-DFQTn1Cm.js","assets/CookiesPolicyPage-CFYiEixx.js","assets/CeoPage-D-GmPZUD.js","assets/PressPage-c6CEqfnH.js","assets/LegalPage-Y4e1pSiN.js","assets/SecurityPolicyPage-DrR_ysEY.js","assets/FeaturesPage-CThrNTsD.js","assets/ApiReferencePage-DSrCVhiu.js","assets/ApiPdfPage-uK2azTaX.js","assets/ApiImagePage-BGh_aB6E.js","assets/ApiSignaturePage-BtKFhAPw.js","assets/AccountSettingsPage-BAbfM8Kv.js","assets/WorkflowsPage-IBonzB4c.js","assets/CreateWorkflowPage-D7Uvdsl9.js","assets/SecurityPage-A6i5e3Aj.js","assets/TeamPage-CBWpMZ9p.js","assets/LastTasksPage-wbqL_OHo.js","assets/SignaturesOverviewPage-BnAsyVaQ.js","assets/SentPage-B4aHCqwc.js","assets/InboxPage-4wfn3aCP.js","assets/SignedPage-CYOUZKU_.js","assets/TemplatesPage-ChXbrgz8.js","assets/ContactsPage-BgwSKmXF.js","assets/xlsx-DGuHH-KN.js","assets/SignatureSettingsPage-BvfZR-Mv.js","assets/PlansAndPackagesPage-DuN4Y8VK.js","assets/BusinessDetailsPage-BjDo9GtA.js","assets/InvoicesPage-zV3kzEQm.js","assets/PwaHomePage-Dwed_ECd.js","assets/PwaToolsPage-BgMWIcZQ.js","assets/PwaArticlesPage-UL9RfPmi.js","assets/PwaSettingsPage-BR3AAJFo.js","assets/PwaStoragePage-BHCUnkvn.js"])))=>i.map(i=>d[i]);
import{r as mT,g as cc,a as gT}from"./react-Ckhrjn13.js";function yT(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in n)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();var $h={exports:{}},Oa={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function _P(){if(Uv)return Oa;Uv=1;var n=mT(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,f={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(u in l)i.call(l,u)&&!r.hasOwnProperty(u)&&(f[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)f[u]===void 0&&(f[u]=l[u]);return{$$typeof:e,type:a,key:m,ref:y,props:f,_owner:s.current}}return Oa.Fragment=t,Oa.jsx=o,Oa.jsxs=o,Oa}var Bv;function bP(){return Bv||(Bv=1,$h.exports=_P()),$h.exports}var p=bP(),P=mT();const Ad=cc(P),xP=yT({__proto__:null,default:Ad},[P]);var eu={},zv;function TP(){if(zv)return eu;zv=1;var n=gT();return eu.createRoot=n.createRoot,eu.hydrateRoot=n.hydrateRoot,eu}var EP=TP();const AP=cc(EP);gT();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rl(){return Rl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Rl.apply(this,arguments)}var cs;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(cs||(cs={}));const jv="popstate";function IP(n){n===void 0&&(n={});function e(i,s){let{pathname:r,search:o,hash:a}=i.location;return op("",{pathname:r,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){return typeof s=="string"?s:ju(s)}return SP(e,t,null,n)}function wt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function vT(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CP(){return Math.random().toString(36).substr(2,8)}function qv(n,e){return{usr:n.state,key:n.key,idx:e}}function op(n,e,t,i){return t===void 0&&(t=null),Rl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?ta(e):e,{state:t,key:e&&e.key||i||CP()})}function ju(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function ta(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function SP(n,e,t,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:r=!1}=i,o=s.history,a=cs.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Rl({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function f(){a=cs.Pop;let x=u(),T=x==null?null:x-c;c=x,l&&l({action:a,location:_.location,delta:T})}function m(x,T){a=cs.Push;let S=op(_.location,x,T);c=u()+1;let C=qv(S,c),D=_.createHref(S);try{o.pushState(C,"",D)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(D)}r&&l&&l({action:a,location:_.location,delta:1})}function y(x,T){a=cs.Replace;let S=op(_.location,x,T);c=u();let C=qv(S,c),D=_.createHref(S);o.replaceState(C,"",D),r&&l&&l({action:a,location:_.location,delta:0})}function v(x){let T=s.location.origin!=="null"?s.location.origin:s.location.href,S=typeof x=="string"?x:ju(x);return S=S.replace(/ $/,"%20"),wt(T,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,T)}let _={get action(){return a},get location(){return n(s,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(jv,f),l=x,()=>{s.removeEventListener(jv,f),l=null}},createHref(x){return e(s,x)},createURL:v,encodeLocation(x){let T=v(x);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:y,go(x){return o.go(x)}};return _}var Hv;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Hv||(Hv={}));function PP(n,e,t){return t===void 0&&(t="/"),kP(n,e,t)}function kP(n,e,t,i){let s=typeof e=="string"?ta(e):e,r=Tm(s.pathname||"/",t);if(r==null)return null;let o=wT(n);RP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=qP(r);a=BP(o[l],c)}return a}function wT(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let s=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(wt(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=ps([i,l.relativePath]),u=t.concat(l);r.children&&r.children.length>0&&(wt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),wT(r.children,e,u,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:OP(c,r.index),routesMeta:u})};return n.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))s(r,o);else for(let l of _T(r.path))s(r,o,l)}),e}function _T(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(i.length===0)return s?[r,""]:[r];let o=_T(i.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function RP(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:UP(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const NP=/^:[\w-]+$/,MP=3,DP=2,LP=1,FP=10,VP=-2,Gv=n=>n==="*";function OP(n,e){let t=n.split("/"),i=t.length;return t.some(Gv)&&(i+=VP),e&&(i+=DP),t.filter(s=>!Gv(s)).reduce((s,r)=>s+(NP.test(r)?MP:r===""?LP:FP),i)}function UP(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function BP(n,e,t){let{routesMeta:i}=n,s={},r="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],c=a===i.length-1,u=r==="/"?e:e.slice(r.length)||"/",f=zP({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:ps([r,f.pathname]),pathnameBase:WP(ps([r,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(r=ps([r,f.pathnameBase]))}return o}function zP(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=jP(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let r=s[0],o=r.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:i.reduce((c,u,f)=>{let{paramName:m,isOptional:y}=u;if(m==="*"){let _=a[f]||"";o=r.slice(0,r.length-_.length).replace(/(.)\/+$/,"$1")}const v=a[f];return y&&!v?c[m]=void 0:c[m]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:n}}function jP(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),vT(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function qP(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return vT(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Tm(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function HP(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?ta(n):n;return{pathname:t?t.startsWith("/")?t:GP(t,e):e,search:KP(i),hash:YP(s)}}function GP(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Wh(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $P(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Em(n,e){let t=$P(n);return e?t.map((i,s)=>s===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function Am(n,e,t,i){i===void 0&&(i=!1);let s;typeof n=="string"?s=ta(n):(s=Rl({},n),wt(!s.pathname||!s.pathname.includes("?"),Wh("?","pathname","search",s)),wt(!s.pathname||!s.pathname.includes("#"),Wh("#","pathname","hash",s)),wt(!s.search||!s.search.includes("#"),Wh("#","search","hash",s)));let r=n===""||s.pathname==="",o=r?"/":s.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!i&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=HP(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(r||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ps=n=>n.join("/").replace(/\/\/+/g,"/"),WP=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),KP=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,YP=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function JP(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const bT=["post","put","patch","delete"];new Set(bT);const XP=["get",...bT];new Set(XP);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nl(){return Nl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Nl.apply(this,arguments)}const Im=P.createContext(null),QP=P.createContext(null),Ds=P.createContext(null),Id=P.createContext(null),xi=P.createContext({outlet:null,matches:[],isDataRoute:!1}),xT=P.createContext(null);function ZP(n,e){let{relative:t}=e===void 0?{}:e;na()||wt(!1);let{basename:i,navigator:s}=P.useContext(Ds),{hash:r,pathname:o,search:a}=ET(n,{relative:t}),l=o;return i!=="/"&&(l=o==="/"?i:ps([i,o])),s.createHref({pathname:l,search:a,hash:r})}function na(){return P.useContext(Id)!=null}function Ti(){return na()||wt(!1),P.useContext(Id).location}function TT(n){P.useContext(Ds).static||P.useLayoutEffect(n)}function ia(){let{isDataRoute:n}=P.useContext(xi);return n?pk():ek()}function ek(){na()||wt(!1);let n=P.useContext(Im),{basename:e,future:t,navigator:i}=P.useContext(Ds),{matches:s}=P.useContext(xi),{pathname:r}=Ti(),o=JSON.stringify(Em(s,t.v7_relativeSplatPath)),a=P.useRef(!1);return TT(()=>{a.current=!0}),P.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){i.go(c);return}let f=Am(c,JSON.parse(o),r,u.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ps([e,f.pathname])),(u.replace?i.replace:i.push)(f,u.state,u)},[e,i,o,r,n])}const tk=P.createContext(null);function nk(n){let e=P.useContext(xi).outlet;return e&&P.createElement(tk.Provider,{value:n},e)}function BJ(){let{matches:n}=P.useContext(xi),e=n[n.length-1];return e?e.params:{}}function ET(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=P.useContext(Ds),{matches:s}=P.useContext(xi),{pathname:r}=Ti(),o=JSON.stringify(Em(s,i.v7_relativeSplatPath));return P.useMemo(()=>Am(n,JSON.parse(o),r,t==="path"),[n,o,r,t])}function ik(n,e){return sk(n,e)}function sk(n,e,t,i){na()||wt(!1);let{navigator:s}=P.useContext(Ds),{matches:r}=P.useContext(xi),o=r[r.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Ti(),u;if(e){var f;let x=typeof e=="string"?ta(e):e;l==="/"||(f=x.pathname)!=null&&f.startsWith(l)||wt(!1),u=x}else u=c;let m=u.pathname||"/",y=m;if(l!=="/"){let x=l.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=PP(n,{pathname:y}),_=ck(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:ps([l,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:ps([l,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),r,t,i);return e&&_?P.createElement(Id.Provider,{value:{location:Nl({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:cs.Pop}},_):_}function rk(){let n=fk(),e=JP(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:s},t):null,null)}const ok=P.createElement(rk,null);class ak extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?P.createElement(xi.Provider,{value:this.props.routeContext},P.createElement(xT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lk(n){let{routeContext:e,match:t,children:i}=n,s=P.useContext(Im);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),P.createElement(xi.Provider,{value:e},i)}function ck(n,e,t,i){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=i)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(f=>f.route.id&&a?.[f.route.id]!==void 0);u>=0||wt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&i&&i.v7_partialHydration)for(let u=0;u<o.length;u++){let f=o[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:m,errors:y}=t,v=f.route.loader&&m[f.route.id]===void 0&&(!y||y[f.route.id]===void 0);if(f.route.lazy||v){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,f,m)=>{let y,v=!1,_=null,x=null;t&&(y=a&&f.route.id?a[f.route.id]:void 0,_=f.route.errorElement||ok,l&&(c<0&&m===0?(mk("route-fallback"),v=!0,x=null):c===m&&(v=!0,x=f.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,m+1)),S=()=>{let C;return y?C=_:v?C=x:f.route.Component?C=P.createElement(f.route.Component,null):f.route.element?C=f.route.element:C=u,P.createElement(lk,{match:f,routeContext:{outlet:u,matches:T,isDataRoute:t!=null},children:C})};return t&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?P.createElement(ak,{location:t.location,revalidation:t.revalidation,component:_,error:y,children:S(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):S()},null)}var AT=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(AT||{}),IT=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(IT||{});function uk(n){let e=P.useContext(Im);return e||wt(!1),e}function dk(n){let e=P.useContext(QP);return e||wt(!1),e}function hk(n){let e=P.useContext(xi);return e||wt(!1),e}function CT(n){let e=hk(),t=e.matches[e.matches.length-1];return t.route.id||wt(!1),t.route.id}function fk(){var n;let e=P.useContext(xT),t=dk(),i=CT();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function pk(){let{router:n}=uk(AT.UseNavigateStable),e=CT(IT.UseNavigateStable),t=P.useRef(!1);return TT(()=>{t.current=!0}),P.useCallback(function(s,r){r===void 0&&(r={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Nl({fromRouteId:e},r)))},[n,e])}const $v={};function mk(n,e,t){$v[n]||($v[n]=!0)}function gk(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function ST(n){let{to:e,replace:t,state:i,relative:s}=n;na()||wt(!1);let{future:r,static:o}=P.useContext(Ds),{matches:a}=P.useContext(xi),{pathname:l}=Ti(),c=ia(),u=Am(e,Em(a,r.v7_relativeSplatPath),l,s==="path"),f=JSON.stringify(u);return P.useEffect(()=>c(JSON.parse(f),{replace:t,state:i,relative:s}),[c,f,s,t,i]),null}function Cm(n){return nk(n.context)}function q(n){wt(!1)}function yk(n){let{basename:e="/",children:t=null,location:i,navigationType:s=cs.Pop,navigator:r,static:o=!1,future:a}=n;na()&&wt(!1);let l=e.replace(/^\/*/,"/"),c=P.useMemo(()=>({basename:l,navigator:r,static:o,future:Nl({v7_relativeSplatPath:!1},a)}),[l,a,r,o]);typeof i=="string"&&(i=ta(i));let{pathname:u="/",search:f="",hash:m="",state:y=null,key:v="default"}=i,_=P.useMemo(()=>{let x=Tm(u,l);return x==null?null:{location:{pathname:x,search:f,hash:m,state:y,key:v},navigationType:s}},[l,u,f,m,y,v,s]);return _==null?null:P.createElement(Ds.Provider,{value:c},P.createElement(Id.Provider,{children:t,value:_}))}function Wv(n){let{children:e,location:t}=n;return ik(ap(e),t)}new Promise(()=>{});function ap(n,e){e===void 0&&(e=[]);let t=[];return P.Children.forEach(n,(i,s)=>{if(!P.isValidElement(i))return;let r=[...e,s];if(i.type===P.Fragment){t.push.apply(t,ap(i.props.children,r));return}i.type!==q&&wt(!1),!i.props.index||!i.props.children||wt(!1);let o={id:i.props.id||r.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=ap(i.props.children,r)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lp(){return lp=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},lp.apply(this,arguments)}function vk(n,e){if(n==null)return{};var t={},i=Object.keys(n),s,r;for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function wk(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function _k(n,e){return n.button===0&&(!e||e==="_self")&&!wk(n)}const bk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xk="6";try{window.__reactRouterVersion=xk}catch{}const Tk="startTransition",Kv=xP[Tk];function Ek(n){let{basename:e,children:t,future:i,window:s}=n,r=P.useRef();r.current==null&&(r.current=IP({window:s,v5Compat:!0}));let o=r.current,[a,l]=P.useState({action:o.action,location:o.location}),{v7_startTransition:c}=i||{},u=P.useCallback(f=>{c&&Kv?Kv(()=>l(f)):l(f)},[l,c]);return P.useLayoutEffect(()=>o.listen(u),[o,u]),P.useEffect(()=>gk(i),[i]),P.createElement(yk,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:i})}const Ak=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ik=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Be=P.forwardRef(function(e,t){let{onClick:i,relative:s,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:f}=e,m=vk(e,bk),{basename:y}=P.useContext(Ds),v,_=!1;if(typeof c=="string"&&Ik.test(c)&&(v=c,Ak))try{let C=new URL(window.location.href),D=c.startsWith("//")?new URL(C.protocol+c):new URL(c),F=Tm(D.pathname,y);D.origin===C.origin&&F!=null?c=F+D.search+D.hash:_=!0}catch{}let x=ZP(c,{relative:s}),T=Ck(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:f});function S(C){i&&i(C),C.defaultPrevented||T(C)}return P.createElement("a",lp({},m,{href:v||x,onClick:_||r?i:S,ref:t,target:l}))});var Yv;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Yv||(Yv={}));var Jv;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Jv||(Jv={}));function Ck(n,e){let{target:t,replace:i,state:s,preventScrollReset:r,relative:o,viewTransition:a}=e===void 0?{}:e,l=ia(),c=Ti(),u=ET(n,{relative:o});return P.useCallback(f=>{if(_k(f,t)){f.preventDefault();let m=i!==void 0?i:ju(c)===ju(u);l(n,{replace:m,state:s,preventScrollReset:r,relative:o,viewTransition:a})}},[c,l,u,i,s,t,n,r,o,a])}const Sk="modulepreload",Pk=function(n){return"/"+n},Xv={},fe=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=l(t.map(c=>{if(c=Pk(c),c in Xv)return;Xv[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Sk,u||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((y,v)=>{m.addEventListener("load",y),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},PT=P.createContext(void 0),kk=({children:n})=>{const[e,t]=P.useState(()=>{if(typeof window<"u"){const s=localStorage.getItem("theme");return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}return"light"});P.useEffect(()=>{const s=window.document.documentElement;e==="dark"?s.classList.add("dark"):s.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const i=()=>{t(s=>s==="light"?"dark":"light")};return p.jsx(PT.Provider,{value:{theme:e,toggleTheme:i},children:n})},Sm=()=>{const n=P.useContext(PT);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},Rk=()=>{};var Qv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Nk=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[t++];e[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=n[t++],o=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},RT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=r>>2,f=(r&3)<<4|a>>4;let m=(a&15)<<2|c>>6,y=c&63;l||(y=64,o||(m=64)),i.push(t[u],t[f],t[m],t[y])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(kT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Nk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,r==null||a==null||c==null||f==null)throw new Mk;const m=r<<2|a>>4;if(i.push(m),c!==64){const y=a<<4&240|c>>2;if(i.push(y),f!==64){const v=c<<6&192|f;i.push(v)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Mk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Dk=function(n){const e=kT(n);return RT.encodeByteArray(e,!0)},qu=function(n){return Dk(n).replace(/\./g,"")},Pm=function(n){try{return RT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Hu(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Lk(t)||(n[t]=Hu(n[t],e[t]));return n}function Lk(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=()=>km().__FIREBASE_DEFAULTS__,Vk=()=>{if(typeof process>"u"||typeof Qv>"u")return;const n=Qv.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Ok=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Pm(n[1]);return e&&JSON.parse(e)},Rm=()=>{try{return Rk()||Fk()||Vk()||Ok()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Nm=()=>Rm()?.config,Uk=n=>Rm()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mm(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[qu(JSON.stringify(t)),qu(JSON.stringify(o)),""].join(".")}const dl={};function zk(){const n={prod:[],emulator:[]};for(const e of Object.keys(dl))dl[e]?n.emulator.push(e):n.prod.push(e);return n}function jk(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Zv=!1;function Dm(n,e){if(typeof window>"u"||typeof document>"u"||!Ls(window.location.host)||dl[n]===e||dl[n]||Zv)return;dl[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",r=zk().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Zv=!0,o()},m}function u(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=jk(i),y=t("text"),v=document.getElementById(y)||document.createElement("span"),_=t("learnmore"),x=document.getElementById(_)||document.createElement("a"),T=t("preprendIcon"),S=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const C=m.element;a(C),u(x,_);const D=c();l(S,T),C.append(S,v,x,D),document.body.appendChild(C)}r?(v.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ot())}function Cd(){const n=Rm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Hk(){return typeof window<"u"||MT()}function MT(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Gk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Lm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LT(){const n=ot();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function FT(){return!Cd()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VT(){return!Cd()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Ml(){try{return typeof indexedDB=="object"}catch{return!1}}function $k(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="FirebaseError";class en extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Wk,Object.setPrototypeOf(this,en.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fr.prototype.create)}}class Fr{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?Kk(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new en(s,a,i)}}function Kk(n,e){return n.replace(Yk,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Yk=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Jk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bs(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const r=n[s],o=e[s];if(t0(r)&&t0(o)){if(!bs(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function t0(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function go(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,r]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function tl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function OT(n,e){const t=new Xk(n,e);return t.subscribe.bind(t)}class Xk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Qk(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Kh),s.error===void 0&&(s.error=Kh),s.complete===void 0&&(s.complete=Kh);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Qk(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Kh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(n){return n&&n._delegate?n._delegate:n}class Un{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Bk;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tR(e))try{this.getOrInitializeService({instanceIdentifier:tr})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(e=tr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tr){return this.instances.has(e)}getOptions(e=tr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&e(r,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:eR(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=tr){return this.component?this.component.multipleInstances?e:tr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eR(n){return n===tr?void 0:n}function tR(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Zk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=[];var Re;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Re||(Re={}));const BT={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},nR=Re.INFO,iR={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},sR=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=iR[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sd{constructor(e){this.name=e,this._logLevel=nR,this._logHandler=sR,this._userLogHandler=null,Fm.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...e),this._logHandler(this,Re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...e),this._logHandler(this,Re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Re.INFO,...e),this._logHandler(this,Re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Re.WARN,...e),this._logHandler(this,Re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...e),this._logHandler(this,Re.ERROR,...e)}}function rR(n){Fm.forEach(e=>{e.setLogLevel(n)})}function oR(n,e){for(const t of Fm){let i=null;e&&e.level&&(i=BT[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,r,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");r>=(i??s.logLevel)&&n({level:Re[r].toLowerCase(),message:a,args:o,type:s.name})}}}const aR=(n,e)=>e.some(t=>n instanceof t);let n0,i0;function lR(){return n0||(n0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cR(){return i0||(i0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zT=new WeakMap,cp=new WeakMap,jT=new WeakMap,Yh=new WeakMap,Vm=new WeakMap;function uR(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(ms(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&zT.set(t,n)}).catch(()=>{}),Vm.set(e,n),e}function dR(n){if(cp.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});cp.set(n,e)}let up={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||jT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ms(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hR(n){up=n(up)}function fR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Jh(this),e,...t);return jT.set(i,e.sort?e.sort():[e]),ms(i)}:cR().includes(n)?function(...e){return n.apply(Jh(this),e),ms(zT.get(this))}:function(...e){return ms(n.apply(Jh(this),e))}}function pR(n){return typeof n=="function"?fR(n):(n instanceof IDBTransaction&&dR(n),aR(n,lR())?new Proxy(n,up):n)}function ms(n){if(n instanceof IDBRequest)return uR(n);if(Yh.has(n))return Yh.get(n);const e=pR(n);return e!==n&&(Yh.set(n,e),Vm.set(e,n)),e}const Jh=n=>Vm.get(n);function mR(n,e,{blocked:t,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,e),a=ms(o);return i&&o.addEventListener("upgradeneeded",l=>{i(ms(o.result),l.oldVersion,l.newVersion,ms(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const gR=["get","getKey","getAll","getAllKeys","count"],yR=["put","add","delete","clear"],Xh=new Map;function s0(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Xh.get(e))return Xh.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=yR.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||gR.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Xh.set(e,r),r}hR(n=>({...n,get:(e,t,i)=>s0(e,t)||n.get(e,t,i),has:(e,t)=>!!s0(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wR(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function wR(n){return n.getComponent()?.type==="VERSION"}const Gu="@firebase/app",dp="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new Sd("@firebase/app"),_R="@firebase/app-compat",bR="@firebase/analytics-compat",xR="@firebase/analytics",TR="@firebase/app-check-compat",ER="@firebase/app-check",AR="@firebase/auth",IR="@firebase/auth-compat",CR="@firebase/database",SR="@firebase/data-connect",PR="@firebase/database-compat",kR="@firebase/functions",RR="@firebase/functions-compat",NR="@firebase/installations",MR="@firebase/installations-compat",DR="@firebase/messaging",LR="@firebase/messaging-compat",FR="@firebase/performance",VR="@firebase/performance-compat",OR="@firebase/remote-config",UR="@firebase/remote-config-compat",BR="@firebase/storage",zR="@firebase/storage-compat",jR="@firebase/firestore",qR="@firebase/ai",HR="@firebase/firestore-compat",GR="firebase",$R="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs="[DEFAULT]",WR={[Gu]:"fire-core",[_R]:"fire-core-compat",[xR]:"fire-analytics",[bR]:"fire-analytics-compat",[ER]:"fire-app-check",[TR]:"fire-app-check-compat",[AR]:"fire-auth",[IR]:"fire-auth-compat",[CR]:"fire-rtdb",[SR]:"fire-data-connect",[PR]:"fire-rtdb-compat",[kR]:"fire-fn",[RR]:"fire-fn-compat",[NR]:"fire-iid",[MR]:"fire-iid-compat",[DR]:"fire-fcm",[LR]:"fire-fcm-compat",[FR]:"fire-perf",[VR]:"fire-perf-compat",[OR]:"fire-rc",[UR]:"fire-rc-compat",[BR]:"fire-gcs",[zR]:"fire-gcs-compat",[jR]:"fire-fst",[HR]:"fire-fst-compat",[qR]:"fire-vertex","fire-js":"fire-js",[GR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new Map,ko=new Map,Ro=new Map;function Dl(n,e){try{n.container.addComponent(e)}catch(t){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function qT(n,e){n.container.addOrOverwriteComponent(e)}function Fi(n){const e=n.name;if(Ro.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;Ro.set(e,n);for(const t of Ts.values())Dl(t,n);for(const t of ko.values())Dl(t,n);return!0}function HT(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function KR(n,e,t=xs){HT(n,e).clearInstance(t)}function Om(n){return n.options!==void 0}function GT(n){return Om(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Ze(n){return n==null?!1:n.settings!==void 0}function YR(){Ro.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pn=new Fr("app","Firebase",JR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $T=class{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n,e){const t=Pm(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(t).exp*1e3,r=new Date().getTime();s-r<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class XR extends $T{constructor(e,t,i,s){const r=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,o={name:i,automaticDataCollectionEnabled:r};if(e.apiKey!==void 0)super(e,o,s);else{const a=e;super(a.options,o,s)}this._serverConfig={automaticDataCollectionEnabled:r,...t},this._serverConfig.authIdToken&&r0(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&r0(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,kn(Gu,dp,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Bm(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Pn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=$R;function Um(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:xs,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw Pn.create("bad-app-name",{appName:String(s)});if(t||(t=Nm()),!t)throw Pn.create("no-options");const r=Ts.get(s);if(r){if(bs(t,r.options)&&bs(i,r.config))return r;throw Pn.create("duplicate-app",{appName:s})}const o=new UT(s);for(const l of Ro.values())o.addComponent(l);const a=new $T(t,i,o);return Ts.set(s,a),a}function QR(n,e={}){if(Hk()&&!MT())throw Pn.create("invalid-server-app-environment");let t,i=e||{};if(n&&(Om(n)?t=n.options:GT(n)?i=n:t=n),i.automaticDataCollectionEnabled===void 0&&(i.automaticDataCollectionEnabled=!0),t||(t=Nm()),!t)throw Pn.create("no-options");const s={...i,...t};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const r=u=>[...u].reduce((f,m)=>Math.imul(31,f)+m.charCodeAt(0)|0,0);if(i.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Pn.create("finalization-registry-not-supported",{});const o=""+r(JSON.stringify(s)),a=ko.get(o);if(a)return a.incRefCount(i.releaseOnDeref),a;const l=new UT(o);for(const u of Ro.values())l.addComponent(u);const c=new XR(t,i,o,l);return ko.set(o,c),c}function ZR(n=xs){const e=Ts.get(n);if(!e&&n===xs&&Nm())return Um();if(!e)throw Pn.create("no-app",{appName:n});return e}function eN(){return Array.from(Ts.values())}async function Bm(n){let e=!1;const t=n.name;Ts.has(t)?(e=!0,Ts.delete(t)):ko.has(t)&&n.decRefCount()<=0&&(ko.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function kn(n,e,t){let i=WR[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),r=e.match(/\s|\//);if(s||r){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(o.join(" "));return}Fi(new Un(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function WT(n,e){if(n!==null&&typeof n!="function")throw Pn.create("invalid-log-argument");oR(n,e)}function KT(n){rR(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN="firebase-heartbeat-database",nN=1,Ll="firebase-heartbeat-store";let Qh=null;function YT(){return Qh||(Qh=mR(tN,nN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ll)}catch(t){console.warn(t)}}}}).catch(n=>{throw Pn.create("idb-open",{originalErrorMessage:n.message})})),Qh}async function iN(n){try{const t=(await YT()).transaction(Ll),i=await t.objectStore(Ll).get(JT(n));return await t.done,i}catch(e){if(e instanceof en)Li.warn(e.message);else{const t=Pn.create("idb-get",{originalErrorMessage:e?.message});Li.warn(t.message)}}}async function o0(n,e){try{const i=(await YT()).transaction(Ll,"readwrite");await i.objectStore(Ll).put(e,JT(n)),await i.done}catch(t){if(t instanceof en)Li.warn(t.message);else{const i=Pn.create("idb-set",{originalErrorMessage:t?.message});Li.warn(i.message)}}}function JT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=1024,rN=30;class oN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=a0();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>rN){const s=cN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Li.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=a0(),{heartbeatsToSend:t,unsentEntries:i}=aN(this._heartbeatsCache.heartbeats),s=qu(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Li.warn(e),""}}}function a0(){return new Date().toISOString().substring(0,10)}function aN(n,e=sN){const t=[];let i=n.slice();for(const s of n){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),l0(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),l0(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class lN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ml()?$k().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await iN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return o0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return o0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function l0(n){return qu(JSON.stringify({version:2,heartbeats:n})).length}function cN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(n){Fi(new Un("platform-logger",e=>new vR(e),"PRIVATE")),Fi(new Un("heartbeat",e=>new oN(e),"PRIVATE")),kn(Gu,dp,n),kn(Gu,dp,"esm2020"),kn("fire-js","")}uN("");const dN=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:en,SDK_VERSION:Bi,_DEFAULT_ENTRY_NAME:xs,_addComponent:Dl,_addOrOverwriteComponent:qT,_apps:Ts,_clearComponents:YR,_components:Ro,_getProvider:HT,_isFirebaseApp:Om,_isFirebaseServerApp:Ze,_isFirebaseServerAppSettings:GT,_registerComponent:Fi,_removeServiceInstance:KR,_serverApps:ko,deleteApp:Bm,getApp:ZR,getApps:eN,initializeApp:Um,initializeServerApp:QR,onLog:WT,registerVersion:kn,setLogLevel:KT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,t){this._delegate=e,this.firebase=t,Dl(e,new Un("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Bm(this._delegate)))}_getService(e,t=xs){this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&i.getComponent()?.instantiationMode==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=xs){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Dl(this._delegate,e)}_addOrOverwriteComponent(e){qT(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},c0=new Fr("app-compat","Firebase",fN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(n){const e={},t={__esModule:!0,initializeApp:r,app:s,registerVersion:kn,setLogLevel:KT,onLog:WT,apps:null,SDK_VERSION:Bi,INTERNAL:{registerComponent:a,removeApp:i,useAsService:l,modularAPIs:dN}};t.default=t,Object.defineProperty(t,"apps",{get:o});function i(c){delete e[c]}function s(c){if(c=c||xs,!e0(e,c))throw c0.create("no-app",{appName:c});return e[c]}s.App=n;function r(c,u={}){const f=Um(c,u);if(e0(e,f.name))return e[f.name];const m=new n(f,t);return e[f.name]=m,m}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const u=c.name,f=u.replace("-compat","");if(Fi(c)&&c.type==="PUBLIC"){const m=(y=s())=>{if(typeof y[f]!="function")throw c0.create("invalid-app-argument",{appName:u});return y[f]()};c.serviceProps!==void 0&&Hu(m,c.serviceProps),t[f]=m,n.prototype[f]=function(...y){return this._getService.bind(this,u).apply(this,c.multipleInstances?y:[])}}return c.type==="PUBLIC"?t[f]:null}function l(c,u){return u==="serverAuth"?null:u}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(){const n=pN(hN);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:XT,extendNamespace:e,createSubscribe:OT,ErrorFactory:Fr,deepExtend:Hu};function e(t){Hu(n,t)}return n}const mN=XT();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=new Sd("@firebase/app-compat"),gN="@firebase/app-compat",yN="0.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(n){kn(gN,yN,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=km();if(n.firebase!==void 0){u0.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&u0.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Vt=mN;vN();var wN="firebase",_N="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vt.registerVersion(wN,_N,"app-compat");const Ua={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},eo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function QT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xN=bN,TN=QT,ZT=new Fr("auth","Firebase",QT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=new Sd("@firebase/auth");function EN(n,...e){$u.logLevel<=Re.WARN&&$u.warn(`Auth (${Bi}): ${n}`,...e)}function Tu(n,...e){$u.logLevel<=Re.ERROR&&$u.error(`Auth (${Bi}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(n,...e){throw jm(n,...e)}function kt(n,...e){return jm(n,...e)}function zm(n,e,t){const i={...TN(),[e]:t};return new Fr("auth","Firebase",i).create(e,{appName:n.name})}function Ot(n){return zm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ra(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&qt(n,"argument-error"),zm(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jm(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ZT.create(n,...e)}function J(n,e,...t){if(!n)throw jm(e,...t)}function hi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Tu(e),new Error(e)}function Jn(n,e){n||hi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(){return typeof self<"u"&&self.location?.href||""}function qm(){return d0()==="http:"||d0()==="https:"}function d0(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qm()||DT()||"connection"in navigator)?navigator.onLine:!0}function IN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Jn(t>e,"Short delay should be less than long delay!"),this.isMobile=qk()||Lm()}get(){return AN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(n,e){Jn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PN=new uc(3e4,6e4);function ft(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function pt(n,e,t,i,s={}){return tE(n,s,async()=>{let r={},o={};i&&(e==="GET"?o=i:r={body:JSON.stringify(i)});const a=sa({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...r};return Gk()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Ls(n.emulatorConfig.host)&&(c.credentials="include"),eE.fetch()(await nE(n,n.config.apiHost,t,a),c)})}async function tE(n,e,t){n._canInitEmulator=!1;const i={...CN,...e};try{const s=new RN(n),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw nl(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw nl(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw nl(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw nl(n,"user-disabled",o);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw zm(n,u,c);qt(n,u)}}catch(s){if(s instanceof en)throw s;qt(n,"network-request-failed",{message:String(s)})}}async function zi(n,e,t,i,s={}){const r=await pt(n,e,t,i,s);return"mfaPendingCredential"in r&&qt(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function nE(n,e,t,i){const s=`${e}${t}?${i}`,r=n,o=r.config.emulator?Hm(n.config,s):`${n.config.apiScheme}://${s}`;return SN.includes(t)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}function kN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class RN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(kt(this.auth,"network-request-failed")),PN.get())})}}function nl(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=kt(n,e,i);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(n){return n!==void 0&&n.getResponse!==void 0}function f0(n){return n!==void 0&&n.enterprise!==void 0}class iE{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NN(n){return(await pt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function sE(n,e){return pt(n,"GET","/v2/recaptchaConfig",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MN(n,e){return pt(n,"POST","/v1/accounts:delete",e)}async function DN(n,e){return pt(n,"POST","/v1/accounts:update",e)}async function Wu(n,e){return pt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LN(n,e=!1){const t=de(n),i=await t.getIdToken(e),s=Pd(i);J(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:i,authTime:hl(Zh(s.auth_time)),issuedAtTime:hl(Zh(s.iat)),expirationTime:hl(Zh(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Zh(n){return Number(n)*1e3}function Pd(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Tu("JWT malformed, contained fewer than 3 sections"),null;try{const s=Pm(t);return s?JSON.parse(s):(Tu("Failed to decode base64 JWT payload"),null)}catch(s){return Tu("Caught error parsing JWT payload as JSON",s?.toString()),null}}function p0(n){const e=Pd(n);return J(e,"internal-error"),J(typeof e.exp<"u","internal-error"),J(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vi(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof en&&FN(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function FN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hl(this.lastLoginAt),this.creationTime=hl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(n){const e=n.auth,t=await n.getIdToken(),i=await Vi(n,Wu(e,{idToken:t}));J(i?.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const r=s.providerUserInfo?.length?rE(s.providerUserInfo):[],o=UN(n.providerData,r),a=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!o?.length,c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new hp(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function ON(n){const e=de(n);await Vl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UN(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function rE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(n,e){const t=await tE(n,{},async()=>{const i=sa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=await nE(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:i};return n.emulatorConfig&&Ls(n.emulatorConfig.host)&&(l.credentials="include"),eE.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function zN(n,e){return pt(n,"POST","/v2/accounts:revokeToken",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){J(e.idToken,"internal-error"),J(typeof e.idToken<"u","internal-error"),J(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):p0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){J(e.length!==0,"internal-error");const t=p0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(J(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:r}=await BN(e,t);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:r}=t,o=new wo;return i&&(J(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),s&&(J(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(J(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wo,this.toJSON())}_performRefresh(){return hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(n,e){J(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Wn{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new VN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Vi(this,this.stsTokenManager.getToken(this.auth,e));return J(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return LN(this,e)}reload(){return ON(this)}_assign(e){this!==e&&(J(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Wn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){J(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vl(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ze(this.auth.app))return Promise.reject(Ot(this.auth));const e=await this.getIdToken();return await Vi(this,MN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,r=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:y,providerData:v,stsTokenManager:_}=t;J(f&&_,e,"internal-error");const x=wo.fromJSON(this.name,_);J(typeof f=="string",e,"internal-error"),ts(i,e.name),ts(s,e.name),J(typeof m=="boolean",e,"internal-error"),J(typeof y=="boolean",e,"internal-error"),ts(r,e.name),ts(o,e.name),ts(a,e.name),ts(l,e.name),ts(c,e.name),ts(u,e.name);const T=new Wn({uid:f,auth:e,email:s,emailVerified:m,displayName:i,isAnonymous:y,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:x,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(T.providerData=v.map(S=>({...S}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,i=!1){const s=new wo;s.updateFromServerResponse(t);const r=new Wn({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await Vl(r),r}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];J(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?rE(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,a=new wo;a.updateFromIdToken(i);const l=new Wn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new hp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=new Map;function Sn(n){Jn(n instanceof Function,"Expected a class definition");let e=m0.get(n);return e?(Jn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,m0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oE.type="NONE";const No=oE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(n,e,t){return`firebase:${n}:${e}:${t}`}class _o{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=gr(this.userKey,s.apiKey,r),this.fullPersistenceKey=gr("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Wu(this.auth,{idToken:e}).catch(()=>{});return t?Wn._fromGetAccountInfoResponse(this.auth,t,e):null}return Wn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new _o(Sn(No),e,i);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=s[0]||Sn(No);const o=gr(i,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let f;if(typeof u=="string"){const m=await Wu(e,{idToken:u}).catch(()=>{});if(!m)break;f=await Wn._fromGetAccountInfoResponse(e,m,u)}else f=Wn._fromJSON(e,u);c!==r&&(a=f),r=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new _o(r,e,i):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new _o(r,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dE(e))return"Blackberry";if(hE(e))return"Webos";if(lE(e))return"Safari";if((e.includes("chrome/")||cE(e))&&!e.includes("edge/"))return"Chrome";if(dc(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function aE(n=ot()){return/firefox\//i.test(n)}function lE(n=ot()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cE(n=ot()){return/crios\//i.test(n)}function uE(n=ot()){return/iemobile/i.test(n)}function dc(n=ot()){return/android/i.test(n)}function dE(n=ot()){return/blackberry/i.test(n)}function hE(n=ot()){return/webos/i.test(n)}function hc(n=ot()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function jN(n=ot()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function qN(n=ot()){return hc(n)&&!!window.navigator?.standalone}function HN(){return LT()&&document.documentMode===10}function fE(n=ot()){return hc(n)||dc(n)||hE(n)||dE(n)||/windows phone/i.test(n)||uE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(n,e=[]){let t;switch(n){case"Browser":t=g0(ot());break;case"Worker":t=`${g0(ot())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Bi}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(n,e={}){return pt(n,"GET","/v2/passwordPolicy",ft(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=6;class KN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??WN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new y0(this),this.idTokenSubscription=new y0(this),this.beforeStateQueue=new GN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sn(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _o.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Wu(this,{idToken:e}),i=await Wn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ze(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!r||r===o)&&a?.user&&(i=a.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return J(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vl(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ze(this.app))return Promise.reject(Ot(this));const t=e?de(e):null;return t&&J(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&J(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ze(this.app)?Promise.reject(Ot(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ze(this.app)?Promise.reject(Ot(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $N(this),t=new KN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fr("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await zN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sn(e)||this._popupRedirectResolver;J(t,this,"argument-error"),this.redirectPersistenceManager=await _o.create(this,[Sn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(J(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return J(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ze(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&EN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function at(n){return de(n)}class y0{constructor(e){this.auth=e,this.observer=null,this.addObserver=OT(t=>this.observer=t)}get next(){return J(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JN(n){fc=n}function Gm(n){return fc.loadJS(n)}function XN(){return fc.recaptchaV2Script}function QN(){return fc.recaptchaEnterpriseScript}function ZN(){return fc.gapiScript}function mE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM=500,tM=6e4,tu=1e12;class nM{constructor(e){this.auth=e,this.counter=tu,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new rM(e,this.auth.name,t||{})),this.counter++,i}reset(e){const t=e||tu;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||tu;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||tu;return this._widgets.get(t)?.execute(),""}}class iM{constructor(){this.enterprise=new sM}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class sM{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rM{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;J(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=oM(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},tM)},eM))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function oM(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const aM="recaptcha-enterprise",fl="NO_RECAPTCHA";class gE{constructor(e){this.type=aM,this.auth=at(e)}async verify(e="verify",t=!1){async function i(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{sE(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new iE(l);return r.tenantId==null?r._agentRecaptchaConfig=c:r._tenantRecaptchaConfigs[r.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(r,o,a){const l=window.grecaptcha;f0(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(c=>{o(c)}).catch(()=>{o(fl)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new iM().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{i(this.auth).then(a=>{if(!t&&f0(window.grecaptcha))s(a,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=QN();l.length!==0&&(l+=a),Gm(l).then(()=>{s(a,r,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Ba(n,e,t,i=!1,s=!1){const r=new gE(n);let o;if(s)o=fl;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function gs(n,e,t,i,s){if(s==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Ba(n,e,t,t==="getOobCode");return i(n,r)}else return i(n,e).catch(async r=>{if(r.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Ba(n,e,t,t==="getOobCode");return i(n,o)}else return Promise.reject(r)});else if(s==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const r=await Ba(n,e,t);return i(n,r).catch(async o=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(o.code==="auth/missing-recaptcha-token"||o.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const a=await Ba(n,e,t,!1,!0);return i(n,a)}return Promise.reject(o)})}else{const r=await Ba(n,e,t,!1,!0);return i(n,r)}else return Promise.reject(s+" provider is not supported.")}async function lM(n){const e=at(n),t=await sE(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new iE(t);e.tenantId==null?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.isAnyProviderEnabled()&&new gE(e).verify()}function cM(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Sn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function uM(n,e,t){const i=at(n);J(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!t?.disableWarnings,r=yE(e),{host:o,port:a}=dM(e),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){J(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),J(bs(c,i.config.emulator)&&bs(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,Ls(o)?(Mm(`${r}//${o}${l}`),Dm("Auth",!0)):s||hM()}function yE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function dM(n){const e=yE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:v0(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:v0(o)}}}function v0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function hM(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hi("not implemented")}_getIdTokenResponse(e){return hi("not implemented")}_linkToIdToken(e,t){return hi("not implemented")}_getReauthenticationResolver(e){return hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vE(n,e){return pt(n,"POST","/v1/accounts:resetPassword",ft(n,e))}async function fM(n,e){return pt(n,"POST","/v1/accounts:update",e)}async function pM(n,e){return pt(n,"POST","/v1/accounts:signUp",e)}async function mM(n,e){return pt(n,"POST","/v1/accounts:update",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gM(n,e){return zi(n,"POST","/v1/accounts:signInWithPassword",ft(n,e))}async function kd(n,e){return pt(n,"POST","/v1/accounts:sendOobCode",ft(n,e))}async function yM(n,e){return kd(n,e)}async function vM(n,e){return kd(n,e)}async function wM(n,e){return kd(n,e)}async function _M(n,e){return kd(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bM(n,e){return zi(n,"POST","/v1/accounts:signInWithEmailLink",ft(n,e))}async function xM(n,e){return zi(n,"POST","/v1/accounts:signInWithEmailLink",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends oa{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Ol(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ol(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gs(e,t,"signInWithPassword",gM,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return bM(e,{email:this._email,oobCode:this._password});default:qt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gs(e,i,"signUpPassword",pM,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return xM(e,{idToken:t,email:this._email,oobCode:this._password});default:qt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mi(n,e){return zi(n,"POST","/v1/accounts:signInWithIdp",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="http://localhost";class wi extends oa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...r}=t;if(!i||!s)return null;const o=new wi(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Mi(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Mi(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Mi(e,t)}buildRequest(){const e={requestUri:TM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=sa(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(n,e){return pt(n,"POST","/v1/accounts:sendVerificationCode",ft(n,e))}async function EM(n,e){return zi(n,"POST","/v1/accounts:signInWithPhoneNumber",ft(n,e))}async function AM(n,e){const t=await zi(n,"POST","/v1/accounts:signInWithPhoneNumber",ft(n,e));if(t.temporaryProof)throw nl(n,"account-exists-with-different-credential",t);return t}const IM={USER_NOT_FOUND:"user-not-found"};async function CM(n,e){const t={...e,operation:"REAUTH"};return zi(n,"POST","/v1/accounts:signInWithPhoneNumber",ft(n,t),IM)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends oa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new yr({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new yr({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return EM(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return AM(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return CM(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:r}=e;return!i&&!t&&!s&&!r?null:new yr({verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PM(n){const e=go(tl(n)).link,t=e?go(tl(e)).deep_link_id:null,i=go(tl(n)).deep_link_id;return(i?go(tl(i)).link:null)||i||t||e||n}class Rd{constructor(e){const t=go(tl(e)),i=t.apiKey??null,s=t.oobCode??null,r=SM(t.mode??null);J(i&&s&&r,"argument-error"),this.apiKey=i,this.operation=r,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=PM(e);try{return new Rd(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){this.providerId=Fs.PROVIDER_ID}static credential(e,t){return Ol._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Rd.parseLink(t);return J(i,"argument-error"),Ol._fromEmailAndCode(e,i.code,i.tenantId)}}Fs.PROVIDER_ID="password";Fs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Fs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa extends ji{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bo extends aa{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return J("providerId"in t&&"signInMethod"in t,"argument-error"),wi._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return J(e.idToken||e.accessToken,"argument-error"),wi._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return bo.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return bo.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:r,nonce:o,providerId:a}=e;if(!i&&!s&&!t&&!r||!a)return null;try{return new bo(a)._credential({idToken:t,accessToken:i,nonce:o,pendingToken:r})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends aa{constructor(){super("facebook.com")}static credential(e){return wi._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ai.credential(e.oauthAccessToken)}catch{return null}}}ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";ai.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends aa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wi._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return li.credential(t,i)}catch{return null}}}li.GOOGLE_SIGN_IN_METHOD="google.com";li.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci extends aa{constructor(){super("github.com")}static credential(e){return wi._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ci.credential(e.oauthAccessToken)}catch{return null}}}ci.GITHUB_SIGN_IN_METHOD="github.com";ci.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM="http://localhost";class Mo extends oa{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Mi(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Mi(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Mi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,pendingToken:r}=t;return!i||!s||!r||i!==s?null:new Mo(i,r)}static _create(e,t){return new Mo(e,t)}buildRequest(){return{requestUri:kM,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM="saml.";class Ku extends ji{constructor(e){J(e.startsWith(RM),"argument-error"),super(e)}static credentialFromResult(e){return Ku.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Ku.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Mo.fromJSON(e);return J(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:i}=e;if(!t||!i)return null;try{return Mo._create(i,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends aa{constructor(){super("twitter.com")}static credential(e,t){return wi._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ui.credential(t,i)}catch{return null}}}ui.TWITTER_SIGN_IN_METHOD="twitter.com";ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wE(n,e){return zi(n,"POST","/v1/accounts:signUp",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const r=await Wn._fromIdTokenResponse(e,i,s),o=_0(i);return new Bn({user:r,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=_0(i);return new Bn({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function _0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NM(n){if(Ze(n.app))return Promise.reject(Ot(n));const e=at(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Bn({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await wE(e,{returnSecureToken:!0}),i=await Bn._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu extends en{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Yu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Yu(e,t,i,s)}}function _E(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Yu._fromErrorAndOperation(n,r,e,i):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MM(n,e){const t=de(n);await Nd(!0,t,e);const{providerUserInfo:i}=await DN(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=bE(i||[]);return t.providerData=t.providerData.filter(r=>s.has(r.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function $m(n,e,t=!1){const i=await Vi(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Bn._forOperation(n,"link",i)}async function Nd(n,e,t){await Vl(e);const i=bE(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";J(i.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xE(n,e,t=!1){const{auth:i}=n;if(Ze(i.app))return Promise.reject(Ot(i));const s="reauthenticate";try{const r=await Vi(n,_E(i,s,e,n),t);J(r.idToken,i,"internal-error");const o=Pd(r.idToken);J(o,i,"internal-error");const{sub:a}=o;return J(n.uid===a,i,"user-mismatch"),Bn._forOperation(n,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&qt(i,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TE(n,e,t=!1){if(Ze(n.app))return Promise.reject(Ot(n));const i="signIn",s=await _E(n,i,e),r=await Bn._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(r.user),r}async function Md(n,e){return TE(at(n),e)}async function EE(n,e){const t=de(n);return await Nd(!1,t,e.providerId),$m(t,e)}async function AE(n,e){return xE(de(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DM(n,e){return zi(n,"POST","/v1/accounts:signInWithCustomToken",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LM(n,e){if(Ze(n.app))return Promise.reject(Ot(n));const t=at(n),i=await DM(t,{token:e,returnSecureToken:!0}),s=await Bn._fromIdTokenResponse(t,"signIn",i);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Wm._fromServerResponse(e,t):"totpInfo"in t?Km._fromServerResponse(e,t):qt(e,"internal-error")}}class Wm extends pc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Wm(t)}}class Km extends pc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Km(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(n,e,t){J(t.url?.length>0,n,"invalid-continue-uri"),J(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),J(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(J(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(J(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ym(n){const e=at(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FM(n,e,t){const i=at(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Dd(i,s,t),await gs(i,s,"getOobCode",vM,"EMAIL_PASSWORD_PROVIDER")}async function VM(n,e,t){await vE(de(n),{oobCode:e,newPassword:t}).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Ym(n),i})}async function OM(n,e){await mM(de(n),{oobCode:e})}async function IE(n,e){const t=de(n),i=await vE(t,{oobCode:e}),s=i.requestType;switch(J(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":J(i.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":J(i.mfaInfo,t,"internal-error");default:J(i.email,t,"internal-error")}let r=null;return i.mfaInfo&&(r=pc._fromServerResponse(at(t),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:r},operation:s}}async function UM(n,e){const{data:t}=await IE(de(n),e);return t.email}async function BM(n,e,t){if(Ze(n.app))return Promise.reject(Ot(n));const i=at(n),o=await gs(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wE,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Ym(n),l}),a=await Bn._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function zM(n,e,t){return Ze(n.app)?Promise.reject(Ot(n)):Md(de(n),Fs.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Ym(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jM(n,e,t){const i=at(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function r(o,a){J(a.handleCodeInApp,i,"argument-error"),a&&Dd(i,o,a)}r(s,t),await gs(i,s,"getOobCode",wM,"EMAIL_PASSWORD_PROVIDER")}function qM(n,e){return Rd.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function HM(n,e,t){if(Ze(n.app))return Promise.reject(Ot(n));const i=de(n),s=Fs.credentialWithLink(e,t||Fl());return J(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Md(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GM(n,e){return pt(n,"POST","/v1/accounts:createAuthUri",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $M(n,e){const t=qm()?Fl():"http://localhost",i={identifier:e,continueUri:t},{signinMethods:s}=await GM(de(n),i);return s||[]}async function WM(n,e){const t=de(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Dd(t.auth,s,e);const{email:r}=await yM(t.auth,s);r!==n.email&&await n.reload()}async function KM(n,e,t){const i=de(n),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Dd(i.auth,r,t);const{email:o}=await _M(i.auth,r);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YM(n,e){return pt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JM(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=de(n),r={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Vi(i,YM(i.auth,r));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function XM(n,e){const t=de(n);return Ze(t.auth.app)?Promise.reject(Ot(t.auth)):CE(t,e,null)}function QM(n,e){return CE(de(n),null,e)}async function CE(n,e,t){const{auth:i}=n,r={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(r.email=e),t&&(r.password=t);const o=await Vi(n,fM(i,r));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},i=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const s=Pd(n.idToken)?.firebase?.sign_in_provider;if(s){const r=s!=="anonymous"&&s!=="custom"?s:null;return new xo(i,r)}}if(!e)return null;switch(e){case"facebook.com":return new eD(i,t);case"github.com":return new tD(i,t);case"google.com":return new nD(i,t);case"twitter.com":return new iD(i,t,n.screenName||null);case"custom":case"anonymous":return new xo(i,null);default:return new xo(i,e,t)}}class xo{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class SE extends xo{constructor(e,t,i,s){super(e,t,i),this.username=s}}class eD extends xo{constructor(e,t){super(e,"facebook.com",t)}}class tD extends SE{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class nD extends xo{constructor(e,t){super(e,"google.com",t)}}class iD extends SE{constructor(e,t,i){super(e,"twitter.com",t,i)}}function sD(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:ZM(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new dr("enroll",e,t)}static _fromMfaPendingCredential(e){return new dr("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return dr._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return dr._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){const i=at(e),s=t.customData._serverResponse,r=(s.mfaInfo||[]).map(a=>pc._fromServerResponse(i,a));J(s.mfaPendingCredential,i,"internal-error");const o=dr._fromMfaPendingCredential(s.mfaPendingCredential);return new Jm(o,r,async a=>{const l=await a._process(i,o);delete s.mfaInfo,delete s.mfaPendingCredential;const c={...s,idToken:l.idToken,refreshToken:l.refreshToken};switch(t.operationType){case"signIn":const u=await Bn._fromIdTokenResponse(i,t.operationType,c);return await i._updateCurrentUser(u.user),u;case"reauthenticate":return J(t.user,i,"internal-error"),Bn._forOperation(t.user,t.operationType,c);default:qt(i,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function rD(n,e){const t=de(n),i=e;return J(e.customData.operationType,t,"argument-error"),J(i.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),Jm._fromError(t,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(n,e){return pt(n,"POST","/v2/accounts/mfaEnrollment:start",ft(n,e))}function oD(n,e){return pt(n,"POST","/v2/accounts/mfaEnrollment:finalize",ft(n,e))}function aD(n,e){return pt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ft(n,e))}class Xm{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(i=>pc._fromServerResponse(e.auth,i)))})}static _fromUser(e){return new Xm(e)}async getSession(){return dr._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const i=e,s=await this.getSession(),r=await Vi(this.user,i._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,i=await this.user.getIdToken();try{const s=await Vi(this.user,aD(this.user.auth,{idToken:i,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:r})=>r!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const ef=new WeakMap;function lD(n){const e=de(n);return ef.has(e)||ef.set(e,Xm._fromUser(e)),ef.get(e)}const Ju="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ju,"1"),this.storage.removeItem(Ju),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=1e3,uD=10;class kE extends PE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);HN()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,uD):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},cD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}kE.type="LOCAL";const Qm=kE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE extends PE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}RE.type="SESSION";const _r=RE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new Ld(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,r)),l=await dD(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ld.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=mc("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(m.data.response);break;default:clearTimeout(u),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return window}function fD(n){At().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(){return typeof At().WorkerGlobalScope<"u"&&typeof At().importScripts=="function"}async function pD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mD(){return navigator?.serviceWorker?.controller||null}function gD(){return Zm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="firebaseLocalStorageDb",yD=1,Xu="firebaseLocalStorage",ME="fbase_key";class gc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fd(n,e){return n.transaction([Xu],e?"readwrite":"readonly").objectStore(Xu)}function vD(){const n=indexedDB.deleteDatabase(NE);return new gc(n).toPromise()}function fp(){const n=indexedDB.open(NE,yD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Xu,{keyPath:ME})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Xu)?e(i):(i.close(),await vD(),e(await fp()))})})}async function x0(n,e,t){const i=Fd(n,!0).put({[ME]:e,value:t});return new gc(i).toPromise()}async function wD(n,e){const t=Fd(n,!1).get(e),i=await new gc(t).toPromise();return i===void 0?null:i.value}function T0(n,e){const t=Fd(n,!0).delete(e);return new gc(t).toPromise()}const _D=800,bD=3;class DE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>bD)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ld._getInstance(gD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await pD(),!this.activeServiceWorker)return;this.sender=new hD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fp();return await x0(e,Ju,"1"),await T0(e,Ju),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>x0(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>wD(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>T0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=Fd(s,!1).getAll();return new gc(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_D)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}DE.type="LOCAL";const Ul=DE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n,e){return pt(n,"POST","/v2/accounts/mfaSignIn:start",ft(n,e))}function xD(n,e){return pt(n,"POST","/v2/accounts/mfaSignIn:finalize",ft(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf=mE("rcb"),TD=new uc(3e4,6e4);class ED{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!At().grecaptcha?.render}load(e,t=""){return J(AD(t),e,"argument-error"),this.shouldResolveImmediately(t)&&h0(At().grecaptcha)?Promise.resolve(At().grecaptcha):new Promise((i,s)=>{const r=At().setTimeout(()=>{s(kt(e,"network-request-failed"))},TD.get());At()[tf]=()=>{At().clearTimeout(r),delete At()[tf];const a=At().grecaptcha;if(!a||!h0(a)){s(kt(e,"internal-error"));return}const l=a.render;a.render=(c,u)=>{const f=l(c,u);return this.counter++,f},this.hostLanguage=t,i(a)};const o=`${XN()}?${sa({onload:tf,render:"explicit",hl:t})}`;Gm(o).catch(()=>{clearTimeout(r),s(kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!At().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function AD(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class ID{async load(e){return new nM(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="recaptcha",CD={theme:"light",type:"image"};let SD=class{constructor(e,t,i={...CD}){this.parameters=i,this.type=pl,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=at(e),this.isInvisible=this.parameters.size==="invisible",J(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;J(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ID:new ED,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(s=>{const r=o=>{o&&(this.tokenChangeListeners.delete(r),s(o))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){J(!this.parameters.sitekey,this.auth,"argument-error"),J(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),J(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=At()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){J(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){J(qm()&&!Zm(),this.auth,"internal-error"),await PD(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await NN(this.auth);J(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return J(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function PD(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=yr._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function kD(n,e,t){if(Ze(n.app))return Promise.reject(Ot(n));const i=at(n),s=await Vd(i,e,de(t));return new eg(s,r=>Md(i,r))}async function RD(n,e,t){const i=de(n);await Nd(!1,i,"phone");const s=await Vd(i.auth,e,de(t));return new eg(s,r=>EE(i,r))}async function ND(n,e,t){const i=de(n);if(Ze(i.auth.app))return Promise.reject(Ot(i.auth));const s=await Vd(i.auth,e,de(t));return new eg(s,r=>AE(i,r))}async function Vd(n,e,t){if(!n._getRecaptchaConfig())try{await lM(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const s=i.session;if("phoneNumber"in i){J(s.type==="enroll",n,"internal-error");const r={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await gs(n,r,"mfaSmsEnrollment",async(c,u)=>{if(u.phoneEnrollmentInfo.captchaResponse===fl){J(t?.type===pl,c,"argument-error");const f=await nf(c,u,t);return b0(c,f)}return b0(c,u)},"PHONE_PROVIDER").catch(c=>Promise.reject(c))).phoneSessionInfo.sessionInfo}else{J(s.type==="signin",n,"internal-error");const r=i.multiFactorHint?.uid||i.multiFactorUid;J(r,n,"missing-multi-factor-info");const o={mfaPendingCredential:s.credential,mfaEnrollmentId:r,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await gs(n,o,"mfaSmsSignIn",async(u,f)=>{if(f.phoneSignInInfo.captchaResponse===fl){J(t?.type===pl,u,"argument-error");const m=await nf(u,f,t);return E0(u,m)}return E0(u,f)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await gs(n,s,"sendVerificationCode",async(l,c)=>{if(c.captchaResponse===fl){J(t?.type===pl,l,"argument-error");const u=await nf(l,c,t);return w0(l,u)}return w0(l,c)},"PHONE_PROVIDER").catch(l=>Promise.reject(l))).sessionInfo}}finally{t?._reset()}}async function MD(n,e){const t=de(n);if(Ze(t.auth.app))return Promise.reject(Ot(t.auth));await $m(t,e)}async function nf(n,e,t){J(t.type===pl,n,"argument-error");const i=await t.verify();J(typeof i=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const r=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,a=s.phoneEnrollmentInfo.clientType,l=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:r,recaptchaToken:i,captchaResponse:o,clientType:a,recaptchaVersion:l}}),s}else if("phoneSignInInfo"in s){const r=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,a=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:r,clientType:o,recaptchaVersion:a}}),s}else return Object.assign(s,{recaptchaToken:i}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let br=class Eu{constructor(e){this.providerId=Eu.PROVIDER_ID,this.auth=at(e)}verifyPhoneNumber(e,t){return Vd(this.auth,e,de(t))}static credential(e,t){return yr._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Eu.credentialFromTaggedObject(t)}static credentialFromError(e){return Eu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:i}=e;return t&&i?yr._fromTokenResponse(t,i):null}};br.PROVIDER_ID="phone";br.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(n,e){return e?Sn(e):(J(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg extends oa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Mi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Mi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DD(n){return TE(n.auth,new tg(n),n.bypassAuthState)}function LD(n){const{auth:e,user:t}=n;return J(t,e,"internal-error"),xE(t,new tg(n),n.bypassAuthState)}async function FD(n){const{auth:e,user:t}=n;return J(t,e,"internal-error"),$m(t,new tg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,t,i,s,r=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DD;case"linkViaPopup":case"linkViaRedirect":return FD;case"reauthViaPopup":case"reauthViaRedirect":return LD;default:qt(this.auth,"internal-error")}}resolve(e){Jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=new uc(2e3,1e4);async function OD(n,e,t){if(Ze(n.app))return Promise.reject(kt(n,"operation-not-supported-in-this-environment"));const i=at(n);ra(n,e,ji);const s=Vr(i,t);return new Ri(i,"signInViaPopup",e,s).executeNotNull()}async function UD(n,e,t){const i=de(n);if(Ze(i.auth.app))return Promise.reject(kt(i.auth,"operation-not-supported-in-this-environment"));ra(i.auth,e,ji);const s=Vr(i.auth,t);return new Ri(i.auth,"reauthViaPopup",e,s,i).executeNotNull()}async function BD(n,e,t){const i=de(n);ra(i.auth,e,ji);const s=Vr(i.auth,t);return new Ri(i.auth,"linkViaPopup",e,s,i).executeNotNull()}class Ri extends LE{constructor(e,t,i,s,r){super(e,t,s,r),this.provider=i,this.authWindow=null,this.pollId=null,Ri.currentPopupAction&&Ri.currentPopupAction.cancel(),Ri.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return J(e,this.auth,"internal-error"),e}async onExecution(){Jn(this.filter.length===1,"Popup operations only handle one event");const e=mc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ri.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VD.get())};e()}}Ri.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="pendingRedirect",ml=new Map;class jD extends LE{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ml.get(this.auth._key());if(!e){try{const i=await qD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ml.set(this.auth._key(),e)}return this.bypassAuthState||ml.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qD(n,e){const t=VE(e),i=FE(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}async function ng(n,e){return FE(n)._set(VE(e),"true")}function HD(){ml.clear()}function ig(n,e){ml.set(n._key(),e)}function FE(n){return Sn(n._redirectPersistence)}function VE(n){return gr(zD,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GD(n,e,t){return $D(n,e,t)}async function $D(n,e,t){if(Ze(n.app))return Promise.reject(Ot(n));const i=at(n);ra(n,e,ji),await i._initializationPromise;const s=Vr(i,t);return await ng(s,i),s._openRedirect(i,e,"signInViaRedirect")}function WD(n,e,t){return KD(n,e,t)}async function KD(n,e,t){const i=de(n);if(ra(i.auth,e,ji),Ze(i.auth.app))return Promise.reject(Ot(i.auth));await i.auth._initializationPromise;const s=Vr(i.auth,t);await ng(s,i.auth);const r=await OE(i);return s._openRedirect(i.auth,e,"reauthViaRedirect",r)}function YD(n,e,t){return JD(n,e,t)}async function JD(n,e,t){const i=de(n);ra(i.auth,e,ji),await i.auth._initializationPromise;const s=Vr(i.auth,t);await Nd(!1,i,e.providerId),await ng(s,i.auth);const r=await OE(i);return s._openRedirect(i.auth,e,"linkViaRedirect",r)}async function XD(n,e){return await at(n)._initializationPromise,Od(n,e,!1)}async function Od(n,e,t=!1){if(Ze(n.app))return Promise.reject(Ot(n));const i=at(n),s=Vr(i,e),o=await new jD(i,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}async function OE(n){const e=mc(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD=600*1e3;class UE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ZD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!BE(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(kt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=QD&&this.cachedEventUids.clear(),this.cachedEventUids.has(A0(e))}saveEventToCache(e){this.cachedEventUids.add(A0(e)),this.lastProcessedEventTime=Date.now()}}function A0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function BE({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function ZD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zE(n,e={}){return pt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,t4=/^https?/;async function n4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zE(n);for(const t of e)try{if(i4(t))return}catch{}qt(n,"unauthorized-domain")}function i4(n){const e=Fl(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!t4.test(t))return!1;if(e4.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=new uc(3e4,6e4);function I0(){const n=At().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function r4(n){return new Promise((e,t)=>{function i(){I0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{I0(),t(kt(n,"network-request-failed"))},timeout:s4.get()})}if(At().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(At().gapi?.load)i();else{const s=mE("iframefcb");return At()[s]=()=>{gapi.load?i():t(kt(n,"network-request-failed"))},Gm(`${ZN()}?onload=${s}`).catch(r=>t(r))}}).catch(e=>{throw Au=null,e})}let Au=null;function o4(n){return Au=Au||r4(n),Au}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=new uc(5e3,15e3),l4="__/auth/iframe",c4="emulator/auth/iframe",u4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function h4(n){const e=n.config;J(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Hm(e,c4):`https://${n.config.authDomain}/${l4}`,i={apiKey:e.apiKey,appName:n.name,v:Bi},s=d4.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${t}?${sa(i).slice(1)}`}async function f4(n){const e=await o4(n),t=At().gapi;return J(t,n,"internal-error"),e.open({where:document.body,url:h4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u4,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=kt(n,"network-request-failed"),a=At().setTimeout(()=>{r(o)},a4.get());function l(){At().clearTimeout(a),s(i)}i.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},m4=500,g4=600,y4="_blank",v4="http://localhost";class C0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function w4(n,e,t,i=m4,s=g4){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l={...p4,width:i.toString(),height:s.toString(),top:r,left:o},c=ot().toLowerCase();t&&(a=cE(c)?y4:t),aE(c)&&(e=e||v4,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[y,v])=>`${m}${y}=${v},`,"");if(qN(c)&&a!=="_self")return _4(e||"",a),new C0(null);const f=window.open(e||"",a,u);J(f,n,"popup-blocked");try{f.focus()}catch{}return new C0(f)}function _4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b4="__/auth/handler",x4="emulator/auth/handler",T4=encodeURIComponent("fac");async function pp(n,e,t,i,s,r){J(n.config.authDomain,n,"auth-domain-config-required"),J(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Bi,eventId:s};if(e instanceof ji){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Jk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries(r||{}))o[u]=f}if(e instanceof aa){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${T4}=${encodeURIComponent(l)}`:"";return`${E4(n)}?${sa(a).slice(1)}${c}`}function E4({config:n}){return n.emulator?Hm(n,x4):`https://${n.authDomain}/${b4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="webStorageSupport";class A4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_r,this._completeRedirectFn=Od,this._overrideRedirectResult=ig}async _openPopup(e,t,i,s){Jn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const r=await pp(e,t,i,Fl(),s);return w4(e,r,mc())}async _openRedirect(e,t,i,s){await this._originValidation(e);const r=await pp(e,t,i,Fl(),s);return fD(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(Jn(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await f4(e),i=new UE(e);return t.register("authEvent",s=>(J(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(sf,{type:sf},s=>{const r=s?.[0]?.[sf];r!==void 0&&t(!!r),qt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=n4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fE()||lE()||hc()}}const I4=A4;class C4{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return hi("unexpected MultiFactorSessionType")}}}class sg extends C4{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new sg(e)}_finalizeEnroll(e,t,i){return oD(e,{idToken:t,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return xD(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class jE{constructor(){}static assertion(e){return sg._fromCredential(e)}}jE.FACTOR_ID="phone";var S0="@firebase/auth",P0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){J(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function k4(n){Fi(new Un("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;J(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pE(n)},c=new YN(i,s,r,l);return cM(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Fi(new Un("auth-internal",e=>{const t=at(e.getProvider("auth").getImmediate());return(i=>new S4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),kn(S0,P0,P4(n)),kn(S0,P0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4=300;Uk("authIdTokenMaxAge");function N4(){return document.getElementsByTagName("head")?.[0]??document}JN({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const r=kt("internal-error");r.customData=s,t(r)},i.type="text/javascript",i.charset="UTF-8",N4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});k4("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=2e3;async function D4(n,e,t){const{BuildInfo:i}=xr();Jn(e.sessionId,"AuthEvent did not contain a session ID");const s=await U4(e.sessionId),r={};return hc()?r.ibi=i.packageName:dc()?r.apn=i.packageName:qt(n,"operation-not-supported-in-this-environment"),i.displayName&&(r.appDisplayName=i.displayName),r.sessionId=s,pp(n,t,e.type,void 0,e.eventId??void 0,r)}async function L4(n){const{BuildInfo:e}=xr(),t={};hc()?t.iosBundleId=e.packageName:dc()?t.androidPackageName=e.packageName:qt(n,"operation-not-supported-in-this-environment"),await zE(n,t)}function F4(n){const{cordova:e}=xr();return new Promise(t=>{e.plugins.browsertab.isAvailable(i=>{let s=null;i?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,jN()?"_blank":"_system","location=yes"),t(s)})})}async function V4(n,e,t){const{cordova:i}=xr();let s=()=>{};try{await new Promise((r,o)=>{let a=null;function l(){r();const f=i.plugins.browsertab?.close;typeof f=="function"&&f(),typeof t?.close=="function"&&t.close()}function c(){a||(a=window.setTimeout(()=>{o(kt(n,"redirect-cancelled-by-user"))},M4))}function u(){document?.visibilityState==="visible"&&c()}e.addPassiveListener(l),document.addEventListener("resume",c,!1),dc()&&document.addEventListener("visibilitychange",u,!1),s=()=>{e.removePassiveListener(l),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{s()}}function O4(n){const e=xr();J(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),J(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),J(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),J(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),J(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function U4(n){const e=B4(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function B4(n){if(Jn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=20;class j4 extends UE{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function q4(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:$4(),postBody:null,tenantId:n.tenantId,error:kt(n,"no-auth-event")}}function H4(n,e){return mp()._set(gp(n),e)}async function k0(n){const e=await mp()._get(gp(n));return e&&await mp()._remove(gp(n)),e}function G4(n,e){const t=K4(e);if(t.includes("/__/auth/callback")){const i=Iu(t),r=(i.firebaseError?W4(decodeURIComponent(i.firebaseError)):null)?.code?.split("auth/")?.[1],o=r?kt(r):null;return o?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:o,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function $4(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<z4;t++){const i=Math.floor(Math.random()*e.length);n.push(e.charAt(i))}return n.join("")}function mp(){return Sn(Qm)}function gp(n){return gr("authEvent",n.config.apiKey,n.name)}function W4(n){try{return JSON.parse(n)}catch{return null}}function K4(n){const e=Iu(n),t=e.link?decodeURIComponent(e.link):void 0,i=Iu(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Iu(s).link||s||i||t||n}function Iu(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return go(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=500;class J4{constructor(){this._redirectPersistence=_r,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Od,this._overrideRedirectResult=ig}async _initialize(e){const t=e._key();let i=this.eventManagers.get(t);return i||(i=new j4(e),this.eventManagers.set(t,i),this.attachCallbackListeners(e,i)),i}_openPopup(e){qt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,i,s){O4(e);const r=await this._initialize(e);await r.initialized(),r.resetRedirect(),HD(),await this._originValidation(e);const o=q4(e,i,s);await H4(e,o);const a=await D4(e,o,t),l=await F4(a);return V4(e,r,l)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=L4(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:i,handleOpenURL:s,BuildInfo:r}=xr(),o=setTimeout(async()=>{await k0(e),t.onEvent(R0())},Y4),a=async u=>{clearTimeout(o);const f=await k0(e);let m=null;f&&u?.url&&(m=G4(f,u.url)),t.onEvent(m||R0())};typeof i<"u"&&typeof i.subscribe=="function"&&i.subscribe(null,a);const l=s,c=`${r.packageName.toLowerCase()}://`;xr().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(c)&&a({url:u}),typeof l=="function")try{l(u)}catch(f){console.error(f)}}}}const X4=J4;function R0(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:kt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(n,e){at(n)._logFramework(e)}var Z4="@firebase/auth-compat",e3="0.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=1e3;function gl(){return self?.location?.protocol||null}function n3(){return gl()==="http:"||gl()==="https:"}function qE(n=ot()){return!!((gl()==="file:"||gl()==="ionic:"||gl()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function i3(){return Lm()||Cd()}function s3(){return LT()&&document?.documentMode===11}function r3(n=ot()){return/Edge\/\d+/.test(n)}function o3(n=ot()){return s3()||r3(n)}function HE(){try{const n=self.localStorage,e=mc();if(n)return n.setItem(e,"1"),n.removeItem(e),o3()?Ml():!0}catch{return rg()&&Ml()}return!1}function rg(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function rf(){return(n3()||DT()||qE())&&!i3()&&HE()&&!rg()}function GE(){return qE()&&typeof document<"u"}async function a3(){return GE()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},t3);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function l3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In={LOCAL:"local",NONE:"none",SESSION:"session"},za=J,$E="persistence";function c3(n,e){if(za(Object.values(In).includes(e),n,"invalid-persistence-type"),Lm()){za(e!==In.SESSION,n,"unsupported-persistence-type");return}if(Cd()){za(e===In.NONE,n,"unsupported-persistence-type");return}if(rg()){za(e===In.NONE||e===In.LOCAL&&Ml(),n,"unsupported-persistence-type");return}za(e===In.NONE||HE(),n,"unsupported-persistence-type")}async function yp(n){await n._initializationPromise;const e=WE(),t=gr($E,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function u3(n,e){const t=WE();if(!t)return[];const i=gr($E,n,e);switch(t.getItem(i)){case In.NONE:return[No];case In.LOCAL:return[Ul,_r];case In.SESSION:return[_r];default:return[]}}function WE(){try{return l3()?.sessionStorage||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3=J;class us{constructor(){this.browserResolver=Sn(I4),this.cordovaResolver=Sn(X4),this.underlyingResolver=null,this._redirectPersistence=_r,this._completeRedirectFn=Od,this._overrideRedirectResult=ig}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,i,s)}async _openRedirect(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,i,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return GE()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return d3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await a3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(n){return n.unwrap()}function h3(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f3(n){return YE(n)}function p3(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const i=e;i.resolver=new m3(n,rD(n,e))}else if(t){const i=YE(e),s=e;i&&(s.credential=i,s.tenantId=t.tenantId||void 0,s.email=t.email||void 0,s.phoneNumber=t.phoneNumber||void 0)}}function YE(n){const{_tokenResponse:e}=n instanceof en?n.customData:n;if(!e)return null;if(!(n instanceof en)&&"temporaryProof"in e&&"phoneNumber"in e)return br.credentialFromResult(n);const t=e.providerId;if(!t||t===Ua.PASSWORD)return null;let i;switch(t){case Ua.GOOGLE:i=li;break;case Ua.FACEBOOK:i=ai;break;case Ua.GITHUB:i=ci;break;case Ua.TWITTER:i=ui;break;default:const{oauthIdToken:s,oauthAccessToken:r,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!r&&!o&&!s&&!a?null:a?t.startsWith("saml.")?Mo._create(t,a):wi._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:s,accessToken:r}):new bo(t).credential({idToken:s,accessToken:r,rawNonce:l})}return n instanceof en?i.credentialFromError(n):i.credentialFromResult(n)}function vn(n,e){return e.catch(t=>{throw t instanceof en&&p3(n,t),t}).then(t=>{const i=t.operationType,s=t.user;return{operationType:i,credential:f3(t),additionalUserInfo:sD(t),user:Ud.getOrCreate(s)}})}async function vp(n,e){const t=await e;return{verificationId:t.verificationId,confirm:i=>vn(n,t.confirm(i))}}class m3{constructor(e,t){this.resolver=t,this.auth=h3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return vn(KE(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ud=class il{constructor(e){this._delegate=e,this.multiFactor=lD(e)}static getOrCreate(e){return il.USER_MAP.has(e)||il.USER_MAP.set(e,new il(e)),il.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return vn(this.auth,EE(this._delegate,e))}async linkWithPhoneNumber(e,t){return vp(this.auth,RD(this._delegate,e,t))}async linkWithPopup(e){return vn(this.auth,BD(this._delegate,e,us))}async linkWithRedirect(e){return await yp(at(this.auth)),YD(this._delegate,e,us)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return vn(this.auth,AE(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return vp(this.auth,ND(this._delegate,e,t))}reauthenticateWithPopup(e){return vn(this.auth,UD(this._delegate,e,us))}async reauthenticateWithRedirect(e){return await yp(at(this.auth)),WD(this._delegate,e,us)}sendEmailVerification(e){return WM(this._delegate,e)}async unlink(e){return await MM(this._delegate,e),this}updateEmail(e){return XM(this._delegate,e)}updatePassword(e){return QM(this._delegate,e)}updatePhoneNumber(e){return MD(this._delegate,e)}updateProfile(e){return JM(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return KM(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Ud.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=J;class wp{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:i}=e.options;ja(i,"invalid-api-key",{appName:e.name}),ja(i,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?us:void 0;this._delegate=t.initialize({options:{persistence:g3(i,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(xN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ud.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){uM(this._delegate,e,t)}applyActionCode(e){return OM(this._delegate,e)}checkActionCode(e){return IE(this._delegate,e)}confirmPasswordReset(e,t){return VM(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return vn(this._delegate,BM(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return $M(this._delegate,e)}isSignInWithEmailLink(e){return qM(this._delegate,e)}async getRedirectResult(){ja(rf(),this._delegate,"operation-not-supported-in-this-environment");const e=await XD(this._delegate,us);return e?vn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Q4(this._delegate,e)}onAuthStateChanged(e,t,i){const{next:s,error:r,complete:o}=N0(e,t,i);return this._delegate.onAuthStateChanged(s,r,o)}onIdTokenChanged(e,t,i){const{next:s,error:r,complete:o}=N0(e,t,i);return this._delegate.onIdTokenChanged(s,r,o)}sendSignInLinkToEmail(e,t){return jM(this._delegate,e,t)}sendPasswordResetEmail(e,t){return FM(this._delegate,e,t||void 0)}async setPersistence(e){c3(this._delegate,e);let t;switch(e){case In.SESSION:t=_r;break;case In.LOCAL:t=await Sn(Ul)._isAvailable()?Ul:Qm;break;case In.NONE:t=No;break;default:return qt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return vn(this._delegate,NM(this._delegate))}signInWithCredential(e){return vn(this._delegate,Md(this._delegate,e))}signInWithCustomToken(e){return vn(this._delegate,LM(this._delegate,e))}signInWithEmailAndPassword(e,t){return vn(this._delegate,zM(this._delegate,e,t))}signInWithEmailLink(e,t){return vn(this._delegate,HM(this._delegate,e,t))}signInWithPhoneNumber(e,t){return vp(this._delegate,kD(this._delegate,e,t))}async signInWithPopup(e){return ja(rf(),this._delegate,"operation-not-supported-in-this-environment"),vn(this._delegate,OD(this._delegate,e,us))}async signInWithRedirect(e){return ja(rf(),this._delegate,"operation-not-supported-in-this-environment"),await yp(this._delegate),GD(this._delegate,e,us)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return UM(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}wp.Persistence=In;function N0(n,e,t){let i=n;typeof n!="function"&&({next:i,error:e,complete:t}=n);const s=i;return{next:o=>s(o&&Ud.getOrCreate(o)),error:e,complete:t}}function g3(n,e){const t=u3(n,e);if(typeof self<"u"&&!t.includes(Ul)&&t.push(Ul),typeof window<"u")for(const i of[Qm,_r])t.includes(i)||t.push(i);return t.includes(No)||t.push(No),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{static credential(e,t){return br.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new br(KE(Vt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}og.PHONE_SIGN_IN_METHOD=br.PHONE_SIGN_IN_METHOD;og.PROVIDER_ID=br.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=J;class v3{constructor(e,t,i=Vt.app()){y3(i.options?.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new SD(i.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3="auth-compat";function _3(n){n.INTERNAL.registerComponent(new Un(w3,e=>{const t=e.getProvider("app-compat").getImmediate(),i=e.getProvider("auth");return new wp(t,i)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:eo.EMAIL_SIGNIN,PASSWORD_RESET:eo.PASSWORD_RESET,RECOVER_EMAIL:eo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:eo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:eo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:eo.VERIFY_EMAIL}},EmailAuthProvider:Fs,FacebookAuthProvider:ai,GithubAuthProvider:ci,GoogleAuthProvider:li,OAuthProvider:bo,SAMLAuthProvider:Ku,PhoneAuthProvider:og,PhoneMultiFactorGenerator:jE,RecaptchaVerifier:v3,TwitterAuthProvider:ui,Auth:wp,AuthCredential:oa,Error:en}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Z4,e3)}_3(Vt);var M0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ys,JE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,E){function A(){}A.prototype=E.prototype,I.D=E.prototype,I.prototype=new A,I.prototype.constructor=I,I.C=function(N,M,L){for(var R=Array(arguments.length-2),G=2;G<arguments.length;G++)R[G-2]=arguments[G];return E.prototype[M].apply(N,R)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,E,A){A||(A=0);var N=Array(16);if(typeof E=="string")for(var M=0;16>M;++M)N[M]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(M=0;16>M;++M)N[M]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=I.g[0],A=I.g[1],M=I.g[2];var L=I.g[3],R=E+(L^A&(M^L))+N[0]+3614090360&4294967295;E=A+(R<<7&4294967295|R>>>25),R=L+(M^E&(A^M))+N[1]+3905402710&4294967295,L=E+(R<<12&4294967295|R>>>20),R=M+(A^L&(E^A))+N[2]+606105819&4294967295,M=L+(R<<17&4294967295|R>>>15),R=A+(E^M&(L^E))+N[3]+3250441966&4294967295,A=M+(R<<22&4294967295|R>>>10),R=E+(L^A&(M^L))+N[4]+4118548399&4294967295,E=A+(R<<7&4294967295|R>>>25),R=L+(M^E&(A^M))+N[5]+1200080426&4294967295,L=E+(R<<12&4294967295|R>>>20),R=M+(A^L&(E^A))+N[6]+2821735955&4294967295,M=L+(R<<17&4294967295|R>>>15),R=A+(E^M&(L^E))+N[7]+4249261313&4294967295,A=M+(R<<22&4294967295|R>>>10),R=E+(L^A&(M^L))+N[8]+1770035416&4294967295,E=A+(R<<7&4294967295|R>>>25),R=L+(M^E&(A^M))+N[9]+2336552879&4294967295,L=E+(R<<12&4294967295|R>>>20),R=M+(A^L&(E^A))+N[10]+4294925233&4294967295,M=L+(R<<17&4294967295|R>>>15),R=A+(E^M&(L^E))+N[11]+2304563134&4294967295,A=M+(R<<22&4294967295|R>>>10),R=E+(L^A&(M^L))+N[12]+1804603682&4294967295,E=A+(R<<7&4294967295|R>>>25),R=L+(M^E&(A^M))+N[13]+4254626195&4294967295,L=E+(R<<12&4294967295|R>>>20),R=M+(A^L&(E^A))+N[14]+2792965006&4294967295,M=L+(R<<17&4294967295|R>>>15),R=A+(E^M&(L^E))+N[15]+1236535329&4294967295,A=M+(R<<22&4294967295|R>>>10),R=E+(M^L&(A^M))+N[1]+4129170786&4294967295,E=A+(R<<5&4294967295|R>>>27),R=L+(A^M&(E^A))+N[6]+3225465664&4294967295,L=E+(R<<9&4294967295|R>>>23),R=M+(E^A&(L^E))+N[11]+643717713&4294967295,M=L+(R<<14&4294967295|R>>>18),R=A+(L^E&(M^L))+N[0]+3921069994&4294967295,A=M+(R<<20&4294967295|R>>>12),R=E+(M^L&(A^M))+N[5]+3593408605&4294967295,E=A+(R<<5&4294967295|R>>>27),R=L+(A^M&(E^A))+N[10]+38016083&4294967295,L=E+(R<<9&4294967295|R>>>23),R=M+(E^A&(L^E))+N[15]+3634488961&4294967295,M=L+(R<<14&4294967295|R>>>18),R=A+(L^E&(M^L))+N[4]+3889429448&4294967295,A=M+(R<<20&4294967295|R>>>12),R=E+(M^L&(A^M))+N[9]+568446438&4294967295,E=A+(R<<5&4294967295|R>>>27),R=L+(A^M&(E^A))+N[14]+3275163606&4294967295,L=E+(R<<9&4294967295|R>>>23),R=M+(E^A&(L^E))+N[3]+4107603335&4294967295,M=L+(R<<14&4294967295|R>>>18),R=A+(L^E&(M^L))+N[8]+1163531501&4294967295,A=M+(R<<20&4294967295|R>>>12),R=E+(M^L&(A^M))+N[13]+2850285829&4294967295,E=A+(R<<5&4294967295|R>>>27),R=L+(A^M&(E^A))+N[2]+4243563512&4294967295,L=E+(R<<9&4294967295|R>>>23),R=M+(E^A&(L^E))+N[7]+1735328473&4294967295,M=L+(R<<14&4294967295|R>>>18),R=A+(L^E&(M^L))+N[12]+2368359562&4294967295,A=M+(R<<20&4294967295|R>>>12),R=E+(A^M^L)+N[5]+4294588738&4294967295,E=A+(R<<4&4294967295|R>>>28),R=L+(E^A^M)+N[8]+2272392833&4294967295,L=E+(R<<11&4294967295|R>>>21),R=M+(L^E^A)+N[11]+1839030562&4294967295,M=L+(R<<16&4294967295|R>>>16),R=A+(M^L^E)+N[14]+4259657740&4294967295,A=M+(R<<23&4294967295|R>>>9),R=E+(A^M^L)+N[1]+2763975236&4294967295,E=A+(R<<4&4294967295|R>>>28),R=L+(E^A^M)+N[4]+1272893353&4294967295,L=E+(R<<11&4294967295|R>>>21),R=M+(L^E^A)+N[7]+4139469664&4294967295,M=L+(R<<16&4294967295|R>>>16),R=A+(M^L^E)+N[10]+3200236656&4294967295,A=M+(R<<23&4294967295|R>>>9),R=E+(A^M^L)+N[13]+681279174&4294967295,E=A+(R<<4&4294967295|R>>>28),R=L+(E^A^M)+N[0]+3936430074&4294967295,L=E+(R<<11&4294967295|R>>>21),R=M+(L^E^A)+N[3]+3572445317&4294967295,M=L+(R<<16&4294967295|R>>>16),R=A+(M^L^E)+N[6]+76029189&4294967295,A=M+(R<<23&4294967295|R>>>9),R=E+(A^M^L)+N[9]+3654602809&4294967295,E=A+(R<<4&4294967295|R>>>28),R=L+(E^A^M)+N[12]+3873151461&4294967295,L=E+(R<<11&4294967295|R>>>21),R=M+(L^E^A)+N[15]+530742520&4294967295,M=L+(R<<16&4294967295|R>>>16),R=A+(M^L^E)+N[2]+3299628645&4294967295,A=M+(R<<23&4294967295|R>>>9),R=E+(M^(A|~L))+N[0]+4096336452&4294967295,E=A+(R<<6&4294967295|R>>>26),R=L+(A^(E|~M))+N[7]+1126891415&4294967295,L=E+(R<<10&4294967295|R>>>22),R=M+(E^(L|~A))+N[14]+2878612391&4294967295,M=L+(R<<15&4294967295|R>>>17),R=A+(L^(M|~E))+N[5]+4237533241&4294967295,A=M+(R<<21&4294967295|R>>>11),R=E+(M^(A|~L))+N[12]+1700485571&4294967295,E=A+(R<<6&4294967295|R>>>26),R=L+(A^(E|~M))+N[3]+2399980690&4294967295,L=E+(R<<10&4294967295|R>>>22),R=M+(E^(L|~A))+N[10]+4293915773&4294967295,M=L+(R<<15&4294967295|R>>>17),R=A+(L^(M|~E))+N[1]+2240044497&4294967295,A=M+(R<<21&4294967295|R>>>11),R=E+(M^(A|~L))+N[8]+1873313359&4294967295,E=A+(R<<6&4294967295|R>>>26),R=L+(A^(E|~M))+N[15]+4264355552&4294967295,L=E+(R<<10&4294967295|R>>>22),R=M+(E^(L|~A))+N[6]+2734768916&4294967295,M=L+(R<<15&4294967295|R>>>17),R=A+(L^(M|~E))+N[13]+1309151649&4294967295,A=M+(R<<21&4294967295|R>>>11),R=E+(M^(A|~L))+N[4]+4149444226&4294967295,E=A+(R<<6&4294967295|R>>>26),R=L+(A^(E|~M))+N[11]+3174756917&4294967295,L=E+(R<<10&4294967295|R>>>22),R=M+(E^(L|~A))+N[2]+718787259&4294967295,M=L+(R<<15&4294967295|R>>>17),R=A+(L^(M|~E))+N[9]+3951481745&4294967295,I.g[0]=I.g[0]+E&4294967295,I.g[1]=I.g[1]+(M+(R<<21&4294967295|R>>>11))&4294967295,I.g[2]=I.g[2]+M&4294967295,I.g[3]=I.g[3]+L&4294967295}i.prototype.u=function(I,E){E===void 0&&(E=I.length);for(var A=E-this.blockSize,N=this.B,M=this.h,L=0;L<E;){if(M==0)for(;L<=A;)s(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<E;)if(N[M++]=I.charCodeAt(L++),M==this.blockSize){s(this,N),M=0;break}}else for(;L<E;)if(N[M++]=I[L++],M==this.blockSize){s(this,N),M=0;break}}this.h=M,this.o+=E},i.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var E=1;E<I.length-8;++E)I[E]=0;var A=8*this.o;for(E=I.length-8;E<I.length;++E)I[E]=A&255,A/=256;for(this.u(I),I=Array(16),E=A=0;4>E;++E)for(var N=0;32>N;N+=8)I[A++]=this.g[E]>>>N&255;return I};function r(I,E){var A=a;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=E(I)}function o(I,E){this.h=E;for(var A=[],N=!0,M=I.length-1;0<=M;M--){var L=I[M]|0;N&&L==E||(A[M]=L,N=!1)}this.g=A}var a={};function l(I){return-128<=I&&128>I?r(I,function(E){return new o([E|0],0>E?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return x(c(-I));for(var E=[],A=1,N=0;I>=A;N++)E[N]=I/A|0,A*=4294967296;return new o(E,0)}function u(I,E){if(I.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(I.charAt(0)=="-")return x(u(I.substring(1),E));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(E,8)),N=f,M=0;M<I.length;M+=8){var L=Math.min(8,I.length-M),R=parseInt(I.substring(M,M+L),E);8>L?(L=c(Math.pow(E,L)),N=N.j(L).add(c(R))):(N=N.j(A),N=N.add(c(R)))}return N}var f=l(0),m=l(1),y=l(16777216);n=o.prototype,n.m=function(){if(_(this))return-x(this).m();for(var I=0,E=1,A=0;A<this.g.length;A++){var N=this.i(A);I+=(0<=N?N:4294967296+N)*E,E*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(_(this))return"-"+x(this).toString(I);for(var E=c(Math.pow(I,6)),A=this,N="";;){var M=D(A,E).g;A=T(A,M.j(E));var L=((0<A.g.length?A.g[0]:A.h)>>>0).toString(I);if(A=M,v(A))return L+N;for(;6>L.length;)L="0"+L;N=L+N}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var E=0;E<I.g.length;E++)if(I.g[E]!=0)return!1;return!0}function _(I){return I.h==-1}n.l=function(I){return I=T(this,I),_(I)?-1:v(I)?0:1};function x(I){for(var E=I.g.length,A=[],N=0;N<E;N++)A[N]=~I.g[N];return new o(A,~I.h).add(m)}n.abs=function(){return _(this)?x(this):this},n.add=function(I){for(var E=Math.max(this.g.length,I.g.length),A=[],N=0,M=0;M<=E;M++){var L=N+(this.i(M)&65535)+(I.i(M)&65535),R=(L>>>16)+(this.i(M)>>>16)+(I.i(M)>>>16);N=R>>>16,L&=65535,R&=65535,A[M]=R<<16|L}return new o(A,A[A.length-1]&-2147483648?-1:0)};function T(I,E){return I.add(x(E))}n.j=function(I){if(v(this)||v(I))return f;if(_(this))return _(I)?x(this).j(x(I)):x(x(this).j(I));if(_(I))return x(this.j(x(I)));if(0>this.l(y)&&0>I.l(y))return c(this.m()*I.m());for(var E=this.g.length+I.g.length,A=[],N=0;N<2*E;N++)A[N]=0;for(N=0;N<this.g.length;N++)for(var M=0;M<I.g.length;M++){var L=this.i(N)>>>16,R=this.i(N)&65535,G=I.i(M)>>>16,oe=I.i(M)&65535;A[2*N+2*M]+=R*oe,S(A,2*N+2*M),A[2*N+2*M+1]+=L*oe,S(A,2*N+2*M+1),A[2*N+2*M+1]+=R*G,S(A,2*N+2*M+1),A[2*N+2*M+2]+=L*G,S(A,2*N+2*M+2)}for(N=0;N<E;N++)A[N]=A[2*N+1]<<16|A[2*N];for(N=E;N<2*E;N++)A[N]=0;return new o(A,0)};function S(I,E){for(;(I[E]&65535)!=I[E];)I[E+1]+=I[E]>>>16,I[E]&=65535,E++}function C(I,E){this.g=I,this.h=E}function D(I,E){if(v(E))throw Error("division by zero");if(v(I))return new C(f,f);if(_(I))return E=D(x(I),E),new C(x(E.g),x(E.h));if(_(E))return E=D(I,x(E)),new C(x(E.g),E.h);if(30<I.g.length){if(_(I)||_(E))throw Error("slowDivide_ only works with positive integers.");for(var A=m,N=E;0>=N.l(I);)A=F(A),N=F(N);var M=V(A,1),L=V(N,1);for(N=V(N,2),A=V(A,2);!v(N);){var R=L.add(N);0>=R.l(I)&&(M=M.add(A),L=R),N=V(N,1),A=V(A,1)}return E=T(I,M.j(E)),new C(M,E)}for(M=f;0<=I.l(E);){for(A=Math.max(1,Math.floor(I.m()/E.m())),N=Math.ceil(Math.log(A)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),L=c(A),R=L.j(E);_(R)||0<R.l(I);)A-=N,L=c(A),R=L.j(E);v(L)&&(L=m),M=M.add(L),I=T(I,R)}return new C(M,I)}n.A=function(I){return D(this,I).h},n.and=function(I){for(var E=Math.max(this.g.length,I.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)&I.i(N);return new o(A,this.h&I.h)},n.or=function(I){for(var E=Math.max(this.g.length,I.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)|I.i(N);return new o(A,this.h|I.h)},n.xor=function(I){for(var E=Math.max(this.g.length,I.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)^I.i(N);return new o(A,this.h^I.h)};function F(I){for(var E=I.g.length+1,A=[],N=0;N<E;N++)A[N]=I.i(N)<<1|I.i(N-1)>>>31;return new o(A,I.h)}function V(I,E){var A=E>>5;E%=32;for(var N=I.g.length-A,M=[],L=0;L<N;L++)M[L]=0<E?I.i(L+A)>>>E|I.i(L+A+1)<<32-E:I.i(L+A);return new o(M,I.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,JE=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,ys=o}).apply(typeof M0<"u"?M0:typeof self<"u"?self:typeof window<"u"?window:{});var nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XE,sl,QE,Cu,_p,ZE,eA,tA;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,w,b){return g==Array.prototype||g==Object.prototype||(g[w]=b.value),g};function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof nu=="object"&&nu];for(var w=0;w<g.length;++w){var b=g[w];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var i=t(this);function s(g,w){if(w)e:{var b=i;g=g.split(".");for(var k=0;k<g.length-1;k++){var U=g[k];if(!(U in b))break e;b=b[U]}g=g[g.length-1],k=b[g],w=w(k),w!=k&&w!=null&&e(b,g,{configurable:!0,writable:!0,value:w})}}function r(g,w){g instanceof String&&(g+="");var b=0,k=!1,U={next:function(){if(!k&&b<g.length){var j=b++;return{value:w(j,g[j]),done:!1}}return k=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}s("Array.prototype.values",function(g){return g||function(){return r(this,function(w,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(g){var w=typeof g;return w=w!="object"?w:g?Array.isArray(g)?"array":w:"null",w=="array"||w=="object"&&typeof g.length=="number"}function c(g){var w=typeof g;return w=="object"&&g!=null||w=="function"}function u(g,w,b){return g.call.apply(g.bind,arguments)}function f(g,w,b){if(!g)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,k),g.apply(w,U)}}return function(){return g.apply(w,arguments)}}function m(g,w,b){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,m.apply(null,arguments)}function y(g,w){var b=Array.prototype.slice.call(arguments,1);return function(){var k=b.slice();return k.push.apply(k,arguments),g.apply(this,k)}}function v(g,w){function b(){}b.prototype=w.prototype,g.aa=w.prototype,g.prototype=new b,g.prototype.constructor=g,g.Qb=function(k,U,j){for(var Z=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)Z[Ge-2]=arguments[Ge];return w.prototype[U].apply(k,Z)}}function _(g){const w=g.length;if(0<w){const b=Array(w);for(let k=0;k<w;k++)b[k]=g[k];return b}return[]}function x(g,w){for(let b=1;b<arguments.length;b++){const k=arguments[b];if(l(k)){const U=g.length||0,j=k.length||0;g.length=U+j;for(let Z=0;Z<j;Z++)g[U+Z]=k[Z]}else g.push(k)}}class T{constructor(w,b){this.i=w,this.j=b,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function S(g){return/^[\s\xa0]*$/.test(g)}function C(){var g=a.navigator;return g&&(g=g.userAgent)?g:""}function D(g){return D[" "](g),g}D[" "]=function(){};var F=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function V(g,w,b){for(const k in g)w.call(b,g[k],k,g)}function I(g,w){for(const b in g)w.call(void 0,g[b],b,g)}function E(g){const w={};for(const b in g)w[b]=g[b];return w}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(g,w){let b,k;for(let U=1;U<arguments.length;U++){k=arguments[U];for(b in k)g[b]=k[b];for(let j=0;j<A.length;j++)b=A[j],Object.prototype.hasOwnProperty.call(k,b)&&(g[b]=k[b])}}function M(g){var w=1;g=g.split(":");const b=[];for(;0<w&&g.length;)b.push(g.shift()),w--;return g.length&&b.push(g.join(":")),b}function L(g){a.setTimeout(()=>{throw g},0)}function R(){var g=H;let w=null;return g.g&&(w=g.g,g.g=g.g.next,g.g||(g.h=null),w.next=null),w}class G{constructor(){this.h=this.g=null}add(w,b){const k=oe.get();k.set(w,b),this.h?this.h.next=k:this.g=k,this.h=k}}var oe=new T(()=>new Y,g=>g.reset());class Y{constructor(){this.next=this.g=this.h=null}set(w,b){this.h=w,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,W=!1,H=new G,te=()=>{const g=a.Promise.resolve(void 0);ie=()=>{g.then(re)}};var re=()=>{for(var g;g=R();){try{g.h.call(g.g)}catch(b){L(b)}var w=oe;w.j(g),100>w.h&&(w.h++,g.next=w.g,w.g=g)}W=!1};function be(){this.s=this.s,this.C=this.C}be.prototype.s=!1,be.prototype.ma=function(){this.s||(this.s=!0,this.N())},be.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function le(g,w){this.type=g,this.g=this.target=w,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};var ee=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var g=!1,w=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const b=()=>{};a.addEventListener("test",b,w),a.removeEventListener("test",b,w)}catch{}return g})();function ye(g,w){if(le.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var b=this.type=g.type,k=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=w,w=g.relatedTarget){if(F){e:{try{D(w.nodeName);var U=!0;break e}catch{}U=!1}U||(w=null)}}else b=="mouseover"?w=g.fromElement:b=="mouseout"&&(w=g.toElement);this.relatedTarget=w,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:Ee[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&ye.aa.h.call(this)}}v(ye,le);var Ee={2:"touch",3:"pen",4:"mouse"};ye.prototype.h=function(){ye.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),Se=0;function pe(g,w,b,k,U){this.listener=g,this.proxy=null,this.src=w,this.type=b,this.capture=!!k,this.ha=U,this.key=++Se,this.da=this.fa=!1}function mt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Nt(g){this.src=g,this.g={},this.h=0}Nt.prototype.add=function(g,w,b,k,U){var j=g.toString();g=this.g[j],g||(g=this.g[j]=[],this.h++);var Z=Qn(g,w,k,U);return-1<Z?(w=g[Z],b||(w.fa=!1)):(w=new pe(w,this.src,j,!!k,U),w.fa=b,g.push(w)),w};function ct(g,w){var b=w.type;if(b in g.g){var k=g.g[b],U=Array.prototype.indexOf.call(k,w,void 0),j;(j=0<=U)&&Array.prototype.splice.call(k,U,1),j&&(mt(w),g.g[b].length==0&&(delete g.g[b],g.h--))}}function Qn(g,w,b,k){for(var U=0;U<g.length;++U){var j=g[U];if(!j.da&&j.listener==w&&j.capture==!!b&&j.ha==k)return U}return-1}var xn="closure_lm_"+(1e6*Math.random()|0),Xi={};function Hs(g,w,b,k,U){if(Array.isArray(w)){for(var j=0;j<w.length;j++)Hs(g,w[j],b,k,U);return null}return b=ve(b),g&&g[ge]?g.K(w,b,c(k)?!!k.capture:!1,U):pn(g,w,b,!1,k,U)}function pn(g,w,b,k,U,j){if(!w)throw Error("Invalid event type");var Z=c(U)?!!U.capture:!!U,Ge=Ei(g);if(Ge||(g[xn]=Ge=new Nt(g)),b=Ge.add(w,b,k,Z,j),b.proxy)return b;if(k=Gs(),b.proxy=k,k.src=g,k.listener=b,g.addEventListener)ee||(U=Z),U===void 0&&(U=!1),g.addEventListener(w.toString(),k,U);else if(g.attachEvent)g.attachEvent(Kr(w.toString()),k);else if(g.addListener&&g.removeListener)g.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return b}function Gs(){function g(b){return w.call(g.src,g.listener,b)}const w=$s;return g}function zn(g,w,b,k,U){if(Array.isArray(w))for(var j=0;j<w.length;j++)zn(g,w[j],b,k,U);else k=c(k)?!!k.capture:!!k,b=ve(b),g&&g[ge]?(g=g.i,w=String(w).toString(),w in g.g&&(j=g.g[w],b=Qn(j,b,k,U),-1<b&&(mt(j[b]),Array.prototype.splice.call(j,b,1),j.length==0&&(delete g.g[w],g.h--)))):g&&(g=Ei(g))&&(w=g.g[w.toString()],g=-1,w&&(g=Qn(w,b,k,U)),(b=-1<g?w[g]:null)&&Zn(b))}function Zn(g){if(typeof g!="number"&&g&&!g.da){var w=g.src;if(w&&w[ge])ct(w.i,g);else{var b=g.type,k=g.proxy;w.removeEventListener?w.removeEventListener(b,k,g.capture):w.detachEvent?w.detachEvent(Kr(b),k):w.addListener&&w.removeListener&&w.removeListener(k),(b=Ei(w))?(ct(b,g),b.h==0&&(b.src=null,w[xn]=null)):mt(g)}}}function Kr(g){return g in Xi?Xi[g]:Xi[g]="on"+g}function $s(g,w){if(g.da)g=!0;else{w=new ye(w,this);var b=g.listener,k=g.ha||g.src;g.fa&&Zn(g),g=b.call(k,w)}return g}function Ei(g){return g=g[xn],g instanceof Nt?g:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function ve(g){return typeof g=="function"?g:(g[X]||(g[X]=function(w){return g.handleEvent(w)}),g[X])}function Pe(){be.call(this),this.i=new Nt(this),this.M=this,this.F=null}v(Pe,be),Pe.prototype[ge]=!0,Pe.prototype.removeEventListener=function(g,w,b,k){zn(this,g,w,b,k)};function Me(g,w){var b,k=g.F;if(k)for(b=[];k;k=k.F)b.push(k);if(g=g.M,k=w.type||w,typeof w=="string")w=new le(w,g);else if(w instanceof le)w.target=w.target||g;else{var U=w;w=new le(k,g),N(w,U)}if(U=!0,b)for(var j=b.length-1;0<=j;j--){var Z=w.g=b[j];U=z(Z,k,!0,w)&&U}if(Z=w.g=g,U=z(Z,k,!0,w)&&U,U=z(Z,k,!1,w)&&U,b)for(j=0;j<b.length;j++)Z=w.g=b[j],U=z(Z,k,!1,w)&&U}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var g=this.i,w;for(w in g.g){for(var b=g.g[w],k=0;k<b.length;k++)mt(b[k]);delete g.g[w],g.h--}}this.F=null},Pe.prototype.K=function(g,w,b,k){return this.i.add(String(g),w,!1,b,k)},Pe.prototype.L=function(g,w,b,k){return this.i.add(String(g),w,!0,b,k)};function z(g,w,b,k){if(w=g.i.g[String(w)],!w)return!0;w=w.concat();for(var U=!0,j=0;j<w.length;++j){var Z=w[j];if(Z&&!Z.da&&Z.capture==b){var Ge=Z.listener,Ut=Z.ha||Z.src;Z.fa&&ct(g.i,Z),U=Ge.call(Ut,k)!==!1&&U}}return U&&!k.defaultPrevented}function De(g,w,b){if(typeof g=="function")b&&(g=m(g,b));else if(g&&typeof g.handleEvent=="function")g=m(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:a.setTimeout(g,w||0)}function gt(g){g.g=De(()=>{g.g=null,g.i&&(g.i=!1,gt(g))},g.l);const w=g.h;g.h=null,g.m.apply(null,w)}class Ta extends be{constructor(w,b){super(),this.m=w,this.l=b,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:gt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ai(g){be.call(this),this.h=g,this.g={}}v(Ai,be);var Yr=[];function Ws(g){V(g.g,function(w,b){this.g.hasOwnProperty(b)&&Zn(w)},g),g.g={}}Ai.prototype.N=function(){Ai.aa.N.call(this),Ws(this)},Ai.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ks=a.JSON.stringify,Ea=a.JSON.parse,Aa=class{stringify(g){return a.JSON.stringify(g,void 0)}parse(g){return a.JSON.parse(g,void 0)}};function Ys(){}Ys.prototype.h=null;function Oc(g){return g.h||(g.h=g.i())}function Yy(){}var Ia={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nh(){le.call(this,"d")}v(Nh,le);function Mh(){le.call(this,"c")}v(Mh,le);var Js={},Jy=null;function Uc(){return Jy=Jy||new Pe}Js.La="serverreachability";function Xy(g){le.call(this,Js.La,g)}v(Xy,le);function Ca(g){const w=Uc();Me(w,new Xy(w))}Js.STAT_EVENT="statevent";function Qy(g,w){le.call(this,Js.STAT_EVENT,g),this.stat=w}v(Qy,le);function sn(g){const w=Uc();Me(w,new Qy(w,g))}Js.Ma="timingevent";function Zy(g,w){le.call(this,Js.Ma,g),this.size=w}v(Zy,le);function Sa(g,w){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){g()},w)}function Pa(){this.g=!0}Pa.prototype.xa=function(){this.g=!1};function XS(g,w,b,k,U,j){g.info(function(){if(g.g)if(j)for(var Z="",Ge=j.split("&"),Ut=0;Ut<Ge.length;Ut++){var Oe=Ge[Ut].split("=");if(1<Oe.length){var Ht=Oe[0];Oe=Oe[1];var Gt=Ht.split("_");Z=2<=Gt.length&&Gt[1]=="type"?Z+(Ht+"="+Oe+"&"):Z+(Ht+"=redacted&")}}else Z=null;else Z=j;return"XMLHTTP REQ ("+k+") [attempt "+U+"]: "+w+`
`+b+`
`+Z})}function QS(g,w,b,k,U,j,Z){g.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+U+"]: "+w+`
`+b+`
`+j+" "+Z})}function Jr(g,w,b,k){g.info(function(){return"XMLHTTP TEXT ("+w+"): "+eP(g,b)+(k?" "+k:"")})}function ZS(g,w){g.info(function(){return"TIMEOUT: "+w})}Pa.prototype.info=function(){};function eP(g,w){if(!g.g)return w;if(!w)return null;try{var b=JSON.parse(w);if(b){for(g=0;g<b.length;g++)if(Array.isArray(b[g])){var k=b[g];if(!(2>k.length)){var U=k[1];if(Array.isArray(U)&&!(1>U.length)){var j=U[0];if(j!="noop"&&j!="stop"&&j!="close")for(var Z=1;Z<U.length;Z++)U[Z]=""}}}}return Ks(b)}catch{return w}}var Bc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ev={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Dh;function zc(){}v(zc,Ys),zc.prototype.g=function(){return new XMLHttpRequest},zc.prototype.i=function(){return{}},Dh=new zc;function Qi(g,w,b,k){this.j=g,this.i=w,this.l=b,this.R=k||1,this.U=new Ai(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new tv}function tv(){this.i=null,this.g="",this.h=!1}var nv={},Lh={};function Fh(g,w,b){g.L=1,g.v=Gc(Ii(w)),g.m=b,g.P=!0,iv(g,null)}function iv(g,w){g.F=Date.now(),jc(g),g.A=Ii(g.v);var b=g.A,k=g.R;Array.isArray(k)||(k=[String(k)]),yv(b.i,"t",k),g.C=0,b=g.j.J,g.h=new tv,g.g=Lv(g.j,b?w:null,!g.m),0<g.O&&(g.M=new Ta(m(g.Y,g,g.g),g.O)),w=g.U,b=g.g,k=g.ca;var U="readystatechange";Array.isArray(U)||(U&&(Yr[0]=U.toString()),U=Yr);for(var j=0;j<U.length;j++){var Z=Hs(b,U[j],k||w.handleEvent,!1,w.h||w);if(!Z)break;w.g[Z.key]=Z}w=g.H?E(g.H):{},g.m?(g.u||(g.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,w)):(g.u="GET",g.g.ea(g.A,g.u,null,w)),Ca(),XS(g.i,g.u,g.A,g.l,g.R,g.m)}Qi.prototype.ca=function(g){g=g.target;const w=this.M;w&&Ci(g)==3?w.j():this.Y(g)},Qi.prototype.Y=function(g){try{if(g==this.g)e:{const Gt=Ci(this.g);var w=this.g.Ba();const Zr=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||Ev(this.g)))){this.J||Gt!=4||w==7||(w==8||0>=Zr?Ca(3):Ca(2)),Vh(this);var b=this.g.Z();this.X=b;t:if(sv(this)){var k=Ev(this.g);g="";var U=k.length,j=Ci(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xs(this),ka(this);var Z="";break t}this.h.i=new a.TextDecoder}for(w=0;w<U;w++)this.h.h=!0,g+=this.h.i.decode(k[w],{stream:!(j&&w==U-1)});k.length=0,this.h.g+=g,this.C=0,Z=this.h.g}else Z=this.g.oa();if(this.o=b==200,QS(this.i,this.u,this.A,this.l,this.R,Gt,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Ge,Ut=this.g;if((Ge=Ut.g?Ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Ge)){var Oe=Ge;break t}}Oe=null}if(b=Oe)Jr(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oh(this,b);else{this.o=!1,this.s=3,sn(12),Xs(this),ka(this);break e}}if(this.P){b=!0;let jn;for(;!this.J&&this.C<Z.length;)if(jn=tP(this,Z),jn==Lh){Gt==4&&(this.s=4,sn(14),b=!1),Jr(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==nv){this.s=4,sn(15),Jr(this.i,this.l,Z,"[Invalid Chunk]"),b=!1;break}else Jr(this.i,this.l,jn,null),Oh(this,jn);if(sv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||Z.length!=0||this.h.h||(this.s=1,sn(16),b=!1),this.o=this.o&&b,!b)Jr(this.i,this.l,Z,"[Invalid Chunked Response]"),Xs(this),ka(this);else if(0<Z.length&&!this.W){this.W=!0;var Ht=this.j;Ht.g==this&&Ht.ba&&!Ht.M&&(Ht.j.info("Great, no buffering proxy detected. Bytes received: "+Z.length),Hh(Ht),Ht.M=!0,sn(11))}}else Jr(this.i,this.l,Z,null),Oh(this,Z);Gt==4&&Xs(this),this.o&&!this.J&&(Gt==4?Rv(this.j,this):(this.o=!1,jc(this)))}else vP(this.g),b==400&&0<Z.indexOf("Unknown SID")?(this.s=3,sn(12)):(this.s=0,sn(13)),Xs(this),ka(this)}}}catch{}finally{}};function sv(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function tP(g,w){var b=g.C,k=w.indexOf(`
`,b);return k==-1?Lh:(b=Number(w.substring(b,k)),isNaN(b)?nv:(k+=1,k+b>w.length?Lh:(w=w.slice(k,k+b),g.C=k+b,w)))}Qi.prototype.cancel=function(){this.J=!0,Xs(this)};function jc(g){g.S=Date.now()+g.I,rv(g,g.I)}function rv(g,w){if(g.B!=null)throw Error("WatchDog timer not null");g.B=Sa(m(g.ba,g),w)}function Vh(g){g.B&&(a.clearTimeout(g.B),g.B=null)}Qi.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(ZS(this.i,this.A),this.L!=2&&(Ca(),sn(17)),Xs(this),this.s=2,ka(this)):rv(this,this.S-g)};function ka(g){g.j.G==0||g.J||Rv(g.j,g)}function Xs(g){Vh(g);var w=g.M;w&&typeof w.ma=="function"&&w.ma(),g.M=null,Ws(g.U),g.g&&(w=g.g,g.g=null,w.abort(),w.ma())}function Oh(g,w){try{var b=g.j;if(b.G!=0&&(b.g==g||Uh(b.h,g))){if(!g.K&&Uh(b.h,g)&&b.G==3){try{var k=b.Da.g.parse(w)}catch{k=null}if(Array.isArray(k)&&k.length==3){var U=k;if(U[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<g.F)Xc(b),Yc(b);else break e;qh(b),sn(18)}}else b.za=U[1],0<b.za-b.T&&37500>U[2]&&b.F&&b.v==0&&!b.C&&(b.C=Sa(m(b.Za,b),6e3));if(1>=lv(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else Zs(b,11)}else if((g.K||b.g==g)&&Xc(b),!S(w))for(U=b.Da.g.parse(w),w=0;w<U.length;w++){let Oe=U[w];if(b.T=Oe[0],Oe=Oe[1],b.G==2)if(Oe[0]=="c"){b.K=Oe[1],b.ia=Oe[2];const Ht=Oe[3];Ht!=null&&(b.la=Ht,b.j.info("VER="+b.la));const Gt=Oe[4];Gt!=null&&(b.Aa=Gt,b.j.info("SVER="+b.Aa));const Zr=Oe[5];Zr!=null&&typeof Zr=="number"&&0<Zr&&(k=1.5*Zr,b.L=k,b.j.info("backChannelRequestTimeoutMs_="+k)),k=b;const jn=g.g;if(jn){const Zc=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zc){var j=k.h;j.g||Zc.indexOf("spdy")==-1&&Zc.indexOf("quic")==-1&&Zc.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Bh(j,j.h),j.h=null))}if(k.D){const Gh=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Gh&&(k.ya=Gh,Je(k.I,k.D,Gh))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-g.F,b.j.info("Handshake RTT: "+b.R+"ms")),k=b;var Z=g;if(k.qa=Dv(k,k.J?k.ia:null,k.W),Z.K){cv(k.h,Z);var Ge=Z,Ut=k.L;Ut&&(Ge.I=Ut),Ge.B&&(Vh(Ge),jc(Ge)),k.g=Z}else Pv(k);0<b.i.length&&Jc(b)}else Oe[0]!="stop"&&Oe[0]!="close"||Zs(b,7);else b.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Zs(b,7):jh(b):Oe[0]!="noop"&&b.l&&b.l.ta(Oe),b.v=0)}}Ca(4)}catch{}}var nP=class{constructor(g,w){this.g=g,this.map=w}};function ov(g){this.l=g||10,a.PerformanceNavigationTiming?(g=a.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function av(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function lv(g){return g.h?1:g.g?g.g.size:0}function Uh(g,w){return g.h?g.h==w:g.g?g.g.has(w):!1}function Bh(g,w){g.g?g.g.add(w):g.h=w}function cv(g,w){g.h&&g.h==w?g.h=null:g.g&&g.g.has(w)&&g.g.delete(w)}ov.prototype.cancel=function(){if(this.i=uv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function uv(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let w=g.i;for(const b of g.g.values())w=w.concat(b.D);return w}return _(g.i)}function iP(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(l(g)){for(var w=[],b=g.length,k=0;k<b;k++)w.push(g[k]);return w}w=[],b=0;for(k in g)w[b++]=g[k];return w}function sP(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(l(g)||typeof g=="string"){var w=[];g=g.length;for(var b=0;b<g;b++)w.push(b);return w}w=[],b=0;for(const k in g)w[b++]=k;return w}}}function dv(g,w){if(g.forEach&&typeof g.forEach=="function")g.forEach(w,void 0);else if(l(g)||typeof g=="string")Array.prototype.forEach.call(g,w,void 0);else for(var b=sP(g),k=iP(g),U=k.length,j=0;j<U;j++)w.call(void 0,k[j],b&&b[j],g)}var hv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rP(g,w){if(g){g=g.split("&");for(var b=0;b<g.length;b++){var k=g[b].indexOf("="),U=null;if(0<=k){var j=g[b].substring(0,k);U=g[b].substring(k+1)}else j=g[b];w(j,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Qs(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof Qs){this.h=g.h,qc(this,g.j),this.o=g.o,this.g=g.g,Hc(this,g.s),this.l=g.l;var w=g.i,b=new Ma;b.i=w.i,w.g&&(b.g=new Map(w.g),b.h=w.h),fv(this,b),this.m=g.m}else g&&(w=String(g).match(hv))?(this.h=!1,qc(this,w[1]||"",!0),this.o=Ra(w[2]||""),this.g=Ra(w[3]||"",!0),Hc(this,w[4]),this.l=Ra(w[5]||"",!0),fv(this,w[6]||"",!0),this.m=Ra(w[7]||"")):(this.h=!1,this.i=new Ma(null,this.h))}Qs.prototype.toString=function(){var g=[],w=this.j;w&&g.push(Na(w,pv,!0),":");var b=this.g;return(b||w=="file")&&(g.push("//"),(w=this.o)&&g.push(Na(w,pv,!0),"@"),g.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&g.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&g.push("/"),g.push(Na(b,b.charAt(0)=="/"?lP:aP,!0))),(b=this.i.toString())&&g.push("?",b),(b=this.m)&&g.push("#",Na(b,uP)),g.join("")};function Ii(g){return new Qs(g)}function qc(g,w,b){g.j=b?Ra(w,!0):w,g.j&&(g.j=g.j.replace(/:$/,""))}function Hc(g,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);g.s=w}else g.s=null}function fv(g,w,b){w instanceof Ma?(g.i=w,dP(g.i,g.h)):(b||(w=Na(w,cP)),g.i=new Ma(w,g.h))}function Je(g,w,b){g.i.set(w,b)}function Gc(g){return Je(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Ra(g,w){return g?w?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Na(g,w,b){return typeof g=="string"?(g=encodeURI(g).replace(w,oP),b&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function oP(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var pv=/[#\/\?@]/g,aP=/[#\?:]/g,lP=/[#\?]/g,cP=/[#\?@]/g,uP=/#/g;function Ma(g,w){this.h=this.g=null,this.i=g||null,this.j=!!w}function Zi(g){g.g||(g.g=new Map,g.h=0,g.i&&rP(g.i,function(w,b){g.add(decodeURIComponent(w.replace(/\+/g," ")),b)}))}n=Ma.prototype,n.add=function(g,w){Zi(this),this.i=null,g=Xr(this,g);var b=this.g.get(g);return b||this.g.set(g,b=[]),b.push(w),this.h+=1,this};function mv(g,w){Zi(g),w=Xr(g,w),g.g.has(w)&&(g.i=null,g.h-=g.g.get(w).length,g.g.delete(w))}function gv(g,w){return Zi(g),w=Xr(g,w),g.g.has(w)}n.forEach=function(g,w){Zi(this),this.g.forEach(function(b,k){b.forEach(function(U){g.call(w,U,k,this)},this)},this)},n.na=function(){Zi(this);const g=Array.from(this.g.values()),w=Array.from(this.g.keys()),b=[];for(let k=0;k<w.length;k++){const U=g[k];for(let j=0;j<U.length;j++)b.push(w[k])}return b},n.V=function(g){Zi(this);let w=[];if(typeof g=="string")gv(this,g)&&(w=w.concat(this.g.get(Xr(this,g))));else{g=Array.from(this.g.values());for(let b=0;b<g.length;b++)w=w.concat(g[b])}return w},n.set=function(g,w){return Zi(this),this.i=null,g=Xr(this,g),gv(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[w]),this.h+=1,this},n.get=function(g,w){return g?(g=this.V(g),0<g.length?String(g[0]):w):w};function yv(g,w,b){mv(g,w),0<b.length&&(g.i=null,g.g.set(Xr(g,w),_(b)),g.h+=b.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],w=Array.from(this.g.keys());for(var b=0;b<w.length;b++){var k=w[b];const j=encodeURIComponent(String(k)),Z=this.V(k);for(k=0;k<Z.length;k++){var U=j;Z[k]!==""&&(U+="="+encodeURIComponent(String(Z[k]))),g.push(U)}}return this.i=g.join("&")};function Xr(g,w){return w=String(w),g.j&&(w=w.toLowerCase()),w}function dP(g,w){w&&!g.j&&(Zi(g),g.i=null,g.g.forEach(function(b,k){var U=k.toLowerCase();k!=U&&(mv(this,k),yv(this,U,b))},g)),g.j=w}function hP(g,w){const b=new Pa;if(a.Image){const k=new Image;k.onload=y(es,b,"TestLoadImage: loaded",!0,w,k),k.onerror=y(es,b,"TestLoadImage: error",!1,w,k),k.onabort=y(es,b,"TestLoadImage: abort",!1,w,k),k.ontimeout=y(es,b,"TestLoadImage: timeout",!1,w,k),a.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=g}else w(!1)}function fP(g,w){const b=new Pa,k=new AbortController,U=setTimeout(()=>{k.abort(),es(b,"TestPingServer: timeout",!1,w)},1e4);fetch(g,{signal:k.signal}).then(j=>{clearTimeout(U),j.ok?es(b,"TestPingServer: ok",!0,w):es(b,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(U),es(b,"TestPingServer: error",!1,w)})}function es(g,w,b,k,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),k(b)}catch{}}function pP(){this.g=new Aa}function mP(g,w,b){const k=b||"";try{dv(g,function(U,j){let Z=U;c(U)&&(Z=Ks(U)),w.push(k+j+"="+encodeURIComponent(Z))})}catch(U){throw w.push(k+"type="+encodeURIComponent("_badmap")),U}}function $c(g){this.l=g.Ub||null,this.j=g.eb||!1}v($c,Ys),$c.prototype.g=function(){return new Wc(this.l,this.j)},$c.prototype.i=(function(g){return function(){return g}})({});function Wc(g,w){Pe.call(this),this.D=g,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Wc,Pe),n=Wc.prototype,n.open=function(g,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=w,this.readyState=1,La(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(w.body=g),(this.D||a).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Da(this)),this.readyState=0},n.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,La(this)),this.g&&(this.readyState=3,La(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vv(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function vv(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}n.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var w=g.value?g.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!g.done}))&&(this.response=this.responseText+=w)}g.done?Da(this):La(this),this.readyState==3&&vv(this)}},n.Ra=function(g){this.g&&(this.response=this.responseText=g,Da(this))},n.Qa=function(g){this.g&&(this.response=g,Da(this))},n.ga=function(){this.g&&Da(this)};function Da(g){g.readyState=4,g.l=null,g.j=null,g.v=null,La(g)}n.setRequestHeader=function(g,w){this.u.append(g,w)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],w=this.h.entries();for(var b=w.next();!b.done;)b=b.value,g.push(b[0]+": "+b[1]),b=w.next();return g.join(`\r
`)};function La(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function wv(g){let w="";return V(g,function(b,k){w+=k,w+=":",w+=b,w+=`\r
`}),w}function zh(g,w,b){e:{for(k in b){var k=!1;break e}k=!0}k||(b=wv(b),typeof g=="string"?b!=null&&encodeURIComponent(String(b)):Je(g,w,b))}function ut(g){Pe.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(ut,Pe);var gP=/^https?$/i,yP=["POST","PUT"];n=ut.prototype,n.Ha=function(g){this.J=g},n.ea=function(g,w,b,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);w=w?w.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Dh.g(),this.v=this.o?Oc(this.o):Oc(Dh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(w,String(g),!0),this.B=!1}catch(j){_v(this,j);return}if(g=b||"",b=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var U in k)b.set(U,k[U]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const j of k.keys())b.set(j,k.get(j));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(b.keys()).find(j=>j.toLowerCase()=="content-type"),U=a.FormData&&g instanceof a.FormData,!(0<=Array.prototype.indexOf.call(yP,w,void 0))||k||U||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,Z]of b)this.g.setRequestHeader(j,Z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Tv(this),this.u=!0,this.g.send(g),this.u=!1}catch(j){_v(this,j)}};function _v(g,w){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=w,g.m=5,bv(g),Kc(g)}function bv(g){g.A||(g.A=!0,Me(g,"complete"),Me(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,Me(this,"complete"),Me(this,"abort"),Kc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kc(this,!0)),ut.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?xv(this):this.bb())},n.bb=function(){xv(this)};function xv(g){if(g.h&&typeof o<"u"&&(!g.v[1]||Ci(g)!=4||g.Z()!=2)){if(g.u&&Ci(g)==4)De(g.Ea,0,g);else if(Me(g,"readystatechange"),Ci(g)==4){g.h=!1;try{const Z=g.Z();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var b;if(!(b=w)){var k;if(k=Z===0){var U=String(g.D).match(hv)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),k=!gP.test(U?U.toLowerCase():"")}b=k}if(b)Me(g,"complete"),Me(g,"success");else{g.m=6;try{var j=2<Ci(g)?g.g.statusText:""}catch{j=""}g.l=j+" ["+g.Z()+"]",bv(g)}}finally{Kc(g)}}}}function Kc(g,w){if(g.g){Tv(g);const b=g.g,k=g.v[0]?()=>{}:null;g.g=null,g.v=null,w||Me(g,"ready");try{b.onreadystatechange=k}catch{}}}function Tv(g){g.I&&(a.clearTimeout(g.I),g.I=null)}n.isActive=function(){return!!this.g};function Ci(g){return g.g?g.g.readyState:0}n.Z=function(){try{return 2<Ci(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(g){if(this.g){var w=this.g.responseText;return g&&w.indexOf(g)==0&&(w=w.substring(g.length)),Ea(w)}};function Ev(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function vP(g){const w={};g=(g.g&&2<=Ci(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<g.length;k++){if(S(g[k]))continue;var b=M(g[k]);const U=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const j=w[U]||[];w[U]=j,j.push(b)}I(w,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fa(g,w,b){return b&&b.internalChannelParams&&b.internalChannelParams[g]||w}function Av(g){this.Aa=0,this.i=[],this.j=new Pa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fa("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fa("baseRetryDelayMs",5e3,g),this.cb=Fa("retryDelaySeedMs",1e4,g),this.Wa=Fa("forwardChannelMaxRetries",2,g),this.wa=Fa("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new ov(g&&g.concurrentRequestLimit),this.Da=new pP,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Av.prototype,n.la=8,n.G=1,n.connect=function(g,w,b,k){sn(0),this.W=g,this.H=w||{},b&&k!==void 0&&(this.H.OSID=b,this.H.OAID=k),this.F=this.X,this.I=Dv(this,null,this.W),Jc(this)};function jh(g){if(Iv(g),g.G==3){var w=g.U++,b=Ii(g.I);if(Je(b,"SID",g.K),Je(b,"RID",w),Je(b,"TYPE","terminate"),Va(g,b),w=new Qi(g,g.j,w),w.L=2,w.v=Gc(Ii(b)),b=!1,a.navigator&&a.navigator.sendBeacon)try{b=a.navigator.sendBeacon(w.v.toString(),"")}catch{}!b&&a.Image&&(new Image().src=w.v,b=!0),b||(w.g=Lv(w.j,null),w.g.ea(w.v)),w.F=Date.now(),jc(w)}Mv(g)}function Yc(g){g.g&&(Hh(g),g.g.cancel(),g.g=null)}function Iv(g){Yc(g),g.u&&(a.clearTimeout(g.u),g.u=null),Xc(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&a.clearTimeout(g.s),g.s=null)}function Jc(g){if(!av(g.h)&&!g.s){g.s=!0;var w=g.Ga;ie||te(),W||(ie(),W=!0),H.add(w,g),g.B=0}}function wP(g,w){return lv(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=w.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=Sa(m(g.Ga,g,w),Nv(g,g.B)),g.B++,!0)}n.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const U=new Qi(this,this.j,g);let j=this.o;if(this.S&&(j?(j=E(j),N(j,this.S)):j=this.S),this.m!==null||this.O||(U.H=j,j=null),this.P)e:{for(var w=0,b=0;b<this.i.length;b++){t:{var k=this.i[b];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(w+=k,4096<w){w=b;break e}if(w===4096||b===this.i.length-1){w=b+1;break e}}w=1e3}else w=1e3;w=Sv(this,U,w),b=Ii(this.I),Je(b,"RID",g),Je(b,"CVER",22),this.D&&Je(b,"X-HTTP-Session-Id",this.D),Va(this,b),j&&(this.O?w="headers="+encodeURIComponent(String(wv(j)))+"&"+w:this.m&&zh(b,this.m,j)),Bh(this.h,U),this.Ua&&Je(b,"TYPE","init"),this.P?(Je(b,"$req",w),Je(b,"SID","null"),U.T=!0,Fh(U,b,null)):Fh(U,b,w),this.G=2}}else this.G==3&&(g?Cv(this,g):this.i.length==0||av(this.h)||Cv(this))};function Cv(g,w){var b;w?b=w.l:b=g.U++;const k=Ii(g.I);Je(k,"SID",g.K),Je(k,"RID",b),Je(k,"AID",g.T),Va(g,k),g.m&&g.o&&zh(k,g.m,g.o),b=new Qi(g,g.j,b,g.B+1),g.m===null&&(b.H=g.o),w&&(g.i=w.D.concat(g.i)),w=Sv(g,b,1e3),b.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Bh(g.h,b),Fh(b,k,w)}function Va(g,w){g.H&&V(g.H,function(b,k){Je(w,k,b)}),g.l&&dv({},function(b,k){Je(w,k,b)})}function Sv(g,w,b){b=Math.min(g.i.length,b);var k=g.l?m(g.l.Na,g.l,g):null;e:{var U=g.i;let j=-1;for(;;){const Z=["count="+b];j==-1?0<b?(j=U[0].g,Z.push("ofs="+j)):j=0:Z.push("ofs="+j);let Ge=!0;for(let Ut=0;Ut<b;Ut++){let Oe=U[Ut].g;const Ht=U[Ut].map;if(Oe-=j,0>Oe)j=Math.max(0,U[Ut].g-100),Ge=!1;else try{mP(Ht,Z,"req"+Oe+"_")}catch{k&&k(Ht)}}if(Ge){k=Z.join("&");break e}}}return g=g.i.splice(0,b),w.D=g,k}function Pv(g){if(!g.g&&!g.u){g.Y=1;var w=g.Fa;ie||te(),W||(ie(),W=!0),H.add(w,g),g.v=0}}function qh(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=Sa(m(g.Fa,g),Nv(g,g.v)),g.v++,!0)}n.Fa=function(){if(this.u=null,kv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=Sa(m(this.ab,this),g)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,sn(10),Yc(this),kv(this))};function Hh(g){g.A!=null&&(a.clearTimeout(g.A),g.A=null)}function kv(g){g.g=new Qi(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var w=Ii(g.qa);Je(w,"RID","rpc"),Je(w,"SID",g.K),Je(w,"AID",g.T),Je(w,"CI",g.F?"0":"1"),!g.F&&g.ja&&Je(w,"TO",g.ja),Je(w,"TYPE","xmlhttp"),Va(g,w),g.m&&g.o&&zh(w,g.m,g.o),g.L&&(g.g.I=g.L);var b=g.g;g=g.ia,b.L=1,b.v=Gc(Ii(w)),b.m=null,b.P=!0,iv(b,g)}n.Za=function(){this.C!=null&&(this.C=null,Yc(this),qh(this),sn(19))};function Xc(g){g.C!=null&&(a.clearTimeout(g.C),g.C=null)}function Rv(g,w){var b=null;if(g.g==w){Xc(g),Hh(g),g.g=null;var k=2}else if(Uh(g.h,w))b=w.D,cv(g.h,w),k=1;else return;if(g.G!=0){if(w.o)if(k==1){b=w.m?w.m.length:0,w=Date.now()-w.F;var U=g.B;k=Uc(),Me(k,new Zy(k,b)),Jc(g)}else Pv(g);else if(U=w.s,U==3||U==0&&0<w.X||!(k==1&&wP(g,w)||k==2&&qh(g)))switch(b&&0<b.length&&(w=g.h,w.i=w.i.concat(b)),U){case 1:Zs(g,5);break;case 4:Zs(g,10);break;case 3:Zs(g,6);break;default:Zs(g,2)}}}function Nv(g,w){let b=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(b*=2),b*w}function Zs(g,w){if(g.j.info("Error code "+w),w==2){var b=m(g.fb,g),k=g.Xa;const U=!k;k=new Qs(k||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qc(k,"https"),Gc(k),U?hP(k.toString(),b):fP(k.toString(),b)}else sn(2);g.G=0,g.l&&g.l.sa(w),Mv(g),Iv(g)}n.fb=function(g){g?(this.j.info("Successfully pinged google.com"),sn(2)):(this.j.info("Failed to ping google.com"),sn(1))};function Mv(g){if(g.G=0,g.ka=[],g.l){const w=uv(g.h);(w.length!=0||g.i.length!=0)&&(x(g.ka,w),x(g.ka,g.i),g.h.i.length=0,_(g.i),g.i.length=0),g.l.ra()}}function Dv(g,w,b){var k=b instanceof Qs?Ii(b):new Qs(b);if(k.g!="")w&&(k.g=w+"."+k.g),Hc(k,k.s);else{var U=a.location;k=U.protocol,w=w?w+"."+U.hostname:U.hostname,U=+U.port;var j=new Qs(null);k&&qc(j,k),w&&(j.g=w),U&&Hc(j,U),b&&(j.l=b),k=j}return b=g.D,w=g.ya,b&&w&&Je(k,b,w),Je(k,"VER",g.la),Va(g,k),k}function Lv(g,w,b){if(w&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=g.Ca&&!g.pa?new ut(new $c({eb:b})):new ut(g.pa),w.Ha(g.J),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fv(){}n=Fv.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Qc(){}Qc.prototype.g=function(g,w){return new Tn(g,w)};function Tn(g,w){Pe.call(this),this.g=new Av(w),this.l=g,this.h=w&&w.messageUrlParams||null,g=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(g?g["X-WebChannel-Content-Type"]=w.messageContentType:g={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(g?g["X-WebChannel-Client-Profile"]=w.va:g={"X-WebChannel-Client-Profile":w.va}),this.g.S=g,(g=w&&w.Sb)&&!S(g)&&(this.g.m=g),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!S(w)&&(this.g.D=w,g=this.h,g!==null&&w in g&&(g=this.h,w in g&&delete g[w])),this.j=new Qr(this)}v(Tn,Pe),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){jh(this.g)},Tn.prototype.o=function(g){var w=this.g;if(typeof g=="string"){var b={};b.__data__=g,g=b}else this.u&&(b={},b.__data__=Ks(g),g=b);w.i.push(new nP(w.Ya++,g)),w.G==3&&Jc(w)},Tn.prototype.N=function(){this.g.l=null,delete this.j,jh(this.g),delete this.g,Tn.aa.N.call(this)};function Vv(g){Nh.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var w=g.__sm__;if(w){e:{for(const b in w){g=b;break e}g=void 0}(this.i=g)&&(g=this.i,w=w!==null&&g in w?w[g]:void 0),this.data=w}else this.data=g}v(Vv,Nh);function Ov(){Mh.call(this),this.status=1}v(Ov,Mh);function Qr(g){this.g=g}v(Qr,Fv),Qr.prototype.ua=function(){Me(this.g,"a")},Qr.prototype.ta=function(g){Me(this.g,new Vv(g))},Qr.prototype.sa=function(g){Me(this.g,new Ov)},Qr.prototype.ra=function(){Me(this.g,"b")},Qc.prototype.createWebChannel=Qc.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,tA=function(){return new Qc},eA=function(){return Uc()},ZE=Js,_p={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bc.NO_ERROR=0,Bc.TIMEOUT=8,Bc.HTTP_ERROR=6,Cu=Bc,ev.COMPLETE="complete",QE=ev,Yy.EventType=Ia,Ia.OPEN="a",Ia.CLOSE="b",Ia.ERROR="c",Ia.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,sl=Yy,ut.prototype.listenOnce=ut.prototype.L,ut.prototype.getLastError=ut.prototype.Ka,ut.prototype.getLastErrorCode=ut.prototype.Ba,ut.prototype.getStatus=ut.prototype.Z,ut.prototype.getResponseJson=ut.prototype.Oa,ut.prototype.getResponseText=ut.prototype.oa,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Ha,XE=ut}).apply(typeof nu<"u"?nu:typeof self<"u"?self:typeof window<"u"?window:{});const D0="@firebase/firestore",L0="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=new Sd("@firebase/firestore");function co(){return Es.logLevel}function b3(n){Es.setLogLevel(n)}function K(n,...e){if(Es.logLevel<=Re.DEBUG){const t=e.map(ag);Es.debug(`Firestore (${la}): ${n}`,...t)}}function vt(n,...e){if(Es.logLevel<=Re.ERROR){const t=e.map(ag);Es.error(`Firestore (${la}): ${n}`,...t)}}function _i(n,...e){if(Es.logLevel<=Re.WARN){const t=e.map(ag);Es.warn(`Firestore (${la}): ${n}`,...t)}}function ag(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,nA(n,i,t)}function nA(n,e,t){let i=`FIRESTORE (${la}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vt(i),new Error(i)}function ce(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||nA(e,s,i)}function x3(n,e){n||se(57014,e)}function ne(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends en{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class T3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ft.UNAUTHENTICATED)))}shutdown(){}}class E3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class A3{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ce(this.o===void 0,42304);let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let r=new jt;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new jt,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const l=r;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},a=l=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new jt)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ce(typeof i.accessToken=="string",31837,{l:i}),new iA(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ce(e===null||typeof e=="string",2055,{h:e}),new Ft(e)}}class I3{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class C3{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new I3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ft.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class F0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class S3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ze(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ce(this.o===void 0,3512);const i=r=>{r.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable((()=>i(r)))};const s=r=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new F0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ce(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new F0(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=P3(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<t&&(i+=e.charAt(s[r]%62))}return i}}function xe(n,e){return n<e?-1:n>e?1:0}function bp(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),r=e.charAt(i);if(s!==r)return of(s)===of(r)?xe(s,r):of(s)?1:-1}return xe(n.length,e.length)}const k3=55296,R3=57343;function of(n){const e=n.charCodeAt(0);return e>=k3&&e<=R3}function Do(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function sA(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="__name__";class si{constructor(e,t,i){t===void 0?t=0:t>e.length&&se(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&se(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return si.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof si?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const r=si.compareSegments(e.get(s),t.get(s));if(r!==0)return r}return xe(e.length,t.length)}static compareSegments(e,t){const i=si.isNumericId(e),s=si.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?si.extractNumericId(e).compare(si.extractNumericId(t)):bp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ys.fromString(e.substring(4,e.length-2))}}class Ne extends si{construct(e,t,i){return new Ne(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new $(B.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new Ne(t)}static emptyPath(){return new Ne([])}}const N3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends si{construct(e,t,i){return new it(e,t,i)}static isValidIdentifier(e){return N3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===V0}static keyField(){return new it([V0])}static fromServerFormat(e){const t=[];let i="",s=0;const r=()=>{if(i.length===0)throw new $(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new $(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new $(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new it(t)}static emptyPath(){return new it([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(Ne.fromString(e))}static fromName(e){return new Q(Ne.fromString(e).popFirst(5))}static empty(){return new Q(Ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new Ne(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(n,e,t){if(!t)throw new $(B.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function rA(n,e,t,i){if(e===!0&&i===!0)throw new $(B.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function O0(n){if(!Q.isDocumentKey(n))throw new $(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function U0(n){if(Q.isDocumentKey(n))throw new $(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function oA(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":se(12329,{type:typeof n})}function Ue(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new $(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bd(n);throw new $(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function aA(n,e){if(e<=0)throw new $(B.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(n,e){const t={typeString:n};return e&&(t.value=e),t}function yc(n,e){if(!oA(n))throw new $(B.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,r="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(s&&typeof o!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){t=`Expected '${i}' field to equal '${r.value}'`;break}}if(t)throw new $(B.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0=-62135596800,z0=1e6;class je{static now(){return je.fromMillis(Date.now())}static fromDate(e){return je.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*z0);return new je(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<B0)throw new $(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/z0}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:je._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yc(e,je._jsonSchema))return new je(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-B0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}je._jsonSchemaVersion="firestore/timestamp/1.0",je._jsonSchema={type:Ct("string",je._jsonSchemaVersion),seconds:Ct("number"),nanoseconds:Ct("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{static fromTimestamp(e){return new he(e)}static min(){return new he(new je(0,0))}static max(){return new he(new je(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=-1;class Qu{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function xp(n){return n.fields.find((e=>e.kind===2))}function nr(n){return n.fields.filter((e=>e.kind!==2))}Qu.UNKNOWN_ID=-1;class Su{constructor(e,t){this.fieldPath=e,this.kind=t}}class Bl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Bl(0,Rn.min())}}function lA(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=he.fromTimestamp(i===1e9?new je(t+1,0):new je(t,i));return new Rn(s,Q.empty(),e)}function cA(n){return new Rn(n.readTime,n.key,Lo)}class Rn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Rn(he.min(),Q.empty(),Lo)}static max(){return new Rn(he.max(),Q.empty(),Lo)}}function ug(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Q.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(n){if(n.code!==B.FAILED_PRECONDITION||n.message!==uA)throw n;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O(((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):O.reject(t)}static resolve(e){return new O(((t,i)=>{t(e)}))}static reject(e){return new O(((t,i)=>{i(e)}))}static waitFor(e){return new O(((t,i)=>{let s=0,r=0,o=!1;e.forEach((a=>{++s,a.next((()=>{++r,o&&r===s&&t()}),(l=>i(l)))})),o=!0,r===s&&t()}))}static or(e){let t=O.resolve(!1);for(const i of e)t=t.next((s=>s?O.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,r)=>{i.push(t.call(this,s,r))})),this.waitFor(i)}static mapArray(e,t){return new O(((i,s)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;t(e[c]).next((u=>{o[c]=u,++a,a===r&&i(o)}),(u=>s(u)))}}))}static doWhile(e,t){return new O(((i,s)=>{const r=()=>{e()===!0?t().next((()=>{r()}),s):i()};r()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="SimpleDb";class zd{static open(e,t,i,s){try{return new zd(t,e.transaction(s,i))}catch(r){throw new yl(t,r)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new jt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new yl(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=dg(i.target.error);this.S.reject(new yl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(K(An,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new D3(t)}}class mi{static delete(e){return K(An,"Removing database:",e),sr(km().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Ml())return!1;if(mi.F())return!0;const e=ot(),t=mi.M(e),i=0<t&&t<10,s=hA(e),r=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||r)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,mi.M(ot())===12.2&&vt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(K(An,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=r=>{const o=r.target.result;t(o)},s.onblocked=()=>{i(new yl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=r=>{const o=r.target.error;o.name==="VersionError"?i(new $(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new $(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new yl(e,o))},s.onupgradeneeded=r=>{K(An,'Database "'+this.name+'" requires upgrade from version:',r.oldVersion);const o=r.target.result;this.N.k(o,s.transaction,r.oldVersion,this.version).next((()=>{K(An,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const r=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=zd.open(this.db,e,r?"readonly":"readwrite",i),l=s(a).next((c=>(a.C(),c))).catch((c=>(a.abort(c),O.reject(c)))).toPromise();return l.catch((()=>{})),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(K(An,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function hA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class M3{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return sr(this.U.delete())}}class yl extends ${constructor(e,t){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Os(n){return n.name==="IndexedDbTransactionError"}class D3{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(K(An,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(K(An,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),sr(i)}add(e){return K(An,"ADD",this.store.name,e,e),sr(this.store.add(e))}get(e){return sr(this.store.get(e)).next((t=>(t===void 0&&(t=null),K(An,"GET",this.store.name,e,t),t)))}delete(e){return K(An,"DELETE",this.store.name,e),sr(this.store.delete(e))}count(){return K(An,"COUNT",this.store.name),sr(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const r=s.getAll(i.range);return new O(((o,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{o(l.target.result)}}))}{const r=this.cursor(i),o=[];return this.H(r,((a,l)=>{o.push(l)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new O(((s,r)=>{i.onerror=o=>{r(o.target.error)},i.onsuccess=o=>{s(o.target.result)}}))}Z(e,t){K(An,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const s=this.cursor(i);return this.H(s,((r,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.H(s,t)}te(e){const t=this.cursor({});return new O(((i,s)=>{t.onerror=r=>{const o=dg(r.target.error);s(o)},t.onsuccess=r=>{const o=r.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new O(((s,r)=>{e.onerror=o=>{r(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new M3(a),c=t(a.primaryKey,a.value,l);if(c instanceof O){const u=c.catch((f=>(l.done(),O.reject(f))));i.push(u)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}})).next((()=>O.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function sr(n){return new O(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=dg(i.target.error);t(s)}}))}let j0=!1;function dg(n){const e=mi.M(ot());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new $("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return j0||(j0=!0,setTimeout((()=>{throw i}),0)),i}}return n}const vl="IndexBackfiller";class L3{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){K(vl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();K(vl,`Documents written: ${t}`)}catch(t){Os(t)?K(vl,"Ignoring IndexedDB error during index backfill: ",t):await Vs(t)}await this.re(6e4)}))}}class F3{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let s=t,r=!0;return O.doWhile((()=>r===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return K(vl,`Processing collection: ${o}`),this.oe(e,o,s).next((a=>{s-=a,i.add(o)}));r=!1})))).next((()=>t-s))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((r=>{const o=r.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(s,r))).next((a=>(K(vl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((s,r)=>{const o=cA(r);ug(o,i)>0&&(i=o)})),new Rn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=-1;function vc(n){return n==null}function zl(n){return n===0&&1/n==-1/0}function fA(n){return typeof n=="number"&&Number.isInteger(n)&&!zl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu="";function tn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=q0(e)),e=V3(n.get(t),e);return q0(e)}function V3(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":t+="";break;case Zu:t+="";break;default:t+=r}}return t}function q0(n){return n+Zu+""}function fi(n){const e=n.length;if(ce(e>=2,64408,{path:n}),e===2)return ce(n.charAt(0)===Zu&&n.charAt(1)==="",56145,{path:n}),Ne.emptyPath();const t=e-2,i=[];let s="";for(let r=0;r<e;){const o=n.indexOf(Zu,r);switch((o<0||o>t)&&se(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(r,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),i.push(l);break;case"":s+=n.substring(r,o),s+="\0";break;case"":s+=n.substring(r,o+1);break;default:se(61167,{path:n})}r=o+2}return new Ne(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="remoteDocuments",wc="owner",to="owner",jl="mutationQueues",O3="userId",Gn="mutations",H0="batchId",hr="userMutationsIndex",G0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(n,e){return[n,tn(e)]}function pA(n,e,t){return[n,tn(e),t]}const U3={},Fo="documentMutations",ed="remoteDocumentsV14",B3=["prefixPath","collectionGroup","readTime","documentId"],ku="documentKeyIndex",z3=["prefixPath","collectionGroup","documentId"],mA="collectionGroupIndex",j3=["collectionGroup","readTime","prefixPath","documentId"],ql="remoteDocumentGlobal",Tp="remoteDocumentGlobalKey",Vo="targets",gA="queryTargetsIndex",q3=["canonicalId","targetId"],Oo="targetDocuments",H3=["targetId","path"],hg="documentTargetsIndex",G3=["path","targetId"],td="targetGlobalKey",vr="targetGlobal",Hl="collectionParents",$3=["collectionId","parent"],Uo="clientMetadata",W3="clientId",jd="bundles",K3="bundleId",qd="namedQueries",Y3="name",fg="indexConfiguration",J3="indexId",Ep="collectionGroupIndex",X3="collectionGroup",wl="indexState",Q3=["indexId","uid"],yA="sequenceNumberIndex",Z3=["uid","sequenceNumber"],_l="indexEntries",e5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],vA="documentKeyIndex",t5=["indexId","uid","orderedDocumentKey"],Hd="documentOverlays",n5=["userId","collectionPath","documentId"],Ap="collectionPathOverlayIndex",i5=["userId","collectionPath","largestBatchId"],wA="collectionGroupOverlayIndex",s5=["userId","collectionGroup","largestBatchId"],pg="globals",r5="name",_A=[jl,Gn,Fo,ir,Vo,wc,vr,Oo,Uo,ql,Hl,jd,qd],o5=[..._A,Hd],bA=[jl,Gn,Fo,ed,Vo,wc,vr,Oo,Uo,ql,Hl,jd,qd,Hd],xA=bA,mg=[...xA,fg,wl,_l],a5=mg,TA=[...mg,pg],l5=TA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip extends dA{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Rt(n,e){const t=ne(n);return mi.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Us(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function EA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new Ye(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new Ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new iu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new iu(this.root,e,this.comparator,!1)}getReverseIterator(){return new iu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new iu(this.root,e,this.comparator,!0)}}class iu{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?i(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,i,s,r){this.key=e,this.value=t,this.color=i??Bt.RED,this.left=s??Bt.EMPTY,this.right=r??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,r){return new Bt(e??this.key,t??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const r=i(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,i),null):r===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Bt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,t,i,s,r){return this}insert(e,t,i){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.comparator=e,this.data=new Ye(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new W0(this.data.getIterator())}getIteratorFrom(e){return new W0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof He)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new He(this.comparator);return t.data=e,t}}class W0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function no(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new _n([])}unionWith(e){let t=new He(it.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new _n(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new AA("Invalid base64 string: "+r):r}})(e);return new ht(t)}static fromUint8Array(e){const t=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(e);return new ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const u5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oi(n){if(ce(!!n,39018),typeof n=="string"){let e=0;const t=u5.exec(n);if(ce(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:nt(n.seconds),nanos:nt(n.nanos)}}function nt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ui(n){return typeof n=="string"?ht.fromBase64String(n):ht.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA="server_timestamp",CA="__type__",SA="__previous_value__",PA="__local_write_time__";function Gd(n){return(n?.mapValue?.fields||{})[CA]?.stringValue===IA}function $d(n){const e=n.mapValue.fields[SA];return Gd(e)?$d(e):e}function Gl(n){const e=Oi(n.mapValue.fields[PA].timestampValue);return new je(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e,t,i,s,r,o,a,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Cp="(default)";class As{constructor(e,t){this.projectId=e,this.database=t||Cp}static empty(){return new As("","")}get isDefaultDatabase(){return this.database===Cp}isEqual(e){return e instanceof As&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg="__type__",kA="__max__",ds={mapValue:{fields:{__type__:{stringValue:kA}}}},yg="__vector__",Bo="value",Ru={nullValue:"NULL_VALUE"};function Is(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gd(n)?4:RA(n)?9007199254740991:Wd(n)?10:11:se(28295,{value:n})}function bi(n,e){if(n===e)return!0;const t=Is(n);if(t!==Is(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gl(n).isEqual(Gl(e));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=Oi(s.timestampValue),a=Oi(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,r){return Ui(s.bytesValue).isEqual(Ui(r.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,r){return nt(s.geoPointValue.latitude)===nt(r.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(r.geoPointValue.longitude)})(n,e);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return nt(s.integerValue)===nt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=nt(s.doubleValue),a=nt(r.doubleValue);return o===a?zl(o)===zl(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],bi);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if($0(o)!==$0(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!bi(o[l],a[l])))return!1;return!0})(n,e);default:return se(52216,{left:n})}}function $l(n,e){return(n.values||[]).find((t=>bi(t,e)))!==void 0}function Cs(n,e){if(n===e)return 0;const t=Is(n),i=Is(e);if(t!==i)return xe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return(function(r,o){const a=nt(r.integerValue||r.doubleValue),l=nt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return K0(n.timestampValue,e.timestampValue);case 4:return K0(Gl(n),Gl(e));case 5:return bp(n.stringValue,e.stringValue);case 6:return(function(r,o){const a=Ui(r),l=Ui(o);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=xe(a[c],l[c]);if(u!==0)return u}return xe(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(r,o){const a=xe(nt(r.latitude),nt(o.latitude));return a!==0?a:xe(nt(r.longitude),nt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Y0(n.arrayValue,e.arrayValue);case 10:return(function(r,o){const a=r.fields||{},l=o.fields||{},c=a[Bo]?.arrayValue,u=l[Bo]?.arrayValue,f=xe(c?.values?.length||0,u?.values?.length||0);return f!==0?f:Y0(c,u)})(n.mapValue,e.mapValue);case 11:return(function(r,o){if(r===ds.mapValue&&o===ds.mapValue)return 0;if(r===ds.mapValue)return 1;if(o===ds.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const m=bp(l[f],u[f]);if(m!==0)return m;const y=Cs(a[l[f]],c[u[f]]);if(y!==0)return y}return xe(l.length,u.length)})(n.mapValue,e.mapValue);default:throw se(23264,{he:t})}}function K0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=Oi(n),i=Oi(e),s=xe(t.seconds,i.seconds);return s!==0?s:xe(t.nanos,i.nanos)}function Y0(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const r=Cs(t[s],i[s]);if(r)return r}return xe(t.length,i.length)}function zo(n){return Sp(n)}function Sp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Oi(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ui(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Q.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const r of t.values||[])s?s=!1:i+=",",i+=Sp(r);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${Sp(t.fields[o])}`;return s+"}"})(n.mapValue):se(61005,{value:n})}function Nu(n){switch(Is(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$d(n);return e?16+Nu(e):16;case 5:return 2*n.stringValue.length;case 6:return Ui(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,r)=>s+Nu(r)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return Us(i.fields,((r,o)=>{s+=r.length+Nu(o)})),s})(n.mapValue);default:throw se(13486,{value:n})}}function Tr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Pp(n){return!!n&&"integerValue"in n}function Wl(n){return!!n&&"arrayValue"in n}function J0(n){return!!n&&"nullValue"in n}function X0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mu(n){return!!n&&"mapValue"in n}function Wd(n){return(n?.mapValue?.fields||{})[gg]?.stringValue===yg}function bl(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Us(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=bl(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bl(n.arrayValue.values[t]);return e}return{...n}}function RA(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===kA}const NA={mapValue:{fields:{[gg]:{stringValue:yg},[Bo]:{arrayValue:{}}}}};function h5(n){return"nullValue"in n?Ru:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Tr(As.empty(),Q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Wd(n)?NA:{mapValue:{}}:se(35942,{value:n})}function f5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Tr(As.empty(),Q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?NA:"mapValue"in n?Wd(n)?{mapValue:{}}:ds:se(61959,{value:n})}function Q0(n,e){const t=Cs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Z0(n,e){const t=Cs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.value=e}static empty(){return new zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Mu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bl(t)}setAll(e){let t=it.emptyPath(),i={},s=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,s),i={},s=[],t=a.popLast()}o?i[a.lastSegment()]=bl(o):s.push(a.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,i,s)}delete(e){const t=this.field(e.popLast());Mu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return bi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Mu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Us(t,((s,r)=>e[s]=r));for(const s of i)delete e[s]}clone(){return new zt(bl(this.value))}}function MA(n){const e=[];return Us(n.fields,((t,i)=>{const s=new it([t]);if(Mu(i)){const r=MA(i.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)})),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,t,i,s,r,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Qe(e,0,he.min(),he.min(),he.min(),zt.empty(),0)}static newFoundDocument(e,t,i,s){return new Qe(e,1,t,he.min(),i,s,0)}static newNoDocument(e,t){return new Qe(e,2,t,he.min(),he.min(),zt.empty(),0)}static newUnknownDocument(e,t){return new Qe(e,3,t,he.min(),he.min(),zt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){this.position=e,this.inclusive=t}}function ew(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const r=e[s],o=n.position[s];if(r.field.isKeyField()?i=Q.comparator(Q.fromName(o.referenceValue),t.key):i=Cs(o,t.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function tw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!bi(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t="asc"){this.field=e,this.dir=t}}function p5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{}class Le extends DA{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new m5(e,t,i):t==="array-contains"?new v5(e,i):t==="in"?new BA(e,i):t==="not-in"?new w5(e,i):t==="array-contains-any"?new _5(e,i):new Le(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new g5(e,i):new y5(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Cs(t,this.value)):t!==null&&Is(this.value)===Is(t)&&this.matchesComparison(Cs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qe extends DA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qe(e,t)}matches(e){return jo(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function jo(n){return n.op==="and"}function kp(n){return n.op==="or"}function vg(n){return LA(n)&&jo(n)}function LA(n){for(const e of n.filters)if(e instanceof qe)return!1;return!0}function Rp(n){if(n instanceof Le)return n.field.canonicalString()+n.op.toString()+zo(n.value);if(vg(n))return n.filters.map((e=>Rp(e))).join(",");{const e=n.filters.map((t=>Rp(t))).join(",");return`${n.op}(${e})`}}function FA(n,e){return n instanceof Le?(function(i,s){return s instanceof Le&&i.op===s.op&&i.field.isEqual(s.field)&&bi(i.value,s.value)})(n,e):n instanceof qe?(function(i,s){return s instanceof qe&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((r,o,a)=>r&&FA(o,s.filters[a])),!0):!1})(n,e):void se(19439)}function VA(n,e){const t=n.filters.concat(e);return qe.create(t,n.op)}function OA(n){return n instanceof Le?(function(t){return`${t.field.canonicalString()} ${t.op} ${zo(t.value)}`})(n):n instanceof qe?(function(t){return t.op.toString()+" {"+t.getFilters().map(OA).join(" ,")+"}"})(n):"Filter"}class m5 extends Le{constructor(e,t,i){super(e,t,i),this.key=Q.fromName(i.referenceValue)}matches(e){const t=Q.comparator(e.key,this.key);return this.matchesComparison(t)}}class g5 extends Le{constructor(e,t){super(e,"in",t),this.keys=UA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class y5 extends Le{constructor(e,t){super(e,"not-in",t),this.keys=UA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function UA(n,e){return(e.arrayValue?.values||[]).map((t=>Q.fromName(t.referenceValue)))}class v5 extends Le{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wl(t)&&$l(t.arrayValue,this.value)}}class BA extends Le{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$l(this.value.arrayValue,t)}}class w5 extends Le{constructor(e,t){super(e,"not-in",t)}matches(e){if($l(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$l(this.value.arrayValue,t)}}class _5 extends Le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wl(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>$l(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e,t=null,i=[],s=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function Np(n,e=null,t=[],i=[],s=null,r=null,o=null){return new b5(n,e,t,i,s,r,o)}function Er(n){const e=ne(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Rp(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(r){return r.field.canonicalString()+r.dir})(i))).join(","),vc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>zo(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>zo(i))).join(",")),e.Te=t}return e.Te}function _c(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!p5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!FA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!tw(n.startAt,e.startAt)&&tw(n.endAt,e.endAt)}function nd(n){return Q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function id(n,e){return n.filters.filter((t=>t instanceof Le&&t.field.isEqual(e)))}function nw(n,e,t){let i=Ru,s=!0;for(const r of id(n,e)){let o=Ru,a=!0;switch(r.op){case"<":case"<=":o=h5(r.value);break;case"==":case"in":case">=":o=r.value;break;case">":o=r.value,a=!1;break;case"!=":case"not-in":o=Ru}Q0({value:i,inclusive:s},{value:o,inclusive:a})<0&&(i=o,s=a)}if(t!==null){for(let r=0;r<n.orderBy.length;++r)if(n.orderBy[r].field.isEqual(e)){const o=t.position[r];Q0({value:i,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(i=o,s=t.inclusive);break}}return{value:i,inclusive:s}}function iw(n,e,t){let i=ds,s=!0;for(const r of id(n,e)){let o=ds,a=!0;switch(r.op){case">=":case">":o=f5(r.value),a=!1;break;case"==":case"in":case"<=":o=r.value;break;case"<":o=r.value,a=!1;break;case"!=":case"not-in":o=ds}Z0({value:i,inclusive:s},{value:o,inclusive:a})>0&&(i=o,s=a)}if(t!==null){for(let r=0;r<n.orderBy.length;++r)if(n.orderBy[r].field.isEqual(e)){const o=t.position[r];Z0({value:i,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(i=o,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,t=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zA(n,e,t,i,s,r,o,a){return new qi(n,e,t,i,s,r,o,a)}function ca(n){return new qi(n)}function sw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function wg(n){return n.collectionGroup!==null}function To(n){const e=ne(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),t.add(r.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new He(it.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new Kl(r,i))})),t.has(it.keyField().canonicalString())||e.Ie.push(new Kl(it.keyField(),i))}return e.Ie}function dn(n){const e=ne(n);return e.Ee||(e.Ee=x5(e,To(n))),e.Ee}function x5(n,e){if(n.limitType==="F")return Np(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new Kl(s.field,r)}));const t=n.endAt?new Ss(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ss(n.startAt.position,n.startAt.inclusive):null;return Np(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Mp(n,e){const t=n.filters.concat([e]);return new qi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sd(n,e,t){return new qi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function bc(n,e){return _c(dn(n),dn(e))&&n.limitType===e.limitType}function jA(n){return`${Er(dn(n))}|lt:${n.limitType}`}function uo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>OA(s))).join(", ")}]`),vc(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>zo(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>zo(s))).join(",")),`Target(${i})`})(dn(n))}; limitType=${n.limitType})`}function xc(n,e){return e.isFoundDocument()&&(function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):Q.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)})(n,e)&&(function(i,s){for(const r of To(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(o,a,l){const c=ew(o,a,l);return o.inclusive?c<=0:c<0})(i.startAt,To(i),s)||i.endAt&&!(function(o,a,l){const c=ew(o,a,l);return o.inclusive?c>=0:c>0})(i.endAt,To(i),s))})(n,e)}function qA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function HA(n){return(e,t)=>{let i=!1;for(const s of To(n)){const r=T5(s,e,t);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function T5(n,e,t){const i=n.field.isKeyField()?Q.comparator(e.key,t.key):(function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?Cs(l,c):se(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return se(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Us(this.inner,((t,i)=>{for(const[s,r]of i)e(s,r)}))}isEmpty(){return EA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=new Ye(Q.comparator);function bn(){return E5}const GA=new Ye(Q.comparator);function rl(...n){let e=GA;for(const t of n)e=e.insert(t.key,t);return e}function $A(n){let e=GA;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function pi(){return xl()}function WA(){return xl()}function xl(){return new Hi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const A5=new Ye(Q.comparator),I5=new He(Q.comparator);function Ae(...n){let e=I5;for(const t of n)e=e.add(t);return e}const C5=new He(xe);function _g(){return C5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zl(e)?"-0":e}}function KA(n){return{integerValue:""+n}}function YA(n,e){return fA(e)?KA(e):bg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(){this._=void 0}}function S5(n,e,t){return n instanceof qo?(function(s,r){const o={fields:{[CA]:{stringValue:IA},[PA]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&Gd(r)&&(r=$d(r)),r&&(o.fields[SA]=r),{mapValue:o}})(t,e):n instanceof Ar?XA(n,e):n instanceof Ir?QA(n,e):(function(s,r){const o=JA(s,r),a=rw(o)+rw(s.Ae);return Pp(o)&&Pp(s.Ae)?KA(a):bg(s.serializer,a)})(n,e)}function P5(n,e,t){return n instanceof Ar?XA(n,e):n instanceof Ir?QA(n,e):t}function JA(n,e){return n instanceof Ho?(function(i){return Pp(i)||(function(r){return!!r&&"doubleValue"in r})(i)})(e)?e:{integerValue:0}:null}class qo extends Kd{}class Ar extends Kd{constructor(e){super(),this.elements=e}}function XA(n,e){const t=ZA(e);for(const i of n.elements)t.some((s=>bi(s,i)))||t.push(i);return{arrayValue:{values:t}}}class Ir extends Kd{constructor(e){super(),this.elements=e}}function QA(n,e){let t=ZA(e);for(const i of n.elements)t=t.filter((s=>!bi(s,i)));return{arrayValue:{values:t}}}class Ho extends Kd{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function rw(n){return nt(n.integerValue||n.doubleValue)}function ZA(n){return Wl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,t){this.field=e,this.transform=t}}function k5(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof Ar&&s instanceof Ar||i instanceof Ir&&s instanceof Ir?Do(i.elements,s.elements,bi):i instanceof Ho&&s instanceof Ho?bi(i.Ae,s.Ae):i instanceof qo&&s instanceof qo})(n.transform,e.transform)}class R5{constructor(e,t){this.version=e,this.transformResults=t}}class st{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new st}static exists(e){return new st(void 0,e)}static updateTime(e){return new st(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Du(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Yd{}function eI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new da(n.key,st.none()):new ua(n.key,n.data,st.none());{const t=n.data,i=zt.empty();let s=new He(it.comparator);for(let r of e.fields)if(!s.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new Gi(n.key,i,new _n(s.toArray()),st.none())}}function N5(n,e,t){n instanceof ua?(function(s,r,o){const a=s.value.clone(),l=aw(s.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Gi?(function(s,r,o){if(!Du(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=aw(s.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(tI(s)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Tl(n,e,t,i){return n instanceof ua?(function(r,o,a,l){if(!Du(r.precondition,o))return a;const c=r.value.clone(),u=lw(r.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null})(n,e,t,i):n instanceof Gi?(function(r,o,a,l){if(!Du(r.precondition,o))return a;const c=lw(r.fieldTransforms,l,o),u=o.data;return u.setAll(tI(r)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((f=>f.field)))})(n,e,t,i):(function(r,o,a){return Du(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function M5(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),r=JA(i.transform,s||null);r!=null&&(t===null&&(t=zt.empty()),t.set(i.field,r))}return t||null}function ow(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Do(i,s,((r,o)=>k5(r,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ua extends Yd{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Gi extends Yd{constructor(e,t,i,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function tI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function aw(n,e,t){const i=new Map;ce(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const r=n[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,P5(o,a,t[s]))}return i}function lw(n,e,t){const i=new Map;for(const s of n){const r=s.transform,o=t.data.field(s.field);i.set(s.field,S5(r,o,e))}return i}class da extends Yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xg extends Yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&N5(r,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Tl(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Tl(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=WA();return this.mutations.forEach((s=>{const r=e.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=t.has(s.key)?null:a;const l=eI(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(he.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ae())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,i)=>ow(t,i)))&&Do(this.baseMutations,e.baseMutations,((t,i)=>ow(t,i)))}}class Eg{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){ce(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return A5})();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new Eg(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,Ve;function nI(n){switch(n){case B.OK:return se(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return se(15467,{code:n})}}function iI(n){if(n===void 0)return vt("GRPC error has no .code"),B.UNKNOWN;switch(n){case Et.OK:return B.OK;case Et.CANCELLED:return B.CANCELLED;case Et.UNKNOWN:return B.UNKNOWN;case Et.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Et.INTERNAL:return B.INTERNAL;case Et.UNAVAILABLE:return B.UNAVAILABLE;case Et.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Et.NOT_FOUND:return B.NOT_FOUND;case Et.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Et.ABORTED:return B.ABORTED;case Et.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Et.DATA_LOSS:return B.DATA_LOSS;default:return se(39323,{code:n})}}(Ve=Et||(Et={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=new ys([4294967295,4294967295],0);function cw(n){const e=sI().encode(n),t=new JE;return t.update(e),new Uint8Array(t.digest())}function uw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new ys([t,i],0),new ys([s,r],0)]}class Ig{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ol(`Invalid padding: ${t}`);if(i<0)throw new ol(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ol(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ol(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ys.fromNumber(this.ge)}ye(e,t,i){let s=e.add(t.multiply(ys.fromNumber(i)));return s.compare(L5)===1&&(s=new ys([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=cw(e),[i,s]=uw(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);if(!this.we(o))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new Ig(r,s,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=cw(e),[i,s]=uw(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ol extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,t,i,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ac.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ec(he.min(),s,new Ye(xe),bn(),Ae())}}class Ac{constructor(e,t,i,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ac(i,t,Ae(),Ae(),Ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t,i,s){this.be=e,this.removedTargetIds=t,this.key=i,this.De=s}}class rI{constructor(e,t){this.targetId=e,this.Ce=t}}class oI{constructor(e,t,i=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class dw{constructor(){this.ve=0,this.Fe=hw(),this.Me=ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ae(),t=Ae(),i=Ae();return this.Fe.forEach(((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:se(38017,{changeType:r})}})),new Ac(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=hw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class F5{constructor(e){this.Ge=e,this.ze=new Map,this.je=bn(),this.Je=su(),this.He=su(),this.Ye=new Ye(xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:se(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,i=e.Ce.count,s=this.ot(t);if(s){const r=s.target;if(nd(r))if(i===0){const o=new Q(r.path);this.et(t,o,Qe.newNoDocument(o,he.min()))}else ce(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=t;let o,a;try{o=Ui(i).toUint8Array()}catch(l){if(l instanceof AA)return _i("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Ig(o,s,r)}catch(l){return _i(l instanceof ol?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let s=0;return i.forEach((r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(a)||(this.et(t,r,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((r,o)=>{const a=this.ot(o);if(a){if(r.current&&nd(a.target)){const l=new Q(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Qe.newNoDocument(l,e))}r.Be&&(t.set(o,r.ke()),r.qe())}}));let i=Ae();this.He.forEach(((r,o)=>{let a=!0;o.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(e)));const s=new Ec(e,t,this.Ye,this.je,i);return this.je=bn(),this.Je=su(),this.He=su(),this.Ye=new Ye(xe),s}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new dw,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new He(xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new He(xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||K("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function su(){return new Ye(Q.comparator)}function hw(){return new Ye(Q.comparator)}const V5={asc:"ASCENDING",desc:"DESCENDING"},O5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},U5={and:"AND",or:"OR"};class B5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Dp(n,e){return n.useProto3Json||vc(e)?e:{value:e}}function Go(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function aI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function z5(n,e){return Go(n,e.toTimestamp())}function _t(n){return ce(!!n,49232),he.fromTimestamp((function(t){const i=Oi(t);return new je(i.seconds,i.nanos)})(n))}function Cg(n,e){return Lp(n,e).canonicalString()}function Lp(n,e){const t=(function(s){return new Ne(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function lI(n){const e=Ne.fromString(n);return ce(vI(e),10190,{key:e.toString()}),e}function Yl(n,e){return Cg(n.databaseId,e.path)}function gi(n,e){const t=lI(e);if(t.get(1)!==n.databaseId.projectId)throw new $(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new $(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Q(dI(t))}function cI(n,e){return Cg(n.databaseId,e)}function uI(n){const e=lI(n);return e.length===4?Ne.emptyPath():dI(e)}function Fp(n){return new Ne(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function dI(n){return ce(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function fw(n,e,t){return{name:Yl(n,e),fields:t.value.mapValue.fields}}function hI(n,e,t){const i=gi(n,e.name),s=_t(e.updateTime),r=e.createTime?_t(e.createTime):he.min(),o=new zt({mapValue:{fields:e.fields}}),a=Qe.newFoundDocument(i,s,r,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function j5(n,e){return"found"in e?(function(i,s){ce(!!s.found,43571),s.found.name,s.found.updateTime;const r=gi(i,s.found.name),o=_t(s.found.updateTime),a=s.found.createTime?_t(s.found.createTime):he.min(),l=new zt({mapValue:{fields:s.found.fields}});return Qe.newFoundDocument(r,o,a,l)})(n,e):"missing"in e?(function(i,s){ce(!!s.missing,3894),ce(!!s.readTime,22933);const r=gi(i,s.missing),o=_t(s.readTime);return Qe.newNoDocument(r,o)})(n,e):se(7234,{result:e})}function q5(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:se(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=(function(c,u){return c.useProto3Json?(ce(u===void 0||typeof u=="string",58123),ht.fromBase64String(u||"")):(ce(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),ht.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(c){const u=c.code===void 0?B.UNKNOWN:iI(c.code);return new $(u,c.message||"")})(o);t=new oI(i,s,r,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=gi(n,i.document.name),r=_t(i.document.updateTime),o=i.document.createTime?_t(i.document.createTime):he.min(),a=new zt({mapValue:{fields:i.document.fields}}),l=Qe.newFoundDocument(s,r,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];t=new Lu(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=gi(n,i.document),r=i.readTime?_t(i.readTime):he.min(),o=Qe.newNoDocument(s,r),a=i.removedTargetIds||[];t=new Lu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=gi(n,i.document),r=i.removedTargetIds||[];t=new Lu([],r,s,null)}else{if(!("filter"in e))return se(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new D5(s,r),a=i.targetId;t=new rI(a,o)}}return t}function Jl(n,e){let t;if(e instanceof ua)t={update:fw(n,e.key,e.value)};else if(e instanceof da)t={delete:Yl(n,e.key)};else if(e instanceof Gi)t={update:fw(n,e.key,e.data),updateMask:Y5(e.fieldMask)};else{if(!(e instanceof xg))return se(16599,{Vt:e.type});t={verify:Yl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(r,o){const a=o.transform;if(a instanceof qo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ar)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ir)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ho)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw se(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:z5(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:se(27497)})(n,e.precondition)),t}function Vp(n,e){const t=e.currentDocument?(function(r){return r.updateTime!==void 0?st.updateTime(_t(r.updateTime)):r.exists!==void 0?st.exists(r.exists):st.none()})(e.currentDocument):st.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(o,a){let l=null;if("setToServerValue"in a)ce(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new qo;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new Ar(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new Ir(u)}else"increment"in a?l=new Ho(o,a.increment):se(16584,{proto:a});const c=it.fromServerFormat(a.fieldPath);return new Tc(c,l)})(n,s))):[];if(e.update){e.update.name;const s=gi(n,e.update.name),r=new zt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(l){const c=l.fieldPaths||[];return new _n(c.map((u=>it.fromServerFormat(u))))})(e.updateMask);return new Gi(s,r,o,t,i)}return new ua(s,r,t,i)}if(e.delete){const s=gi(n,e.delete);return new da(s,t)}if(e.verify){const s=gi(n,e.verify);return new xg(s,t)}return se(1463,{proto:e})}function H5(n,e){return n&&n.length>0?(ce(e!==void 0,14353),n.map((t=>(function(s,r){let o=s.updateTime?_t(s.updateTime):_t(r);return o.isEqual(he.min())&&(o=_t(r)),new R5(o,s.transformResults||[])})(t,e)))):[]}function fI(n,e){return{documents:[cI(n,e.path)]}}function pI(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=cI(n,s);const r=(function(c){if(c.length!==0)return yI(qe.create(c,"and"))})(e.filters);r&&(t.structuredQuery.where=r);const o=(function(c){if(c.length!==0)return c.map((u=>(function(m){return{field:ho(m.field),direction:$5(m.dir)}})(u)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Dp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:s}}function mI(n){let e=uI(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){ce(i===1,65062);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let r=[];t.where&&(r=(function(f){const m=gI(f);return m instanceof qe&&vg(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(f){return f.map((m=>(function(v){return new Kl(fo(v.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(f){let m;return m=typeof f=="object"?f.value:f,vc(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(f){const m=!!f.before,y=f.values||[];return new Ss(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(f){const m=!f.before,y=f.values||[];return new Ss(y,m)})(t.endAt)),zA(e,s,o,r,a,"F",l,c)}function G5(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=fo(t.unaryFilter.field);return Le.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=fo(t.unaryFilter.field);return Le.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fo(t.unaryFilter.field);return Le.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=fo(t.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Le.create(fo(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return qe.create(t.compositeFilter.filters.map((i=>gI(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return se(1026)}})(t.compositeFilter.op))})(n):se(30097,{filter:n})}function $5(n){return V5[n]}function W5(n){return O5[n]}function K5(n){return U5[n]}function ho(n){return{fieldPath:n.canonicalString()}}function fo(n){return it.fromServerFormat(n.fieldPath)}function yI(n){return n instanceof Le?(function(t){if(t.op==="=="){if(X0(t.value))return{unaryFilter:{field:ho(t.field),op:"IS_NAN"}};if(J0(t.value))return{unaryFilter:{field:ho(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(X0(t.value))return{unaryFilter:{field:ho(t.field),op:"IS_NOT_NAN"}};if(J0(t.value))return{unaryFilter:{field:ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ho(t.field),op:W5(t.op),value:t.value}}})(n):n instanceof qe?(function(t){const i=t.getFilters().map((s=>yI(s)));return i.length===1?i[0]:{compositeFilter:{op:K5(t.op),filters:i}}})(n):se(54877,{filter:n})}function Y5(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function vI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,t,i,s,r=he.min(),o=he.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ni(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.yt=e}}function J5(n,e){let t;if(e.document)t=hI(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Q.fromSegments(e.noDocument.path),s=Sr(e.noDocument.readTime);t=Qe.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return se(56709);{const i=Q.fromSegments(e.unknownDocument.path),s=Sr(e.unknownDocument.version);t=Qe.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const r=new je(s[0],s[1]);return he.fromTimestamp(r)})(e.readTime)),t}function pw(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:rd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(r,o){return{name:Yl(r,o.key),fields:o.data.value.mapValue.fields,updateTime:Go(r,o.version.toTimestamp()),createTime:Go(r,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cr(e.version)};else{if(!e.isUnknownDocument())return se(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cr(e.version)}}return i}function rd(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cr(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sr(n){const e=new je(n.seconds,n.nanoseconds);return he.fromTimestamp(e)}function rr(n,e){const t=(e.baseMutations||[]).map((r=>Vp(n.yt,r)));for(let r=0;r<e.mutations.length-1;++r){const o=e.mutations[r];if(r+1<e.mutations.length&&e.mutations[r+1].transform!==void 0){const a=e.mutations[r+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}const i=e.mutations.map((r=>Vp(n.yt,r))),s=je.fromMillis(e.localWriteTimeMs);return new Tg(e.batchId,s,t,i)}function al(n){const e=Sr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Sr(n.lastLimboFreeSnapshotVersion):he.min();let i;return i=(function(r){return r.documents!==void 0})(n.query)?(function(r){const o=r.documents.length;return ce(o===1,1966,{count:o}),dn(ca(uI(r.documents[0])))})(n.query):(function(r){return dn(mI(r))})(n.query),new Ni(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ht.fromBase64String(n.resumeToken))}function _I(n,e){const t=Cr(e.snapshotVersion),i=Cr(e.lastLimboFreeSnapshotVersion);let s;s=nd(e.target)?fI(n.yt,e.target):pI(n.yt,e.target).ft;const r=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Er(e.target),readTime:t,resumeToken:r,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function Sg(n){const e=mI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sd(e,e.limit,"L"):e}function af(n,e){return new Ag(e.largestBatchId,Vp(n.yt,e.overlayMutation))}function mw(n,e){const t=e.path.lastSegment();return[n,tn(e.path.popLast()),t]}function gw(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cr(i.readTime),documentKey:tn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{getBundleMetadata(e,t){return yw(e).get(t).next((i=>{if(i)return(function(r){return{id:r.bundleId,createTime:Sr(r.createTime),version:r.version}})(i)}))}saveBundleMetadata(e,t){return yw(e).put((function(s){return{bundleId:s.id,createTime:Cr(_t(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return vw(e).get(t).next((i=>{if(i)return(function(r){return{name:r.name,query:Sg(r.bundledQuery),readTime:Sr(r.readTime)}})(i)}))}saveNamedQuery(e,t){return vw(e).put((function(s){return{name:s.name,readTime:Cr(_t(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function yw(n){return Rt(n,jd)}function vw(n){return Rt(n,qd)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new Jd(e,i)}getOverlay(e,t){return qa(e).get(mw(this.userId,t)).next((i=>i?af(this.serializer,i):null))}getOverlays(e,t){const i=pi();return O.forEach(t,(s=>this.getOverlay(e,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((r,o)=>{const a=new Ag(t,o);s.push(this.St(e,a))})),O.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((o=>s.add(tn(o.getCollectionPath()))));const r=[];return s.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);r.push(qa(e).Z(Ap,a))})),O.waitFor(r)}getOverlaysForCollection(e,t,i){const s=pi(),r=tn(t),o=IDBKeyRange.bound([this.userId,r,i],[this.userId,r,Number.POSITIVE_INFINITY],!0);return qa(e).J(Ap,o).next((a=>{for(const l of a){const c=af(this.serializer,l);s.set(c.getKey(),c)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const r=pi();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qa(e).ee({index:wA,range:a},((l,c,u)=>{const f=af(this.serializer,c);r.size()<s||f.largestBatchId===o?(r.set(f.getKey(),f),o=f.largestBatchId):u.done()})).next((()=>r))}St(e,t){return qa(e).put((function(s,r,o){const[a,l,c]=mw(r,o.mutation.key);return{userId:r,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Jl(s.yt,o.mutation)}})(this.serializer,this.userId,t))}}function qa(n){return Rt(n,Hd)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{bt(e){return Rt(e,pg)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ht.fromUint8Array(i):ht.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(nt(e.integerValue));else if("doubleValue"in e){const i=nt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),zl(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Oi(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ui(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?RA(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Wd(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):se(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const s of Object.keys(i))this.Ot(s,t),this.Ct(i[s],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const s=Bo,r=i[s].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(nt(r)),this.Ot(s,t),this.Ct(i[s],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const s of i)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),Q.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}or.Kt=new or;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=255;function Z5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function ww(n){const e=64-(function(i){let s=0;for(let r=0;r<8;++r){const o=Z5(255&i[r]);if(s+=o,o!==8)break}return s})(n);return Math.ceil(e/8)}class eL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),i=ww(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),i=ww(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(io),this.sn(255)}_n(){this.an(io),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(r){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,r,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===io?(this.sn(io),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===io?(this.an(io),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class tL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class nL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ha{constructor(){this.cn=new eL,this.ln=new tL(this.cn),this.hn=new nL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,i,s){this.Tn=e,this.In=t,this.En=i,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new ar(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Fu(this.En),directionalValue:Fu(this.dn),orderedDocumentKey:Fu(t),documentKey:i.path.toArray()}}Vn(e,t,i){const s=this.Rn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ns(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=_w(n.En,e.En),t!==0?t:(t=_w(n.dn,e.dn),t!==0?t:Q.comparator(n.In,e.In)))}function _w(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Fu(n){return VT()?(function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i})(n):n}function bw(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(n)}class xw{constructor(e){this.mn=new He(((t,i)=>it.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(ce(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=xp(e);if(t!==void 0&&!this.wn(t))return!1;const i=nr(e);let s=new Set,r=0,o=0;for(;r<i.length&&this.wn(i[r]);++r)s=s.add(i[r].fieldPath.canonicalString());if(r===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=i[r];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++r}for(;r<i.length;++r){const a=i[r];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new He(it.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Su(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Su(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Su(i.field,i.dir==="asc"?0:1)));return new Qu(Qu.UNKNOWN_ID,this.collectionId,t,Bl.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(n){if(ce(n instanceof Le||n instanceof qe,20012),n instanceof Le){if(n instanceof BA){const t=n.value.arrayValue?.values?.map((i=>Le.create(n.field,"==",i)))||[];return qe.create(t,"or")}return n}const e=n.filters.map((t=>bI(t)));return qe.create(e,n.op)}function iL(n){if(n.getFilters().length===0)return[];const e=Bp(bI(n));return ce(xI(e),7391),Op(e)||Up(e)?[e]:e.getFilters()}function Op(n){return n instanceof Le}function Up(n){return n instanceof qe&&vg(n)}function xI(n){return Op(n)||Up(n)||(function(t){if(t instanceof qe&&kp(t)){for(const i of t.getFilters())if(!Op(i)&&!Up(i))return!1;return!0}return!1})(n)}function Bp(n){if(ce(n instanceof Le||n instanceof qe,34018),n instanceof Le)return n;if(n.filters.length===1)return Bp(n.filters[0]);const e=n.filters.map((i=>Bp(i)));let t=qe.create(e,n.op);return t=od(t),xI(t)?t:(ce(t instanceof qe,64498),ce(jo(t),40251),ce(t.filters.length>1,57927),t.filters.reduce(((i,s)=>Pg(i,s))))}function Pg(n,e){let t;return ce(n instanceof Le||n instanceof qe,38388),ce(e instanceof Le||e instanceof qe,25473),t=n instanceof Le?e instanceof Le?(function(s,r){return qe.create([s,r],"and")})(n,e):Tw(n,e):e instanceof Le?Tw(e,n):(function(s,r){if(ce(s.filters.length>0&&r.filters.length>0,48005),jo(s)&&jo(r))return VA(s,r.getFilters());const o=kp(s)?s:r,a=kp(s)?r:s,l=o.filters.map((c=>Pg(c,a)));return qe.create(l,"or")})(n,e),od(t)}function Tw(n,e){if(jo(e))return VA(e,n.getFilters());{const t=e.filters.map((i=>Pg(n,i)));return qe.create(t,"or")}}function od(n){if(ce(n instanceof Le||n instanceof qe,11850),n instanceof Le)return n;const e=n.getFilters();if(e.length===1)return od(e[0]);if(LA(n))return n;const t=e.map((s=>od(s))),i=[];return t.forEach((s=>{s instanceof Le?i.push(s):s instanceof qe&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:qe.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(){this.Cn=new kg}addToCollectionParentIndex(e,t){return this.Cn.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(Rn.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(Rn.min())}updateCollectionGroup(e,t,i){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class kg{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new He(Ne.comparator),r=!s.has(i);return this.index[t]=s.add(i),r}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new He(Ne.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="IndexedDbIndexManager",ru=new Uint8Array(0);class rL{constructor(e,t){this.databaseId=t,this.vn=new kg,this.Fn=new Hi((i=>Er(i)),((i,s)=>_c(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const r={collectionId:i,parent:tn(s)};return Aw(e).put(r)}return O.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[sA(t),""],!1,!0);return Aw(e).J(s).next((r=>{for(const o of r){if(o.collectionId!==t)break;i.push(fi(o.parent))}return i}))}addFieldIndex(e,t){const i=Ga(e),s=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete s.indexId;const r=i.add(s);if(t.indexState){const o=ro(e);return r.next((a=>{o.put(gw(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return r.next()}deleteFieldIndex(e,t){const i=Ga(e),s=ro(e),r=so(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Ga(e),i=so(e),s=ro(e);return t.Z().next((()=>i.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return O.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const r=new xw(i).Dn();if(r!=null)return this.addFieldIndex(e,r)}}))))}getDocumentsMatchingTarget(e,t){const i=so(e);let s=!0;const r=new Map;return O.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{s&&(s=!!a),r.set(o,a)})))).next((()=>{if(s){let o=Ae();const a=[];return O.forEach(r,((l,c)=>{K(Ew,`Using index ${(function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map((D=>`${D.fieldPath}:${D.kind}`)).join(",")}`})(l)} to execute ${Er(t)}`);const u=(function(C,D){const F=xp(D);if(F===void 0)return null;for(const V of id(C,F.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(c,l),f=(function(C,D){const F=new Map;for(const V of nr(D))for(const I of id(C,V.fieldPath))switch(I.op){case"==":case"in":F.set(V.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return F.set(V.fieldPath.canonicalString(),I.value),Array.from(F.values())}return null})(c,l),m=(function(C,D){const F=[];let V=!0;for(const I of nr(D)){const E=I.kind===0?nw(C,I.fieldPath,C.startAt):iw(C,I.fieldPath,C.startAt);F.push(E.value),V&&(V=E.inclusive)}return new Ss(F,V)})(c,l),y=(function(C,D){const F=[];let V=!0;for(const I of nr(D)){const E=I.kind===0?iw(C,I.fieldPath,C.endAt):nw(C,I.fieldPath,C.endAt);F.push(E.value),V&&(V=E.inclusive)}return new Ss(F,V)})(c,l),v=this.On(l,c,m),_=this.On(l,c,y),x=this.Nn(l,c,f),T=this.Bn(l.indexId,u,v,m.inclusive,_,y.inclusive,x);return O.forEach(T,(S=>i.Y(S,t.limit).next((C=>{C.forEach((D=>{const F=Q.fromSegments(D.documentKey);o.has(F)||(o=o.add(F),a.push(F))}))}))))})).next((()=>a))}return O.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=iL(qe.create(e.filters,"and")).map((i=>Np(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,s,r,o,a){const l=(t!=null?t.length:1)*Math.max(i.length,r.length),c=l/(t!=null?t.length:1),u=[];for(let f=0;f<l;++f){const m=t?this.Ln(t[f/c]):ru,y=this.kn(e,m,i[f%c],s),v=this.qn(e,m,r[f%c],o),_=a.map((x=>this.kn(e,m,x,!0)));u.push(...this.createRange(y,v,_))}return u}kn(e,t,i,s){const r=new ar(e,Q.empty(),t,i);return s?r:r.An()}qn(e,t,i,s){const r=new ar(e,Q.empty(),t,i);return s?r.An():r}xn(e,t){const i=new xw(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((r=>{let o=null;for(const a of r)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const s=this.Mn(t);return O.forEach(s,(r=>this.xn(e,r).next((o=>{o?i!==0&&o.fields.length<(function(l){let c=new He(it.comparator),u=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?u=!0:c=c.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(u?1:0)})(r)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&s.length>1&&i===2?1:i))}Qn(e,t){const i=new Ha;for(const s of nr(e)){const r=t.data.field(s.fieldPath);if(r==null)return null;const o=i.Pn(s.kind);or.Kt.Dt(r,o)}return i.un()}Ln(e){const t=new Ha;return or.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Ha;return or.Kt.Dt(Tr(this.databaseId,t),i.Pn((function(r){const o=nr(r);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let s=[];s.push(new Ha);let r=0;for(const o of nr(e)){const a=i[r++];for(const l of s)if(this.Un(t,o.fieldPath)&&Wl(a))s=this.Kn(s,o,a);else{const c=l.Pn(o.kind);or.Kt.Dt(a,c)}}return this.Wn(s)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const s=[...e],r=[];for(const o of i.arrayValue.values||[])for(const a of s){const l=new Ha;l.seed(a.un()),or.Kt.Dt(o,l.Pn(t.kind)),r.push(l)}return r}Un(e,t){return!!e.filters.find((i=>i instanceof Le&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Ga(e),s=ro(e);return(t?i.J(Ep,IDBKeyRange.bound(t,t)):i.J()).next((r=>{const o=[];return O.forEach(r,(a=>s.get([a.indexId,this.uid]).next((l=>{o.push((function(u,f){const m=f?new Bl(f.sequenceNumber,new Rn(Sr(f.readTime),new Q(fi(f.documentKey)),f.largestBatchId)):Bl.empty(),y=u.fields.map((([v,_])=>new Su(it.fromServerFormat(v),_)));return new Qu(u.indexId,u.collectionGroup,y,m)})(a,l))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const r=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return r!==0?r:xe(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=Ga(e),r=ro(e);return this.Gn(e).next((o=>s.J(Ep,IDBKeyRange.bound(t,t)).next((a=>O.forEach(a,(l=>r.put(gw(l.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return O.forEach(t,((s,r)=>{const o=i.get(s.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next((a=>(i.set(s.collectionGroup,a),O.forEach(a,(l=>this.zn(e,s,l).next((c=>{const u=this.jn(r,l);return c.isEqual(u)?O.resolve():this.Jn(e,r,l,c,u)})))))))}))}Hn(e,t,i,s){return so(e).put(s.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,s){return so(e).delete(s.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const s=so(e);let r=new He(ns);return s.ee({index:vA,range:IDBKeyRange.only([i.indexId,this.uid,Fu(this.$n(i,t))])},((o,a)=>{r=r.add(new ar(i.indexId,t,bw(a.arrayValue),bw(a.directionalValue)))})).next((()=>r))}jn(e,t){let i=new He(ns);const s=this.Qn(t,e);if(s==null)return i;const r=xp(t);if(r!=null){const o=e.data.field(r.fieldPath);if(Wl(o))for(const a of o.arrayValue.values||[])i=i.add(new ar(t.indexId,e.key,this.Ln(a),s))}else i=i.add(new ar(t.indexId,e.key,ru,s));return i}Jn(e,t,i,s,r){K(Ew,"Updating index entries for document '%s'",t.key);const o=[];return(function(l,c,u,f,m){const y=l.getIterator(),v=c.getIterator();let _=no(y),x=no(v);for(;_||x;){let T=!1,S=!1;if(_&&x){const C=u(_,x);C<0?S=!0:C>0&&(T=!0)}else _!=null?S=!0:T=!0;T?(f(x),x=no(v)):S?(m(_),_=no(y)):(_=no(y),x=no(v))}})(s,r,ns,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),O.waitFor(o)}Gn(e){let t=1;return ro(e).ee({index:yA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,r)=>{r.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>ns(o,a))).filter(((o,a,l)=>!a||ns(o,l[a-1])!==0));const s=[];s.push(e);for(const o of i){const a=ns(o,e),l=ns(o,t);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(t);const r=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,ru,Q.empty()),l=s[o+1].Vn(this.uid,ru,Q.empty());r.push(IDBKeyRange.bound(a,l))}return r}Zn(e,t){return ns(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Iw)}getMinOffset(e,t){return O.mapArray(this.Mn(t),(i=>this.xn(e,i).next((s=>s||se(44426))))).next(Iw)}}function Aw(n){return Rt(n,Hl)}function so(n){return Rt(n,_l)}function Ga(n){return Rt(n,fg)}function ro(n){return Rt(n,wl)}function Iw(n){ce(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;ug(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Rn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},TI=41943040;class Kt{static withCacheSize(e){return new Kt(e,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(n,e,t){const i=n.store(Gn),s=n.store(Fo),r=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=i.ee({range:o},((u,f,m)=>(a++,m.delete())));r.push(l.next((()=>{ce(a===1,47070,{batchId:t.batchId})})));const c=[];for(const u of t.mutations){const f=pA(e,u.key.path,t.batchId);r.push(s.delete(f)),c.push(u.key)}return O.waitFor(r).next((()=>c))}function ad(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw se(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kt.DEFAULT_COLLECTION_PERCENTILE=10,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kt.DEFAULT=new Kt(TI,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kt.DISABLED=new Kt(-1,0,0);class Xd{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(e,t,i,s){ce(e.uid!=="",64387);const r=e.isAuthenticated()?e.uid:"";return new Xd(r,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return is(e).ee({index:hr,range:i},((s,r,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const r=po(e),o=is(e);return o.add({}).next((a=>{ce(typeof a=="number",49019);const l=new Tg(a,t,i,s),c=(function(y,v,_){const x=_.baseMutations.map((S=>Jl(y.yt,S))),T=_.mutations.map((S=>Jl(y.yt,S)));return{userId:v,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:x,mutations:T}})(this.serializer,this.userId,l),u=[];let f=new He(((m,y)=>xe(m.canonicalString(),y.canonicalString())));for(const m of s){const y=pA(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),u.push(o.put(c)),u.push(r.put(y,U3))}return f.forEach((m=>{u.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=l.keys()})),O.waitFor(u).next((()=>l))}))}lookupMutationBatch(e,t){return is(e).get(t).next((i=>i?(ce(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),rr(this.serializer,i)):null))}er(e,t){return this.Xn[t]?O.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let r=null;return is(e).ee({index:hr,range:s},((o,a,l)=>{a.userId===this.userId&&(ce(a.batchId>=i,47524,{tr:i}),r=rr(this.serializer,a)),l.done()})).next((()=>r))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=vs;return is(e).ee({index:hr,range:t,reverse:!0},((s,r,o)=>{i=r.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,vs],[this.userId,Number.POSITIVE_INFINITY]);return is(e).J(hr,t).next((i=>i.map((s=>rr(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Pu(this.userId,t.path),s=IDBKeyRange.lowerBound(i),r=[];return po(e).ee({range:s},((o,a,l)=>{const[c,u,f]=o,m=fi(u);if(c===this.userId&&t.path.isEqual(m))return is(e).get(f).next((y=>{if(!y)throw se(61480,{nr:o,batchId:f});ce(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),r.push(rr(this.serializer,y))}));l.done()})).next((()=>r))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new He(xe);const s=[];return t.forEach((r=>{const o=Pu(this.userId,r.path),a=IDBKeyRange.lowerBound(o),l=po(e).ee({range:a},((c,u,f)=>{const[m,y,v]=c,_=fi(y);m===this.userId&&r.path.isEqual(_)?i=i.add(v):f.done()}));s.push(l)})),O.waitFor(s).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,r=Pu(this.userId,i),o=IDBKeyRange.lowerBound(r);let a=new He(xe);return po(e).ee({range:o},((l,c,u)=>{const[f,m,y]=l,v=fi(m);f===this.userId&&i.isPrefixOf(v)?v.length===s&&(a=a.add(y)):u.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],s=[];return t.forEach((r=>{s.push(is(e).get(r).next((o=>{if(o===null)throw se(35274,{batchId:r});ce(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:r}),i.push(rr(this.serializer,o))})))})),O.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return EI(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),O.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return O.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),s=[];return po(e).ee({range:i},((r,o,a)=>{if(r[0]===this.userId){const l=fi(r[1]);s.push(l)}else a.done()})).next((()=>{ce(s.length===0,56720,{sr:s.map((r=>r.canonicalString()))})}))}))}containsKey(e,t){return AI(e,this.userId,t)}_r(e){return II(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:vs,lastStreamToken:""}))}}function AI(n,e,t){const i=Pu(e,t.path),s=i[1],r=IDBKeyRange.lowerBound(i);let o=!1;return po(n).ee({range:r,X:!0},((a,l,c)=>{const[u,f,m]=a;u===e&&f===s&&(o=!0),c.done()})).next((()=>o))}function is(n){return Rt(n,Gn)}function po(n){return Rt(n,Fo)}function II(n){return Rt(n,jl)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Pr(0)}static cr(){return new Pr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Pr(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>he.fromTimestamp(new je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>oo(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(ce(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let s=0;const r=[];return oo(e).ee(((o,a)=>{const l=al(a);l.sequenceNumber<=t&&i.get(l.targetId)===null&&(s++,r.push(this.removeTargetData(e,l)))})).next((()=>O.waitFor(r))).next((()=>s))}forEachTarget(e,t){return oo(e).ee(((i,s)=>{const r=al(s);t(r)}))}lr(e){return Sw(e).get(td).next((t=>(ce(t!==null,2888),t)))}hr(e,t){return Sw(e).put(td,t)}Pr(e,t){return oo(e).put(_I(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Er(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let r=null;return oo(e).ee({range:s,index:gA},((o,a,l)=>{const c=al(a);_c(t,c.target)&&(r=c,l.done())})).next((()=>r))}addMatchingKeys(e,t,i){const s=[],r=as(e);return t.forEach((o=>{const a=tn(o.path);s.push(r.put({targetId:i,path:a})),s.push(this.referenceDelegate.addReference(e,i,o))})),O.waitFor(s)}removeMatchingKeys(e,t,i){const s=as(e);return O.forEach(t,(r=>{const o=tn(r.path);return O.waitFor([s.delete([i,o]),this.referenceDelegate.removeReference(e,i,r)])}))}removeMatchingKeysForTargetId(e,t){const i=as(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=as(e);let r=Ae();return s.ee({range:i,X:!0},((o,a,l)=>{const c=fi(o[1]),u=new Q(c);r=r.add(u)})).next((()=>r))}containsKey(e,t){const i=tn(t.path),s=IDBKeyRange.bound([i],[sA(i)],!1,!0);let r=0;return as(e).ee({index:hg,X:!0,range:s},(([o,a],l,c)=>{o!==0&&(r++,c.done())})).next((()=>r>0))}At(e,t){return oo(e).get(t).next((i=>i?al(i):null))}}function oo(n){return Rt(n,Vo)}function Sw(n){return Rt(n,vr)}function as(n){return Rt(n,Oo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw="LruGarbageCollector",aL=1048576;function kw([n,e],[t,i]){const s=xe(n,t);return s===0?xe(e,i):s}class lL{constructor(e){this.Ir=e,this.buffer=new He(kw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();kw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class CI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(Pw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Os(t)?K(Pw,"Ignoring IndexedDB error during garbage collection: ",t):await Vs(t)}await this.Vr(3e5)}))}}class cL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return O.resolve(wn.ce);const i=new lL(t);return this.mr.forEachTarget(e,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(Cw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Cw):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,s,r,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s)))).next((f=>(i=f,a=Date.now(),this.removeTargets(e,i,t)))).next((f=>(r=f,l=Date.now(),this.removeOrphanedDocuments(e,i)))).next((f=>(c=Date.now(),co()<=Re.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:f}))))}}function SI(n,e){return new cL(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,t){this.db=e,this.garbageCollector=SI(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,s)=>t(s)))}addReference(e,t,i){return ou(e,i)}removeReference(e,t,i){return ou(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return ou(e,t)}br(e,t){return(function(s,r){let o=!1;return II(s).te((a=>AI(s,a,r).next((l=>(l&&(o=!0),O.resolve(!l)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let r=0;return this.Sr(e,((o,a)=>{if(a<=t){const l=this.br(e,o).next((c=>{if(!c)return r++,i.getEntry(e,o).next((()=>(i.removeEntry(o,he.min()),as(e).delete((function(f){return[0,tn(f.path)]})(o)))))}));s.push(l)}})).next((()=>O.waitFor(s))).next((()=>i.apply(e))).next((()=>r))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return ou(e,t)}Sr(e,t){const i=as(e);let s,r=wn.ce;return i.ee({index:hg},(([o,a],{path:l,sequenceNumber:c})=>{o===0?(r!==wn.ce&&t(new Q(fi(s)),r),r=c,s=l):r=wn.ce})).next((()=>{r!==wn.ce&&t(new Q(fi(s)),r)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ou(n,e){return as(n).put((function(i,s){return{targetId:0,path:tn(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.changes=new Hi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?O.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return er(e).put(i)}removeEntry(e,t,i){return er(e).delete((function(r,o){const a=r.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],rd(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Qe.newInvalidDocument(t);return er(e).ee({index:ku,range:IDBKeyRange.only($a(t))},((s,r)=>{i=this.Cr(t,r)})).next((()=>i))}vr(e,t){let i={size:0,document:Qe.newInvalidDocument(t)};return er(e).ee({index:ku,range:IDBKeyRange.only($a(t))},((s,r)=>{i={document:this.Cr(t,r),size:ad(r)}})).next((()=>i))}getEntries(e,t){let i=bn();return this.Fr(e,t,((s,r)=>{const o=this.Cr(s,r);i=i.insert(s,o)})).next((()=>i))}Mr(e,t){let i=bn(),s=new Ye(Q.comparator);return this.Fr(e,t,((r,o)=>{const a=this.Cr(r,o);i=i.insert(r,a),s=s.insert(r,ad(o))})).next((()=>({documents:i,Or:s})))}Fr(e,t,i){if(t.isEmpty())return O.resolve();let s=new He(Mw);t.forEach((l=>s=s.add(l)));const r=IDBKeyRange.bound($a(s.first()),$a(s.last())),o=s.getIterator();let a=o.getNext();return er(e).ee({index:ku,range:r},((l,c,u)=>{const f=Q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&Mw(a,f)<0;)i(a,null),a=o.getNext();a&&a.isEqual(f)&&(i(a,c),a=o.hasNext()?o.getNext():null),a?u.j($a(a)):u.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,r){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),rd(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return er(e).J(IDBKeyRange.bound(a,l,!0)).next((c=>{r?.incrementDocumentReadCount(c.length);let u=bn();for(const f of c){const m=this.Cr(Q.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(xc(t,m)||s.has(m.key))&&(u=u.insert(m.key,m))}return u}))}getAllFromCollectionGroup(e,t,i,s){let r=bn();const o=Nw(t,i),a=Nw(t,Rn.max());return er(e).ee({index:mA,range:IDBKeyRange.bound(o,a,!0)},((l,c,u)=>{const f=this.Cr(Q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);r=r.insert(f.key,f),r.size===s&&u.done()})).next((()=>r))}newChangeBuffer(e){return new hL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Rw(e).get(Tp).next((t=>(ce(!!t,20021),t)))}Dr(e,t){return Rw(e).put(Tp,t)}Cr(e,t){if(t){const i=J5(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(he.min())))return i}return Qe.newInvalidDocument(e)}}function kI(n){return new dL(n)}class hL extends PI{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Hi((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new He(((r,o)=>xe(r.canonicalString(),o.canonicalString())));return this.changes.forEach(((r,o)=>{const a=this.Br.get(r);if(t.push(this.Nr.removeEntry(e,r,a.readTime)),o.isValidDocument()){const l=pw(this.Nr.serializer,o);s=s.add(r.path.popLast());const c=ad(l);i+=c-a.size,t.push(this.Nr.addEntry(e,r,l))}else if(i-=a.size,this.trackRemovals){const l=pw(this.Nr.serializer,o.convertToNoDocument(he.min()));t.push(this.Nr.addEntry(e,r,l))}})),s.forEach((r=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,r))})),t.push(this.Nr.updateMetadata(e,i)),O.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:s})=>(s.forEach(((r,o)=>{this.Br.set(r,{size:o,readTime:i.get(r).readTime})})),i)))}}function Rw(n){return Rt(n,ql)}function er(n){return Rt(n,ed)}function $a(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Nw(n,e){const t=e.documentKey.path.toArray();return[n,rd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Mw(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let r=0;r<t.length-2&&r<i.length-2;++r)if(s=xe(t[r],i[r]),s)return s;return s=xe(t.length,i.length),s||(s=xe(t[t.length-2],i[i.length-2]),s||xe(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&Tl(i.mutation,s,_n.empty(),je.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ae()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ae()){const s=pi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((r=>{let o=rl();return r.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=pi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ae())))}populateOverlays(e,t,i){const s=[];return i.forEach((r=>{t.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(e,s).next((r=>{r.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,s){let r=bn();const o=xl(),a=(function(){return xl()})();return t.forEach(((l,c)=>{const u=i.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Gi)?r=r.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Tl(u.mutation,c,u.mutation.getFieldMask(),je.now())):o.set(c.key,_n.empty())})),this.recalculateAndSaveOverlays(e,r).next((l=>(l.forEach(((c,u)=>o.set(c,u))),t.forEach(((c,u)=>a.set(c,new fL(u,o.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=xl();let s=new Ye(((o,a)=>o-a)),r=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let u=i.get(l)||_n.empty();u=a.applyToLocalView(c,u),i.set(l,u);const f=(s.get(a.batchId)||Ae()).add(l);s=s.insert(a.batchId,f)}))})).next((()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=WA();u.forEach((m=>{if(!r.has(m)){const y=eI(t.get(m),i.get(m));y!==null&&f.set(m,y),r=r.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return O.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(o){return Q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):wg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-r.size):O.resolve(pi());let a=Lo,l=r;return o.next((c=>O.forEach(c,((u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),r.get(u)?O.resolve():this.remoteDocumentCache.getEntry(e,u).next((m=>{l=l.insert(u,m)}))))).next((()=>this.populateOverlays(e,c,r))).next((()=>this.computeViews(e,l,c,Ae()))).next((u=>({batchId:a,changes:$A(u)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Q(t)).next((i=>{let s=rl();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const r=t.collectionGroup;let o=rl();return this.indexManager.getCollectionParents(e,r).next((a=>O.forEach(a,(l=>{const c=(function(f,m){return new qi(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,i,s).next((u=>{u.forEach(((f,m)=>{o=o.insert(f,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r,s)))).next((o=>{r.forEach(((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Qe.newInvalidDocument(u)))}));let a=rl();return o.forEach(((l,c)=>{const u=r.get(l);u!==void 0&&Tl(u.mutation,c,_n.empty(),je.now()),xc(t,c)&&(a=a.insert(l,c))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return O.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:_t(s.createTime)}})(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:Sg(s.bundledQuery),readTime:_t(s.readTime)}})(t)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(){this.overlays=new Ye(Q.comparator),this.qr=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const i=pi();return O.forEach(t,(s=>this.getOverlay(e,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,r)=>{this.St(e,t,r)})),O.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.qr.delete(i)),O.resolve()}getOverlaysForCollection(e,t,i){const s=pi(),r=t.length+1,o=new Q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return O.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let r=new Ye(((c,u)=>c-u));const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let u=r.get(c.largestBatchId);u===null&&(u=pi(),r=r.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=pi(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=s)););return O.resolve(a)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Ag(t,i));let r=this.qr.get(t);r===void 0&&(r=Ae(),this.qr.set(t,r)),this.qr.set(t,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(){this.Qr=new He(Lt.$r),this.Ur=new He(Lt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Lt(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Lt(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Q(new Ne([])),i=new Lt(t,e),s=new Lt(t,e+1),r=[];return this.Ur.forEachInRange([i,s],(o=>{this.Gr(o),r.push(o.key)})),r}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Q(new Ne([])),i=new Lt(t,e),s=new Lt(t,e+1);let r=Ae();return this.Ur.forEachInRange([i,s],(o=>{r=r.add(o.key)})),r}containsKey(e){const t=new Lt(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Lt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Q.comparator(e.key,t.key)||xe(e.Yr,t.Yr)}static Kr(e,t){return xe(e.Yr,t.Yr)||Q.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new He(Lt.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Tg(r,t,i,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Lt(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,t){return O.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ei(i),r=s<0?0:s;return O.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?vs:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Lt(t,0),s=new Lt(t,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([i,s],(o=>{const a=this.Xr(o.Yr);r.push(a)})),O.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new He(xe);return t.forEach((s=>{const r=new Lt(s,0),o=new Lt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],(a=>{i=i.add(a.Yr)}))})),O.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let r=i;Q.isDocumentKey(r)||(r=r.child(""));const o=new Lt(new Q(r),0);let a=new He(xe);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)}),o),O.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const s=this.Xr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ce(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return O.forEach(t.mutations,(s=>{const r=new Lt(s.key,t.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Lt(t,0),s=this.Zr.firstAfterOrEqual(i);return O.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e){this.ri=e,this.docs=(function(){return new Ye(Q.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),r=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return O.resolve(i?i.document.mutableCopy():Qe.newInvalidDocument(t))}getEntries(e,t){let i=bn();return t.forEach((s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():Qe.newInvalidDocument(s))})),O.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let r=bn();const o=t.path,a=new Q(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||ug(cA(u),i)<=0||(s.has(u.key)||xc(t,u))&&(r=r.insert(u.key,u.mutableCopy()))}return O.resolve(r)}getAllFromCollectionGroup(e,t,i,s){se(9500)}ii(e,t){return O.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new wL(this)}getSize(e){return O.resolve(this.size)}}class wL extends PI{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(i)})),O.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.persistence=e,this.si=new Hi((t=>Er(t)),_c),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this.oi=0,this._i=new Rg,this.targetCount=0,this.ai=Pr.ur()}forEachTarget(e,t){return this.si.forEach(((i,s)=>t(s))),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),O.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Pr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Pr(t),O.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,i){let s=0;const r=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)})),O.waitFor(r).next((()=>s))}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return O.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),O.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach((o=>{r.push(s.markPotentiallyOrphaned(e,o))})),O.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),O.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return O.resolve(i)}containsKey(e,t){return O.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e,t){this.ui={},this.overlays={},this.ci=new wn(0),this.li=!1,this.li=!0,this.hi=new gL,this.referenceDelegate=e(this),this.Pi=new _L(this),this.indexManager=new sL,this.remoteDocumentCache=(function(s){return new vL(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new wI(t),this.Ii=new pL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new mL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new yL(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){K("MemoryPersistence","Starting transaction:",e);const s=new bL(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((r=>this.referenceDelegate.di(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ai(e,t){return O.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class bL extends dA{constructor(e){super(),this.currentSequenceNumber=e}}class Qd{constructor(e){this.persistence=e,this.Ri=new Rg,this.Vi=null}static mi(e){return new Qd(e)}get fi(){if(this.Vi)return this.Vi;throw se(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),O.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),O.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((r=>this.fi.add(r.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,(i=>{const s=Q.fromPath(i);return this.gi(e,s).next((r=>{r||t.removeEntry(s,he.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return O.or([()=>O.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ld{constructor(e,t){this.persistence=e,this.pi=new Hi((i=>tn(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=SI(this,t)}static mi(e,t){return new ld(e,t)}Ei(){}di(e){return O.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return O.forEach(this.pi,((i,s)=>this.br(e,i,s).next((r=>r?O.resolve():t(s)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,r.removeEntry(o,he.min()))})))).next((()=>r.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),O.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),O.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),O.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nu(e.data.value)),t}br(e,t,i){return O.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return O.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e){this.serializer=e}k(e,t,i,s){const r=new zd("createOrUpgrade",t);i<1&&s>=1&&((function(l){l.createObjectStore(wc)})(e),(function(l){l.createObjectStore(jl,{keyPath:O3}),l.createObjectStore(Gn,{keyPath:H0,autoIncrement:!0}).createIndex(hr,G0,{unique:!0}),l.createObjectStore(Fo)})(e),Dw(e),(function(l){l.createObjectStore(ir)})(e));let o=O.resolve();return i<3&&s>=3&&(i!==0&&((function(l){l.deleteObjectStore(Oo),l.deleteObjectStore(Vo),l.deleteObjectStore(vr)})(e),Dw(e)),o=o.next((()=>(function(l){const c=l.store(vr),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:he.min().toTimestamp(),targetCount:0};return c.put(td,u)})(r)))),i<4&&s>=4&&(i!==0&&(o=o.next((()=>(function(l,c){return c.store(Gn).J().next((f=>{l.deleteObjectStore(Gn),l.createObjectStore(Gn,{keyPath:H0,autoIncrement:!0}).createIndex(hr,G0,{unique:!0});const m=c.store(Gn),y=f.map((v=>m.put(v)));return O.waitFor(y)}))})(e,r)))),o=o.next((()=>{(function(l){l.createObjectStore(Uo,{keyPath:W3})})(e)}))),i<5&&s>=5&&(o=o.next((()=>this.yi(r)))),i<6&&s>=6&&(o=o.next((()=>((function(l){l.createObjectStore(ql)})(e),this.wi(r))))),i<7&&s>=7&&(o=o.next((()=>this.Si(r)))),i<8&&s>=8&&(o=o.next((()=>this.bi(e,r)))),i<9&&s>=9&&(o=o.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(o=o.next((()=>this.Di(r)))),i<11&&s>=11&&(o=o.next((()=>{(function(l){l.createObjectStore(jd,{keyPath:K3})})(e),(function(l){l.createObjectStore(qd,{keyPath:Y3})})(e)}))),i<12&&s>=12&&(o=o.next((()=>{(function(l){const c=l.createObjectStore(Hd,{keyPath:n5});c.createIndex(Ap,i5,{unique:!1}),c.createIndex(wA,s5,{unique:!1})})(e)}))),i<13&&s>=13&&(o=o.next((()=>(function(l){const c=l.createObjectStore(ed,{keyPath:B3});c.createIndex(ku,z3),c.createIndex(mA,j3)})(e))).next((()=>this.Ci(e,r))).next((()=>e.deleteObjectStore(ir)))),i<14&&s>=14&&(o=o.next((()=>this.Fi(e,r)))),i<15&&s>=15&&(o=o.next((()=>(function(l){l.createObjectStore(fg,{keyPath:J3,autoIncrement:!0}).createIndex(Ep,X3,{unique:!1}),l.createObjectStore(wl,{keyPath:Q3}).createIndex(yA,Z3,{unique:!1}),l.createObjectStore(_l,{keyPath:e5}).createIndex(vA,t5,{unique:!1})})(e)))),i<16&&s>=16&&(o=o.next((()=>{t.objectStore(wl).clear()})).next((()=>{t.objectStore(_l).clear()}))),i<17&&s>=17&&(o=o.next((()=>{(function(l){l.createObjectStore(pg,{keyPath:r5})})(e)}))),i<18&&s>=18&&VT()&&(o=o.next((()=>{t.objectStore(wl).clear()})).next((()=>{t.objectStore(_l).clear()}))),o}wi(e){let t=0;return e.store(ir).ee(((i,s)=>{t+=ad(s)})).next((()=>{const i={byteSize:t};return e.store(ql).put(Tp,i)}))}yi(e){const t=e.store(jl),i=e.store(Gn);return t.J().next((s=>O.forEach(s,(r=>{const o=IDBKeyRange.bound([r.userId,vs],[r.userId,r.lastAcknowledgedBatchId]);return i.J(hr,o).next((a=>O.forEach(a,(l=>{ce(l.userId===r.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=rr(this.serializer,l);return EI(e,r.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(Oo),i=e.store(ir);return e.store(vr).get(td).next((s=>{const r=[];return i.ee(((o,a)=>{const l=new Ne(o),c=(function(f){return[0,tn(f)]})(l);r.push(t.get(c).next((u=>u?O.resolve():(f=>t.put({targetId:0,path:tn(f),sequenceNumber:s.highestListenSequenceNumber}))(l))))})).next((()=>O.waitFor(r)))}))}bi(e,t){e.createObjectStore(Hl,{keyPath:$3});const i=t.store(Hl),s=new kg,r=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return i.put({collectionId:a,parent:tn(l)})}};return t.store(ir).ee({X:!0},((o,a)=>{const l=new Ne(o);return r(l.popLast())})).next((()=>t.store(Fo).ee({X:!0},(([o,a,l],c)=>{const u=fi(a);return r(u.popLast())}))))}Di(e){const t=e.store(Vo);return t.ee(((i,s)=>{const r=al(s),o=_I(this.serializer,r);return t.put(o)}))}Ci(e,t){const i=t.store(ir),s=[];return i.ee(((r,o)=>{const a=t.store(ed),l=(function(f){return f.document?new Q(Ne.fromString(f.document.name).popFirst(5)):f.noDocument?Q.fromSegments(f.noDocument.path):f.unknownDocument?Q.fromSegments(f.unknownDocument.path):se(36783)})(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))})).next((()=>O.waitFor(s)))}Fi(e,t){const i=t.store(Gn),s=kI(this.serializer),r=new Ng(Qd.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((l=>{let c=a.get(l.userId)??Ae();rr(this.serializer,l).keys().forEach((u=>c=c.add(u))),a.set(l.userId,c)})),O.forEach(a,((l,c)=>{const u=new Ft(c),f=Jd.wt(this.serializer,u),m=r.getIndexManager(u),y=Xd.wt(u,this.serializer,m,r.referenceDelegate);return new RI(s,y,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Ip(t,wn.ce),l).next()}))}))}}function Dw(n){n.createObjectStore(Oo,{keyPath:H3}).createIndex(hg,G3,{unique:!0}),n.createObjectStore(Vo,{keyPath:"targetId"}).createIndex(gA,q3,{unique:!0}),n.createObjectStore(vr)}const ss="IndexedDbPersistence",lf=18e5,cf=5e3,uf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",NI="main";class Mg{constructor(e,t,i,s,r,o,a,l,c,u,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=r,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Mg.v())throw new $(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new uL(this,s),this.$i=t+NI,this.serializer=new wI(l),this.Ui=new mi(this.$i,this.Ni,new xL(this.serializer)),this.hi=new Q5,this.Pi=new oL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kI(this.serializer),this.Ii=new X5,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&vt(ss,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new $(B.FAILED_PRECONDITION,uf);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new wn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>au(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Os(e))return K(ss,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return K(ss,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Wa(e).get(to).next((t=>O.resolve(this.es(t))))}ts(e){return au(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,lf)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Rt(t,Uo);return i.J().next((s=>{const r=this.ss(s,lf),o=s.filter((a=>r.indexOf(a)===-1));return O.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):Wa(e).get(to).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,cf)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new $(B.FAILED_PRECONDITION,uf);return!1}}return!(!this.networkEnabled||!this.inForeground)||au(e).J().next((i=>this.ss(i,cf).find((s=>{if(this.clientId!==s.clientId){const r=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(r||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&K(ss,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[wc,Uo],(e=>{const t=new Ip(e,wn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>au(e).J().next((t=>this.ss(t,lf).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Xd.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new rL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Jd.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){K(ss,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",r=(function(l){return l===18?l5:l===17?TA:l===16?a5:l===15?mg:l===14?xA:l===13?bA:l===12?o5:l===11?_A:void se(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,s,r,(a=>(o=new Ip(a,this.ci?this.ci.next():wn.ce),t==="readwrite-primary"?this.Hi(o).next((l=>!!l||this.Yi(o))).next((l=>{if(!l)throw vt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new $(B.FAILED_PRECONDITION,uA);return i(o)})).next((l=>this.Xi(o).next((()=>l)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return Wa(e).get(to).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,cf)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new $(B.FAILED_PRECONDITION,uf)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wa(e).put(to,t)}static v(){return mi.v()}Zi(e){const t=Wa(e);return t.get(to).next((i=>this.es(i)?(K(ss,"Releasing primary lease."),t.delete(to)):O.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(vt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;FT()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return K(ss,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return vt(ss,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){vt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wa(n){return Rt(n,wc)}function au(n){return Rt(n,Uo)}function Dg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=s}static As(e,t){let i=Ae(),s=Ae();for(const r of t.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new Lg(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return FT()?8:hA(ot())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,s){const r={result:null};return this.ys(e,t).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ws(e,t,s,i).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new TL;return this.Ss(e,t,o).next((a=>{if(r.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>r.result))}bs(e,t,i,s){return i.documentReadCount<this.fs?(co()<=Re.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",uo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(co()<=Re.DEBUG&&K("QueryEngine","Query:",uo(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(co()<=Re.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",uo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(t))):O.resolve())}ys(e,t){if(sw(t))return O.resolve(null);let i=dn(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=sd(t,null,"F"),i=dn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((r=>{const o=Ae(...r);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((l=>{const c=this.Ds(t,a);return this.Cs(t,c,o,l.readTime)?this.ys(e,sd(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,i,s){return sw(t)||s.isEqual(he.min())?O.resolve(null):this.ps.getDocuments(e,i).next((r=>{const o=this.Ds(t,r);return this.Cs(t,o,i,s)?O.resolve(null):(co()<=Re.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),uo(t)),this.vs(e,o,t,lA(s,Lo)).next((a=>a)))}))}Ds(e,t){let i=new He(HA(e));return t.forEach(((s,r)=>{xc(e,r)&&(i=i.add(r))})),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(e,t,i){return co()<=Re.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",uo(t)),this.ps.getDocumentsMatchingQuery(e,t,Rn.min(),i)}vs(e,t,i,s){return this.ps.getDocumentsMatchingQuery(e,i,s).next((r=>(t.forEach((o=>{r=r.insert(o.key,o)})),r)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="LocalStore",EL=3e8;class AL{constructor(e,t,i,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new Ye(xe),this.xs=new Hi((r=>Er(r)),_c),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function DI(n,e,t,i){return new AL(n,e,t,i)}async function LI(n,e){const t=ne(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((r=>(s=r,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((r=>{const o=[],a=[];let l=Ae();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of r){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(i,l).next((c=>({Ls:c,removedBatchIds:o,addedBatchIds:a})))}))}))}function IL(n,e){const t=ne(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),r=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const f=c.batch,m=f.keys();let y=O.resolve();return m.forEach((v=>{y=y.next((()=>u.getEntry(l,v))).next((_=>{const x=c.docVersions.get(v);ce(x!==null,48541),_.version.compareTo(x)<0&&(f.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),u.addEntry(_)))}))})),y.next((()=>a.mutationQueue.removeMutationBatch(l,f)))})(t,i,e,r).next((()=>r.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=Ae();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function FI(n){const e=ne(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function CL(n,e){const t=ne(n),i=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const a=[];e.targetChanges.forEach(((u,f)=>{const m=s.get(f);if(!m)return;a.push(t.Pi.removeMatchingKeys(r,u.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(r,u.addedDocuments,f))));let y=m.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(ht.EMPTY_BYTE_STRING,he.min()).withLastLimboFreeSnapshotVersion(he.min()):u.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(u.resumeToken,i)),s=s.insert(f,y),(function(_,x,T){return _.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=EL?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,y,u)&&a.push(t.Pi.updateTargetData(r,y))}));let l=bn(),c=Ae();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(r,u))})),a.push(VI(r,o,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!i.isEqual(he.min())){const u=t.Pi.getLastRemoteSnapshotVersion(r).next((f=>t.Pi.setTargetsMetadata(r,r.currentSequenceNumber,i)));a.push(u)}return O.waitFor(a).next((()=>o.apply(r))).next((()=>t.localDocuments.getLocalViewOfDocuments(r,l,c))).next((()=>l))})).then((r=>(t.Ms=s,r)))}function VI(n,e,t){let i=Ae(),s=Ae();return t.forEach((r=>i=i.add(r))),e.getEntries(n,i).next((r=>{let o=bn();return t.forEach(((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(he.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):K(Fg,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:o,qs:s}}))}function SL(n,e){const t=ne(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=vs),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function $o(n,e){const t=ne(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Pi.getTargetData(i,e).next((r=>r?(s=r,O.resolve(s)):t.Pi.allocateTargetId(i).next((o=>(s=new Ni(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Wo(n,e,t){const i=ne(n),s=i.Ms.get(e),r=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",r,(o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Os(o))throw o;K(Fg,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(s.target)}function cd(n,e,t){const i=ne(n);let s=he.min(),r=Ae();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,c,u){const f=ne(l),m=f.xs.get(u);return m!==void 0?O.resolve(f.Ms.get(m)):f.Pi.getTargetData(c,u)})(i,o,dn(e)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{r=l}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?s:he.min(),t?r:Ae()))).next((a=>(BI(i,qA(e),a),{documents:a,Qs:r})))))}function OI(n,e){const t=ne(n),i=ne(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(r=>i.At(r,e).next((o=>o?o.target:null))))}function UI(n,e){const t=ne(n),i=t.Os.get(e)||he.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,lA(i,Lo),Number.MAX_SAFE_INTEGER))).then((s=>(BI(t,e,s),s)))}function BI(n,e,t){let i=n.Os.get(e)||he.min();t.forEach(((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)})),n.Os.set(e,i)}async function PL(n,e,t,i){const s=ne(n);let r=Ae(),o=bn();for(const c of t){const u=e.$s(c.metadata.name);c.document&&(r=r.add(u));const f=e.Us(c);f.setReadTime(e.Ks(c.metadata.readTime)),o=o.insert(u,f)}const a=s.Ns.newChangeBuffer({trackRemovals:!0}),l=await $o(s,(function(u){return dn(ca(Ne.fromString(`__bundle__/docs/${u}`)))})(i));return s.persistence.runTransaction("Apply bundle documents","readwrite",(c=>VI(c,a,o).next((u=>(a.apply(c),u))).next((u=>s.Pi.removeMatchingKeysForTargetId(c,l.targetId).next((()=>s.Pi.addMatchingKeys(c,r,l.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(c,u.ks,u.qs))).next((()=>u.ks))))))}async function kL(n,e,t=Ae()){const i=await $o(n,dn(Sg(e.bundledQuery))),s=ne(n);return s.persistence.runTransaction("Save named query","readwrite",(r=>{const o=_t(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return s.Ii.saveNamedQuery(r,e);const a=i.withResumeToken(ht.EMPTY_BYTE_STRING,o);return s.Ms=s.Ms.insert(a.targetId,a),s.Pi.updateTargetData(r,a).next((()=>s.Pi.removeMatchingKeysForTargetId(r,i.targetId))).next((()=>s.Pi.addMatchingKeys(r,t,i.targetId))).next((()=>s.Ii.saveNamedQuery(r,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI="firestore_clients";function Lw(n,e){return`${zI}_${n}_${e}`}const jI="firestore_mutations";function Fw(n,e,t){let i=`${jI}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const qI="firestore_targets";function df(n,e){return`${qI}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="SharedClientState";class ud{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Ws(e,t,i){const s=JSON.parse(i);let r,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(r=new $(s.error.code,s.error.message))),o?new ud(e,t,s.state,r):(vt(oi,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class El{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let s,r=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return r&&i.error&&(r=typeof i.error.message=="string"&&typeof i.error.code=="string",r&&(s=new $(i.error.code,i.error.message))),r?new El(e,i.state,s):(vt(oi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,r=_g();for(let o=0;s&&o<i.activeTargetIds.length;++o)s=fA(i.activeTargetIds[o]),r=r.add(i.activeTargetIds[o]);return s?new dd(e,r):(vt(oi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Vg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Vg(t.clientId,t.onlineState):(vt(oi,`Failed to parse online state: ${e}`),null)}}class zp{constructor(){this.activeTargetIds=_g()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hf{constructor(e,t,i,s,r){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Ye(xe),this.started=!1,this.Xs=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.eo=Lw(this.persistenceKey,this.Js),this.no=(function(l){return`firestore_sequence_number_${l}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new zp),this.ro=new RegExp(`^${zI}_${o}_([^_]*)$`),this.io=new RegExp(`^${jI}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${qI}_${o}_(\\d+)$`),this.oo=(function(l){return`firestore_online_state_${l}`})(this.persistenceKey),this._o=(function(l){return`firestore_bundle_loaded_v2_${l}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const s=this.getItem(Lw(this.persistenceKey,i));if(s){const r=dd.Ws(i,s);r&&(this.Zs=this.Zs.insert(r.clientId,r))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(df(this.persistenceKey,e));if(s){const r=El.Ws(e,s);r&&(i=r.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(df(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Po(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return K(oi,"READ",e,t),t}setItem(e,t){K(oi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){K(oi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(K(oi,"EVENT",t.key,t.newValue),t.key===this.eo)return void vt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(r){let o=wn.ce;if(r!=null)try{const a=JSON.parse(r);ce(typeof a=="number",30636,{So:r}),o=a}catch(a){vt(oi,"Failed to read sequence number from WebStorage",a)}return o})(t.newValue);i!==wn.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const s=new ud(this.currentUser,e,t,i),r=Fw(this.persistenceKey,this.currentUser,e);this.setItem(r,s.Gs())}Po(e){const t=Fw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const s=df(this.persistenceKey,e),r=new El(e,t,i);this.setItem(s,r.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return dd.Ws(i,t)}fo(e,t){const i=this.io.exec(e),s=Number(i[1]),r=i[2]!==void 0?i[2]:null;return ud.Ws(new Ft(r),s,t)}yo(e,t){const i=this.so.exec(e),s=Number(i[1]);return El.Ws(s,t)}uo(e){return Vg.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);K(oi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),r=this.lo(i),o=[],a=[];return r.forEach((l=>{s.has(l)||o.push(l)})),s.forEach((l=>{r.has(l)||a.push(l)})),this.syncEngine.Fo(o,a).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=_g();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class HI{constructor(){this.Mo=new zp,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zp,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="ConnectivityMonitor";class Ow{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Vw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Vw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lu=null;function jp(){return lu===null?lu=(function(){return 268435456+Math.round(2147483648*Math.random())})():lu++,"0x"+lu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="RestConnection",NL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ML{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Cp?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(e,t,i,s,r){const o=jp(),a=this.zo(e,t.toUriEncodedString());K(ff,`Sending RPC '${e}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,r);const{host:c}=new URL(a),u=Ls(c);return this.Jo(e,a,l,i,u).then((f=>(K(ff,`Received RPC '${e}' ${o}: `,f),f)),(f=>{throw _i(ff,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",i),f}))}Ho(e,t,i,s,r,o){return this.Go(e,t,i,s,r)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+la})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,r)=>e[r]=s)),i&&i.headers.forEach(((s,r)=>e[r]=s))}zo(e,t){const i=NL[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t="WebChannelConnection";class LL extends ML{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,r){const o=jp();return new Promise(((a,l)=>{const c=new XE;c.setWithCredentials(!0),c.listenOnce(QE.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case Cu.NO_ERROR:const f=c.getResponseJson();K($t,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Cu.TIMEOUT:K($t,`RPC '${e}' ${o} timed out`),l(new $(B.DEADLINE_EXCEEDED,"Request time out"));break;case Cu.HTTP_ERROR:const m=c.getStatus();if(K($t,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const _=(function(T){const S=T.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(S)>=0?S:B.UNKNOWN})(v.status);l(new $(_,v.message))}else l(new $(B.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new $(B.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{K($t,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(s);K($t,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",u,i,15)}))}T_(e,t,i){const s=jp(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=tA(),a=eA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const u=r.join("");K($t,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=o.createWebChannel(u,l);this.I_(f);let m=!1,y=!1;const v=new DL({Yo:x=>{y?K($t,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(m||(K($t,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),K($t,`RPC '${e}' stream ${s} sending:`,x),f.send(x))},Zo:()=>f.close()}),_=(x,T,S)=>{x.listen(T,(C=>{try{S(C)}catch(D){setTimeout((()=>{throw D}),0)}}))};return _(f,sl.EventType.OPEN,(()=>{y||(K($t,`RPC '${e}' stream ${s} transport opened.`),v.o_())})),_(f,sl.EventType.CLOSE,(()=>{y||(y=!0,K($t,`RPC '${e}' stream ${s} transport closed`),v.a_(),this.E_(f))})),_(f,sl.EventType.ERROR,(x=>{y||(y=!0,_i($t,`RPC '${e}' stream ${s} transport errored. Name:`,x.name,"Message:",x.message),v.a_(new $(B.UNAVAILABLE,"The operation could not be completed")))})),_(f,sl.EventType.MESSAGE,(x=>{if(!y){const T=x.data[0];ce(!!T,16349);const S=T,C=S?.error||S[0]?.error;if(C){K($t,`RPC '${e}' stream ${s} received error:`,C);const D=C.status;let F=(function(E){const A=Et[E];if(A!==void 0)return iI(A)})(D),V=C.message;F===void 0&&(F=B.INTERNAL,V="Unknown error status: "+D+" with message "+C.message),y=!0,v.a_(new $(F,V)),f.close()}else K($t,`RPC '${e}' stream ${s} received:`,T),v.u_(T)}})),_(a,ZE.STAT_EVENT,(x=>{x.stat===_p.PROXY?K($t,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===_p.NOPROXY&&K($t,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(){return typeof window<"u"?window:null}function Vu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(n){return new B5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,t,i=1e3,s=1.5,r=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="PersistentStream";class $I{constructor(e,t,i,s,r,o,a,l){this.Mi=e,this.S_=i,this.b_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Og(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(vt(t.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===t&&this.G_(i,s)}),(i=>{e((()=>{const s=new $(B.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return K(Uw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(K(Uw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class FL extends $I{constructor(e,t,i,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,o),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=q5(this.serializer,e),i=(function(r){if(!("targetChange"in r))return he.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?he.min():o.readTime?_t(o.readTime):he.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=Fp(this.serializer),t.addTarget=(function(r,o){let a;const l=o.target;if(a=nd(l)?{documents:fI(r,l)}:{query:pI(r,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=aI(r,o.resumeToken);const c=Dp(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(he.min())>0){a.readTime=Go(r,o.snapshotVersion.toTimestamp());const c=Dp(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const i=G5(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=Fp(this.serializer),t.removeTarget=e,this.q_(t)}}class VL extends $I{constructor(e,t,i,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=H5(e.writeResults,e.commitTime),i=_t(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Fp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Jl(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{}class UL extends OL{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new $(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Go(e,Lp(t,i),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new $(B.UNKNOWN,r.toString())}))}Ho(e,t,i,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Lp(t,i),s,o,a,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(B.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class BL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vt(t),this.aa=!1):K("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="RemoteStore";class zL{constructor(e,t,i,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Bs(this)&&(K(kr,"Restarting streams for network reachability change."),await(async function(l){const c=ne(l);c.Ea.add(4),await ha(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Cc(c)})(this))}))})),this.Ra=new BL(i,s)}}async function Cc(n){if(Bs(n))for(const e of n.da)await e(!0)}async function ha(n){for(const e of n.da)await e(!1)}function Zd(n,e){const t=ne(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),zg(t)?Bg(t):pa(t).O_()&&Ug(t,e))}function Ko(n,e){const t=ne(n),i=pa(t);t.Ia.delete(e),i.O_()&&WI(t,e),t.Ia.size===0&&(i.O_()?i.L_():Bs(t)&&t.Ra.set("Unknown"))}function Ug(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(he.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pa(n).Y_(e)}function WI(n,e){n.Va.Ue(e),pa(n).Z_(e)}function Bg(n){n.Va=new F5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),pa(n).start(),n.Ra.ua()}function zg(n){return Bs(n)&&!pa(n).x_()&&n.Ia.size>0}function Bs(n){return ne(n).Ea.size===0}function KI(n){n.Va=void 0}async function jL(n){n.Ra.set("Online")}async function qL(n){n.Ia.forEach(((e,t)=>{Ug(n,e)}))}async function HL(n,e){KI(n),zg(n)?(n.Ra.ha(e),Bg(n)):n.Ra.set("Unknown")}async function GL(n,e,t){if(n.Ra.set("Online"),e instanceof oI&&e.state===2&&e.cause)try{await(async function(s,r){const o=r.cause;for(const a of r.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))})(n,e)}catch(i){K(kr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await hd(n,i)}else if(e instanceof Lu?n.Va.Ze(e):e instanceof rI?n.Va.st(e):n.Va.tt(e),!t.isEqual(he.min()))try{const i=await FI(n.localStore);t.compareTo(i)>=0&&await(function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=r.Ia.get(c);u&&r.Ia.set(c,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,c)=>{const u=r.Ia.get(l);if(!u)return;r.Ia.set(l,u.withResumeToken(ht.EMPTY_BYTE_STRING,u.snapshotVersion)),WI(r,l);const f=new Ni(u.target,l,c,u.sequenceNumber);Ug(r,f)})),r.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){K(kr,"Failed to raise snapshot:",i),await hd(n,i)}}async function hd(n,e,t){if(!Os(e))throw e;n.Ea.add(1),await ha(n),n.Ra.set("Offline"),t||(t=()=>FI(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{K(kr,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Cc(n)}))}function YI(n,e){return e().catch((t=>hd(n,t,e)))}async function fa(n){const e=ne(n),t=Ps(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vs;for(;$L(e);)try{const s=await SL(e.localStore,i);if(s===null){e.Ta.length===0&&t.L_();break}i=s.batchId,WL(e,s)}catch(s){await hd(e,s)}JI(e)&&XI(e)}function $L(n){return Bs(n)&&n.Ta.length<10}function WL(n,e){n.Ta.push(e);const t=Ps(n);t.O_()&&t.X_&&t.ea(e.mutations)}function JI(n){return Bs(n)&&!Ps(n).x_()&&n.Ta.length>0}function XI(n){Ps(n).start()}async function KL(n){Ps(n).ra()}async function YL(n){const e=Ps(n);for(const t of n.Ta)e.ea(t.mutations)}async function JL(n,e,t){const i=n.Ta.shift(),s=Eg.from(i,e,t);await YI(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await fa(n)}async function XL(n,e){e&&Ps(n).X_&&await(async function(i,s){if((function(o){return nI(o)&&o!==B.ABORTED})(s.code)){const r=i.Ta.shift();Ps(i).B_(),await YI(i,(()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s))),await fa(i)}})(n,e),JI(n)&&XI(n)}async function Bw(n,e){const t=ne(n);t.asyncQueue.verifyOperationInProgress(),K(kr,"RemoteStore received new credentials");const i=Bs(t);t.Ea.add(3),await ha(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Cc(t)}async function qp(n,e){const t=ne(n);e?(t.Ea.delete(2),await Cc(t)):e||(t.Ea.add(2),await ha(t),t.Ra.set("Unknown"))}function pa(n){return n.ma||(n.ma=(function(t,i,s){const r=ne(t);return r.sa(),new FL(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:jL.bind(null,n),t_:qL.bind(null,n),r_:HL.bind(null,n),H_:GL.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),zg(n)?Bg(n):n.Ra.set("Unknown")):(await n.ma.stop(),KI(n))}))),n.ma}function Ps(n){return n.fa||(n.fa=(function(t,i,s){const r=ne(t);return r.sa(),new VL(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:KL.bind(null,n),r_:XL.bind(null,n),ta:YL.bind(null,n),na:JL.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await fa(n)):(await n.fa.stop(),n.Ta.length>0&&(K(kr,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e,t,i,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,r){const o=Date.now()+i,a=new jg(e,t,o,s,r);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ma(n,e){if(vt("AsyncQueue",`${e}: ${n}`),Os(n))return new $(B.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{static emptySet(e){return new Eo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Q.comparator(t.key,i.key):(t,i)=>Q.comparator(t.key,i.key),this.keyedMap=rl(),this.sortedSet=new Ye(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Eo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Eo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(){this.ga=new Ye(Q.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):se(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Yo{constructor(e,t,i,s,r,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,s,r){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Yo(e,t,Eo.emptySet(t),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class ZL{constructor(){this.queries=jw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=ne(t),r=s.queries;s.queries=jw(),r.forEach(((o,a)=>{for(const l of a.Sa)l.onError(i)}))})(this,new $(B.ABORTED,"Firestore shutting down"))}}function jw(){return new Hi((n=>jA(n)),bc)}async function qg(n,e){const t=ne(n);let i=3;const s=e.query;let r=t.queries.get(s);r?!r.ba()&&e.Da()&&(i=2):(r=new QL,i=e.Da()?0:1);try{switch(i){case 0:r.wa=await t.onListen(s,!0);break;case 1:r.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=ma(o,`Initialization of query '${uo(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,r),r.Sa.push(e),e.va(t.onlineState),r.wa&&e.Fa(r.wa)&&Gg(t)}async function Hg(n,e){const t=ne(n),i=e.query;let s=3;const r=t.queries.get(i);if(r){const o=r.Sa.indexOf(e);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?s=e.Da()?0:1:!r.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function eF(n,e){const t=ne(n);let i=!1;for(const s of e){const r=s.query,o=t.queries.get(r);if(o){for(const a of o.Sa)a.Fa(s)&&(i=!0);o.wa=s}}i&&Gg(t)}function tF(n,e,t){const i=ne(n),s=i.queries.get(e);if(s)for(const r of s.Sa)r.onError(t);i.queries.delete(e)}function Gg(n){n.Ca.forEach((e=>{e.next()}))}var Hp,qw;(qw=Hp||(Hp={})).Ma="default",qw.Cache="cache";class $g{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Yo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Hp.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.serializer=e}$s(e){return gi(this.serializer,e)}Us(e){return e.metadata.exists?hI(this.serializer,e.document,!1):Qe.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return _t(e)}}class iF{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=QI(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const i=Ne.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,i=new Hw(this.serializer);for(const s of e)if(s.metadata.queries){const r=i.$s(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||Ae()).add(r);t.set(o,a)}}return t}async ja(e){const t=await PL(e,new Hw(this.serializer),this.Wa,this.Ua.id),i=this.za(this.documents);for(const s of this.Ka)await kL(e,s,i.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function QI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.key=e}}class e2{constructor(e){this.key=e}}class t2{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ae(),this.mutatedKeys=Ae(),this.eu=HA(e),this.tu=new Eo(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new zw,s=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((u,f)=>{const m=s.get(u),y=xc(this.query,f)?f:null,v=!!m&&this.mutatedKeys.has(m.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let x=!1;m&&y?m.data.isEqual(y.data)?v!==_&&(i.track({type:3,doc:y}),x=!0):this.su(m,y)||(i.track({type:2,doc:y}),x=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(a=!0)):!m&&y?(i.track({type:0,doc:y}),x=!0):m&&!y&&(i.track({type:1,doc:m}),x=!0,(l||c)&&(a=!0)),x&&(y?(o=o.add(y),r=_?r.add(u):r.delete(u)):(o=o.delete(u),r=r.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),r=r.delete(u.key),i.track({type:1,doc:u})}return{tu:o,iu:i,Cs:a,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((u,f)=>(function(y,v){const _=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Rt:x})}};return _(y)-_(v)})(u.type,f.type)||this.eu(u.doc,f.doc))),this.ou(i),s=s??!1;const a=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Yo(this.query,e.tu,r,o,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ae(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new e2(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new ZI(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ae();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const zs="SyncEngine";class sF{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class rF{constructor(e){this.key=e,this.hu=!1}}class oF{constructor(e,t,i,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Hi((a=>jA(a)),bc),this.Iu=new Map,this.Eu=new Set,this.du=new Ye(Q.comparator),this.Au=new Map,this.Ru=new Rg,this.Vu={},this.mu=new Map,this.fu=Pr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function aF(n,e,t=!0){const i=eh(n);let s;const r=i.Tu.get(e);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await n2(i,e,t,!0),s}async function lF(n,e){const t=eh(n);await n2(t,e,!0,!1)}async function n2(n,e,t,i){const s=await $o(n.localStore,dn(e)),r=s.targetId,o=n.sharedClientState.addLocalQueryTarget(r,t);let a;return i&&(a=await Wg(n,e,r,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Zd(n.remoteStore,s),a}async function Wg(n,e,t,i,s){n.pu=(f,m,y)=>(async function(_,x,T,S){let C=x.view.ru(T);C.Cs&&(C=await cd(_.localStore,x.query,!1).then((({documents:I})=>x.view.ru(I,C))));const D=S&&S.targetChanges.get(x.targetId),F=S&&S.targetMismatches.get(x.targetId)!=null,V=x.view.applyChanges(C,_.isPrimaryClient,D,F);return Gp(_,x.targetId,V.au),V.snapshot})(n,f,m,y);const r=await cd(n.localStore,e,!0),o=new t2(e,r.Qs),a=o.ru(r.documents),l=Ac.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Gp(n,t,c.au);const u=new sF(e,t,o);return n.Tu.set(e,u),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function cF(n,e,t){const i=ne(n),s=i.Tu.get(e),r=i.Iu.get(s.targetId);if(r.length>1)return i.Iu.set(s.targetId,r.filter((o=>!bc(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Wo(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Ko(i.remoteStore,s.targetId),Jo(i,s.targetId)})).catch(Vs)):(Jo(i,s.targetId),await Wo(i.localStore,s.targetId,!0))}async function uF(n,e){const t=ne(n),i=t.Tu.get(e),s=t.Iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ko(t.remoteStore,i.targetId))}async function dF(n,e,t){const i=Xg(n);try{const s=await(function(o,a){const l=ne(o),c=je.now(),u=a.reduce(((y,v)=>y.add(v.key)),Ae());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=bn(),_=Ae();return l.Ns.getEntries(y,u).next((x=>{v=x,v.forEach(((T,S)=>{S.isValidDocument()||(_=_.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((x=>{f=x;const T=[];for(const S of a){const C=M5(S,f.get(S.key).overlayedDocument);C!=null&&T.push(new Gi(S.key,C,MA(C.value.mapValue),st.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,T,a)})).next((x=>{m=x;const T=x.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(y,x.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:$A(f)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new Ye(xe)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c})(i,s.batchId,t),await $i(i,s.changes),await fa(i.remoteStore)}catch(s){const r=ma(s,"Failed to persist write");t.reject(r)}}async function i2(n,e){const t=ne(n);try{const i=await CL(t.localStore,e);e.targetChanges.forEach(((s,r)=>{const o=t.Au.get(r);o&&(ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ce(o.hu,14607):s.removedDocuments.size>0&&(ce(o.hu,42227),o.hu=!1))})),await $i(t,i,e)}catch(i){await Vs(i)}}function Gw(n,e,t){const i=ne(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Tu.forEach(((r,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)})),(function(o,a){const l=ne(o);l.onlineState=a;let c=!1;l.queries.forEach(((u,f)=>{for(const m of f.Sa)m.va(a)&&(c=!0)})),c&&Gg(l)})(i.eventManager,e),s.length&&i.Pu.H_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function hF(n,e,t){const i=ne(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Au.get(e),r=s&&s.key;if(r){let o=new Ye(Q.comparator);o=o.insert(r,Qe.newNoDocument(r,he.min()));const a=Ae().add(r),l=new Ec(he.min(),new Map,new Ye(xe),o,a);await i2(i,l),i.du=i.du.remove(r),i.Au.delete(e),Jg(i)}else await Wo(i.localStore,e,!1).then((()=>Jo(i,e,t))).catch(Vs)}async function fF(n,e){const t=ne(n),i=e.batch.batchId;try{const s=await IL(t.localStore,e);Yg(t,i,null),Kg(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $i(t,s)}catch(s){await Vs(s)}}async function pF(n,e,t){const i=ne(n);try{const s=await(function(o,a){const l=ne(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((f=>(ce(f!==null,37113),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(i.localStore,e);Yg(i,e,t),Kg(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $i(i,s)}catch(s){await Vs(s)}}async function mF(n,e){const t=ne(n);Bs(t.remoteStore)||K(zs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await(function(o){const a=ne(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l)))})(t.localStore);if(i===vs)return void e.resolve();const s=t.mu.get(i)||[];s.push(e),t.mu.set(i,s)}catch(i){const s=ma(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Kg(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Yg(n,e,t){const i=ne(n);let s=i.Vu[i.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),i.Vu[i.currentUser.toKey()]=s}}function Jo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||s2(n,i)}))}function s2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ko(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Jg(n))}function Gp(n,e,t){for(const i of t)i instanceof ZI?(n.Ru.addReference(i.key,e),gF(n,i)):i instanceof e2?(K(zs,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||s2(n,i.key)):se(19791,{wu:i})}function gF(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(K(zs,"New document in limbo: "+t),n.Eu.add(i),Jg(n))}function Jg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Q(Ne.fromString(e)),i=n.fu.next();n.Au.set(i,new rF(t)),n.du=n.du.insert(t,i),Zd(n.remoteStore,new Ni(dn(ca(t.path)),i,"TargetPurposeLimboResolution",wn.ce))}}async function $i(n,e,t){const i=ne(n),s=[],r=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,l)=>{o.push(i.pu(l,e,t).then((c=>{if((c||t)&&i.isPrimaryClient){const u=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=Lg.As(l.targetId,c);r.push(u)}})))})),await Promise.all(o),i.Pu.H_(s),await(async function(l,c){const u=ne(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>O.forEach(c,(m=>O.forEach(m.Es,(y=>u.persistence.referenceDelegate.addReference(f,m.targetId,y))).next((()=>O.forEach(m.ds,(y=>u.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))))))}catch(f){if(!Os(f))throw f;K(Fg,"Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const y=u.Ms.get(m),v=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,_)}}})(i.localStore,r))}async function yF(n,e){const t=ne(n);if(!t.currentUser.isEqual(e)){K(zs,"User change. New user:",e.toKey());const i=await LI(t.localStore,e);t.currentUser=e,(function(r,o){r.mu.forEach((a=>{a.forEach((l=>{l.reject(new $(B.CANCELLED,o))}))})),r.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $i(t,i.Ls)}}function vF(n,e){const t=ne(n),i=t.Au.get(e);if(i&&i.hu)return Ae().add(i.key);{let s=Ae();const r=t.Iu.get(e);if(!r)return s;for(const o of r){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function wF(n,e){const t=ne(n),i=await cd(t.localStore,e.query,!0),s=e.view.cu(i);return t.isPrimaryClient&&Gp(t,e.targetId,s.au),s}async function _F(n,e){const t=ne(n);return UI(t.localStore,e).then((i=>$i(t,i)))}async function bF(n,e,t,i){const s=ne(n),r=await(function(a,l){const c=ne(a),u=ne(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",(f=>u.er(f,l).next((m=>m?c.localDocuments.getDocuments(f,m):O.resolve(null)))))})(s.localStore,e);r!==null?(t==="pending"?await fa(s.remoteStore):t==="acknowledged"||t==="rejected"?(Yg(s,e,i||null),Kg(s,e),(function(a,l){ne(ne(a).mutationQueue).ir(l)})(s.localStore,e)):se(6720,"Unknown batchState",{Su:t}),await $i(s,r)):K(zs,"Cannot apply mutation batch with id: "+e)}async function xF(n,e){const t=ne(n);if(eh(t),Xg(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await $w(t,i.toArray());t.gu=!0,await qp(t.remoteStore,!0);for(const r of s)Zd(t.remoteStore,r)}else if(e===!1&&t.gu!==!1){const i=[];let s=Promise.resolve();t.Iu.forEach(((r,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):s=s.then((()=>(Jo(t,o),Wo(t.localStore,o,!0)))),Ko(t.remoteStore,o)})),await s,await $w(t,i),(function(o){const a=ne(o);a.Au.forEach(((l,c)=>{Ko(a.remoteStore,c)})),a.Ru.Jr(),a.Au=new Map,a.du=new Ye(Q.comparator)})(t),t.gu=!1,await qp(t.remoteStore,!1)}}async function $w(n,e,t){const i=ne(n),s=[],r=[];for(const o of e){let a;const l=i.Iu.get(o);if(l&&l.length!==0){a=await $o(i.localStore,dn(l[0]));for(const c of l){const u=i.Tu.get(c),f=await wF(i,u);f.snapshot&&r.push(f.snapshot)}}else{const c=await OI(i.localStore,o);a=await $o(i.localStore,c),await Wg(i,r2(c),o,!1,a.resumeToken)}s.push(a)}return i.Pu.H_(r),s}function r2(n){return zA(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function TF(n){return(function(t){return ne(ne(t).persistence).Ts()})(ne(n).localStore)}async function EF(n,e,t,i){const s=ne(n);if(s.gu)return void K(zs,"Ignoring unexpected query state notification.");const r=s.Iu.get(e);if(r&&r.length>0)switch(t){case"current":case"not-current":{const o=await UI(s.localStore,qA(r[0])),a=Ec.createSynthesizedRemoteEventForCurrentChange(e,t==="current",ht.EMPTY_BYTE_STRING);await $i(s,o,a);break}case"rejected":await Wo(s.localStore,e,!0),Jo(s,e,i);break;default:se(64155,t)}}async function AF(n,e,t){const i=eh(n);if(i.gu){for(const s of e){if(i.Iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){K(zs,"Adding an already active target "+s);continue}const r=await OI(i.localStore,s),o=await $o(i.localStore,r);await Wg(i,r2(r),o.targetId,!1,o.resumeToken),Zd(i.remoteStore,o)}for(const s of t)i.Iu.has(s)&&await Wo(i.localStore,s,!1).then((()=>{Ko(i.remoteStore,s),Jo(i,s)})).catch(Vs)}}function eh(n){const e=ne(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=i2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hF.bind(null,e),e.Pu.H_=eF.bind(null,e.eventManager),e.Pu.yu=tF.bind(null,e.eventManager),e}function Xg(n){const e=ne(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pF.bind(null,e),e}function IF(n,e,t){const i=ne(n);(async function(r,o,a){try{const l=await o.getMetadata();if(await(function(y,v){const _=ne(y),x=_t(v.createTime);return _.persistence.runTransaction("hasNewerBundle","readonly",(T=>_.Ii.getBundleMetadata(T,v.id))).then((T=>!!T&&T.createTime.compareTo(x)>=0))})(r.localStore,l))return await o.close(),a._completeWith((function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}})(l)),Promise.resolve(new Set);a._updateProgress(QI(l));const c=new iF(l,o.serializer);let u=await o.bu();for(;u;){const m=await c.Ga(u);m&&a._updateProgress(m),u=await o.bu()}const f=await c.ja(r.localStore);return await $i(r,f.Ha,void 0),await(function(y,v){const _=ne(y);return _.persistence.runTransaction("Save bundle","readwrite",(x=>_.Ii.saveBundleMetadata(x,v)))})(r.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Ja)}catch(l){return _i(zs,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(i,e,t).then((s=>{i.sharedClientState.notifyBundleLoaded(s)}))}class Xl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ic(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return DI(this.persistence,new MI,e.initialUser,this.serializer)}Cu(e){return new Ng(Qd.mi,this.serializer)}Du(e){return new HI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xl.provider={build:()=>new Xl};class CF extends Xl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ce(this.persistence.referenceDelegate instanceof ld,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new CI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new Ng((i=>ld.mi(i,t)),this.serializer)}}class o2 extends Xl{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Xg(this.xu.syncEngine),await fa(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return DI(this.persistence,new MI,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new CI(i,e.asyncQueue,t)}Mu(e,t){const i=new F3(t,this.persistence);return new L3(e.asyncQueue,i)}Cu(e){const t=Dg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new Mg(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,GI(),Vu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new HI}}class SF extends o2{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof hf&&(this.sharedClientState.syncEngine={Co:bF.bind(null,t),vo:EF.bind(null,t),Fo:AF.bind(null,t),Ts:TF.bind(null,t),Do:_F.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await xF(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=GI();if(!hf.v(t))throw new $(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Dg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new hf(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Ql{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Gw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=yF.bind(null,this.syncEngine),await qp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new ZL})()}createDatastore(e){const t=Ic(e.databaseInfo.databaseId),i=(function(r){return new LL(r)})(e.databaseInfo);return(function(r,o,a,l){return new UL(r,o,a,l)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,r,o,a){return new zL(i,s,r,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>Gw(this.syncEngine,t,0)),(function(){return Ow.v()?new Ow:new RL})())}createSyncEngine(e,t){return(function(s,r,o,a,l,c,u){const f=new oF(s,r,o,a,l,c);return u&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ne(t);K(kr,"RemoteStore shutting down."),i.Ea.add(5),await ha(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ql.provider={build:()=>new Ql};function Ww(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new jt,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((i=>{i&&i.$a()?this.metadata.resolve(i.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.Qa)}`))}),(i=>this.metadata.reject(i)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),i=Number(t);isNaN(i)&&this.Qu(`length string (${t}) is not valid number`);const s=await this.$u(i);return new nF(JSON.parse(s),e.length+i)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new $(B.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,r){const o=ne(s),a={documents:r.map((f=>Yl(o.serializer,f)))},l=await o.Ho("BatchGetDocuments",o.serializer.databaseId,Ne.emptyPath(),a,r.length),c=new Map;l.forEach((f=>{const m=j5(o.serializer,f);c.set(m.key.toString(),m)}));const u=[];return r.forEach((f=>{const m=c.get(f.toString());ce(!!m,55234,{key:f}),u.push(m)})),u})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new da(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const s=Q.fromPath(i);this.mutations.push(new xg(s,this.precondition(s)))})),await(async function(i,s){const r=ne(i),o={writes:s.map((a=>Jl(r.serializer,a)))};await r.Go("Commit",r.serializer.databaseId,Ne.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw se(50498,{Gu:e.constructor.name});t=he.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new $(B.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(he.min())?st.exists(!1):st.updateTime(t):st.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(he.min()))throw new $(B.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return st.updateTime(t)}return st.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e,t,i,s,r){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=s,this.deferred=r,this.zu=i.maxAttempts,this.M_=new Og(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new kF(this.datastore),t=this.Hu(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((s=>{this.Yu(s)}))))})).catch((i=>{this.Yu(i)}))}))}Hu(e){try{const t=this.updateFunction(e);return!vc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!nI(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="FirestoreClient";class NF{constructor(e,t,i,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=Ft.UNAUTHENTICATED,this.clientId=lg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,(async o=>{K(ks,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(K(ks,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ma(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function pf(n,e){n.asyncQueue.verifyOperationInProgress(),K(ks,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await LI(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Kw(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Qg(n);K(ks,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Bw(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>Bw(e.remoteStore,s))),n._onlineComponents=e}async function Qg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){K(ks,"Using user provided OfflineComponentProvider");try{await pf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;_i("Error using user provided cache. Falling back to memory cache: "+t),await pf(n,new Xl)}}else K(ks,"Using default OfflineComponentProvider"),await pf(n,new CF(void 0));return n._offlineComponents}async function nh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(K(ks,"Using user provided OnlineComponentProvider"),await Kw(n,n._uninitializedComponentsProvider._online)):(K(ks,"Using default OnlineComponentProvider"),await Kw(n,new Ql))),n._onlineComponents}function a2(n){return Qg(n).then((e=>e.persistence))}function Zg(n){return Qg(n).then((e=>e.localStore))}function l2(n){return nh(n).then((e=>e.remoteStore))}function ey(n){return nh(n).then((e=>e.syncEngine))}function MF(n){return nh(n).then((e=>e.datastore))}async function Xo(n){const e=await nh(n),t=e.eventManager;return t.onListen=aF.bind(null,e.syncEngine),t.onUnlisten=cF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=lF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=uF.bind(null,e.syncEngine),t}function DF(n){return n.asyncQueue.enqueue((async()=>{const e=await a2(n),t=await l2(n);return e.setNetworkEnabled(!0),(function(s){const r=ne(s);return r.Ea.delete(0),Cc(r)})(t)}))}function LF(n){return n.asyncQueue.enqueue((async()=>{const e=await a2(n),t=await l2(n);return e.setNetworkEnabled(!1),(async function(s){const r=ne(s);r.Ea.add(0),await ha(r),r.Ra.set("Offline")})(t)}))}function FF(n,e){const t=new jt;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,r,o){try{const a=await(function(c,u){const f=ne(c);return f.persistence.runTransaction("read document","readonly",(m=>f.localDocuments.getDocument(m,u)))})(s,r);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new $(B.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=ma(a,`Failed to get document '${r} from cache`);o.reject(l)}})(await Zg(n),e,t))),t.promise}function c2(n,e,t={}){const i=new jt;return n.asyncQueue.enqueueAndForget((async()=>(function(r,o,a,l,c){const u=new th({next:m=>{u.Nu(),o.enqueueAndForget((()=>Hg(r,f)));const y=m.docs.has(a);!y&&m.fromCache?c.reject(new $(B.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new $(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new $g(ca(a.path),u,{includeMetadataChanges:!0,qa:!0});return qg(r,f)})(await Xo(n),n.asyncQueue,e,t,i))),i.promise}function VF(n,e){const t=new jt;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,r,o){try{const a=await cd(s,r,!0),l=new t2(r,a.Qs),c=l.ru(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){const l=ma(a,`Failed to execute query '${r} against cache`);o.reject(l)}})(await Zg(n),e,t))),t.promise}function u2(n,e,t={}){const i=new jt;return n.asyncQueue.enqueueAndForget((async()=>(function(r,o,a,l,c){const u=new th({next:m=>{u.Nu(),o.enqueueAndForget((()=>Hg(r,f))),m.fromCache&&l.source==="server"?c.reject(new $(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new $g(a,u,{includeMetadataChanges:!0,qa:!0});return qg(r,f)})(await Xo(n),n.asyncQueue,e,t,i))),i.promise}function OF(n,e){const t=new th(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,r){ne(s).Ca.add(r),r.next()})(await Xo(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(s,r){ne(s).Ca.delete(r)})(await Xo(n),t)))}}function UF(n,e,t,i){const s=(function(o,a){let l;return l=typeof o=="string"?sI().encode(o):o,(function(u,f){return new PF(u,f)})((function(u,f){if(u instanceof Uint8Array)return Ww(u,f);if(u instanceof ArrayBuffer)return Ww(new Uint8Array(u),f);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(l),a)})(t,Ic(e));n.asyncQueue.enqueueAndForget((async()=>{IF(await ey(n),s,i)}))}function BF(n,e){return n.asyncQueue.enqueue((async()=>(function(i,s){const r=ne(i);return r.persistence.runTransaction("Get named query","readonly",(o=>r.Ii.getNamedQuery(o,s)))})(await Zg(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2="firestore.googleapis.com",Jw=!0;class Xw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=h2,this.ssl=Jw}else this.host=e.host,this.ssl=e.ssl??Jw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=TI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aL)throw new $(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=d2(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new $(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new $(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new $(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sc{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new T3;switch(i.type){case"firstParty":return new C3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new $(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Yw.get(t);i&&(K("ComponentProvider","Removing Datastore"),Yw.delete(t),i.terminate())})(this),Promise.resolve()}}function zF(n,e,t,i={}){n=Ue(n,Sc);const s=Ls(e),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;s&&(Mm(`https://${a}`),Dm("Firestore",!0)),r.host!==h2&&r.host!==a&&_i("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...r,host:a,ssl:s,emulatorOptions:i};if(!bs(l,o)&&(n._setSettings(l),i.mockUserToken)){let c,u;if(typeof i.mockUserToken=="string")c=i.mockUserToken,u=Ft.MOCK_USER;else{c=NT(i.mockUserToken,n._app?.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new $(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ft(f)}n._authCredentials=new E3(new iA(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fn=class f2{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new f2(this.firestore,e,this._query)}},Ke=class ll{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ws(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ll(this.firestore,e,this._key)}toJSON(){return{type:ll._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(yc(t,ll._jsonSchema))return new ll(e,i||null,new Q(Ne.fromString(t.referencePath)))}};Ke._jsonSchemaVersion="firestore/documentReference/1.0",Ke._jsonSchema={type:Ct("string",Ke._jsonSchemaVersion),referencePath:Ct("string")};let ws=class p2 extends fn{constructor(e,t,i){super(e,t,ca(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ke(this.firestore,null,new Q(e))}withConverter(e){return new p2(this.firestore,e,this._path)}};function m2(n,e,...t){if(n=de(n),cg("collection","path",e),n instanceof Sc){const i=Ne.fromString(e,...t);return U0(i),new ws(n,null,i)}{if(!(n instanceof Ke||n instanceof ws))throw new $(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ne.fromString(e,...t));return U0(i),new ws(n.firestore,null,i)}}function jF(n,e){if(n=Ue(n,Sc),cg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new $(B.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new fn(n,null,(function(i){return new qi(Ne.emptyPath(),i)})(e))}function fd(n,e,...t){if(n=de(n),arguments.length===1&&(e=lg.newId()),cg("doc","path",e),n instanceof Sc){const i=Ne.fromString(e,...t);return O0(i),new Ke(n,null,new Q(i))}{if(!(n instanceof Ke||n instanceof ws))throw new $(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ne.fromString(e,...t));return O0(i),new Ke(n.firestore,n instanceof ws?n.converter:null,new Q(i))}}function g2(n,e){return n=de(n),e=de(e),(n instanceof Ke||n instanceof ws)&&(e instanceof Ke||e instanceof ws)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function y2(n,e){return n=de(n),e=de(e),n instanceof fn&&e instanceof fn&&n.firestore===e.firestore&&bc(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="AsyncQueue";class Zw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Og(this,"async_queue_retry"),this._c=()=>{const i=Vu();i&&K(Qw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Vu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Vu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new jt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Os(e))throw e;K(Qw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,vt("INTERNAL UNHANDLED ERROR: ",e_(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=jg.createAndSchedule(this,e,t,i,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&se(47125,{Pc:e_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function e_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const r of i)if(r in s&&typeof s[r]=="function")return!0;return!1})(n,["next","error","complete"])}class qF{constructor(){this._progressObserver={},this._taskCompletionResolver=new jt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=-1;let bt=class extends Sc{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new Zw,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zw(e),this._firestoreClient=void 0,await e}}};function nn(n){if(n._terminated)throw new $(B.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||v2(n),n._firestoreClient}function v2(n){const e=n._freezeSettings(),t=(function(s,r,o,a){return new d5(s,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,d2(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new NF(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}})(n._componentsProvider))}function GF(n,e){_i("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return w2(n,Ql.provider,{build:i=>new o2(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function $F(n){_i("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();w2(n,Ql.provider,{build:t=>new SF(t,e.cacheSizeBytes)})}function w2(n,e,t){if((n=Ue(n,bt))._firestoreClient||n._terminated)throw new $(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new $(B.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},v2(n)}function WF(n){if(n._initialized&&!n._terminated)throw new $(B.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new jt;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(i){if(!mi.v())return Promise.resolve();const s=i+NI;await mi.delete(s)})(Dg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function KF(n){return(function(t){const i=new jt;return t.asyncQueue.enqueueAndForget((async()=>mF(await ey(t),i))),i.promise})(nn(n=Ue(n,bt)))}function YF(n){return DF(nn(n=Ue(n,bt)))}function JF(n){return LF(nn(n=Ue(n,bt)))}function XF(n,e){const t=nn(n=Ue(n,bt)),i=new qF;return UF(t,n._databaseId,e,i),i}function QF(n,e){return BF(nn(n=Ue(n,bt)),e).then((t=>t?new fn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(ht.fromBase64String(e))}catch(t){throw new $(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jt(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yc(e,Jt._jsonSchema))return Jt.fromBase64String(e.bytes)}}Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:Ct("string",Jt._jsonSchemaVersion),bytes:Ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Or=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Kn._jsonSchemaVersion}}static fromJSON(e){if(yc(e,Kn._jsonSchema))return new Kn(e.latitude,e.longitude)}}Kn._jsonSchemaVersion="firestore/geoPoint/1.0",Kn._jsonSchema={type:Ct("string",Kn._jsonSchemaVersion),latitude:Ct("number"),longitude:Ct("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0})(this._values,e._values)}toJSON(){return{type:yi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yc(e,yi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new yi(e.vectorValues);throw new $(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yi._jsonSchemaVersion="firestore/vectorValue/1.0",yi._jsonSchema={type:Ct("string",yi._jsonSchemaVersion),vectorValues:Ct("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=/^__.*__$/;class e6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms):new ua(e,this.data,t,this.fieldTransforms)}}class _2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function b2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{Ac:n})}}class ih{constructor(e,t,i,s,r,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ih({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return pd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(b2(this.Ac)&&ZF.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class t6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Ic(e)}Cc(e,t,i,s=!1){return new ih({Ac:e,methodName:t,Dc:i,path:it.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ur(n){const e=n._freezeSettings(),t=Ic(n._databaseId);return new t6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sh(n,e,t,i,s,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,e,t,s);ay("Data must be an object, but it was:",o,i);const a=E2(i,o);let l,c;if(r.merge)l=new _n(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const u=[];for(const f of r.mergeFields){const m=Wp(e,f,t);if(!o.contains(m))throw new $(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);I2(u,m)||u.push(m)}l=new _n(u),c=o.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,c=o.fieldTransforms;return new e6(new zt(a),l,c)}class Pc extends Or{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pc}}function x2(n,e,t){return new ih({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ty extends Or{_toFieldTransform(e){return new Tc(e.path,new qo)}isEqual(e){return e instanceof ty}}class ny extends Or{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=x2(this,e,!0),i=this.vc.map((r=>Br(r,t))),s=new Ar(i);return new Tc(e.path,s)}isEqual(e){return e instanceof ny&&bs(this.vc,e.vc)}}class iy extends Or{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=x2(this,e,!0),i=this.vc.map((r=>Br(r,t))),s=new Ir(i);return new Tc(e.path,s)}isEqual(e){return e instanceof iy&&bs(this.vc,e.vc)}}class sy extends Or{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Ho(e.serializer,YA(e.serializer,this.Fc));return new Tc(e.path,t)}isEqual(e){return e instanceof sy&&this.Fc===e.Fc}}function ry(n,e,t,i){const s=n.Cc(1,e,t);ay("Data must be an object, but it was:",s,i);const r=[],o=zt.empty();Us(i,((l,c)=>{const u=ly(e,l,t);c=de(c);const f=s.yc(u);if(c instanceof Pc)r.push(u);else{const m=Br(c,f);m!=null&&(r.push(u),o.set(u,m))}}));const a=new _n(r);return new _2(o,a,s.fieldTransforms)}function oy(n,e,t,i,s,r){const o=n.Cc(1,e,t),a=[Wp(e,i,t)],l=[s];if(r.length%2!=0)throw new $(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<r.length;m+=2)a.push(Wp(e,r[m])),l.push(r[m+1]);const c=[],u=zt.empty();for(let m=a.length-1;m>=0;--m)if(!I2(c,a[m])){const y=a[m];let v=l[m];v=de(v);const _=o.yc(y);if(v instanceof Pc)c.push(y);else{const x=Br(v,_);x!=null&&(c.push(y),u.set(y,x))}}const f=new _n(c);return new _2(u,f,o.fieldTransforms)}function T2(n,e,t,i=!1){return Br(t,n.Cc(i?4:3,e))}function Br(n,e){if(A2(n=de(n)))return ay("Unsupported field value:",e,n),E2(n,e);if(n instanceof Or)return(function(i,s){if(!b2(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,s){const r=[];let o=0;for(const a of i){let l=Br(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}})(n,e)}return(function(i,s){if((i=de(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return YA(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=je.fromDate(i);return{timestampValue:Go(s.serializer,r)}}if(i instanceof je){const r=new je(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Go(s.serializer,r)}}if(i instanceof Kn)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Jt)return{bytesValue:aI(s.serializer,i._byteString)};if(i instanceof Ke){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Cg(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof yi)return(function(o,a){return{mapValue:{fields:{[gg]:{stringValue:yg},[Bo]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return bg(a.serializer,c)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${Bd(i)}`)})(n,e)}function E2(n,e){const t={};return EA(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Us(n,((i,s)=>{const r=Br(s,e.mc(i));r!=null&&(t[i]=r)})),{mapValue:{fields:t}}}function A2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof je||n instanceof Kn||n instanceof Jt||n instanceof Ke||n instanceof Or||n instanceof yi)}function ay(n,e,t){if(!A2(t)||!oA(t)){const i=Bd(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function Wp(n,e,t){if((e=de(e))instanceof Rs)return e._internalPath;if(typeof e=="string")return ly(n,e);throw pd("Field path arguments must be of type string or ",n,!1,void 0,t)}const n6=new RegExp("[~\\*/\\[\\]]");function ly(n,e,t){if(e.search(n6)>=0)throw pd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Rs(...e.split("."))._internalPath}catch{throw pd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function pd(n,e,t,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new $(B.INVALID_ARGUMENT,a+n+l)}function I2(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t,i,s,r){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new i6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class i6 extends Zl{data(){return super.data()}}function rh(n,e){return typeof e=="string"?ly(n,e):e instanceof Rs?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new $(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cy{}class kc extends cy{}function rs(n,e,...t){let i=[];e instanceof cy&&i.push(e),i=i.concat(t),(function(r){const o=r.filter((l=>l instanceof uy)).length,a=r.filter((l=>l instanceof oh)).length;if(o>1||o>0&&a>0)throw new $(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class oh extends kc{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new oh(e,t,i)}_apply(e){const t=this._parse(e);return P2(e._query,t),new fn(e.firestore,e.converter,Mp(e._query,t))}_parse(e){const t=Ur(e.firestore);return(function(r,o,a,l,c,u,f){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new $(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){n_(f,u);const v=[];for(const _ of f)v.push(t_(l,r,_));m={arrayValue:{values:v}}}else m=t_(l,r,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||n_(f,u),m=T2(a,o,f,u==="in"||u==="not-in");return Le.create(c,u,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function s6(n,e,t){const i=e,s=rh("where",n);return oh._create(s,i,t)}class uy extends cy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:qe.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,r){let o=s;const a=r.getFlattenedFilters();for(const l of a)P2(o,l),o=Mp(o,l)})(e._query,t),new fn(e.firestore,e.converter,Mp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class dy extends kc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dy(e,t)}_apply(e){const t=(function(s,r,o){if(s.startAt!==null)throw new $(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new $(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Kl(r,o)})(e._query,this._field,this._direction);return new fn(e.firestore,e.converter,(function(s,r){const o=s.explicitOrderBy.concat([r]);return new qi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function r6(n,e="asc"){const t=e,i=rh("orderBy",n);return dy._create(i,t)}class ah extends kc{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new ah(e,t,i)}_apply(e){return new fn(e.firestore,e.converter,sd(e._query,this._limit,this._limitType))}}function o6(n){return aA("limit",n),ah._create("limit",n,"F")}function a6(n){return aA("limitToLast",n),ah._create("limitToLast",n,"L")}class lh extends kc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new lh(e,t,i)}_apply(e){const t=S2(e,this.type,this._docOrFields,this._inclusive);return new fn(e.firestore,e.converter,(function(s,r){return new qi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)})(e._query,t))}}function l6(...n){return lh._create("startAt",n,!0)}function c6(...n){return lh._create("startAfter",n,!1)}class ch extends kc{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new ch(e,t,i)}_apply(e){const t=S2(e,this.type,this._docOrFields,this._inclusive);return new fn(e.firestore,e.converter,(function(s,r){return new qi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)})(e._query,t))}}function u6(...n){return ch._create("endBefore",n,!1)}function d6(...n){return ch._create("endAt",n,!0)}function S2(n,e,t,i){if(t[0]=de(t[0]),t[0]instanceof Zl)return(function(r,o,a,l,c){if(!l)throw new $(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const f of To(r))if(f.field.isKeyField())u.push(Tr(o,l.key));else{const m=l.data.field(f.field);if(Gd(m))throw new $(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const y=f.field.canonicalString();throw new $(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}u.push(m)}return new Ss(u,c)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=Ur(n.firestore);return(function(o,a,l,c,u,f){const m=o.explicitOrderBy;if(u.length>m.length)throw new $(B.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let v=0;v<u.length;v++){const _=u[v];if(m[v].field.isKeyField()){if(typeof _!="string")throw new $(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof _}`);if(!wg(o)&&_.indexOf("/")!==-1)throw new $(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${_}' contains a slash.`);const x=o.path.child(Ne.fromString(_));if(!Q.isDocumentKey(x))throw new $(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const T=new Q(x);y.push(Tr(a,T))}else{const x=T2(l,c,_);y.push(x)}}return new Ss(y,f)})(n._query,n.firestore._databaseId,s,e,t,i)}}function t_(n,e,t){if(typeof(t=de(t))=="string"){if(t==="")throw new $(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wg(e)&&t.indexOf("/")!==-1)throw new $(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ne.fromString(t));if(!Q.isDocumentKey(i))throw new $(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Tr(n,new Q(i))}if(t instanceof Ke)return Tr(n,t._key);throw new $(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bd(t)}.`)}function n_(n,e){if(!Array.isArray(n)||n.length===0)throw new $(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function P2(n,e){const t=(function(s,r){for(const o of s)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new $(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class hy{convertValue(e,t="none"){switch(Is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Us(e,((s,r)=>{i[s]=this.convertValue(r,t)})),i}convertVectorValue(e){const t=e.fields?.[Bo].arrayValue?.values?.map((i=>nt(i.doubleValue)));return new yi(t)}convertGeoPoint(e){return new Kn(nt(e.latitude),nt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=$d(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Gl(e));default:return null}}convertTimestamp(e){const t=Oi(e);return new je(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ne.fromString(e);ce(vI(i),9688,{name:e});const s=new As(i.get(1),i.get(3)),r=new Q(i.popFirst(5));return s.isEqual(t)||vt(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uh(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class h6 extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,t)}}class fr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Vn=class k2 extends Zl{constructor(e,t,i,s,r,o){super(e,t,i,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Al(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(rh("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=k2._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Vn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vn._jsonSchema={type:Ct("string",Vn._jsonSchemaVersion),bundleSource:Ct("string","DocumentSnapshot"),bundleName:Ct("string"),bundle:Ct("string")};let Al=class extends Vn{data(e={}){return super.data(e)}},Yn=class R2{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new fr(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Al(this._firestore,this._userDataWriter,i.key,i,new fr(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((a=>{const l=new Al(s._firestore,s._userDataWriter,a.doc.key,a.doc,new fr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>r||a.type!==3)).map((a=>{const l=new Al(s._firestore,s._userDataWriter,a.doc.key,a.doc,new fr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:f6(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=R2._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=lg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(t.push(r._document),i.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function f6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:n})}}function N2(n,e){return n instanceof Vn&&e instanceof Vn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Yn&&e instanceof Yn&&n._firestore===e._firestore&&y2(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(n){n=Ue(n,Ke);const e=Ue(n.firestore,bt);return c2(nn(e),n._key).then((t=>fy(e,n,t)))}Yn._jsonSchemaVersion="firestore/querySnapshot/1.0",Yn._jsonSchema={type:Ct("string",Yn._jsonSchemaVersion),bundleSource:Ct("string","QuerySnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class zr extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,t)}}function m6(n){n=Ue(n,Ke);const e=Ue(n.firestore,bt),t=nn(e),i=new zr(e);return FF(t,n._key).then((s=>new Vn(e,i,n._key,s,new fr(s!==null&&s.hasLocalMutations,!0),n.converter)))}function g6(n){n=Ue(n,Ke);const e=Ue(n.firestore,bt);return c2(nn(e),n._key,{source:"server"}).then((t=>fy(e,n,t)))}function y6(n){n=Ue(n,fn);const e=Ue(n.firestore,bt),t=nn(e),i=new zr(e);return C2(n._query),u2(t,n._query).then((s=>new Yn(e,i,n,s)))}function v6(n){n=Ue(n,fn);const e=Ue(n.firestore,bt),t=nn(e),i=new zr(e);return VF(t,n._query).then((s=>new Yn(e,i,n,s)))}function w6(n){n=Ue(n,fn);const e=Ue(n.firestore,bt),t=nn(e),i=new zr(e);return u2(t,n._query,{source:"server"}).then((s=>new Yn(e,i,n,s)))}function i_(n,e,t){n=Ue(n,Ke);const i=Ue(n.firestore,bt),s=uh(n.converter,e,t);return Rc(i,[sh(Ur(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,st.none())])}function s_(n,e,t,...i){n=Ue(n,Ke);const s=Ue(n.firestore,bt),r=Ur(s);let o;return o=typeof(e=de(e))=="string"||e instanceof Rs?oy(r,"updateDoc",n._key,e,t,i):ry(r,"updateDoc",n._key,e),Rc(s,[o.toMutation(n._key,st.exists(!0))])}function _6(n){return Rc(Ue(n.firestore,bt),[new da(n._key,st.none())])}function b6(n,e){const t=Ue(n.firestore,bt),i=fd(n),s=uh(n.converter,e);return Rc(t,[sh(Ur(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,st.exists(!1))]).then((()=>i))}function M2(n,...e){n=de(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||$p(e[i])||(t=e[i++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if($p(e[i])){const l=e[i];e[i]=l.next?.bind(l),e[i+1]=l.error?.bind(l),e[i+2]=l.complete?.bind(l)}let r,o,a;if(n instanceof Ke)o=Ue(n.firestore,bt),a=ca(n._key.path),r={next:l=>{e[i]&&e[i](fy(o,n,l))},error:e[i+1],complete:e[i+2]};else{const l=Ue(n,fn);o=Ue(l.firestore,bt),a=l._query;const c=new zr(o);r={next:u=>{e[i]&&e[i](new Yn(o,c,l,u))},error:e[i+1],complete:e[i+2]},C2(n._query)}return(function(c,u,f,m){const y=new th(m),v=new $g(u,y,f);return c.asyncQueue.enqueueAndForget((async()=>qg(await Xo(c),v))),()=>{y.Nu(),c.asyncQueue.enqueueAndForget((async()=>Hg(await Xo(c),v)))}})(nn(o),a,s,r)}function x6(n,e){return OF(nn(n=Ue(n,bt)),$p(e)?e:{next:e})}function Rc(n,e){return(function(i,s){const r=new jt;return i.asyncQueue.enqueueAndForget((async()=>dF(await ey(i),s,r))),r.promise})(nn(n),e)}function fy(n,e,t){const i=t.docs.get(e._key),s=new zr(n);return new Vn(n,s,e._key,i,new fr(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E6=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ur(e)}set(e,t,i){this._verifyNotCommitted();const s=hs(e,this._firestore),r=uh(s.converter,t,i),o=sh(this._dataReader,"WriteBatch.set",s._key,r,s.converter!==null,i);return this._mutations.push(o.toMutation(s._key,st.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const r=hs(e,this._firestore);let o;return o=typeof(t=de(t))=="string"||t instanceof Rs?oy(this._dataReader,"WriteBatch.update",r._key,t,i,s):ry(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(o.toMutation(r._key,st.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hs(e,this._firestore);return this._mutations=this._mutations.concat(new da(t._key,st.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function hs(n,e){if((n=de(n)).firestore!==e)throw new $(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ur(e)}get(e){const t=hs(e,this._firestore),i=new h6(this._firestore);return this._transaction.lookup([t._key]).then((s=>{if(!s||s.length!==1)return se(24041);const r=s[0];if(r.isFoundDocument())return new Zl(this._firestore,i,r.key,r,t.converter);if(r.isNoDocument())return new Zl(this._firestore,i,t._key,null,t.converter);throw se(18433,{doc:r})}))}set(e,t,i){const s=hs(e,this._firestore),r=uh(s.converter,t,i),o=sh(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(e,t,i,...s){const r=hs(e,this._firestore);let o;return o=typeof(t=de(t))=="string"||t instanceof Rs?oy(this._dataReader,"Transaction.update",r._key,t,i,s):ry(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,o),this}delete(e){const t=hs(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I6=class extends A6{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hs(e,this._firestore),i=new zr(this._firestore);return super.get(e).then((s=>new Vn(this._firestore,i,t._key,s._document,new fr(!1,!1),t.converter)))}};function C6(n,e,t){n=Ue(n,bt);const i={...T6,...t};return(function(r){if(r.maxAttempts<1)throw new $(B.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(r,o,a){const l=new jt;return r.asyncQueue.enqueueAndForget((async()=>{const c=await MF(r);new RF(r.asyncQueue,c,a,o,l).ju()})),l.promise})(nn(n),(s=>e(new I6(n,s))),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S6(){return new Pc("deleteField")}function P6(){return new ty("serverTimestamp")}function k6(...n){return new ny("arrayUnion",n)}function R6(...n){return new iy("arrayRemove",n)}function N6(n){return new sy("increment",n)}(function(e,t=!0){(function(s){la=s})(Bi),Fi(new Un("firestore",((i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new bt(new A3(i.getProvider("auth-internal")),new S3(o,i.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new $(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new As(c.options.projectId,u)})(o,s),o);return r={useFetchStreams:t,...r},a._setSettings(r),a}),"PUBLIC").setMultipleInstances(!0)),kn(D0,L0,e),kn(D0,L0,"esm2020")})();const M6="@firebase/firestore-compat",D6="0.4.1";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new $("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(){if(typeof Uint8Array>"u")throw new $("unimplemented","Uint8Arrays are not available in this environment.")}function o_(){if(!c5())throw new $("unimplemented","Blobs are unavailable in Firestore in this environment.")}let D2=class Kp{constructor(e){this._delegate=e}static fromBase64String(e){return o_(),new Kp(Jt.fromBase64String(e))}static fromUint8Array(e){return r_(),new Kp(Jt.fromUint8Array(e))}toBase64(){return o_(),this._delegate.toBase64()}toUint8Array(){return r_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(n){return L6(n,["next","error","complete"])}function L6(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{enableIndexedDbPersistence(e,t){return GF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return $F(e._delegate)}clearIndexedDbPersistence(e){return WF(e._delegate)}}class L2{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof As||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&_i("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){zF(this._delegate,e,t,i)}enableNetwork(){return YF(this._delegate)}disableNetwork(){return JF(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,rA("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return KF(this._delegate)}onSnapshotsInSync(e){return x6(this._delegate,e)}get app(){if(!this._appCompat)throw new $("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qo(this,m2(this._delegate,e))}catch(t){throw cn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ln(this,fd(this._delegate,e))}catch(t){throw cn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ln(this,jF(this._delegate,e))}catch(t){throw cn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return C6(this._delegate,t=>e(new F2(this,t)))}batch(){return nn(this._delegate),new V2(new E6(this._delegate,e=>Rc(this._delegate,e)))}loadBundle(e){return XF(this._delegate,e)}namedQuery(e){return QF(this._delegate,e).then(t=>t?new ln(this,t):null)}}class dh extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new D2(new Jt(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ln.forKey(t,this.firestore,null)}}function V6(n){b3(n)}class F2{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new dh(e)}get(e){const t=pr(e);return this._delegate.get(t).then(i=>new ec(this._firestore,new Vn(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const s=pr(e);return i?(py("Transaction.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const r=pr(e);return arguments.length===2?this._delegate.update(r,t):this._delegate.update(r,t,i,...s),this}delete(e){const t=pr(e);return this._delegate.delete(t),this}}class V2{constructor(e){this._delegate=e}set(e,t,i){const s=pr(e);return i?(py("WriteBatch.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const r=pr(e);return arguments.length===2?this._delegate.update(r,t):this._delegate.update(r,t,i,...s),this}delete(e){const t=pr(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Rr{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Al(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new tc(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Rr.INSTANCES;let s=i.get(e);s||(s=new WeakMap,i.set(e,s));let r=s.get(t);return r||(r=new Rr(e,new dh(e),t),s.set(t,r)),r}}Rr.INSTANCES=new WeakMap;class Ln{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dh(e)}static forPath(e,t,i){if(e.length%2!==0)throw new $("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ln(t,new Ke(t._delegate,i,new Q(e)))}static forKey(e,t,i){return new Ln(t,new Ke(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Qo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qo(this.firestore,m2(this._delegate,e))}catch(t){throw cn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=de(e),e instanceof Ke?g2(this._delegate,e):!1}set(e,t){t=py("DocumentReference.set",t);try{return t?i_(this._delegate,e,t):i_(this._delegate,e)}catch(i){throw cn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?s_(this._delegate,e):s_(this._delegate,e,t,...i)}catch(s){throw cn(s,"updateDoc()","DocumentReference.update()")}}delete(){return _6(this._delegate)}onSnapshot(...e){const t=O2(e),i=U2(e,s=>new ec(this.firestore,new Vn(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return M2(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=m6(this._delegate):e?.source==="server"?t=g6(this._delegate):t=p6(this._delegate),t.then(i=>new ec(this.firestore,new Vn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new Ln(this.firestore,e?this._delegate.withConverter(Rr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function cn(n,e,t){return n.message=n.message.replace(e,t),n}function O2(n){for(const e of n)if(typeof e=="object"&&!Yp(e))return e;return{}}function U2(n,e){let t;return Yp(n[0])?t=n[0]:Yp(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:i=>{t.next&&t.next(e(i))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class ec{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ln(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return N2(this._delegate,e._delegate)}}class tc extends ec{data(e){const t=this._delegate.data(e);return this._delegate._converter||x3(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class ln{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dh(e)}where(e,t,i){try{return new ln(this.firestore,rs(this._delegate,s6(e,t,i)))}catch(s){throw cn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new ln(this.firestore,rs(this._delegate,r6(e,t)))}catch(i){throw cn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ln(this.firestore,rs(this._delegate,o6(e)))}catch(t){throw cn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new ln(this.firestore,rs(this._delegate,a6(e)))}catch(t){throw cn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ln(this.firestore,rs(this._delegate,l6(...e)))}catch(t){throw cn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ln(this.firestore,rs(this._delegate,c6(...e)))}catch(t){throw cn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ln(this.firestore,rs(this._delegate,u6(...e)))}catch(t){throw cn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ln(this.firestore,rs(this._delegate,d6(...e)))}catch(t){throw cn(t,"endAt()","Query.endAt()")}}isEqual(e){return y2(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=v6(this._delegate):e?.source==="server"?t=w6(this._delegate):t=y6(this._delegate),t.then(i=>new Jp(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=O2(e),i=U2(e,s=>new Jp(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return M2(this._delegate,t,i)}withConverter(e){return new ln(this.firestore,e?this._delegate.withConverter(Rr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class O6{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new tc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Jp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ln(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new tc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new O6(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new tc(this._firestore,i))})}isEqual(e){return N2(this._delegate,e._delegate)}}class Qo extends ln{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ln(this.firestore,e):null}doc(e){try{return e===void 0?new Ln(this.firestore,fd(this._delegate)):new Ln(this.firestore,fd(this._delegate,e))}catch(t){throw cn(t,"doc()","CollectionReference.doc()")}}add(e){return b6(this._delegate,e).then(t=>new Ln(this.firestore,t))}isEqual(e){return g2(this._delegate,e._delegate)}withConverter(e){return new Qo(this.firestore,e?this._delegate.withConverter(Rr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function pr(n){return Ue(n,Ke)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(...e){this._delegate=new Rs(...e)}static documentId(){return new my(it.keyField().canonicalString())}isEqual(e){return e=de(e),e instanceof Rs?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{static serverTimestamp(){const e=P6();return e._methodName="FieldValue.serverTimestamp",new lr(e)}static delete(){const e=S6();return e._methodName="FieldValue.delete",new lr(e)}static arrayUnion(...e){const t=k6(...e);return t._methodName="FieldValue.arrayUnion",new lr(t)}static arrayRemove(...e){const t=R6(...e);return t._methodName="FieldValue.arrayRemove",new lr(t)}static increment(e){const t=N6(e);return t._methodName="FieldValue.increment",new lr(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6={Firestore:L2,GeoPoint:Kn,Timestamp:je,Blob:D2,Transaction:F2,WriteBatch:V2,DocumentReference:Ln,DocumentSnapshot:ec,Query:ln,QueryDocumentSnapshot:tc,QuerySnapshot:Jp,CollectionReference:Qo,FieldPath:my,FieldValue:lr,setLogLevel:V6,CACHE_SIZE_UNLIMITED:HF};function B6(n,e){n.INTERNAL.registerComponent(new Un("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(i,s)},"PUBLIC").setServiceProps({...U6}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z6(n){B6(n,(e,t)=>new L2(e,t,new F6)),n.registerVersion(M6,D6)}z6(Vt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="firebasestorage.googleapis.com",z2="storageBucket",j6=120*1e3,q6=600*1e3,H6=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt extends en{constructor(e,t,i=0){super(mf(e),`Firebase Storage: ${t} (${mf(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,lt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var et;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(et||(et={}));function mf(n){return"storage/"+n}function gy(){const n="An unknown error occurred, please check the error payload for server response.";return new lt(et.UNKNOWN,n)}function G6(n){return new lt(et.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function $6(n){return new lt(et.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function W6(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new lt(et.UNAUTHENTICATED,n)}function K6(){return new lt(et.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Y6(n){return new lt(et.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function j2(){return new lt(et.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function q2(){return new lt(et.CANCELED,"User canceled the upload/download.")}function J6(n){return new lt(et.INVALID_URL,"Invalid URL '"+n+"'.")}function X6(n){return new lt(et.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Q6(){return new lt(et.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+z2+"' property when initializing the app?")}function H2(){return new lt(et.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Z6(){return new lt(et.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function eV(){return new lt(et.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function tV(n){return new lt(et.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ao(n){return new lt(et.INVALID_ARGUMENT,n)}function G2(){return new lt(et.APP_DELETED,"The Firebase app was deleted.")}function $2(n){return new lt(et.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Il(n,e){return new lt(et.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Ka(n){throw new lt(et.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Qt.makeFromUrl(e,t)}catch{return new Qt(e,"")}if(i.path==="")return i;throw X6(e)}static makeFromUrl(e,t){let i=null;const s="([A-Za-z0-9.\\-_]+)";function r(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(D){D.path_=decodeURIComponent(D.path)}const u="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${u}/b/${s}/o${m}`,"i"),v={bucket:1,path:3},_=t===B2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",T=new RegExp(`^https?://${_}/${s}/${x}`,"i"),C=[{regex:a,indices:l,postModify:r},{regex:y,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let D=0;D<C.length;D++){const F=C[D],V=F.regex.exec(e);if(V){const I=V[F.indices.bucket];let E=V[F.indices.path];E||(E=""),i=new Qt(I,E),F.postModify(i);break}}if(i==null)throw J6(e);return i}}class nV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(n,e,t){let i=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...x){c||(c=!0,e.apply(null,x))}function f(x){s=setTimeout(()=>{s=null,n(y,l())},x)}function m(){r&&clearTimeout(r)}function y(x,...T){if(c){m();return}if(x){m(),u.call(null,x,...T);return}if(l()||o){m(),u.call(null,x,...T);return}i<64&&(i*=2);let C;a===1?(a=2,C=0):C=(i+Math.random())*1e3,f(C)}let v=!1;function _(x){v||(v=!0,m(),!c&&(s!==null?(x||(a=2),clearTimeout(s),f(0)):x||(a=1)))}return f(0),r=setTimeout(()=>{o=!0,_(!0)},t),_}function sV(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rV(n){return n!==void 0}function oV(n){return typeof n=="function"}function aV(n){return typeof n=="object"&&!Array.isArray(n)}function hh(n){return typeof n=="string"||n instanceof String}function a_(n){return yy()&&n instanceof Blob}function yy(){return typeof Blob<"u"}function Xp(n,e,t,i){if(i<e)throw Ao(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Ao(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function W2(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const s=e(i)+"="+e(n[i]);t=t+s+"&"}return t=t.slice(0,-1),t}var wr;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wr||(wr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,r=e.indexOf(n)!==-1;return t||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t,i,s,r,o,a,l,c,u,f,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,_)=>{this.resolve_=v,this.reject_=_,this.start_()})}start_(){const e=(i,s)=>{if(s){i(!1,new cu(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===wr.NO_ERROR,l=r.getStatus();if(!a||K2(l,this.additionalRetryCodes_)&&this.retry){const u=r.getErrorCode()===wr.ABORT;i(!1,new cu(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new cu(c,r))})},t=(i,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());rV(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=gy();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?G2():q2();o(l)}else{const l=j2();o(l)}};this.canceled_?t(!1,new cu(!1,null,!0)):this.backoffId_=iV(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&sV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cu{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function cV(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function uV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function dV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function hV(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function fV(n,e,t,i,s,r,o=!0,a=!1){const l=W2(n.urlParams),c=n.url+l,u=Object.assign({},n.headers);return dV(u,e),cV(u,t),uV(u,r),hV(u,i),new lV(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function mV(...n){const e=pV();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(yy())return new Blob(n);throw new lt(et.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gV(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(n){if(typeof atob>"u")throw tV("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class gf{constructor(e,t){this.data=e,this.contentType=t||null}}function Y2(n,e){switch(n){case Fn.RAW:return new gf(J2(e));case Fn.BASE64:case Fn.BASE64URL:return new gf(X2(n,e));case Fn.DATA_URL:return new gf(wV(e),_V(e))}throw gy()}function J2(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const r=i,o=n.charCodeAt(++t);i=65536|(r&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function vV(n){let e;try{e=decodeURIComponent(n)}catch{throw Il(Fn.DATA_URL,"Malformed data URL.")}return J2(e)}function X2(n,e){switch(n){case Fn.BASE64:{const s=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(s||r)throw Il(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Fn.BASE64URL:{const s=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(s||r)throw Il(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=yV(e)}catch(s){throw s.message.includes("polyfill")?s:Il(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}class Q2{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Il(Fn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=bV(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function wV(n){const e=new Q2(n);return e.base64?X2(Fn.BASE64,e.rest):vV(e.rest)}function _V(n){return new Q2(n).contentType}function bV(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,t){let i=0,s="";a_(e)?(this.data_=e,i=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(a_(this.data_)){const i=this.data_,s=gV(i,e,t);return s===null?null:new ki(s)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new ki(i,!0)}}static getBlob(...e){if(yy()){const t=e.map(i=>i instanceof ki?i.data_:i);return new ki(mV.apply(null,t))}else{const t=e.map(o=>hh(o)?Y2(Fn.RAW,o).data:o.data_);let i=0;t.forEach(o=>{i+=o.byteLength});const s=new Uint8Array(i);let r=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)s[r++]=o[a]}),new ki(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(n){let e;try{e=JSON.parse(n)}catch{return null}return aV(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function TV(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Z2(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(n,e){return e}class rn{constructor(e,t,i,s){this.server=e,this.local=t||e,this.writable=!!i,this.xform=s||EV}}let uu=null;function AV(n){return!hh(n)||n.length<2?n:Z2(n)}function fh(){if(uu)return uu;const n=[];n.push(new rn("bucket")),n.push(new rn("generation")),n.push(new rn("metageneration")),n.push(new rn("name","fullPath",!0));function e(r,o){return AV(o)}const t=new rn("name");t.xform=e,n.push(t);function i(r,o){return o!==void 0?Number(o):o}const s=new rn("size");return s.xform=i,n.push(s),n.push(new rn("timeCreated")),n.push(new rn("updated")),n.push(new rn("md5Hash",null,!0)),n.push(new rn("cacheControl",null,!0)),n.push(new rn("contentDisposition",null,!0)),n.push(new rn("contentEncoding",null,!0)),n.push(new rn("contentLanguage",null,!0)),n.push(new rn("contentType",null,!0)),n.push(new rn("metadata","customMetadata",!0)),uu=n,uu}function IV(n,e){function t(){const i=n.bucket,s=n.fullPath,r=new Qt(i,s);return e._makeStorageReference(r)}Object.defineProperty(n,"ref",{get:t})}function CV(n,e,t){const i={};i.type="file";const s=t.length;for(let r=0;r<s;r++){const o=t[r];i[o.local]=o.xform(i,e[o.server])}return IV(i,n),i}function eC(n,e,t){const i=vy(e);return i===null?null:CV(n,i,t)}function SV(n,e,t,i){const s=vy(e);if(s===null||!hh(s.downloadTokens))return null;const r=s.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(c=>{const u=n.bucket,f=n.fullPath,m="/b/"+o(u)+"/o/"+o(f),y=js(m,t,i),v=W2({alt:"media",token:c});return y+v})[0]}function wy(n,e){const t={},i=e.length;for(let s=0;s<i;s++){const r=e[s];r.writable&&(t[r.server]=n[r.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_="prefixes",c_="items";function PV(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[l_])for(const s of t[l_]){const r=s.replace(/\/$/,""),o=n._makeStorageReference(new Qt(e,r));i.prefixes.push(o)}if(t[c_])for(const s of t[c_]){const r=n._makeStorageReference(new Qt(e,s.name));i.items.push(r)}return i}function kV(n,e,t){const i=vy(t);return i===null?null:PV(n,e,i)}class Wi{constructor(e,t,i,s){this.url=e,this.method=t,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(n){if(!n)throw gy()}function ph(n,e){function t(i,s){const r=eC(n,s,e);return vi(r!==null),r}return t}function RV(n,e){function t(i,s){const r=kV(n,e,s);return vi(r!==null),r}return t}function NV(n,e){function t(i,s){const r=eC(n,s,e);return vi(r!==null),SV(r,s,n.host,n._protocol)}return t}function ga(n){function e(t,i){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=K6():s=W6():t.getStatus()===402?s=$6(n.bucket):t.getStatus()===403?s=Y6(n.path):s=i,s.status=t.getStatus(),s.serverResponse=i.serverResponse,s}return e}function mh(n){const e=ga(n);function t(i,s){let r=e(i,s);return i.getStatus()===404&&(r=G6(n.path)),r.serverResponse=s.serverResponse,r}return t}function tC(n,e,t){const i=e.fullServerUrl(),s=js(i,n.host,n._protocol),r="GET",o=n.maxOperationRetryTime,a=new Wi(s,r,ph(n,t),o);return a.errorHandler=mh(e),a}function MV(n,e,t,i,s){const r={};e.isRoot?r.prefix="":r.prefix=e.path+"/",t.length>0&&(r.delimiter=t),i&&(r.pageToken=i),s&&(r.maxResults=s);const o=e.bucketOnlyServerUrl(),a=js(o,n.host,n._protocol),l="GET",c=n.maxOperationRetryTime,u=new Wi(a,l,RV(n,e.bucket),c);return u.urlParams=r,u.errorHandler=ga(e),u}function DV(n,e,t){const i=e.fullServerUrl(),s=js(i,n.host,n._protocol),r="GET",o=n.maxOperationRetryTime,a=new Wi(s,r,NV(n,t),o);return a.errorHandler=mh(e),a}function LV(n,e,t,i){const s=e.fullServerUrl(),r=js(s,n.host,n._protocol),o="PATCH",a=wy(t,i),l={"Content-Type":"application/json; charset=utf-8"},c=n.maxOperationRetryTime,u=new Wi(r,o,ph(n,i),c);return u.headers=l,u.body=a,u.errorHandler=mh(e),u}function FV(n,e){const t=e.fullServerUrl(),i=js(t,n.host,n._protocol),s="DELETE",r=n.maxOperationRetryTime;function o(l,c){}const a=new Wi(i,s,o,r);return a.successCodes=[200,204],a.errorHandler=mh(e),a}function VV(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function nC(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=VV(null,e)),i}function OV(n,e,t,i,s){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let C="";for(let D=0;D<2;D++)C=C+Math.random().toString().slice(2);return C}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=nC(e,i,s),u=wy(c,t),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+l+"--",y=ki.getBlob(f,i,m);if(y===null)throw H2();const v={name:c.fullPath},_=js(r,n.host,n._protocol),x="POST",T=n.maxUploadRetryTime,S=new Wi(_,x,ph(n,t),T);return S.urlParams=v,S.headers=o,S.body=y.uploadData(),S.errorHandler=ga(e),S}class md{constructor(e,t,i,s){this.current=e,this.total=t,this.finalized=!!i,this.metadata=s||null}}function _y(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{vi(!1)}return vi(!!t&&(e||["active"]).indexOf(t)!==-1),t}function UV(n,e,t,i,s){const r=e.bucketOnlyServerUrl(),o=nC(e,i,s),a={name:o.fullPath},l=js(r,n.host,n._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=wy(o,t),m=n.maxUploadRetryTime;function y(_){_y(_);let x;try{x=_.getResponseHeader("X-Goog-Upload-URL")}catch{vi(!1)}return vi(hh(x)),x}const v=new Wi(l,c,y,m);return v.urlParams=a,v.headers=u,v.body=f,v.errorHandler=ga(e),v}function BV(n,e,t,i){const s={"X-Goog-Upload-Command":"query"};function r(c){const u=_y(c,["active","final"]);let f=null;try{f=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{vi(!1)}f||vi(!1);const m=Number(f);return vi(!isNaN(m)),new md(m,i.size(),u==="final")}const o="POST",a=n.maxUploadRetryTime,l=new Wi(t,o,r,a);return l.headers=s,l.errorHandler=ga(e),l}const u_=256*1024;function zV(n,e,t,i,s,r,o,a){const l=new md(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw Z6();const c=l.total-l.current;let u=c;s>0&&(u=Math.min(u,s));const f=l.current,m=f+u;let y="";u===0?y="finalize":c===u?y="upload, finalize":y="upload";const v={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${l.current}`},_=i.slice(f,m);if(_===null)throw H2();function x(D,F){const V=_y(D,["active","final"]),I=l.current+u,E=i.size();let A;return V==="final"?A=ph(e,r)(D,F):A=null,new md(I,E,V==="final",A)}const T="POST",S=e.maxUploadRetryTime,C=new Wi(t,T,x,S);return C.headers=v,C.body=_.uploadData(),C.progressCallback=a||null,C.errorHandler=ga(n),C}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV={STATE_CHANGED:"state_changed"},un={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function yf(n){switch(n){case"running":case"pausing":case"canceling":return un.RUNNING;case"paused":return un.PAUSED;case"success":return un.SUCCESS;case"canceled":return un.CANCELED;case"error":return un.ERROR;default:return un.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,t,i){if(oV(e)||t!=null||i!=null)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{const r=e;this.next=r.next,this.error=r.error,this.complete=r.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class HV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=wr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=wr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=wr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,s,r){if(this.sent_)throw Ka("cannot .send() more than once");if(Ls(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),r!==void 0)for(const o in r)r.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,r[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ka("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ka("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ka("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ka("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class GV extends HV{initXhr(){this.xhr_.responseType="text"}}function di(){return new GV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=fh(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(et.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const r=this.isExponentialBackoffExpired();if(K2(s.status,[]))if(r)s=j2();else{this.sleepTime=Math.max(this.sleepTime*2,H6),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(et.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,r)=>{this._resolve=s,this._reject=r,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const i=UV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,di,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._uploadUrl=r,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,i)=>{const s=BV(this._ref.storage,this._ref._location,e,this._blob),r=this._ref.storage._makeRequest(s,di,t,i);this._request=r,r.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=u_*this._chunkMultiplier,t=new md(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((s,r)=>{let o;try{o=zV(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,di,s,r,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){u_*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const i=tC(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(i,di,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const i=OV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,di,e,t);this._request=s,s.getPromise().then(r=>{this._request=void 0,this._metadata=r,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=q2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=yf(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,s){const r=new qV(t||void 0,i||void 0,s||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(yf(this._state)){case un.SUCCESS:ao(this._resolve.bind(null,this.snapshot))();break;case un.CANCELED:case un.ERROR:const t=this._reject;ao(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(yf(this._state)){case un.RUNNING:case un.PAUSED:e.next&&ao(e.next.bind(e,this.snapshot))();break;case un.SUCCESS:e.complete&&ao(e.complete.bind(e))();break;case un.CANCELED:case un.ERROR:e.error&&ao(e.error.bind(e,this._error))();break;default:e.error&&ao(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,t){this._service=e,t instanceof Qt?this._location=t:this._location=Qt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Nr(e,t)}get root(){const e=new Qt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Z2(this._location.path)}get storage(){return this._service}get parent(){const e=xV(this._location.path);if(e===null)return null;const t=new Qt(this._location.bucket,e);return new Nr(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $2(e)}}function $V(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new iC(n,new ki(e),t)}function WV(n){const e={prefixes:[],items:[]};return sC(n,e).then(()=>e)}async function sC(n,e,t){const s=await rC(n,{pageToken:t});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await sC(n,e,s.nextPageToken)}function rC(n,e){e!=null&&typeof e.maxResults=="number"&&Xp("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=MV(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,di)}function KV(n){n._throwIfRoot("getMetadata");const e=tC(n.storage,n._location,fh());return n.storage.makeRequestWithTokens(e,di)}function YV(n,e){n._throwIfRoot("updateMetadata");const t=LV(n.storage,n._location,e,fh());return n.storage.makeRequestWithTokens(t,di)}function JV(n){n._throwIfRoot("getDownloadURL");const e=DV(n.storage,n._location,fh());return n.storage.makeRequestWithTokens(e,di).then(t=>{if(t===null)throw eV();return t})}function XV(n){n._throwIfRoot("deleteObject");const e=FV(n.storage,n._location);return n.storage.makeRequestWithTokens(e,di)}function oC(n,e){const t=TV(n._location.path,e),i=new Qt(n._location.bucket,t);return new Nr(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(n){return/^[A-Za-z]+:\/\//.test(n)}function ZV(n,e){return new Nr(n,e)}function aC(n,e){if(n instanceof by){const t=n;if(t._bucket==null)throw Q6();const i=new Nr(t,t._bucket);return e!=null?aC(i,e):i}else return e!==void 0?oC(n,e):n}function e8(n,e){if(e&&QV(e)){if(n instanceof by)return ZV(n,e);throw Ao("To use ref(service, url), the first argument must be a Storage instance.")}else return aC(n,e)}function d_(n,e){const t=e?.[z2];return t==null?null:Qt.makeFromBucketSpec(t,n)}function t8(n,e,t,i={}){n.host=`${e}:${t}`;const s=Ls(e);s&&(Mm(`https://${n.host}/b`),Dm("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:r}=i;r&&(n._overrideAuthToken=typeof r=="string"?r:NT(r,n.app.options.projectId))}class by{constructor(e,t,i,s,r,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=s,this._firebaseVersion=r,this._isUsingEmulator=o,this._bucket=null,this._host=B2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=j6,this._maxUploadRetryTime=q6,this._requests=new Set,s!=null?this._bucket=Qt.makeFromBucketSpec(s,this._host):this._bucket=d_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qt.makeFromBucketSpec(this._url,e):this._bucket=d_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Xp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Xp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ze(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Nr(this,e)}_makeRequest(e,t,i,s,r=!0){if(this._deleted)return new nV(G2());{const o=fV(e,this._appId,i,s,t,this._firebaseVersion,r,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,s).getPromise()}}const h_="@firebase/storage",f_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8="storage";function i8(n,e,t){return n=de(n),$V(n,e,t)}function s8(n){return n=de(n),KV(n)}function r8(n,e){return n=de(n),YV(n,e)}function o8(n,e){return n=de(n),rC(n,e)}function a8(n){return n=de(n),WV(n)}function l8(n){return n=de(n),JV(n)}function c8(n){return n=de(n),XV(n)}function p_(n,e){return n=de(n),e8(n,e)}function u8(n,e){return oC(n,e)}function d8(n,e,t,i={}){t8(n,e,t,i)}function h8(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new by(t,i,s,e,Bi)}function f8(){Fi(new Un(n8,h8,"PUBLIC").setMultipleInstances(!0)),kn(h_,f_,""),kn(h_,f_,"esm2020")}f8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,t,i){this._delegate=e,this.task=t,this.ref=i}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new du(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(i=>{if(e)return e(new du(i,this,this._ref))},t)}on(e,t,i,s){let r;return t&&(typeof t=="function"?r=o=>t(new du(o,this,this._ref)):r={next:t.next?o=>t.next(new du(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,r,i||void 0,s||void 0)}}class g_{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Di(e,this._service))}get items(){return this._delegate.items.map(e=>new Di(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=u8(this._delegate,e);return new Di(t,this.storage)}get root(){return new Di(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new Di(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new m_(i8(this._delegate,e,t),this)}putString(e,t=Fn.RAW,i){this._throwIfRoot("putString");const s=Y2(t,e),r={...i};return r.contentType==null&&s.contentType!=null&&(r.contentType=s.contentType),new m_(new iC(this._delegate,new ki(s.data,!0),r),this)}listAll(){return a8(this._delegate).then(e=>new g_(e,this.storage))}list(e){return o8(this._delegate,e||void 0).then(t=>new g_(t,this.storage))}getMetadata(){return s8(this._delegate)}updateMetadata(e){return r8(this._delegate,e)}getDownloadURL(){return l8(this._delegate)}delete(){return this._throwIfRoot("delete"),c8(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw $2(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(y_(e))throw Ao("ref() expected a child path but got a URL, use refFromURL instead.");return new Di(p_(this._delegate,e),this)}refFromURL(e){if(!y_(e))throw Ao("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Qt.makeFromUrl(e,this._delegate.host)}catch{throw Ao("refFromUrl() expected a valid full URL but got an invalid one.")}return new Di(p_(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,i={}){d8(this._delegate,e,t,i)}}function y_(n){return/^[A-Za-z]+:\/\//.test(n)}const p8="@firebase/storage-compat",m8="0.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8="storage-compat";function y8(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),i=n.getProvider("storage").getImmediate({identifier:e});return new lC(t,i)}function v8(n){const e={TaskState:un,TaskEvent:jV,StringFormat:Fn,Storage:lC,Reference:Di};n.INTERNAL.registerComponent(new Un(g8,y8,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(p8,m8)}v8(Vt);const w8={apiKey:"AIzaSyCyuWX133uQ8CAxs5IvNiN8Tf9Q09Zi1-E",authDomain:"pdfbullet-a766e.firebaseapp.com",projectId:"pdfbullet-a766e",storageBucket:"pdfbullet-a766e.appspot.com",messagingSenderId:"491932898021",appId:"1:491932898021:web:a7c1c9f5197e655c1f7a0c",measurementId:"G-PYLVB5NKSY"};Vt.apps.length?Vt.app():Vt.initializeApp(w8);const qn=Vt.auth(),dt=Vt.firestore(),JJ=Vt.storage(),nc=()=>{const{theme:n}=Sm();return p.jsx("div",{id:"preloader",className:"fixed inset-0 z-[100] flex items-center justify-center bg-white dark:bg-black",children:p.jsx("img",{src:"https://ik.imagekit.io/fonepay/logo%20(2).png?updatedAt=1758997939639",alt:"PDFBullet Loading...",className:`w-48 h-auto animate-pulse ${n==="dark"?"logo-img-dark":""}`})})},cC=P.createContext(void 0),Mt=(n,e)=>(console.error(`Firestore error during ${e}:`,n),n.code==="permission-denied"?new Error("Operation failed: Permission Denied. Please check your Firestore security rules to allow this action."):n.code==="unavailable"?new Error("Could not connect to the database. The service may be temporarily unavailable or blocked by your network."):new Error(`An unexpected error occurred during ${e}.`)),_8=({children:n})=>{const[e,t]=P.useState(null),[i,s]=P.useState(!0);P.useEffect(()=>{const W=qn.onAuthStateChanged(async H=>{if(!H){t(null),s(!1);return}const te={uid:H.uid,username:H.displayName||H.email?.split("@")[0]||"Anonymous",email:H.email||void 0,profileImage:H.photoURL||void 0,isPremium:!1,creationDate:H.metadata.creationTime||new Date().toISOString(),apiPlan:"free",isAdmin:!1};try{const re=dt.collection("users").doc(H.uid),be=await re.get();if(be.exists){const le=be.data();t({...le,...te,...le})}else(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)&&(te.trialEnds=Date.now()+6048e5),await re.set(te),t(te)}catch(re){console.error("Critical Firestore error during auth state change:",re),alert("Could not connect to the user database. Please check your connection and Firebase setup. The application may not function correctly."),t(te)}finally{s(!1)}});return()=>W()},[]);const ie={user:e,loading:i,logout:async()=>{sessionStorage.removeItem("isAdminAuthenticated"),await qn.signOut()},updateProfileImage:async W=>{if(!e)throw new Error("No user is signed in.");const H=URL.createObjectURL(W),te=qn.currentUser;te&&await te.updateProfile({photoURL:H});try{await dt.collection("users").doc(e.uid).update({profileImage:H}),t(be=>be?{...be,profileImage:H}:null)}catch(re){throw Mt(re,"profile image update")}},updateUserProfile:async W=>{if(!e)throw new Error("No user is signed in.");try{await dt.collection("users").doc(e.uid).update(W),t(te=>te?{...te,...W}:null)}catch(H){throw Mt(H,"user profile update")}},getAllUsers:async()=>{try{return(await dt.collection("users").get()).docs.map(te=>te.data())}catch(W){throw Mt(W,"fetching all users")}},updateUserPremiumStatus:async(W,H)=>{try{await dt.collection("users").doc(W).update({isPremium:H})}catch(te){throw Mt(te,"updating premium status")}},updateUserApiPlan:async(W,H)=>{try{await dt.collection("users").doc(W).update({apiPlan:H})}catch(te){throw Mt(te,"updating API plan")}},deleteUser:async W=>{try{await dt.collection("users").doc(W).delete()}catch(H){throw Mt(H,"deleting user")}},deleteCurrentUser:async()=>{const W=qn.currentUser;if(!W)throw new Error("No user is currently signed in to delete.");try{await dt.collection("users").doc(W.uid).delete()}catch(H){throw Mt(H,"deleting current user data")}await W.delete()},loginOrSignupWithGoogle:async()=>{const W=new Vt.auth.GoogleAuthProvider;await qn.signInWithPopup(W)},loginOrSignupWithGithub:async()=>{const W=new Vt.auth.GithubAuthProvider;await qn.signInWithPopup(W)},signInWithEmail:async(W,H)=>{await qn.signInWithEmailAndPassword(W,H)},signUpWithEmail:async(W,H)=>{await qn.createUserWithEmailAndPassword(W,H)},signInWithCustomToken:async W=>{await qn.signInWithCustomToken(W)},generateApiKey:async()=>{if(!e)throw new Error("You must be logged in.");const W=crypto.getRandomValues(new Uint8Array(32)),H="sk_live_"+btoa(String.fromCharCode(...W)).replace(/[^A-Za-z0-9]/g,"").substring(0,40);try{return await dt.collection("users").doc(e.uid).update({apiKey:H}),t(re=>re?{...re,apiKey:H}:null),H}catch(te){throw Mt(te,"API key generation")}},getApiUsage:async()=>{if(!e)throw new Error("You must be logged in.");const W=e.apiPlan||"free",H={free:100,developer:1e3,business:1e4};return{count:Math.floor(Math.random()*H[W]),limit:H[W],resetsIn:"23h 59m"}},changePassword:async(W,H)=>{const te=qn.currentUser;if(!te||!te.email)throw new Error("No user is signed in or user does not have an email address.");const re=Vt.auth.EmailAuthProvider.credential(te.email,W);await te.reauthenticateWithCredential(re),await te.updatePassword(H)},updateTwoFactorStatus:async W=>{if(!e)throw new Error("No user is signed in.");try{await dt.collection("users").doc(e.uid).update({twoFactorEnabled:W}),t(te=>te?{...te,twoFactorEnabled:W}:null)}catch(H){throw Mt(H,"2FA status update")}},updateBusinessDetails:async W=>{if(!e)throw new Error("No user is signed in.");try{await dt.collection("users").doc(e.uid).update({businessDetails:W}),t(te=>te?{...te,businessDetails:W}:null)}catch(H){throw Mt(H,"business details update")}},submitProblemReport:async W=>{const H={...W,timestamp:Vt.firestore.FieldValue.serverTimestamp(),status:"New",userId:e?.uid,userName:e?.username};try{await dt.collection("reports").add(H)}catch(te){throw Mt(te,"problem report submission")}},getProblemReports:async()=>{try{return(await dt.collection("reports").orderBy("timestamp","desc").get()).docs.map(te=>({id:te.id,...te.data()}))}catch(W){throw Mt(W,"fetching problem reports")}},updateReportStatus:async(W,H)=>{try{await dt.collection("reports").doc(W).update({status:H})}catch(te){throw Mt(te,"updating report status")}},deleteProblemReport:async W=>{try{await dt.collection("reports").doc(W).delete()}catch(H){throw Mt(H,"deleting problem report")}},sendTaskCompletionEmail:async(W,H)=>{if(!e||!e.email){console.log("User not logged in, skipping email notification.");return}try{await dt.collection("notifications").add({to:e.email,message:{subject:`✅ Your task '${W}' is complete!`,html:`
            <p>Hello ${e.username},</p>
            <p>Your task '<strong>${W}</strong>' has been successfully completed.</p>
            <p>The output file is named: <strong>${H}</strong>.</p>
            <p>You can download it from the success screen in the app.</p>
            <p>Thank you for using PDFBullet!</p>
          `},createdAt:Vt.firestore.FieldValue.serverTimestamp(),userId:e.uid})}catch(te){console.error("Error queueing email notification:",te)}},logTask:async W=>{if(!(!e||!W.fileBlob))try{const H={userId:e.uid,username:e.username,toolId:W.toolId,toolTitle:W.toolTitle,outputFilename:W.outputFilename,timestamp:Vt.firestore.FieldValue.serverTimestamp(),fileSize:W.fileBlob.size};await dt.collection("tasks").add(H)}catch(H){console.error("Error logging task to Firestore:",H)}},getTaskHistory:async()=>{try{return(await dt.collection("tasks").orderBy("timestamp","desc").get()).docs.map(te=>({id:te.id,...te.data()}))}catch(W){throw Mt(W,"fetching task history")}},deleteTaskRecord:async W=>{try{await dt.collection("tasks").doc(W).delete()}catch(H){throw Mt(H,"deleting task record")}},auth:qn,saveFaceDescriptor:async W=>{if(!e)throw new Error("No user is signed in.");try{await dt.collection("users").doc(e.uid).update({faceDescriptor:W}),t(te=>te?{...te,faceDescriptor:W}:null)}catch(H){throw Mt(H,"saving face descriptor")}},loginWithFace:async W=>{try{const re=await dt.collection("users").where("email","==",W).limit(1).get();if(re.empty)throw new Error("No account found with this email address.");const be=re.docs[0].data();t(be)}catch(H){throw H instanceof Error?H:Mt(H,"face login")}}};return p.jsx(cC.Provider,{value:ie,children:i?p.jsx(nc,{}):n})},Nn=()=>{const n=P.useContext(cC);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},uC=P.createContext(void 0),v_=[{code:"en",name:"English"},{code:"hi",name:"हिन्दी"},{code:"ne",name:"नेपाली"}],b8=({children:n})=>{const[e,t]=P.useState(()=>localStorage.getItem("locale")||"en"),[i,s]=P.useState({}),[r,o]=P.useState(!0);P.useEffect(()=>{(async()=>{o(!0);try{const f=await fetch(`/locales/${e}.json`);if(!f.ok)throw new Error(`Could not load ${e}.json`);const m=await f.json();s(m),document.documentElement.dir=["ar"].includes(e)?"rtl":"ltr",document.documentElement.lang=e}catch(f){if(console.error("Failed to load translations:",f),e!=="en"){const y=await(await fetch("/locales/en.json")).json();s(y),document.documentElement.dir="ltr",document.documentElement.lang="en"}}finally{o(!1)}})()},[e]);const a=u=>{localStorage.setItem("locale",u),t(u)},l=P.useCallback((u,f)=>{if(!u)return"";const m=u.split(".");let y=i;for(const v of m)if(y=y?.[v],y===void 0)return console.warn(`Translation key not found: ${u}`),u;return typeof y=="string"&&f&&Object.keys(f).forEach(v=>{const _=new RegExp(`{${v}}`,"g");y=y.replace(_,String(f[v]))}),y||u},[i]),c={locale:e,setLocale:a,t:l};return r?null:p.jsx(uC.Provider,{value:c,children:n})},Nc=()=>{const n=P.useContext(uC);if(n===void 0)throw new Error("useI18n must be used within an I18nProvider");return n},dC=P.createContext(void 0),x8=({children:n})=>{const[e,t]=P.useState(null),[i,s]=P.useState(!1),[r,o]=P.useState(!1);P.useEffect(()=>{const u=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;o(u),u&&(document.body.style.paddingBottom="72px");const f=m=>{m.preventDefault(),t(m)};return window.addEventListener("beforeinstallprompt",f),()=>{window.removeEventListener("beforeinstallprompt",f),u&&(document.body.style.paddingBottom="0")}},[]);const a=P.useCallback(()=>{e?(e.prompt(),e.userChoice.then(u=>{u.outcome==="accepted"?console.log("User accepted the PWA installation"):console.log("User dismissed the PWA installation"),t(null)})):s(!0)},[e]),l=P.useCallback(()=>{s(!1)},[]),c={isPwa:r,canInstall:!!e,promptInstall:a,showInstallInstructions:i,closeInstallInstructions:l};return p.jsx(dC.Provider,{value:c,children:n})},ya=()=>{const n=P.useContext(dC);if(n===void 0)throw new Error("usePWAInstall must be used within a PWAInstallProvider");return n},hC=P.createContext(void 0),T8=({children:n})=>{const[e,t]=P.useState("Home"),i=P.useMemo(()=>({title:e,setTitle:t}),[e]);return p.jsx(hC.Provider,{value:i,children:n})},E8=()=>{const n=P.useContext(hC);if(n===void 0)throw new Error("usePwaLayout must be used within a PwaLayoutProvider");return n},A8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsxs("g",{fill:"#EE6C4D",fillRule:"evenodd",children:[p.jsx("path",{d:"M5.488.363h21.75c1.78 0 2.43.184 3.082.535a3.66 3.66 0 0 1 1.512 1.512c.348.652.535 1.297.535 3.082v21.746c0 1.78-.187 2.43-.535 3.082a3.66 3.66 0 0 1-1.512 1.512c-.652.348-1.3.535-3.082-.535H5.488c-1.78 0-2.43-.187-3.082-.535A3.66 3.66 0 0 1 .895 30.32c-.348-.652-.535-1.3-.535-3.082V5.488c0-1.78.188-2.43.535-3.082A3.7 3.7 0 0 1 2.406.895c.652-.348 1.3-.53 3.082-.53z"}),p.jsx("path",{d:"M44.563 49.69H22.816c-1.78 0-2.43-.184-3.082-.535a3.6 3.6 0 0 1-1.512-1.512c-.348-.652-.535-1.297-.535-3.082V22.816c0-1.78.184-2.43.535-3.082a3.6 3.6 0 0 1 1.512-1.512c.652-.348 1.3-.535 3.082-.535h21.746c1.785 0 2.43.188 3.082.535.645.34 1.172.867 1.512 1.512.352.652.535 1.3.535 3.082v21.746c0 1.785-.184 2.43-.535 3.082a3.6 3.6 0 0 1-1.512 1.512c-.652.352-1.297.535-3.082.535z"})]}),p.jsx("path",{fill:"#FFF",d:"M17.906 10.965a.87.87 0 0 0-.875.86v3.8L9.84 8.523a.886.886 0 0 0-1.238 0 .85.85 0 0 0-.254.605.86.86 0 0 0 .254.6l7.195 7.098h-3.875c-.484 0-.875.387-.875.86s.4.86.875.86h5.984a.9.9 0 0 0 .332-.066.86.86 0 0 0 .473-.465.8.8 0 0 0 .066-.328v-5.87a.86.86 0 0 0-.87-.86zm14.418 28.008c.48 0 .87-.383.87-.86v-3.797l7.195 7.098a.88.88 0 0 0 1.234 0 .85.85 0 0 0 .258-.605c0-.23-.094-.45-.258-.605l-7.2-7.102h3.875c.484 0 .875-.383.875-.86s-.4-.855-.875-.855h-5.984a.9.9 0 0 0-.336.066.9.9 0 0 0-.473.46.9.9 0 0 0-.066.328v5.87c0 .477.4.86.875.86zm-10.1-10.1c-.355.352-.93.352-1.285 0s-.355-.934 0-1.3a.91.91 0 0 1 1.285 0 .927.927 0 0 1 0 1.3m3.374-3.357a.91.91 0 0 1-1.285 0 .91.91 0 0 1 0-1.285.914.914 0 0 1 1.285 0 .91.91 0 0 1 0 1.285m3.36-3.364a.91.91 0 0 1-1.285 0 .91.91 0 0 1 0-1.285.91.91 0 0 1 1.285 0 .91.91 0 0 1 0 1.285"})]}),I8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsxs("g",{fill:"#EE6C4D",fillRule:"evenodd",children:[p.jsx("path",{d:"M5.488.363h21.75c1.78 0 2.43.184 3.082.535a3.66 3.66 0 0 1 1.512 1.512c.348.652.535 1.297.535 3.082v21.746c0 1.78-.187 2.43-.535 3.082a3.66 3.66 0 0 1-1.512 1.512c-.652.348-1.3.535-3.082-.535H5.488c-1.78 0-2.43-.187-3.082-.535A3.66 3.66 0 0 1 .895 30.32c-.348-.652-.535-1.3-.535-3.082V5.488c0-1.78.188-2.43.535-3.082A3.7 3.7 0 0 1 2.406.895c.652-.348 1.3-.53 3.082-.53z"}),p.jsx("path",{d:"M44.563 49.69H22.816c-1.78 0-2.43-.184-3.082-.535a3.6 3.6 0 0 1-1.512-1.512c-.348-.652-.535-1.297-.535-3.082V22.816c0-1.78.184-2.43.535-3.082a3.6 3.6 0 0 1 1.512-1.512c.652-.348 1.3-.535 3.082-.535h21.746c1.785 0 2.43.188 3.082.535.645.34 1.172.867 1.512 1.512.352.652.535 1.3.535 3.082v21.746c0 1.785-.184 2.43-.535 3.082a3.6 3.6 0 0 1-1.512 1.512c-.652.352-1.297.535-3.082.535z"})]}),p.jsx("path",{fill:"#FFF",d:"M9.22 15.87a.87.87 0 0 0 .875-.86v-3.8l7.195 7.102a.88.88 0 0 0 1.234 0 .85.85 0 0 0 0-1.215L11.328 10h3.875c.484 0 .875-.387.875-.86s-.4-.86-.875-.86H9.22a.9.9 0 0 0-.332.066.86.86 0 0 0-.539.793v5.875c0 .473.4.86.87.86zm31.793 18.2a.865.865 0 0 0-.875.855v3.8L32.94 31.63a.88.88 0 0 0-1.234 0 .84.84 0 0 0-.258.605.85.85 0 0 0 .258.605l7.2 7.1H35.02c-.48 0-.87.387-.87.86a.86.86 0 0 0 .871.855H41a.88.88 0 0 0 .805-.527.9.9 0 0 0 .066-.328v-5.883a.87.87 0 0 0-.87-.855zm-18.78-5.187c-.355.352-.93.352-1.285 0s-.355-.934 0-1.3a.91.91 0 0 1 1.285 0 .927.927 0 0 1 0 1.3m3.365-3.367a.91.91 0 0 1-1.285 0 .91.91 0 0 1 0-1.285.914.914 0 0 1 1.285 0 .91.91 0 0 1 0 1.285m3.36-3.364a.91.91 0 0 1-1.285 0 .91.91 0 0 1 0-1.285.91.91 0 0 1 1.285 0 .91.91 0 0 1 0 1.285m0 0"})]}),w_=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#8FBC5D",fillRule:"evenodd",d:"M31.523 28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H31.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04c-.242-.45-.367-.895-.367-2.117V31.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04.45-.242.895-.367 2.117-.367zm0-28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H31.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04c-.242-.45-.367-.895-.367-2.117V3.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04C29.855.125 30.3 0 31.523 0m-28 28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H3.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04C.125 48.145 0 47.7 0 46.477V31.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04.45-.242.895-.367 2.117-.367zm0-28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H3.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04C.125 20.145 0 19.7 0 18.477V3.523C0 2.3.13 1.852.367 1.406A2.56 2.56 0 0 1 1.406.367C1.855.13 2.3 0 3.523 0m0 0"}),p.jsx("path",{fill:"#FFF",d:"M35 41.8c0 .48.398.867.883.867a.88.88 0 0 0 .883-.867v-3.844l5.145 5.05a.89.89 0 0 0 1.246 0 .85.85 0 0 0 .262-.613c0-.23-.094-.45-.262-.613l-5.14-5.047h3.914a.88.88 0 0 0 .883-.867.874.874 0 0 0-.883-.867h-6.05a.875.875 0 0 0-.817.536.8.8 0 0 0-.066.328zm7.3-26.387c.48 0 .867-.398.867-.883a.88.88 0 0 0-.867-.883h-3.844l5.05-5.14a.9.9 0 0 0 0-1.25.86.86 0 0 0-1.227 0l-5.047 5.148V8.492a.876.876 0 0 0-.867-.883.87.87 0 0 0-.867.879v6.05c0 .113.023.23.066.336a.86.86 0 0 0 .47.477.8.8 0 0 0 .332.07H42.3zM8.46 35c-.48 0-.867.398-.867.883s.387.883.867.883h3.844L7.254 41.9a.893.893 0 0 0 0 1.25.86.86 0 0 0 .613.258c.23 0 .45-.094.613-.258l5.047-5.145v3.914c0 .488.387.883.867.883s.867-.402.867-.883v-6.05a.875.875 0 0 0-.536-.813.8.8 0 0 0-.332-.07H8.46zm6.074-27.406a.874.874 0 0 0-.883.867v3.844l-5.145-5.05a.9.9 0 0 0-1.25 0A.86.86 0 0 0 7 7.867c0 .23.094.45.258.613l5.145 5.047H8.488c-.488 0-.883.387-.883.867s.402.867.883.867h6.05a.9.9 0 0 0 .336-.066c.215-.1.39-.258.477-.47.05-.102.07-.22.07-.332V8.46a.874.874 0 0 0-.883-.867zm0 0"})]}),__=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#5F83C6",fillRule:"evenodd",d:"M17.676 34.344h9.55c2.477 0 3.375-.258 4.28-.742a5.04 5.04 0 0 0 2.098-2.102c.484-.902.742-1.8.742-4.277v-9.547H44.82c1.8 0 2.453.188 3.113.54s1.176.87 1.527 1.527.54 1.31.54 3.113V44.82c0 1.8-.187 2.453-.54 3.113a3.7 3.7 0 0 1-1.527 1.527c-.66.352-1.312.54-3.113.54H22.855c-1.8 0-2.453-.187-3.113-.54s-1.172-.87-1.527-1.527-.54-1.312-.54-3.113zm0 0"}),p.jsx("path",{fill:"#FFF",d:"M43.94 37.137c0-.477-.395-.863-.883-.863s-.883.387-.883.863v3.844l-5.145-5.047a.893.893 0 0 0-1.25 0 .85.85 0 0 0-.258.609.86.86 0 0 0 .258.613l5.145 5.05H37.01c-.488 0-.883.387-.883.867s.395.867.883.867h6.05a.9.9 0 0 0 .336-.07.87.87 0 0 0 .477-.465.8.8 0 0 0 .066-.332l.004-5.934zm0 0"}),p.jsx("path",{fill:"#DCE5FA",fillRule:"evenodd",d:"M27.145 32.324H5.18c-1.8 0-2.453-.187-3.113-.543S.89 30.914.54 30.254 0 28.95 0 27.145V5.18c0-1.8.188-2.453.54-3.113A3.7 3.7 0 0 1 2.066.539C2.727.188 3.38 0 5.18 0h21.965c1.8 0 2.453.188 3.113.54s1.172.87 1.527 1.527.54 1.313.54 3.113v21.965c0 1.8-.187 2.453-.54 3.113s-.87 1.176-1.527 1.527-1.312.54-3.113.54zm0 0"}),p.jsx("path",{fill:"#295795",d:"M20.844 8.61h2.96l-2.94 14.64H17.77l-1.777-9.035-1.824 9.035h-3.203L8.04 8.61h3.164l1.508 9.363L14.65 8.61h3.004l.04.203 1.688 9.1zm0 0"})]}),b_=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 14h-2v-2h2v2zm0-4h-2V9h2v3z"})}),x_=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 14h-4v-2h4v2zm0-4h-4v-2h4v2zm0-4h-4V6h4v2z"})}),C8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",fillRule:"evenodd",viewBox:"0 0 100 100",children:[p.jsx("path",{fill:"#ab6993",d:"M16.024 0h67.95c5.572 0 7.593.58 9.63 1.67s3.636 2.688 4.725 4.725 1.67 4.058 1.67 9.63v67.95c0 5.572-.58 7.593-1.67 9.63s-2.688 3.636-4.725 4.725-4.058 1.67-9.63 1.67h-67.95c-5.572 0-7.593-.58-9.63-1.67S2.76 95.642 1.67 93.605 0 89.548 0 83.976v-67.95c0-5.572.58-7.593 1.67-9.63S4.358 2.76 6.395 1.67 10.452 0 16.024 0"}),p.jsx("path",{fill:"#fff",d:"m57.98 39.967 5.413 4.398a.51.51 0 0 1-.092.847l-6.234 3.142a1.4 1.4 0 0 1-.388.124l-.136.016a1.44 1.44 0 0 1-1.031-.31 1.34 1.34 0 0 1-.48-1.336l.037-.134 2.108-6.5a.51.51 0 0 1 .803-.238zm15.55-20.523a4.33 4.33 0 0 1 5.728-.648l.182.136 1.06.88a4.14 4.14 0 0 1 1.486 2.821 4.12 4.12 0 0 1-.82 2.849l-.148.184-14.9 17.566c-.36.425-.995.48-1.423.125l-5.915-4.9a1.007 1.007 0 0 1-.133-1.43z"}),p.jsx("g",{stroke:"#eadae4",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3.046",children:p.jsx("path",{d:"M48.012 62.483h-7.356m7.356-24.49h-7.356M44.232 39.695l.004 21.566"})}),p.jsx("path",{fill:"#fff",fillRule:"nonzero",d:"M24 22.985c-.523 0-.954.396-1.01.905l-.006.11v52c0 .523.396.954.905 1.01l.11.006h52c.523 0 .954-.396 1.01-.905l.006-.11V42.302a1.016 1.016 0 0 0-2.025-.11l-.006.11v32.682h-49.97v-49.97h34.7c.523 0 .954-.396 1.01-.905l.006-.11c0-.523-.396-.954-.905-1.01l-.11-.006H24z"}),p.jsxs("g",{fill:"#eadae4",children:[p.jsx("rect",{width:"12",height:"12",x:"18",y:"18",rx:"6"}),p.jsx("rect",{width:"12",height:"12",x:"18",y:"70",rx:"6"}),p.jsx("rect",{width:"12",height:"12",x:"70",y:"70",rx:"6"})]})]}),S8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm-1.25 10.5H11v1h1.75c.41 0 .75-.34.75-.75s-.34-.75-.75-.75zm-1-2.25H11v1h1.75c.41 0 .75-.34.75-.75s-.34-.75-.75-.75zm-2 4.5h-.75v1.5h-1.5v-1.5H8v-4.5h3v4.5z"})}),P8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#FBEFA8",fillRule:"evenodd",d:"M17.676 34.344h9.55c2.477 0 3.375-.258 4.28-.742a5.04 5.04 0 0 0 2.098-2.102c.484-.902.742-1.8.742-4.277v-9.547H44.82c1.8 0 2.453.188 3.113.54s1.176.87 1.527 1.527.54 1.31.54 3.113V44.82c0 1.8-.187 2.453-.54 3.113a3.7 3.7 0 0 1-1.527 1.527c-.66.352-1.312.54-3.113.54H22.855c-1.8 0-2.453-.187-3.113-.54s-1.172-.87-1.527-1.527-.54-1.312-.54-3.113zm0 0"}),p.jsx("path",{fill:"#B7A001",d:"M43.94 37.137c0-.477-.395-.863-.883-.863s-.883.387-.883.863v3.844l-5.145-5.047a.893.893 0 0 0-1.25 0 .85.85 0 0 0-.258.609.86.86 0 0 0 .258.613l5.145 5.05H37.01c-.488 0-.883.387-.883.867s.395.867.883.867h6.05a.9.9 0 0 0 .336-.07.87.87 0 0 0 .477-.465.8.8 0 0 0 .066-.332l.004-5.934zm0 0"}),p.jsxs("g",{fillRule:"evenodd",children:[p.jsx("path",{fill:"#D6BF2D",d:"M5.184 0h21.988c1.8 0 2.453.188 3.113.54.652.344 1.184.88 1.527 1.53.352.656.54 1.313.54 3.113v21.984c0 1.805-.187 2.457-.54 3.117a3.67 3.67 0 0 1-1.527 1.527c-.66.352-1.312.54-3.113.54H5.184c-1.8 0-2.457-.187-3.113-.54a3.67 3.67 0 0 1-1.527-1.527C.188 29.625 0 28.973 0 27.168V5.184c0-1.8.188-2.457.54-3.113.344-.652.88-1.184 1.53-1.53S3.383 0 5.184 0m0 0"}),p.jsx("path",{fill:"#FFF",d:"M10.28 12.945v4.688c0 1.66-.926 2.66-2.707 2.66C5.406 20.293 5 18.852 5 18.07c0-.668.31-1.098.86-1.098.648 0 .813.504.813 1.05 0 .516.242.89.88.89.594 0 .926-.44.926-1.3V12.95c0-.54.352-.898.902-.898s.902.36.902.898zm1.672 6.402v-6.102c0-.8.418-1.055 1.055-1.055h2.762c1.516 0 2.738.75 2.738 2.508 0 1.44-1 2.508-2.75 2.508h-2v2.152c0 .54-.355.902-.902.902s-.902-.363-.902-.902zm1.805-5.773v2.242h1.68c.727 0 1.266-.437 1.266-1.12 0-.793-.56-1.12-1.45-1.12zm13.285 3.1v2.984a.595.595 0 0 1-.613.602c-.52 0-.66-.32-.773-1.023-.516.648-1.23 1.066-2.352 1.066-2.793 0-3.863-1.926-3.863-4.145 0-2.676 1.672-4.148 4.125-4.148 2.004 0 3.07 1.2 3.07 1.902 0 .63-.46.793-.848.793-.89 0-.56-1.242-2.32-1.242-1.242 0-2.223.813-2.223 2.816 0 1.56.77 2.637 2.246 2.637.957 0 1.793-.648 1.88-1.617H24.2c-.383 0-.812-.14-.812-.69 0-.44.254-.69.703-.69h2.223c.527 0 .738.262.738.758zm0 0"})]})]}),fC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),vf=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),k8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),Qp=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"})}),R8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0l-3.75 3.75M12 9.75l3.75 3.75M17.25 21H6.75c-1.035 0-1.875-.84-1.875-1.875V15.75c0-1.035.84-1.875 1.875-1.875h10.5c1.035 0 1.875.84 1.875 1.875v3.375c0 1.035-.84 1.875-1.875-1.875z"})}),N8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),pC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"})}),T_=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#AB6993",fillRule:"evenodd",d:"M8.012 0h33.977c2.785 0 3.797.29 4.816.836a5.66 5.66 0 0 1 2.36 2.363c.547 1.016.836 2.027.836 4.813v33.977c0 2.785-.29 3.797-.836 4.816a5.67 5.67 0 0 1-2.36 2.36c-1.02.547-2.03.836-4.816.836H8.012c-2.785 0-3.797-.29-4.816-.836a5.67 5.67 0 0 1-2.36-2.36C.29 45.785 0 44.773 0 41.988V8.012c0-2.785.29-3.797.836-4.816A5.64 5.64 0 0 1 3.2.836C4.215.29 5.227 0 8.012 0m0 0"}),p.jsx("path",{fill:"#FFF",d:"M22.7 22.523c0 .863-1.094 3.023-2.11 4.668a.68.68 0 0 0-.078.523.64.64 0 0 0 .61.47h7.75a.63.63 0 0 0 .566-.352.65.65 0 0 0-.055-.672c-1.445-1.97-2.1-3.398-2.1-4.633s.645-2.66 2.094-4.637a5.5 5.5 0 0 0 1.012-3.195c0-3.02-2.422-5.477-5.398-5.477s-5.398 2.45-5.398 5.473a5.5 5.5 0 0 0 1.02 3.203c1.44 1.97 2.086 3.398 2.086 4.63zm14.02 6.55H13.266a.64.64 0 0 0-.633.645v6.465c0 .352.285.645.633.645H36.72a.64.64 0 0 0 .633-.645V29.72a.643.643 0 0 0-.633-.645zm-3.582 8.7H16.863a.64.64 0 0 0-.633.645v.727c0 .352.285.645.633.645h16.273a.64.64 0 0 0 .633-.645v-.727a.643.643 0 0 0-.633-.645zm0 0"})]}),M8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#AB6993",d:"M8.012 0h33.976c2.786 0 3.796.3 4.815.835a5.7 5.7 0 0 1 2.363 2.363c.545 1.02.835 2.03.835 4.815v33.976c0 2.786-.3 3.796-.835 4.815a5.7 5.7 0 0 1-2.363 2.363c-1.02.545-2.03.835-4.815.835H8.012c-2.786 0-3.796-.3-4.815-.835a5.7 5.7 0 0 1-2.363-2.363C.3 45.784 0 44.774 0 41.988V8.012c0-2.786.3-3.796.835-4.815A5.7 5.7 0 0 1 3.197.835C4.216.3 5.226 0 8.012 0"}),p.jsxs("g",{fill:"#FFF",children:[p.jsx("path",{fillRule:"nonzero",d:"M23.366 13.26a1.25 1.25 0 1 1 .318 2.48c-5.352.686-9.434 5.212-9.434 10.638 0 4.407 2.692 8.285 6.726 9.926a1.25 1.25 0 0 1-.942 2.316c-4.963-2.02-8.284-6.804-8.284-12.242 0-6.697 5.03-12.273 11.616-13.118m14.778 11.437a1.25 1.25 0 1 1-2.475.354 11.6 11.6 0 0 0-.905-3.163 1.25 1.25 0 1 1 2.278-1.03 14 14 0 0 1 1.102 3.84zM26.71 39.493a1.25 1.25 0 0 1-.354-2.475c1.1-.157 2.125-.445 3.09-.872a1.25 1.25 0 0 1 1.013 2.286 14 14 0 0 1-3.748 1.06zm8.792-4.998a1.25 1.25 0 1 1-2-1.5q1.078-1.434 1.627-2.866a1.25 1.25 0 1 1 2.335.893C37 32.206 36.35 33.36 35.5 34.495z"}),p.jsx("path",{d:"M24.282 21a.786.786 0 0 1-.78-.78V9.28c0-.427.354-.78.78-.78.208 0 .403.085.55.232l5.47 5.47c.146.146.232.342.232.55s-.085.403-.232.55l-5.47 5.47a.78.78 0 0 1-.55.232z"})]})]}),D8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",viewBox:"0 0 100 100",children:[p.jsx("path",{fill:"#4a7aab",d:"M16.024 0h67.95c5.572 0 7.593.58 9.63 1.67s3.636 2.688 4.725 4.725 1.67 4.058 1.67 9.63v67.95c0 5.572-.58 7.593-1.67 9.63s-2.688 3.636-4.725 4.725-4.058 1.67-9.63 1.67h-67.95c-5.572 0-7.593-.58-9.63-1.67S2.76 95.642 1.67 93.605 0 89.548 0 83.976v-67.95c0-5.572.58-7.593 1.67-9.63S4.358 2.76 6.395 1.67 10.452 0 16.024 0"}),p.jsx("path",{fill:"#fff",fillRule:"nonzero",d:"M70.607 44.156h-30.35l.033-10.502c.18-2.232 1.377-4.486 3.2-6.03 1.898-1.603 4.092-2.37 6.652-2.344a12 12 0 0 1 .91.043c4.586.37 8.4 4.088 8.68 8.466.03.43.014.8-.005 1.636l-.05 2.586a2.64 2.64 0 0 0 2.602 2.678c1.482-.012 2.657-1.145 2.678-2.602l.048-2.54c.023-.992.034-1.492-.004-2.1-.447-6.933-6.39-12.815-13.527-13.4a20 20 0 0 0-1.28-.06h-.183c-3.77 0-7.11 1.208-9.933 3.593-2.873 2.432-4.763 6.035-5.053 9.633-.02.225-.074.925-.05 10.93h-5.582c-.77 0-1.393.625-1.393 1.393v29.525c0 .77.625 1.393 1.393 1.393h41.214c.77 0 1.393-.625 1.393-1.393V45.55c0-.77-.623-1.393-1.393-1.393zM53.415 68.06h-6.83l1.043-8.468c-1.006-.707-1.66-1.85-1.66-3.14 0-2.145 1.805-3.884 4.033-3.884s4.033 1.74 4.033 3.884c0 1.3-.653 2.434-1.66 3.14l1.042 8.468z"})]}),L8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",children:[p.jsx("path",{fill:"#4A7AAB",d:"M16.024 0h67.95c5.572 0 7.593.58 9.63 1.67s3.636 2.688 4.725 4.725 1.67 4.058 1.67 9.63v67.95c0 5.572-.58 7.593-1.67 9.63s-2.688 3.636-4.725 4.725-4.058 1.67-9.63 1.67h-67.95c-5.572 0-7.593-.58-9.63-1.67S2.76 95.642 1.67 93.605 0 89.548 0 83.976v-67.95c0-5.572.58-7.593 1.67-9.63S4.358 2.76 6.395 1.67 10.452 0 16.024 0"}),p.jsxs("g",{fill:"#fff",children:[p.jsx("path",{d:"M49.485 21.715a2.5 2.5 0 0 1 2.031 0l21.5 9.556a2.5 2.5 0 0 1 1.485 2.285V47.89c0 14.445-10 27.82-23.407 31.095a2.5 2.5 0 0 1-1.186 0C36.5 75.708 26.5 62.334 26.5 47.89V33.556a2.5 2.5 0 0 1 1.485-2.285zM31.5 35.18v12.71c0 11.97 8.165 23.116 19 26.084 10.835-2.968 19-14.113 19-26.084V35.18l-19-8.444z"}),p.jsx("path",{d:"M53.89 58.493h-7.713l1.178-9.56c-1.136-.798-1.874-2.088-1.874-3.546 0-2.422 2.038-4.386 4.553-4.386s4.553 1.964 4.553 4.386c0 1.457-.738 2.748-1.874 3.546l1.176 9.56z"})]})]}),F8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#8FBC5D",d:"M8.012 0h33.977c2.785 0 3.797.29 4.816.836a5.66 5.66 0 0 1 2.36 2.363c.547 1.016.836 2.027.836 4.813v33.977c0 2.785-.29 3.797-.836 4.816a5.67 5.67 0 0 1-2.36 2.36c-1.02.547-2.03.836-4.816.836H8.012c-2.785 0-3.797-.29-4.816-.836a5.67 5.67 0 0 1-2.36-2.36C.29 45.785 0 44.773 0 41.988V8.012c0-2.785.29-3.797.836-4.816A5.64 5.64 0 0 1 3.2.836C4.215.29 5.227 0 8.012 0m0 0"}),p.jsx("path",{fill:"#FFF",d:"M20.816 27.363a.5.5 0 0 1 .18.39c0 .12-.04.234-.113.324l-6.563 7.906a.51.51 0 0 1-.715.063.52.52 0 0 1-.18-.391.53.53 0 0 1 .117-.328l6.56-7.902a.5.5 0 0 1 .71-.063zm2.13 1.793a.51.51 0 0 1 .066.715l-6.562 7.906a.5.5 0 0 1-.344.18.5.5 0 0 1-.367-.117.52.52 0 0 1-.18-.391c0-.12.04-.234.117-.328l6.56-7.902a.505.505 0 0 1 .714-.063zm-10.816 5.31a2.764 2.764 0 0 0 .344 3.86l1.238 1.043a2.72 2.72 0 0 0 3.836-.352l6.953-8.367L19.988 25zm21.13-18.527a4.4 4.4 0 0 1 1.32-1.062l.313-.16c.387-.203.723-.473.996-.8l1.04-1.25c.137-.164.078-.44-.13-.613l-1.69-1.418c-.21-.176-.488-.184-.625-.02l-1.04 1.25a3.3 3.3 0 0 0-.609 1.125l-.102.336a4.3 4.3 0 0 1-.805 1.492L26.5 21.32l1.29 1.18zm3.082 21.637a1.81 1.81 0 0 1-1.305.484 1.8 1.8 0 0 1-1.262-.578 1.824 1.824 0 0 1 .094-2.574 1.8 1.8 0 0 1 1.301-.484 1.8 1.8 0 0 1 1.266.578 1.83 1.83 0 0 1-.094 2.574M24.1 20.996c-.906-.848-1.36-2.1-1.156-3.316a6.05 6.05 0 0 0-1.527-5.094 6 6 0 0 0-4.852-1.906.376.376 0 0 0-.246.63l2.742 2.965a1.46 1.46 0 0 1-.074 2.051l-2.492 2.324c-.28.262-.656.402-1.04.387a1.44 1.44 0 0 1-1.008-.461l-2.734-2.953a.37.37 0 0 0-.387-.102.37.37 0 0 0-.262.305c-.25 1.773.273 3.648 1.6 5.035a6.01 6.01 0 0 0 4.836 1.852 3.75 3.75 0 0 1 3.215 1.398L32.5 38.828c1.38 1.484 3.7 1.566 5.18.19s1.563-3.72.19-5.2zm0 0"})]}),V8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",viewBox:"0 0 50 50",children:[p.jsx("path",{fill:"#AB6993",d:"M31.523 28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H31.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04c-.242-.45-.367-.895-.367-2.117V31.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04.45-.242.895-.367 2.117-.367zm0-28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H31.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04c-.242-.45-.367-.895-.367-2.117V3.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04C29.855.125 30.3 0 31.523 0m-28 28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H3.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04C.125 48.145 0 47.7 0 46.477V31.523c0-1.223.13-1.668.367-2.117.234-.44.598-.805 1.04-1.04.45-.242.895-.367 2.117-.367zm0-28h14.953c1.223 0 1.668.13 2.117.367.44.234.805.598 1.04 1.04.242.45.367.895.367 2.117v14.953c0 1.223-.13 1.668-.367 2.117-.234.44-.598-.805-1.04 1.04-.45.242-.895-.367-2.117-.367H3.523c-1.223 0-1.668-.13-2.117-.367a2.52 2.52 0 0 1-1.04-1.04C.125 20.145 0 19.7 0 18.477V3.523C0 2.3.13 1.852.367 1.406A2.56 2.56 0 0 1 1.406.367C1.855.13 2.3 0 3.523 0m0 0"}),p.jsx("path",{fill:"#FFF",d:"M10.34 14.27V9.33H8.664c-.43 0-.664-.156-.664-.687 0-.484.262-.613.938-.742l.48-.105C10.86 7.48 10.457 6 11.566 6c.418 0 .754.184.754.883v7.387c0 .676-.258 1.14-.988 1.14s-.988-.465-.988-1.14zm27.31-.668h3.902c.492 0 .855.234.855.816s-.363.82-.96.82H36.57c-.754 0-1.066-.508-1.066-.96 0-.926.82-1.953 2.445-2.977 1.81-1.145 2.43-1.38 2.43-2.434 0-.848-.648-1.313-1.363-1.313-.832 0-1.39.34-1.676 1.38-.133.48-.3.727-.82.727-.535 0-.95-.22-.95-.87 0-1.586 1.56-2.8 3.47-2.8 2.082 0 3.316 1.367 3.316 2.563 0 1.73-.793 2.398-2.172 3.184-1.47.832-2.363 1.367-2.535 1.86zM7.5 41.664a.88.88 0 0 1 .922-.91c1.156 0 .535 1.598 2.328 1.598.977 0 1.5-.598 1.5-1.402 0-.625-.273-1.082-1.172-1.172-.363-.04-1.078-.102-1.078-.703 0-.676.39-.816 1.133-.855.648-.04.988-.418.988-1.016 0-.777-.613-1.145-1.3-1.145-1.574 0-1.21 1.484-2.234 1.484-.445 0-.87-.2-.87-.78 0-1.586 1.883-2.262 3.145-2.262 2.25 0 3.082 1.262 3.082 2.523 0 .832-.38 1.43-1.102 1.82.977.27 1.39 1.05 1.39 2.027 0 2.055-1.586 3.04-3.508 3.04-2.445 0-3.21-1.52-3.21-2.246zm31.75-1.484v-3.367h-.023l-2.512 3.367zm0 2.824v-1.34h-3.262c-.676 0-.988-.48-.988-.898 0-.336.078-.547.246-.766l4.004-5.137c.2-.258.48-.363.852-.363.703 0 .973.38.973.938v4.75h.652c.44 0 .727.31.727.738s-.285.742-.727.742h-.652v1.34c0 .547-.23.9-.9.9s-.906-.363-.906-.9zm0 0"})]}),E_=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 14H10v-3.5h1.5v3.5zm3.5 0h-1.5v-3.5H15v3.5zm3.5 0h-1.5V9H17v7zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"})}),O8=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 48 48",children:[p.jsx("path",{fill:"#AB6993",d:"M7.68 0h32.64c2.671 0 3.673.25 4.591.835a4.9 4.9 0 0 1 2.254 2.254C47.666 4.09 48 5.009 48 7.68v32.64c0 2.671-.25 3.673-.835 4.591a4.9 4.9 0 0 1-2.254 2.254c-1.001.501-1.92.835-4.591.835H7.68c-2.671 0-3.673-.25-4.591-.835-.919-.584-1.753-1.252-2.254-2.254C.334 43.91 0 42.991 0 40.32V7.68c0-2.671.25-3.673.835-4.591A4.9 4.9 0 0 1 3.089.835C4.007.25 5.009 0 7.68 0"}),p.jsx("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M20.8 14.4h7.68c1.792 0 2.688 0 3.373.349a3.2 3.2 0 0 1 1.398 1.398c.349.685.349 1.58.349 3.373v7.68M8 14.4h6.4m19.2 19.2V40m6.4-6.4H19.52c-1.792 0-2.688 0-3.373-.349a3.2 3.2 0 0 1-1.398-1.398c-.349-.685-.349-1.58-.349-3.373V8"}),p.jsx("path",{stroke:"#F2E7EF",strokeLinecap:"round",strokeWidth:"2",d:"M19.5 20h5m-5 4h9m-9 4h9"})]}),U8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-6.364-.386l1.591-1.591M3 12h2.25m.386-6.364l1.591 1.591M12 12a4.5 4.5 0 000 9 4.5 4.5 0 000-9z"})}),B8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"})}),z8=({className:n})=>p.jsxs("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("path",{d:"M16.75,13.96C17,14.23 17,14.89 16.74,15.82C16.45,16.82 15.3,17.5 15.06,17.56C14.82,17.62 12.06,18.5 9.38,15.89C6.7,13.28 5.8,10.5 5.86,10.26C5.92,10.02 6.53,8.73 7.3,7.96C7.58,7.68 7.82,7.67 8,7.67C8.18,7.67 8.35,7.67 8.5,7.67C8.65,7.67 8.79,7.72 8.95,8.03C9.11,8.34 9.53,9.45 9.59,9.58C9.65,9.71 9.7,9.81 9.62,9.97C9.54,10.13 9.42,10.23 9.27,10.39C9.12,10.54 9,10.68 8.86,10.82C8.72,10.96 8.59,11.11 8.75,11.39C8.91,11.67 9.43,12.24 10.15,13.12C11.11,14.03 11.9,14.34 12.2,14.45C12.5,14.56 12.68,14.53 12.85,14.35C13.02,14.17 13.33,13.78 13.53,13.51C13.73,13.24 13.95,13.2 14.15,13.26C14.35,13.32 15.45,13.85 15.7,13.96C15.95,14.07 16.11,14.11 16.19,14.2C16.27,14.29 16.5,14.53 16.75,13.96Z",fillRule:"evenodd",clipRule:"evenodd"}),p.jsx("path",{d:"M12,2C6.48,2 2,6.48 2,12C2,14.08 2.59,16.03 3.61,17.69L2,22L6.45,20.44C7.99,21.41 9.8,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2ZM12,20C10.04,20 8.18,19.43 6.64,18.4L6.28,18.18L4.07,18.84L4.75,16.68L4.5,16.32C3.58,14.83 3,13.04 3,12C3,7.03 7.03,3 12,3C16.97,3 21,7.03 21,12C21,16.97 16.97,20 12,20Z",fillRule:"evenodd",clipRule:"evenodd"})]}),j8=({className:n})=>p.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.989C18.343 21.128 22 16.991 22 12z"})}),q8=({className:n})=>p.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M21.582,6.186c-0.23-0.86-0.908-1.538-1.768-1.768C18.267,4,12,4,12,4S5.733,4,4.186,4.418 c-0.86,0.23-1.538,0.908-1.768,1.768C2,7.733,2,12,2,12s0,4.267,0.418,5.814c0.23,0.86,0.908,1.538,1.768,1.768 C5.733,20,12,20,12,20s6.267,0,7.814-0.418c0.861-0.23,1.538-0.908,1.768-1.768C22,16.267,22,12,22,12S22,7.733,21.582,6.186z M10,15.464V8.536L16,12L10,15.464z"})}),H8=({className:n})=>p.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.378.203 2.397.1 2.65.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.942.359.308.678.92.678 1.852 0 1.336-.012 2.415-.012 2.741 0 .268.18.578.688.48A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z"})}),XJ=({className:n})=>p.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M19 3a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h14zm-11 6H5v10h3V9zM6.5 6.732a1.732 1.732 0 100-3.464 1.732 1.732 0 000 3.464zM18 19h-3v-4.74c0-1.42-.6-1.927-1.421-1.927-.927 0-1.25.734-1.455 1.313-.075.207-.095.49-.095.772V19h-3V9h3v1.322c.49-.781 1.2-1.322 2.754-1.322C17.388 9 18 10.59 18 13.236V19z"})}),QJ=({className:n})=>p.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),$n=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),mC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2 .01 7z"})}),G8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),xy=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})}),$8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})}),gC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 13c-2.67 0-8 1.34-8 4v1h16v-1c0-2.66-5.33-4-8-4z"})}),yC=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[p.jsx("circle",{cx:"12",cy:"12",r:"3.2"}),p.jsx("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})]}),Ty=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"})}),vC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})}),gh=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),ZJ=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"})}),Ey=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Ay=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L8 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1h-2v-2h2c.55 0 1-.45 1-1V8h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})}),gd=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),eX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),tX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M18 6h-2c0-2.21-1.79-4-4-4S8 3.79 8 6H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-6-2c1.1 0 2 .9 2 2h-4c0-1.1.9-2 2-2zm6 16H6V8h2v2c0 .55.45 1 1 1s1-.45 1-1V8h4v2c0 .55.45 1 1 1s1-.45 1-1V8h2v12z"})}),Mc=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),W8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M17.4,14.63c-1.63,0-2.85,1.06-3.57,2.11-.79-1.21-2.22-2.11-3.83-2.11-2.08,0-3.83,1.66-3.83,4.43,0,2.44,1.3,5.19,3.16,6.94,1,.95,2.16,1.99,3.67,1.99,1.51,0,2.39-1,3.67-1.99,1.86-1.75,3.16-4.5,3.16-6.94,0-2.77-1.75-4.43-3.83-4.43M12,1.75c1.78,0,3.37.8,4.2,2.1-1.12.7-2.7,1.15-4.2,1.15-1.5,0-3.08"})}),wC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9.21 15.5l1.41-1.41L12 15.5l1.38-1.38L14.79 15.5H19v-5l-3.5-4.5-2.5 3.01L9.17 6H5v9.5h4.21z"})}),_C=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 14h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2zm-4 8H7v-2h2v2zm0-4H7v-2h2v2zm0-4H7V7h2v2z"})}),K8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9.5 11.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5-1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm3.5 0c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5-1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm3.5 0c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5-1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"})}),Y8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9.5 15.5v-1.5H8v-1.5h1.5V11h1.5v1.5h1.5v1.5h-1.5v1.5H9.5zm6.5-1.5h-3v-4.5h3v4.5zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"})}),bC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"})}),yh=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5-1.17 0-2.39.15-3.5.5v14c1.11.35 2.33.5 3.5.5 1.95 0 4.05-.4 5.5-1.5 1.45 1.1 3.55 1.5 5.5 1.5 1.17 0 2.39-.15 3.5-.5V5zm-5.5 8.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"})}),xC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 20H5V6h14v14zM5 4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H5zm2 4h10v2H7V8zm0 4h10v2H7v-2zm0 4h5v2H7v-2z"})}),J8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1z"})}),X8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-2 6h-2v2h2v2h-2v2h-2v-2h2v-2h-2v-2h2v-2h-2V8h2v2h2v2z"})}),TC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zM10 4h4v2h-4V4zm10 15H4V8h16v11z"})}),Q8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V5H6c-1.1 0-2 .9-2 2v4H2.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5H4v4c0 1.1.9 2 2 2h4v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h4c1.1 0 2-.9 2-2v-4h1.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5z"})}),EC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M1 21h12v2H1zM5.24 8.07l2.83-2.83 14.14 14.14-2.83 2.83zM12.32 1l5.66 5.66-2.83 2.83-5.66-5.66z"})}),wf=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),Z8=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"})}),va=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),nX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),eO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-.96.73-1.66 2.2-1.66 1.51 0 2.15.68 2.22 1.55H15c-.07-1.44-1.12-2.43-3-2.43-1.96 0-3.43 1.1-3.43 2.73 0 1.45 1.1 2.38 3.19 2.88 2.1.51 2.83 1.25 2.83 2.31 0 1.05-.8 1.8-2.34 1.8-1.74 0-2.52-.84-2.6-1.8H9.3c.1 1.76 1.52 2.8 3.7 2.8 2.1 0 3.62-1.03 3.62-2.73 0-1.45-1.1-2.38-3.19-2.88z"})}),iX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21.94,10.51a1,1,0,0,0-1,.1,8.06,8.06,0,0,1-1.3,1,1,1,0,0,0-.43,1,8.06,8.06,0,0,1-.43,1.52,1,1,0,1,0,1.88.68,10.33,10.33,0,0,0,.43-1.6,10.22,10.22,0,0,0,1.29-1.2,1,1,0,0,0-.44-1.5ZM12.29,18.52a1,1,0,0,0-1.08-.2,8.43,8.43,0,0,1-1.53.54,1,1,0,0,0-.54,1,8.2,8.2,0,0,1-.09,1.6,1,1,0,0,0,1,1,1,1,0,0,0,1-.89,10,10,0,0,0,.09-1.87,10.15,10.15,0,0,0,1.58-.61A1,1,0,0,0,12.29,18.52ZM19.7,5.32a1,1,0,0,0-1.17.48,8.22,8.22,0,0,1-1.2,1.28,1,1,0,0,0-.2,1.08,8.22,8.22,0,0,1-.61,1.58,1,1,0,1,0,1.83.78,10,10,0,0,0,.7-1.8,10.3,10.3,0,0,0,1.11-1.42A1,1,0,0,0,19.7,5.32ZM12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm5.5,13.91a1,1,0,0,0-1.12-.55,8.3,8.3,0,0,1-1.6.09,1,1,0,0,0-1,.54,8.3,8.3,0,0,1-1.28,1.2,1,1,0,1,0,1.42,1.42,10.15,10.15,0,0,0,1.42-1.11A10.33,10.33,0,0,0,17.91,16,1,1,0,0,0,17.5,15.91ZM9.49,4.41a1,1,0,0,0-1.12.55,8.3,8.3,0,0,1-1.6-.09,1,1,0,0,0-1-.54,8.3,8.3,0,0,1-1.28-1.2,1,1,0,0,0-1.42,1.42A10.15,10.15,0,0,0,4.18,6,10.33,10.33,0,0,0,6,7.41,1,1,0,0,0,7.5,6.59ZM5.5,9.41a1,1,0,0,0-1.12.55,8.3,8.3,0,0,1-1.6-.09,1,1,0,0,0-1,.54,8.3,8.3,0,0,1-1.28,1.2,1,1,0,1,0,1.42,1.42A10.15,10.15,0,0,0,3.18,12,10.33,10.33,0,0,0,5,13.41,1,1,0,0,0,6.5,12.59Z"})}),sX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C9.25 2 7 4.25 7 7c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2 0-2.75-2.25-5-5-5zm-3.5 8C6.02 10 4 12.02 4 14.5S6.02 19 8.5 19H9v2c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-2h.5c2.48 0 4.5-2.02 4.5-4.5S17.98 10 15.5 10h-7z"})}),tO=({className:n})=>p.jsxs("svg",{className:n,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),AC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),rX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),oX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3 10H9v-2h8v2zm-4-4H9V6h4v4z"})}),aX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"})}),lX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z"})}),cX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6h-6z"})}),uX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})}),dX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zM16 19H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zM18 3H6v4h12V3z"})}),hX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M15.6 10.79c.97-1.07 1.5-2.5 1.5-4.04 0-3.87-3.13-7-7-7H6v18h5.78c3.54 0 6.22-2.79 6.22-6.21 0-2.34-1.21-4.33-3-5.46zM10 5.5h2.78c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5H10V5.5zm3.18 11H10v-5h3.18c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5z"})}),fX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"})}),pX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"})}),mX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M17 1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 18H7V5h10v14zM8 6h8v2H8V6zm0 3h8v2H8V9z"})}),gX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12zM6 6h12v2H6V6zm0 3h12v2H6V9z"})}),yX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M22 3H2v18h20V3zM12 19H4v-2h8v2zm6 0h-4v-2h4v2zm2-4H4v-2h16v2zm0-4H4V9h16v2zm0-4H4V5h16v2z"})}),vX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),wX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),_X=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})}),nO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM13 21h8v-8h-8v8zm2-6h4v4h-4v-4z"})}),bX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41s-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"})}),xX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"})}),iO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M8 11h2.55v2.55H8zM13.45 11h2.55v2.55h-2.55zM8 5.45h2.55v2.55H8zM13.45 5.45h2.55v2.55h-2.55zM22 2H2v20h20V2zm-4 16H6v-4h12v4zm0-6H6V8h12v4z"})}),IC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})}),vh=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})}),TX=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[p.jsx("path",{d:"M0 0h24v24H0z",fill:"none"}),p.jsx("path",{d:"M6 20.25l-6-10.5h7l6 10.5z",fill:"#0066da"}),p.jsx("path",{d:"M12 20.25l6-10.5h7l-6 10.5z",fill:"#ffde00"}),p.jsx("path",{d:"M25 9.75l-6-10.5h-7l6 10.5z",fill:"#00aa47"})]}),EX=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[p.jsx("path",{d:"M0 0h24v24H0z",fill:"none"}),p.jsx("path",{d:"M3.75 6L9 2.25 14.25 6 9 9.75zm0 12L9 14.25 14.25 18 9 21.75zm16.5-12L15 2.25 9.75 6 15 9.75zm-5.25 3L9 8.25 3.75 12 9 15.75z"})]}),AX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),Ki=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})}),sO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12z"})}),A_=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),rO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),CC=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z"})}),oO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"})}),_f=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:p.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),aO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:p.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})}),lO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"})}),IX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M9 16h6v-6h4l-8-8-8 8h4v6zm-4 2h14v2H5v-2z"})}),CX=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("circle",{cx:"6",cy:"6",r:"3"}),p.jsx("circle",{cx:"18",cy:"18",r:"3"}),p.jsx("path",{d:"M6 9v6a3 3 0 0 0 3 3h6"})]}),SX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5-4H7V4h9v14z"})}),cO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M16 1H8C6.34 1 5 2.34 5 4v16c0 1.66 1.34 3 3 3h8c1.66 0 3-1.34 3-3V4c0-1.66-1.34-1-3-1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5-4H7V4h10v14zM9.5 5.5h-1v1h1v-1zm1.5 0h1v1h-1v-1z"})}),PX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 2H4C2.9 2 2 2.9 2 4v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM4 15V4h16v11H4zM12 18H2v2h20v-2h-10z"})}),kX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M3 3h8.5v8.5H3zm9.5 0v8.5H21V3zM3 12.5h8.5V21H3zm9.5 0V21H21v-8.5z"})}),uO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:p.jsx("path",{d:"M12 4l-6 6h12l-6-6zm0 16l6-6H6l6 6z"})}),RX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:p.jsx("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm-1 12h-2v2H9v-2H7v-2h2V9h2v2h2v2z"})}),dO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10z"})}),ic=n=>p.jsx("svg",{...n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),hO=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),fO=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[p.jsx("path",{d:"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm-1 16H6V5h12v14z"}),p.jsx("path",{d:"M8 9h8v2H8zM8 13h5v2H8z"}),p.jsx("path",{d:"M1 7h2v10H1z"})]}),NX=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 1C6.48 1 2 5.48 2 11v7c0 1.66 1.34 3 3 3h1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4v-2c0-4.41 3.59-8 8-8s8 3.59 8 8v2h-2c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h1c1.66 0 3-1.34 3-3v-1h-1.5c-.83 0-1.5-.67-1.5-1.5v-3c0-.83.67-1.5 1.5-1.5H22V11c0-5.52-4.48-10-10-10zm0 2c3.54 0 6.43 2.61 6.92 6H5.08C5.57 5.61 8.46 3 12 3z"})}),hu=80,pO=.5,mO=({children:n})=>{const[e,t]=P.useState(null),[i,s]=P.useState(0),[r,o]=P.useState(!1),a=/iPhone|iPad|iPod/i.test(navigator.userAgent),l=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;if(!a||!l)return p.jsx(p.Fragment,{children:n});const c=x=>{window.scrollY===0&&!r&&t(x.touches[0].clientY)},u=x=>{if(e===null||r)return;let S=x.touches[0].clientY-e;S>0?(window.scrollY===0&&x.preventDefault(),s(S*pO)):(t(null),s(0))},f=()=>{e===null||r||(i>hu?(o(!0),setTimeout(()=>{window.location.reload()},500)):(t(null),s(0)))};P.useEffect(()=>()=>{t(null),s(0),o(!1)},[]);const m={transform:i>0||r?`translateY(${r?hu:i}px)`:"none",transition:e===null&&!r?"transform 0.3s":"none"},y=Math.min(i/hu,1)*360,v=Math.min(i/hu,1),_={opacity:r?1:v,transform:`rotate(${r?0:y}deg)`,transition:"opacity 0.2s"};return p.jsxs("div",{onTouchStart:c,onTouchMove:u,onTouchEnd:f,style:m,children:[p.jsx("div",{className:"absolute top-0 left-0 right-0 h-20 flex items-center justify-center -translate-y-full pointer-events-none","aria-hidden":"true",children:p.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-full shadow-lg flex items-center justify-center",style:_,children:p.jsx(xy,{className:`h-6 w-6 text-brand-red ${r?"animate-spin":""}`})})}),n]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gO,yO;function vO(){return{geminiUrl:gO,vertexUrl:yO}}function wO(n,e,t,i){var s,r;if(!n?.baseUrl){const o=vO();return e?(s=o.vertexUrl)!==null&&s!==void 0?s:t:(r=o.geminiUrl)!==null&&r!==void 0?r:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jr{}function ue(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function h(n,e,t){for(let r=0;r<e.length-1;r++){const o=e[r];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let c=0;c<l.length;c++){const u=l[c];h(u,e.slice(r+1),t[c])}else for(const c of l)h(c,e.slice(r+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];h(l[0],e.slice(r+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else n[i]=t}function d(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const i=e[t];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in n){const r=n[s];return Array.isArray(r)?r.map(o=>d(o,e.slice(t+1))):void 0}else return}else n=n[i]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zp(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var I_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(I_||(I_={}));var C_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(C_||(C_={}));var fs;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(fs||(fs={}));var S_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(S_||(S_={}));var P_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(P_||(P_={}));var k_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(k_||(k_={}));var R_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(R_||(R_={}));var N_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(N_||(N_={}));var M_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(M_||(M_={}));var D_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(D_||(D_={}));var L_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(L_||(L_={}));var F_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(F_||(F_={}));var V_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(V_||(V_={}));var O_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(O_||(O_={}));var U_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(U_||(U_={}));var yd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(yd||(yd={}));var B_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(B_||(B_={}));var em;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(em||(em={}));var z_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(z_||(z_={}));var j_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(j_||(j_={}));var q_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(q_||(q_={}));var H_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(H_||(H_={}));var G_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(G_||(G_={}));var $_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})($_||($_={}));var W_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(W_||(W_={}));var K_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(K_||(K_={}));var Y_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Y_||(Y_={}));var J_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(J_||(J_={}));var X_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(X_||(X_={}));var Q_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Q_||(Q_={}));var Z_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Z_||(Z_={}));var eb;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(eb||(eb={}));var tb;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(tb||(tb={}));var nb;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(nb||(nb={}));var ib;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(ib||(ib={}));var sb;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(sb||(sb={}));var rb;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(rb||(rb={}));var ob;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ob||(ob={}));var ab;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(ab||(ab={}));var lb;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(lb||(lb={}));var cb;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(cb||(cb={}));var ub;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(ub||(ub={}));var db;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(db||(db={}));var hb;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(hb||(hb={}));var yo;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(yo||(yo={}));class tm{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ya{get text(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",u=!1;const f=[];for(const m of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[y,v]of Object.entries(m))y!=="text"&&y!=="thought"&&(v!==null||v!==void 0)&&f.push(y);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;u=!0,c+=m.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?c:void 0}get data(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const u=[];for(const f of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,y]of Object.entries(f))m!=="inlineData"&&(y!==null||y!==void 0)&&u.push(m);f.inlineData&&typeof f.inlineData.data=="string"&&(c+=atob(f.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if(c?.length!==0)return c}get executableCode(){var e,t,i,s,r,o,a,l,c;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if(u?.length!==0)return(c=u?.[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,i,s,r,o,a,l,c;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if(u?.length!==0)return(c=u?.[0])===null||c===void 0?void 0:c.output}}class fb{}class pb{}class _O{}class bO{}class xO{}class TO{}class mb{}class gb{}class yb{}class EO{}class vb{}class wb{}class _b{}class bb{}class AO{}class IO{}class CO{}class xb{}class SO{get text(){var e,t,i;let s="",r=!1;const o=[];for(const a of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[l,c]of Object.entries(a))l!=="text"&&l!=="thought"&&c!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;r=!0,s+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,t,i;let s="";const r=[];for(const o of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&r.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class vd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new vd;if(i.name=e.name,i.metadata=e.metadata,i.done=e.done,i.error=e.error,t){const s=e.response;if(s){const r=new vb,o=s.videos;r.generatedVideos=o?.map(a=>({video:{uri:a.gcsUri,videoBytes:a.bytesBase64Encoded?Zp(a.bytesBase64Encoded):void 0,mimeType:a.mimeType}})),r.raiMediaFilteredCount=s.raiMediaFilteredCount,r.raiMediaFilteredReasons=s.raiMediaFilteredReasons,i.response=r}}else{const s=e.response;if(s){const r=new vb,o=s.generateVideoResponse,a=o?.generatedSamples;r.generatedVideos=a?.map(l=>{const c=l.video;return{video:{uri:c?.uri,videoBytes:c?.encodedVideo?Zp(c?.encodedVideo):void 0,mimeType:l.encoding}}}),r.raiMediaFilteredCount=o?.raiMediaFilteredCount,r.raiMediaFilteredReasons=o?.raiMediaFilteredReasons,i.response=r}}return i}}class PO{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ze(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function SC(n,e){const t=ze(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function PC(n){return Array.isArray(n)?n.map(e=>wd(e)):[wd(n)]}function wd(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function kC(n){const e=wd(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function RC(n){const e=wd(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Tb(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function NC(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>Tb(e)):[Tb(n)]}function nm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Eb(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function Ab(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Zt(n){if(n==null)throw new Error("ContentUnion is required");return nm(n)?n:{role:"user",parts:NC(n)}}function MC(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Zt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Zt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Zt(t)):[Zt(e)]}function On(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Eb(n)||Ab(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zt(n)]}const e=[],t=[],i=nm(n[0]);for(const s of n){const r=nm(s);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(Eb(s)||Ab(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:NC(t)}),e}function kO(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(fs).includes(t[0].toUpperCase())?t[0].toUpperCase():fs.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(fs).includes(i.toUpperCase())?i.toUpperCase():fs.TYPE_UNSPECIFIED})}}function Io(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=n.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,n=r[1]):r[1].type==="null"&&(e.nullable=!0,n=r[0])),n.type instanceof Array&&kO(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(fs).includes(a.toUpperCase())?a.toUpperCase():fs.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Io(a);else if(i.includes(o)){const l=[];for(const c of a){if(c.type=="null"){e.nullable=!0;continue}l.push(Io(c))}e[o]=l}else if(s.includes(o)){const l={};for(const[c,u]of Object.entries(a))l[c]=Io(u);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Iy(n){return Io(n)}function Cy(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Sy(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function wa(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Io(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Io(e.response));return n}function _a(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function RO(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Yi(n,e){if(typeof e!="string")throw new Error("name must be a string");return RO(n,e,"cachedContents")}function DC(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function qr(n){return Zp(n)}function NO(n){return n!=null&&typeof n=="object"&&"name"in n}function MO(n){return n!=null&&typeof n=="object"&&"video"in n}function DO(n){return n!=null&&typeof n=="object"&&"uri"in n}function LC(n){var e;let t;if(NO(n)&&(t=n.name),!(DO(n)&&(t=n.uri,t===void 0))&&!(MO(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function FC(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function VC(n){for(const e of["models","tunedModels","publisherModels"])if(LO(n,e))return n[e];return[]}function LO(n,e){return n!==null&&typeof n=="object"&&e in n}function FO(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function VO(n,e={}){const t=[],i=new Set;for(const s of n){const r=s.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const o=FO(s,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function OC(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function OO(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ba(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function UC(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UO(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function BO(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function zO(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function jO(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],UO(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],BO(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],zO(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function BC(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>jO(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function qO(n){const e={},t=d(n,["anyOf"]);t!=null&&h(e,["anyOf"],t);const i=d(n,["default"]);i!=null&&h(e,["default"],i);const s=d(n,["description"]);s!=null&&h(e,["description"],s);const r=d(n,["enum"]);r!=null&&h(e,["enum"],r);const o=d(n,["example"]);o!=null&&h(e,["example"],o);const a=d(n,["format"]);a!=null&&h(e,["format"],a);const l=d(n,["items"]);l!=null&&h(e,["items"],l);const c=d(n,["maxItems"]);c!=null&&h(e,["maxItems"],c);const u=d(n,["maxLength"]);u!=null&&h(e,["maxLength"],u);const f=d(n,["maxProperties"]);f!=null&&h(e,["maxProperties"],f);const m=d(n,["maximum"]);m!=null&&h(e,["maximum"],m);const y=d(n,["minItems"]);y!=null&&h(e,["minItems"],y);const v=d(n,["minLength"]);v!=null&&h(e,["minLength"],v);const _=d(n,["minProperties"]);_!=null&&h(e,["minProperties"],_);const x=d(n,["minimum"]);x!=null&&h(e,["minimum"],x);const T=d(n,["nullable"]);T!=null&&h(e,["nullable"],T);const S=d(n,["pattern"]);S!=null&&h(e,["pattern"],S);const C=d(n,["properties"]);C!=null&&h(e,["properties"],C);const D=d(n,["propertyOrdering"]);D!=null&&h(e,["propertyOrdering"],D);const F=d(n,["required"]);F!=null&&h(e,["required"],F);const V=d(n,["title"]);V!=null&&h(e,["title"],V);const I=d(n,["type"]);return I!=null&&h(e,["type"],I),e}function HO(n){const e={};if(d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=d(n,["category"]);t!=null&&h(e,["category"],t);const i=d(n,["threshold"]);return i!=null&&h(e,["threshold"],i),e}function GO(n){const e={},t=d(n,["behavior"]);t!=null&&h(e,["behavior"],t);const i=d(n,["description"]);i!=null&&h(e,["description"],i);const s=d(n,["name"]);s!=null&&h(e,["name"],s);const r=d(n,["parameters"]);r!=null&&h(e,["parameters"],r);const o=d(n,["parametersJsonSchema"]);o!=null&&h(e,["parametersJsonSchema"],o);const a=d(n,["response"]);a!=null&&h(e,["response"],a);const l=d(n,["responseJsonSchema"]);return l!=null&&h(e,["responseJsonSchema"],l),e}function $O(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function WO(n){const e={},t=d(n,["timeRangeFilter"]);if(t!=null&&h(e,["timeRangeFilter"],$O(t)),d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function KO(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function YO(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],KO(t)),e}function JO(){return{}}function XO(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function QO(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>GO(c))),h(e,["functionDeclarations"],l)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearch"]);i!=null&&h(e,["googleSearch"],WO(i));const s=d(n,["googleSearchRetrieval"]);if(s!=null&&h(e,["googleSearchRetrieval"],YO(s)),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(n,["urlContext"])!=null&&h(e,["urlContext"],JO());const o=d(n,["computerUse"]);o!=null&&h(e,["computerUse"],XO(o));const a=d(n,["codeExecution"]);return a!=null&&h(e,["codeExecution"],a),e}function ZO(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);return i!=null&&h(e,["allowedFunctionNames"],i),e}function e7(n){const e={},t=d(n,["latitude"]);t!=null&&h(e,["latitude"],t);const i=d(n,["longitude"]);return i!=null&&h(e,["longitude"],i),e}function t7(n){const e={},t=d(n,["latLng"]);t!=null&&h(e,["latLng"],e7(t));const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function n7(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&h(e,["functionCallingConfig"],ZO(t));const i=d(n,["retrievalConfig"]);return i!=null&&h(e,["retrievalConfig"],t7(i)),e}function i7(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function zC(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],i7(t)),e}function s7(n){const e={},t=d(n,["speaker"]);t!=null&&h(e,["speaker"],t);const i=d(n,["voiceConfig"]);return i!=null&&h(e,["voiceConfig"],zC(i)),e}function r7(n){const e={},t=d(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s7(s))),h(e,["speakerVoiceConfigs"],i)}return e}function o7(n){const e={},t=d(n,["voiceConfig"]);t!=null&&h(e,["voiceConfig"],zC(t));const i=d(n,["multiSpeakerVoiceConfig"]);i!=null&&h(e,["multiSpeakerVoiceConfig"],r7(i));const s=d(n,["languageCode"]);return s!=null&&h(e,["languageCode"],s),e}function a7(n){const e={},t=d(n,["includeThoughts"]);t!=null&&h(e,["includeThoughts"],t);const i=d(n,["thinkingBudget"]);return i!=null&&h(e,["thinkingBudget"],i),e}function l7(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&h(t,["systemInstruction"],BC(Zt(s)));const r=d(e,["temperature"]);r!=null&&h(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&h(i,["topP"],o);const a=d(e,["topK"]);a!=null&&h(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(i,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&h(i,["maxOutputTokens"],c);const u=d(e,["stopSequences"]);u!=null&&h(i,["stopSequences"],u);const f=d(e,["responseLogprobs"]);f!=null&&h(i,["responseLogprobs"],f);const m=d(e,["logprobs"]);m!=null&&h(i,["logprobs"],m);const y=d(e,["presencePenalty"]);y!=null&&h(i,["presencePenalty"],y);const v=d(e,["frequencyPenalty"]);v!=null&&h(i,["frequencyPenalty"],v);const _=d(e,["seed"]);_!=null&&h(i,["seed"],_);const x=d(e,["responseMimeType"]);x!=null&&h(i,["responseMimeType"],x);const T=d(e,["responseSchema"]);T!=null&&h(i,["responseSchema"],qO(Iy(T)));const S=d(e,["responseJsonSchema"]);if(S!=null&&h(i,["responseJsonSchema"],S),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(t!==void 0&&C!=null){let M=C;Array.isArray(M)&&(M=M.map(L=>HO(L))),h(t,["safetySettings"],M)}const D=d(e,["tools"]);if(t!==void 0&&D!=null){let M=_a(D);Array.isArray(M)&&(M=M.map(L=>QO(wa(L)))),h(t,["tools"],M)}const F=d(e,["toolConfig"]);if(t!==void 0&&F!=null&&h(t,["toolConfig"],n7(F)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const V=d(e,["cachedContent"]);t!==void 0&&V!=null&&h(t,["cachedContent"],Yi(n,V));const I=d(e,["responseModalities"]);I!=null&&h(i,["responseModalities"],I);const E=d(e,["mediaResolution"]);E!=null&&h(i,["mediaResolution"],E);const A=d(e,["speechConfig"]);if(A!=null&&h(i,["speechConfig"],o7(Cy(A))),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);return N!=null&&h(i,["thinkingConfig"],a7(N)),i}function c7(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["request","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>BC(a))),h(t,["request","contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["request","generationConfig"],l7(n,r,t)),t}function u7(n,e){const t={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=d(e,["fileName"]);i!=null&&h(t,["fileName"],i);const s=d(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>c7(n,o))),h(t,["requests","requests"],r)}return t}function d7(n,e){const t={},i=d(n,["displayName"]);if(e!==void 0&&i!=null&&h(e,["batch","displayName"],i),d(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Ib(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["src"]);s!=null&&h(t,["batch","inputConfig"],u7(n,OC(n,s)));const r=d(e,["config"]);return r!=null&&h(t,["config"],d7(r,t)),t}function h7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function f7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function p7(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);if(e!==void 0&&s!=null&&h(e,["_query","pageToken"],s),d(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function m7(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],p7(t,e)),e}function g7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function y7(n){const e={},t=d(n,["format"]);t!=null&&h(e,["instancesFormat"],t);const i=d(n,["gcsUri"]);i!=null&&h(e,["gcsSource","uris"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&h(e,["bigquerySource","inputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function v7(n){const e={},t=d(n,["format"]);t!=null&&h(e,["predictionsFormat"],t);const i=d(n,["gcsUri"]);i!=null&&h(e,["gcsDestination","outputUriPrefix"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&h(e,["bigqueryDestination","outputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function w7(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&h(e,["displayName"],i);const s=d(n,["dest"]);return e!==void 0&&s!=null&&h(e,["outputConfig"],v7(OO(s))),t}function _7(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["model"],ze(n,i));const s=d(e,["src"]);s!=null&&h(t,["inputConfig"],y7(OC(n,s)));const r=d(e,["config"]);return r!=null&&h(t,["config"],w7(r,t)),t}function b7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function x7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function T7(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const r=d(n,["filter"]);return e!==void 0&&r!=null&&h(e,["_query","filter"],r),t}function E7(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],T7(t,e)),e}function A7(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],ba(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function I7(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function C7(n){const e={},t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function S7(n){const e={},t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function P7(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],I7(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],C7(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],S7(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function k7(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>P7(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function R7(n){const e={},t=d(n,["citationSources"]);return t!=null&&h(e,["citations"],t),e}function N7(n){const e={},t=d(n,["retrievedUrl"]);t!=null&&h(e,["retrievedUrl"],t);const i=d(n,["urlRetrievalStatus"]);return i!=null&&h(e,["urlRetrievalStatus"],i),e}function M7(n){const e={},t=d(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>N7(s))),h(e,["urlMetadata"],i)}return e}function D7(n){const e={},t=d(n,["content"]);t!=null&&h(e,["content"],k7(t));const i=d(n,["citationMetadata"]);i!=null&&h(e,["citationMetadata"],R7(i));const s=d(n,["tokenCount"]);s!=null&&h(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&h(e,["finishReason"],r);const o=d(n,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],M7(o));const a=d(n,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=d(n,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const c=d(n,["index"]);c!=null&&h(e,["index"],c);const u=d(n,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(n,["safetyRatings"]);return f!=null&&h(e,["safetyRatings"],f),e}function L7(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>D7(c))),h(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&h(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function jC(n){const e={},t=d(n,["details"]);t!=null&&h(e,["details"],t);const i=d(n,["code"]);i!=null&&h(e,["code"],i);const s=d(n,["message"]);return s!=null&&h(e,["message"],s),e}function F7(n){const e={},t=d(n,["response"]);t!=null&&h(e,["response"],L7(t));const i=d(n,["error"]);return i!=null&&h(e,["error"],jC(i)),e}function V7(n){const e={},t=d(n,["responsesFile"]);t!=null&&h(e,["fileName"],t);const i=d(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>F7(r))),h(e,["inlinedResponses"],s)}return e}function Ou(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["metadata","displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["metadata","state"]);s!=null&&h(e,["state"],UC(s));const r=d(n,["metadata","createTime"]);r!=null&&h(e,["createTime"],r);const o=d(n,["metadata","endTime"]);o!=null&&h(e,["endTime"],o);const a=d(n,["metadata","updateTime"]);a!=null&&h(e,["updateTime"],a);const l=d(n,["metadata","model"]);l!=null&&h(e,["model"],l);const c=d(n,["metadata","output"]);return c!=null&&h(e,["dest"],V7(c)),e}function O7(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Ou(o))),h(e,["batchJobs"],r)}return e}function U7(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["done"]);s!=null&&h(e,["done"],s);const r=d(n,["error"]);return r!=null&&h(e,["error"],jC(r)),e}function qC(n){const e={},t=d(n,["details"]);t!=null&&h(e,["details"],t);const i=d(n,["code"]);i!=null&&h(e,["code"],i);const s=d(n,["message"]);return s!=null&&h(e,["message"],s),e}function B7(n){const e={},t=d(n,["instancesFormat"]);t!=null&&h(e,["format"],t);const i=d(n,["gcsSource","uris"]);i!=null&&h(e,["gcsUri"],i);const s=d(n,["bigquerySource","inputUri"]);return s!=null&&h(e,["bigqueryUri"],s),e}function z7(n){const e={},t=d(n,["predictionsFormat"]);t!=null&&h(e,["format"],t);const i=d(n,["gcsDestination","outputUriPrefix"]);i!=null&&h(e,["gcsUri"],i);const s=d(n,["bigqueryDestination","outputUri"]);return s!=null&&h(e,["bigqueryUri"],s),e}function im(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["state"]);s!=null&&h(e,["state"],UC(s));const r=d(n,["error"]);r!=null&&h(e,["error"],qC(r));const o=d(n,["createTime"]);o!=null&&h(e,["createTime"],o);const a=d(n,["startTime"]);a!=null&&h(e,["startTime"],a);const l=d(n,["endTime"]);l!=null&&h(e,["endTime"],l);const c=d(n,["updateTime"]);c!=null&&h(e,["updateTime"],c);const u=d(n,["model"]);u!=null&&h(e,["model"],u);const f=d(n,["inputConfig"]);f!=null&&h(e,["src"],B7(f));const m=d(n,["outputConfig"]);return m!=null&&h(e,["dest"],z7(m)),e}function j7(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>im(o))),h(e,["batchJobs"],r)}return e}function q7(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["done"]);s!=null&&h(e,["done"],s);const r=d(n,["error"]);return r!=null&&h(e,["error"],qC(r)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Mr||(Mr={}));class Dc{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(r=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H7 extends jr{constructor(e){super(),this.apiClient=e,this.create=async t=>{var i,s;if(this.apiClient.isVertexAI()){const o=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${o}`;else throw new Error("Unsupported source:"+t.src)}else if(Array.isArray(t.src)||typeof t.src!="string"&&t.src.inlinedRequests){let r="",o={};const a=Ib(this.apiClient,t);r=ue("{model}:batchGenerateContent",a._url),o=a._query;const u=a.batch.inputConfig.requests,f=u.requests,m=[];for(const v of f){const _=v;if(_.systemInstruction){const x=_.systemInstruction;delete _.systemInstruction;const T=_.request;T.systemInstruction=x,_.request=T}m.push(_)}return u.requests=m,delete a.config,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()).then(v=>Ou(v))}return await this.createInternal(t)},this.list=async(t={})=>new Dc(Mr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}async createInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=_7(this.apiClient,e);return a=ue("batchPredictionJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>im(u))}else{const c=Ib(this.apiClient,e);return a=ue("{model}:batchGenerateContent",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Ou(u))}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=b7(this.apiClient,e);return a=ue("batchPredictionJobs/{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>im(u))}else{const c=h7(this.apiClient,e);return a=ue("batches/{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Ou(u))}}async cancel(e){var t,i,s,r;let o="",a={};if(this.apiClient.isVertexAI()){const l=x7(this.apiClient,e);o=ue("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const l=f7(this.apiClient,e);o=ue("batches/{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=E7(e);return a=ue("batchPredictionJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=j7(u),m=new xb;return Object.assign(m,f),m})}else{const c=m7(e);return a=ue("batches",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=O7(u),m=new xb;return Object.assign(m,f),m})}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=A7(this.apiClient,e);return a=ue("batchPredictionJobs/{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>q7(u))}else{const c=g7(this.apiClient,e);return a=ue("batches/{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>U7(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G7(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function $7(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function W7(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function K7(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],G7(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],$7(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],W7(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function Cb(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>K7(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function Y7(n){const e={},t=d(n,["behavior"]);t!=null&&h(e,["behavior"],t);const i=d(n,["description"]);i!=null&&h(e,["description"],i);const s=d(n,["name"]);s!=null&&h(e,["name"],s);const r=d(n,["parameters"]);r!=null&&h(e,["parameters"],r);const o=d(n,["parametersJsonSchema"]);o!=null&&h(e,["parametersJsonSchema"],o);const a=d(n,["response"]);a!=null&&h(e,["response"],a);const l=d(n,["responseJsonSchema"]);return l!=null&&h(e,["responseJsonSchema"],l),e}function J7(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function X7(n){const e={},t=d(n,["timeRangeFilter"]);if(t!=null&&h(e,["timeRangeFilter"],J7(t)),d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Q7(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function Z7(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],Q7(t)),e}function eU(){return{}}function tU(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function nU(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>Y7(c))),h(e,["functionDeclarations"],l)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearch"]);i!=null&&h(e,["googleSearch"],X7(i));const s=d(n,["googleSearchRetrieval"]);if(s!=null&&h(e,["googleSearchRetrieval"],Z7(s)),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(n,["urlContext"])!=null&&h(e,["urlContext"],eU());const o=d(n,["computerUse"]);o!=null&&h(e,["computerUse"],tU(o));const a=d(n,["codeExecution"]);return a!=null&&h(e,["codeExecution"],a),e}function iU(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);return i!=null&&h(e,["allowedFunctionNames"],i),e}function sU(n){const e={},t=d(n,["latitude"]);t!=null&&h(e,["latitude"],t);const i=d(n,["longitude"]);return i!=null&&h(e,["longitude"],i),e}function rU(n){const e={},t=d(n,["latLng"]);t!=null&&h(e,["latLng"],sU(t));const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function oU(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&h(e,["functionCallingConfig"],iU(t));const i=d(n,["retrievalConfig"]);return i!=null&&h(e,["retrievalConfig"],rU(i)),e}function aU(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&h(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&h(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let u=On(o);Array.isArray(u)&&(u=u.map(f=>Cb(f))),h(e,["contents"],u)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Cb(Zt(a)));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(f=>nU(f))),h(e,["tools"],u)}const c=d(n,["toolConfig"]);if(e!==void 0&&c!=null&&h(e,["toolConfig"],oU(c)),d(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function lU(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["model"],SC(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],aU(s,t)),t}function cU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function uU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function dU(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&h(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&h(e,["expireTime"],s),t}function hU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],dU(s,t)),t}function fU(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&h(e,["_query","pageToken"],s),t}function pU(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],fU(t,e)),e}function mU(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function gU(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["data"]);i!=null&&h(e,["data"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function yU(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["fileUri"]);i!=null&&h(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function vU(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],mU(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],gU(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],yU(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function Sb(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>vU(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function wU(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&h(e,["description"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["parameters"]);s!=null&&h(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&h(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&h(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function _U(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function bU(n){const e={},t=d(n,["timeRangeFilter"]);t!=null&&h(e,["timeRangeFilter"],_U(t));const i=d(n,["excludeDomains"]);return i!=null&&h(e,["excludeDomains"],i),e}function xU(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function TU(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],xU(t)),e}function EU(n){const e={},t=d(n,["excludeDomains"]);return t!=null&&h(e,["excludeDomains"],t),e}function AU(n){const e={},t=d(n,["apiKeyString"]);return t!=null&&h(e,["apiKeyString"],t),e}function IU(n){const e={},t=d(n,["apiKeyConfig"]);t!=null&&h(e,["apiKeyConfig"],AU(t));const i=d(n,["authType"]);i!=null&&h(e,["authType"],i);const s=d(n,["googleServiceAccountConfig"]);s!=null&&h(e,["googleServiceAccountConfig"],s);const r=d(n,["httpBasicAuthConfig"]);r!=null&&h(e,["httpBasicAuthConfig"],r);const o=d(n,["oauthConfig"]);o!=null&&h(e,["oauthConfig"],o);const a=d(n,["oidcConfig"]);return a!=null&&h(e,["oidcConfig"],a),e}function CU(n){const e={},t=d(n,["authConfig"]);return t!=null&&h(e,["authConfig"],IU(t)),e}function SU(){return{}}function PU(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function kU(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(m=>wU(m))),h(e,["functionDeclarations"],f)}const i=d(n,["retrieval"]);i!=null&&h(e,["retrieval"],i);const s=d(n,["googleSearch"]);s!=null&&h(e,["googleSearch"],bU(s));const r=d(n,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],TU(r));const o=d(n,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],EU(o));const a=d(n,["googleMaps"]);a!=null&&h(e,["googleMaps"],CU(a)),d(n,["urlContext"])!=null&&h(e,["urlContext"],SU());const c=d(n,["computerUse"]);c!=null&&h(e,["computerUse"],PU(c));const u=d(n,["codeExecution"]);return u!=null&&h(e,["codeExecution"],u),e}function RU(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);return i!=null&&h(e,["allowedFunctionNames"],i),e}function NU(n){const e={},t=d(n,["latitude"]);t!=null&&h(e,["latitude"],t);const i=d(n,["longitude"]);return i!=null&&h(e,["longitude"],i),e}function MU(n){const e={},t=d(n,["latLng"]);t!=null&&h(e,["latLng"],NU(t));const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function DU(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&h(e,["functionCallingConfig"],RU(t));const i=d(n,["retrievalConfig"]);return i!=null&&h(e,["retrievalConfig"],MU(i)),e}function LU(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&h(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&h(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&h(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let f=On(o);Array.isArray(f)&&(f=f.map(m=>Sb(m))),h(e,["contents"],f)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&h(e,["systemInstruction"],Sb(Zt(a)));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>kU(m))),h(e,["tools"],f)}const c=d(n,["toolConfig"]);e!==void 0&&c!=null&&h(e,["toolConfig"],DU(c));const u=d(n,["kmsKeyName"]);return e!==void 0&&u!=null&&h(e,["encryption_spec","kmsKeyName"],u),t}function FU(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["model"],SC(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],LU(s,t)),t}function VU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function OU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function UU(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&h(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&h(e,["expireTime"],s),t}function BU(n,e){const t={},i=d(e,["name"]);i!=null&&h(t,["_url","name"],Yi(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],UU(s,t)),t}function zU(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&h(e,["_query","pageToken"],s),t}function jU(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],zU(t,e)),e}function Uu(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["model"]);s!=null&&h(e,["model"],s);const r=d(n,["createTime"]);r!=null&&h(e,["createTime"],r);const o=d(n,["updateTime"]);o!=null&&h(e,["updateTime"],o);const a=d(n,["expireTime"]);a!=null&&h(e,["expireTime"],a);const l=d(n,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function qU(){return{}}function HU(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Uu(o))),h(e,["cachedContents"],r)}return e}function Bu(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["model"]);s!=null&&h(e,["model"],s);const r=d(n,["createTime"]);r!=null&&h(e,["createTime"],r);const o=d(n,["updateTime"]);o!=null&&h(e,["updateTime"],o);const a=d(n,["expireTime"]);a!=null&&h(e,["expireTime"],a);const l=d(n,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function GU(){return{}}function $U(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Bu(o))),h(e,["cachedContents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WU extends jr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Dc(Mr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=FU(this.apiClient,e);return a=ue("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>Bu(u))}else{const c=lU(this.apiClient,e);return a=ue("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Uu(u))}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=VU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>Bu(u))}else{const c=cU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Uu(u))}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=OU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(()=>{const u=GU(),f=new _b;return Object.assign(f,u),f})}else{const c=uU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(()=>{const u=qU(),f=new _b;return Object.assign(f,u),f})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=BU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>Bu(u))}else{const c=hU(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Uu(u))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=jU(e);return a=ue("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=$U(u),m=new bb;return Object.assign(m,f),m})}else{const c=pU(e);return a=ue("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=HU(u),m=new bb;return Object.assign(m,f),m})}}}function Pb(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xe(n){return this instanceof Xe?(this.v=n,this):new Xe(n)}function Co(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(y){return function(v){return Promise.resolve(v).then(y,f)}}function a(y,v){i[y]&&(s[y]=function(_){return new Promise(function(x,T){r.push([y,_,x,T])>1||l(y,_)})},v&&(s[y]=v(s[y])))}function l(y,v){try{c(i[y](v))}catch(_){m(r[0][3],_)}}function c(y){y.value instanceof Xe?Promise.resolve(y.value.v).then(u,f):m(r[0][2],y)}function u(y){l("next",y)}function f(y){l("throw",y)}function m(y,v){y(v),r.shift(),r.length&&l(r[0][0],r[0][1])}}function Cl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Pb=="function"?Pb(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(c){r({value:c,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KU(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:HC(t)}function HC(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function YU(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function kb(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let r=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),r&&!HC(n[i])&&(r=!1),i++;r?e.push(...s):e.pop()}return e}class JU{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new XU(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class XU{constructor(e,t,i,s={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),YU(r)}async sendMessage(e){var t;await this.sendPromise;const i=Zt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,o,a;const l=await s,c=(o=(r=l.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content,u=l.automaticFunctionCallingHistory,f=this.getHistory(!0).length;let m=[];u!=null&&(m=(a=u.slice(f))!==null&&a!==void 0?a:[]);const y=c?[c]:[];this.recordHistory(i,y,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=Zt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,i)}getHistory(e=!1){const t=e?kb(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,s;return Co(this,arguments,function*(){var o,a,l,c;const u=[];try{for(var f=!0,m=Cl(e),y;y=yield Xe(m.next()),o=y.done,!o;f=!0){c=y.value,f=!1;const v=c;if(KU(v)){const _=(s=(i=v.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content;_!==void 0&&u.push(_)}yield yield Xe(v)}}catch(v){a={error:v}}finally{try{!f&&!o&&(l=m.return)&&(yield Xe(l.call(m)))}finally{if(a)throw a.error}}this.recordHistory(t,u)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(r=>r.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...kb(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,wh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QU(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&h(e,["_query","pageToken"],s),t}function ZU(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],QU(t,e)),e}function e9(n){const e={},t=d(n,["details"]);t!=null&&h(e,["details"],t);const i=d(n,["message"]);i!=null&&h(e,["message"],i);const s=d(n,["code"]);return s!=null&&h(e,["code"],s),e}function t9(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["mimeType"]);s!=null&&h(e,["mimeType"],s);const r=d(n,["sizeBytes"]);r!=null&&h(e,["sizeBytes"],r);const o=d(n,["createTime"]);o!=null&&h(e,["createTime"],o);const a=d(n,["expirationTime"]);a!=null&&h(e,["expirationTime"],a);const l=d(n,["updateTime"]);l!=null&&h(e,["updateTime"],l);const c=d(n,["sha256Hash"]);c!=null&&h(e,["sha256Hash"],c);const u=d(n,["uri"]);u!=null&&h(e,["uri"],u);const f=d(n,["downloadUri"]);f!=null&&h(e,["downloadUri"],f);const m=d(n,["state"]);m!=null&&h(e,["state"],m);const y=d(n,["source"]);y!=null&&h(e,["source"],y);const v=d(n,["videoMetadata"]);v!=null&&h(e,["videoMetadata"],v);const _=d(n,["error"]);return _!=null&&h(e,["error"],e9(_)),e}function n9(n){const e={},t=d(n,["file"]);t!=null&&h(e,["file"],t9(t));const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function i9(n){const e={},t=d(n,["name"]);t!=null&&h(e,["_url","file"],LC(t));const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function s9(n){const e={},t=d(n,["name"]);t!=null&&h(e,["_url","file"],LC(t));const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function r9(n){const e={},t=d(n,["details"]);t!=null&&h(e,["details"],t);const i=d(n,["message"]);i!=null&&h(e,["message"],i);const s=d(n,["code"]);return s!=null&&h(e,["code"],s),e}function sm(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["mimeType"]);s!=null&&h(e,["mimeType"],s);const r=d(n,["sizeBytes"]);r!=null&&h(e,["sizeBytes"],r);const o=d(n,["createTime"]);o!=null&&h(e,["createTime"],o);const a=d(n,["expirationTime"]);a!=null&&h(e,["expirationTime"],a);const l=d(n,["updateTime"]);l!=null&&h(e,["updateTime"],l);const c=d(n,["sha256Hash"]);c!=null&&h(e,["sha256Hash"],c);const u=d(n,["uri"]);u!=null&&h(e,["uri"],u);const f=d(n,["downloadUri"]);f!=null&&h(e,["downloadUri"],f);const m=d(n,["state"]);m!=null&&h(e,["state"],m);const y=d(n,["source"]);y!=null&&h(e,["source"],y);const v=d(n,["videoMetadata"]);v!=null&&h(e,["videoMetadata"],v);const _=d(n,["error"]);return _!=null&&h(e,["error"],r9(_)),e}function o9(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>sm(o))),h(e,["files"],r)}return e}function a9(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&h(e,["sdkHttpResponse"],t),e}function l9(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c9 extends jr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Dc(Mr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>sm(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ZU(e);return r=ue("files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>{const c=o9(l),u=new AO;return Object.assign(u,c),u})}}async createInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=n9(e);return r=ue("upload/v1beta/files",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const c=a9(l),u=new IO;return Object.assign(u,c),u})}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=i9(e);return r=ue("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>sm(l))}}async delete(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=s9(e);return r=ue("files/{file}",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(()=>{const l=l9(),c=new CO;return Object.assign(c,l),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u9(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function GC(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],u9(t)),e}function d9(n){const e={},t=d(n,["speaker"]);t!=null&&h(e,["speaker"],t);const i=d(n,["voiceConfig"]);return i!=null&&h(e,["voiceConfig"],GC(i)),e}function h9(n){const e={},t=d(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>d9(s))),h(e,["speakerVoiceConfigs"],i)}return e}function f9(n){const e={},t=d(n,["voiceConfig"]);t!=null&&h(e,["voiceConfig"],GC(t));const i=d(n,["multiSpeakerVoiceConfig"]);i!=null&&h(e,["multiSpeakerVoiceConfig"],h9(i));const s=d(n,["languageCode"]);return s!=null&&h(e,["languageCode"],s),e}function p9(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function m9(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function g9(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function y9(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],p9(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],m9(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],g9(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function v9(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>y9(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function w9(n){const e={},t=d(n,["behavior"]);t!=null&&h(e,["behavior"],t);const i=d(n,["description"]);i!=null&&h(e,["description"],i);const s=d(n,["name"]);s!=null&&h(e,["name"],s);const r=d(n,["parameters"]);r!=null&&h(e,["parameters"],r);const o=d(n,["parametersJsonSchema"]);o!=null&&h(e,["parametersJsonSchema"],o);const a=d(n,["response"]);a!=null&&h(e,["response"],a);const l=d(n,["responseJsonSchema"]);return l!=null&&h(e,["responseJsonSchema"],l),e}function _9(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function b9(n){const e={},t=d(n,["timeRangeFilter"]);if(t!=null&&h(e,["timeRangeFilter"],_9(t)),d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function x9(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function T9(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],x9(t)),e}function E9(){return{}}function A9(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function I9(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>w9(c))),h(e,["functionDeclarations"],l)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearch"]);i!=null&&h(e,["googleSearch"],b9(i));const s=d(n,["googleSearchRetrieval"]);if(s!=null&&h(e,["googleSearchRetrieval"],T9(s)),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(n,["urlContext"])!=null&&h(e,["urlContext"],E9());const o=d(n,["computerUse"]);o!=null&&h(e,["computerUse"],A9(o));const a=d(n,["codeExecution"]);return a!=null&&h(e,["codeExecution"],a),e}function C9(n){const e={},t=d(n,["handle"]);if(t!=null&&h(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Rb(){return{}}function S9(n){const e={},t=d(n,["disabled"]);t!=null&&h(e,["disabled"],t);const i=d(n,["startOfSpeechSensitivity"]);i!=null&&h(e,["startOfSpeechSensitivity"],i);const s=d(n,["endOfSpeechSensitivity"]);s!=null&&h(e,["endOfSpeechSensitivity"],s);const r=d(n,["prefixPaddingMs"]);r!=null&&h(e,["prefixPaddingMs"],r);const o=d(n,["silenceDurationMs"]);return o!=null&&h(e,["silenceDurationMs"],o),e}function P9(n){const e={},t=d(n,["automaticActivityDetection"]);t!=null&&h(e,["automaticActivityDetection"],S9(t));const i=d(n,["activityHandling"]);i!=null&&h(e,["activityHandling"],i);const s=d(n,["turnCoverage"]);return s!=null&&h(e,["turnCoverage"],s),e}function k9(n){const e={},t=d(n,["targetTokens"]);return t!=null&&h(e,["targetTokens"],t),e}function R9(n){const e={},t=d(n,["triggerTokens"]);t!=null&&h(e,["triggerTokens"],t);const i=d(n,["slidingWindow"]);return i!=null&&h(e,["slidingWindow"],k9(i)),e}function N9(n){const e={},t=d(n,["proactiveAudio"]);return t!=null&&h(e,["proactiveAudio"],t),e}function M9(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(n,["mediaResolution"]);e!==void 0&&c!=null&&h(e,["setup","generationConfig","mediaResolution"],c);const u=d(n,["seed"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","seed"],u);const f=d(n,["speechConfig"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","speechConfig"],f9(Sy(f)));const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&h(e,["setup","systemInstruction"],v9(Zt(y)));const v=d(n,["tools"]);if(e!==void 0&&v!=null){let F=_a(v);Array.isArray(F)&&(F=F.map(V=>I9(wa(V)))),h(e,["setup","tools"],F)}const _=d(n,["sessionResumption"]);e!==void 0&&_!=null&&h(e,["setup","sessionResumption"],C9(_));const x=d(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],Rb());const T=d(n,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],Rb());const S=d(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],P9(S));const C=d(n,["contextWindowCompression"]);e!==void 0&&C!=null&&h(e,["setup","contextWindowCompression"],R9(C));const D=d(n,["proactivity"]);return e!==void 0&&D!=null&&h(e,["setup","proactivity"],N9(D)),t}function D9(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["setup","model"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],M9(s,t)),t}function L9(){return{}}function F9(){return{}}function V9(n){const e={},t=d(n,["media"]);t!=null&&h(e,["mediaChunks"],PC(t));const i=d(n,["audio"]);i!=null&&h(e,["audio"],RC(i));const s=d(n,["audioStreamEnd"]);s!=null&&h(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&h(e,["video"],kC(r));const o=d(n,["text"]);return o!=null&&h(e,["text"],o),d(n,["activityStart"])!=null&&h(e,["activityStart"],L9()),d(n,["activityEnd"])!=null&&h(e,["activityEnd"],F9()),e}function $C(n){const e={},t=d(n,["text"]);t!=null&&h(e,["text"],t);const i=d(n,["weight"]);return i!=null&&h(e,["weight"],i),e}function O9(n){const e={},t=d(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>$C(s))),h(e,["weightedPrompts"],i)}return e}function WC(n){const e={},t=d(n,["temperature"]);t!=null&&h(e,["temperature"],t);const i=d(n,["topK"]);i!=null&&h(e,["topK"],i);const s=d(n,["seed"]);s!=null&&h(e,["seed"],s);const r=d(n,["guidance"]);r!=null&&h(e,["guidance"],r);const o=d(n,["bpm"]);o!=null&&h(e,["bpm"],o);const a=d(n,["density"]);a!=null&&h(e,["density"],a);const l=d(n,["brightness"]);l!=null&&h(e,["brightness"],l);const c=d(n,["scale"]);c!=null&&h(e,["scale"],c);const u=d(n,["muteBass"]);u!=null&&h(e,["muteBass"],u);const f=d(n,["muteDrums"]);f!=null&&h(e,["muteDrums"],f);const m=d(n,["onlyBassAndDrums"]);m!=null&&h(e,["onlyBassAndDrums"],m);const y=d(n,["musicGenerationMode"]);return y!=null&&h(e,["musicGenerationMode"],y),e}function U9(n){const e={},t=d(n,["musicGenerationConfig"]);return t!=null&&h(e,["musicGenerationConfig"],WC(t)),e}function KC(n){const e={},t=d(n,["model"]);return t!=null&&h(e,["model"],t),e}function YC(n){const e={},t=d(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>$C(s))),h(e,["weightedPrompts"],i)}return e}function rm(n){const e={},t=d(n,["setup"]);t!=null&&h(e,["setup"],KC(t));const i=d(n,["clientContent"]);i!=null&&h(e,["clientContent"],YC(i));const s=d(n,["musicGenerationConfig"]);s!=null&&h(e,["musicGenerationConfig"],WC(s));const r=d(n,["playbackControl"]);return r!=null&&h(e,["playbackControl"],r),e}function B9(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function z9(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],B9(t)),e}function j9(n){const e={},t=d(n,["voiceConfig"]);if(t!=null&&h(e,["voiceConfig"],z9(t)),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function q9(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function H9(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["data"]);i!=null&&h(e,["data"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function G9(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["fileUri"]);i!=null&&h(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function $9(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],q9(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],H9(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],G9(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function W9(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>$9(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function K9(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&h(e,["description"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["parameters"]);s!=null&&h(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&h(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&h(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function Y9(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function J9(n){const e={},t=d(n,["timeRangeFilter"]);t!=null&&h(e,["timeRangeFilter"],Y9(t));const i=d(n,["excludeDomains"]);return i!=null&&h(e,["excludeDomains"],i),e}function X9(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function Q9(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],X9(t)),e}function Z9(n){const e={},t=d(n,["excludeDomains"]);return t!=null&&h(e,["excludeDomains"],t),e}function eB(n){const e={},t=d(n,["apiKeyString"]);return t!=null&&h(e,["apiKeyString"],t),e}function tB(n){const e={},t=d(n,["apiKeyConfig"]);t!=null&&h(e,["apiKeyConfig"],eB(t));const i=d(n,["authType"]);i!=null&&h(e,["authType"],i);const s=d(n,["googleServiceAccountConfig"]);s!=null&&h(e,["googleServiceAccountConfig"],s);const r=d(n,["httpBasicAuthConfig"]);r!=null&&h(e,["httpBasicAuthConfig"],r);const o=d(n,["oauthConfig"]);o!=null&&h(e,["oauthConfig"],o);const a=d(n,["oidcConfig"]);return a!=null&&h(e,["oidcConfig"],a),e}function nB(n){const e={},t=d(n,["authConfig"]);return t!=null&&h(e,["authConfig"],tB(t)),e}function iB(){return{}}function sB(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function rB(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(m=>K9(m))),h(e,["functionDeclarations"],f)}const i=d(n,["retrieval"]);i!=null&&h(e,["retrieval"],i);const s=d(n,["googleSearch"]);s!=null&&h(e,["googleSearch"],J9(s));const r=d(n,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],Q9(r));const o=d(n,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],Z9(o));const a=d(n,["googleMaps"]);a!=null&&h(e,["googleMaps"],nB(a)),d(n,["urlContext"])!=null&&h(e,["urlContext"],iB());const c=d(n,["computerUse"]);c!=null&&h(e,["computerUse"],sB(c));const u=d(n,["codeExecution"]);return u!=null&&h(e,["codeExecution"],u),e}function oB(n){const e={},t=d(n,["handle"]);t!=null&&h(e,["handle"],t);const i=d(n,["transparent"]);return i!=null&&h(e,["transparent"],i),e}function Nb(){return{}}function aB(n){const e={},t=d(n,["disabled"]);t!=null&&h(e,["disabled"],t);const i=d(n,["startOfSpeechSensitivity"]);i!=null&&h(e,["startOfSpeechSensitivity"],i);const s=d(n,["endOfSpeechSensitivity"]);s!=null&&h(e,["endOfSpeechSensitivity"],s);const r=d(n,["prefixPaddingMs"]);r!=null&&h(e,["prefixPaddingMs"],r);const o=d(n,["silenceDurationMs"]);return o!=null&&h(e,["silenceDurationMs"],o),e}function lB(n){const e={},t=d(n,["automaticActivityDetection"]);t!=null&&h(e,["automaticActivityDetection"],aB(t));const i=d(n,["activityHandling"]);i!=null&&h(e,["activityHandling"],i);const s=d(n,["turnCoverage"]);return s!=null&&h(e,["turnCoverage"],s),e}function cB(n){const e={},t=d(n,["targetTokens"]);return t!=null&&h(e,["targetTokens"],t),e}function uB(n){const e={},t=d(n,["triggerTokens"]);t!=null&&h(e,["triggerTokens"],t);const i=d(n,["slidingWindow"]);return i!=null&&h(e,["slidingWindow"],cB(i)),e}function dB(n){const e={},t=d(n,["proactiveAudio"]);return t!=null&&h(e,["proactiveAudio"],t),e}function hB(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(n,["mediaResolution"]);e!==void 0&&c!=null&&h(e,["setup","generationConfig","mediaResolution"],c);const u=d(n,["seed"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","seed"],u);const f=d(n,["speechConfig"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","speechConfig"],j9(Sy(f)));const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&h(e,["setup","systemInstruction"],W9(Zt(y)));const v=d(n,["tools"]);if(e!==void 0&&v!=null){let F=_a(v);Array.isArray(F)&&(F=F.map(V=>rB(wa(V)))),h(e,["setup","tools"],F)}const _=d(n,["sessionResumption"]);e!==void 0&&_!=null&&h(e,["setup","sessionResumption"],oB(_));const x=d(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],Nb());const T=d(n,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],Nb());const S=d(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],lB(S));const C=d(n,["contextWindowCompression"]);e!==void 0&&C!=null&&h(e,["setup","contextWindowCompression"],uB(C));const D=d(n,["proactivity"]);return e!==void 0&&D!=null&&h(e,["setup","proactivity"],dB(D)),t}function fB(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["setup","model"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],hB(s,t)),t}function pB(){return{}}function mB(){return{}}function gB(n){const e={},t=d(n,["media"]);t!=null&&h(e,["mediaChunks"],PC(t));const i=d(n,["audio"]);i!=null&&h(e,["audio"],RC(i));const s=d(n,["audioStreamEnd"]);s!=null&&h(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&h(e,["video"],kC(r));const o=d(n,["text"]);return o!=null&&h(e,["text"],o),d(n,["activityStart"])!=null&&h(e,["activityStart"],pB()),d(n,["activityEnd"])!=null&&h(e,["activityEnd"],mB()),e}function yB(){return{}}function vB(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function wB(n){const e={},t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function _B(n){const e={},t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function bB(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],vB(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],wB(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],_B(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function xB(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>bB(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function Mb(n){const e={},t=d(n,["text"]);t!=null&&h(e,["text"],t);const i=d(n,["finished"]);return i!=null&&h(e,["finished"],i),e}function TB(n){const e={},t=d(n,["retrievedUrl"]);t!=null&&h(e,["retrievedUrl"],t);const i=d(n,["urlRetrievalStatus"]);return i!=null&&h(e,["urlRetrievalStatus"],i),e}function EB(n){const e={},t=d(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>TB(s))),h(e,["urlMetadata"],i)}return e}function AB(n){const e={},t=d(n,["modelTurn"]);t!=null&&h(e,["modelTurn"],xB(t));const i=d(n,["turnComplete"]);i!=null&&h(e,["turnComplete"],i);const s=d(n,["interrupted"]);s!=null&&h(e,["interrupted"],s);const r=d(n,["groundingMetadata"]);r!=null&&h(e,["groundingMetadata"],r);const o=d(n,["generationComplete"]);o!=null&&h(e,["generationComplete"],o);const a=d(n,["inputTranscription"]);a!=null&&h(e,["inputTranscription"],Mb(a));const l=d(n,["outputTranscription"]);l!=null&&h(e,["outputTranscription"],Mb(l));const c=d(n,["urlContextMetadata"]);return c!=null&&h(e,["urlContextMetadata"],EB(c)),e}function IB(n){const e={},t=d(n,["id"]);t!=null&&h(e,["id"],t);const i=d(n,["args"]);i!=null&&h(e,["args"],i);const s=d(n,["name"]);return s!=null&&h(e,["name"],s),e}function CB(n){const e={},t=d(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>IB(s))),h(e,["functionCalls"],i)}return e}function SB(n){const e={},t=d(n,["ids"]);return t!=null&&h(e,["ids"],t),e}function fu(n){const e={},t=d(n,["modality"]);t!=null&&h(e,["modality"],t);const i=d(n,["tokenCount"]);return i!=null&&h(e,["tokenCount"],i),e}function PB(n){const e={},t=d(n,["promptTokenCount"]);t!=null&&h(e,["promptTokenCount"],t);const i=d(n,["cachedContentTokenCount"]);i!=null&&h(e,["cachedContentTokenCount"],i);const s=d(n,["responseTokenCount"]);s!=null&&h(e,["responseTokenCount"],s);const r=d(n,["toolUsePromptTokenCount"]);r!=null&&h(e,["toolUsePromptTokenCount"],r);const o=d(n,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=d(n,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=d(n,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(y=>fu(y))),h(e,["promptTokensDetails"],m)}const c=d(n,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(y=>fu(y))),h(e,["cacheTokensDetails"],m)}const u=d(n,["responseTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(y=>fu(y))),h(e,["responseTokensDetails"],m)}const f=d(n,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(y=>fu(y))),h(e,["toolUsePromptTokensDetails"],m)}return e}function kB(n){const e={},t=d(n,["timeLeft"]);return t!=null&&h(e,["timeLeft"],t),e}function RB(n){const e={},t=d(n,["newHandle"]);t!=null&&h(e,["newHandle"],t);const i=d(n,["resumable"]);i!=null&&h(e,["resumable"],i);const s=d(n,["lastConsumedClientMessageIndex"]);return s!=null&&h(e,["lastConsumedClientMessageIndex"],s),e}function NB(n){const e={};d(n,["setupComplete"])!=null&&h(e,["setupComplete"],yB());const i=d(n,["serverContent"]);i!=null&&h(e,["serverContent"],AB(i));const s=d(n,["toolCall"]);s!=null&&h(e,["toolCall"],CB(s));const r=d(n,["toolCallCancellation"]);r!=null&&h(e,["toolCallCancellation"],SB(r));const o=d(n,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],PB(o));const a=d(n,["goAway"]);a!=null&&h(e,["goAway"],kB(a));const l=d(n,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],RB(l)),e}function MB(){return{}}function DB(n){const e={},t=d(n,["text"]);t!=null&&h(e,["text"],t);const i=d(n,["weight"]);return i!=null&&h(e,["weight"],i),e}function LB(n){const e={},t=d(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>DB(s))),h(e,["weightedPrompts"],i)}return e}function FB(n){const e={},t=d(n,["temperature"]);t!=null&&h(e,["temperature"],t);const i=d(n,["topK"]);i!=null&&h(e,["topK"],i);const s=d(n,["seed"]);s!=null&&h(e,["seed"],s);const r=d(n,["guidance"]);r!=null&&h(e,["guidance"],r);const o=d(n,["bpm"]);o!=null&&h(e,["bpm"],o);const a=d(n,["density"]);a!=null&&h(e,["density"],a);const l=d(n,["brightness"]);l!=null&&h(e,["brightness"],l);const c=d(n,["scale"]);c!=null&&h(e,["scale"],c);const u=d(n,["muteBass"]);u!=null&&h(e,["muteBass"],u);const f=d(n,["muteDrums"]);f!=null&&h(e,["muteDrums"],f);const m=d(n,["onlyBassAndDrums"]);m!=null&&h(e,["onlyBassAndDrums"],m);const y=d(n,["musicGenerationMode"]);return y!=null&&h(e,["musicGenerationMode"],y),e}function VB(n){const e={},t=d(n,["clientContent"]);t!=null&&h(e,["clientContent"],LB(t));const i=d(n,["musicGenerationConfig"]);return i!=null&&h(e,["musicGenerationConfig"],FB(i)),e}function OB(n){const e={},t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);i!=null&&h(e,["mimeType"],i);const s=d(n,["sourceMetadata"]);return s!=null&&h(e,["sourceMetadata"],VB(s)),e}function UB(n){const e={},t=d(n,["audioChunks"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>OB(s))),h(e,["audioChunks"],i)}return e}function BB(n){const e={},t=d(n,["text"]);t!=null&&h(e,["text"],t);const i=d(n,["filteredReason"]);return i!=null&&h(e,["filteredReason"],i),e}function zB(n){const e={};d(n,["setupComplete"])!=null&&h(e,["setupComplete"],MB());const i=d(n,["serverContent"]);i!=null&&h(e,["serverContent"],UB(i));const s=d(n,["filteredPrompt"]);return s!=null&&h(e,["filteredPrompt"],BB(s)),e}function jB(n){const e={},t=d(n,["sessionId"]);return t!=null&&h(e,["sessionId"],t),e}function qB(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function HB(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["data"]);i!=null&&h(e,["data"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function GB(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["fileUri"]);i!=null&&h(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function $B(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],qB(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],HB(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],GB(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function WB(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>$B(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function Db(n){const e={},t=d(n,["text"]);t!=null&&h(e,["text"],t);const i=d(n,["finished"]);return i!=null&&h(e,["finished"],i),e}function KB(n){const e={},t=d(n,["modelTurn"]);t!=null&&h(e,["modelTurn"],WB(t));const i=d(n,["turnComplete"]);i!=null&&h(e,["turnComplete"],i);const s=d(n,["interrupted"]);s!=null&&h(e,["interrupted"],s);const r=d(n,["groundingMetadata"]);r!=null&&h(e,["groundingMetadata"],r);const o=d(n,["generationComplete"]);o!=null&&h(e,["generationComplete"],o);const a=d(n,["inputTranscription"]);a!=null&&h(e,["inputTranscription"],Db(a));const l=d(n,["outputTranscription"]);return l!=null&&h(e,["outputTranscription"],Db(l)),e}function YB(n){const e={},t=d(n,["args"]);t!=null&&h(e,["args"],t);const i=d(n,["name"]);return i!=null&&h(e,["name"],i),e}function JB(n){const e={},t=d(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>YB(s))),h(e,["functionCalls"],i)}return e}function XB(n){const e={},t=d(n,["ids"]);return t!=null&&h(e,["ids"],t),e}function pu(n){const e={},t=d(n,["modality"]);t!=null&&h(e,["modality"],t);const i=d(n,["tokenCount"]);return i!=null&&h(e,["tokenCount"],i),e}function QB(n){const e={},t=d(n,["promptTokenCount"]);t!=null&&h(e,["promptTokenCount"],t);const i=d(n,["cachedContentTokenCount"]);i!=null&&h(e,["cachedContentTokenCount"],i);const s=d(n,["candidatesTokenCount"]);s!=null&&h(e,["responseTokenCount"],s);const r=d(n,["toolUsePromptTokenCount"]);r!=null&&h(e,["toolUsePromptTokenCount"],r);const o=d(n,["thoughtsTokenCount"]);o!=null&&h(e,["thoughtsTokenCount"],o);const a=d(n,["totalTokenCount"]);a!=null&&h(e,["totalTokenCount"],a);const l=d(n,["promptTokensDetails"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(v=>pu(v))),h(e,["promptTokensDetails"],y)}const c=d(n,["cacheTokensDetails"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(v=>pu(v))),h(e,["cacheTokensDetails"],y)}const u=d(n,["candidatesTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(v=>pu(v))),h(e,["responseTokensDetails"],y)}const f=d(n,["toolUsePromptTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(v=>pu(v))),h(e,["toolUsePromptTokensDetails"],y)}const m=d(n,["trafficType"]);return m!=null&&h(e,["trafficType"],m),e}function ZB(n){const e={},t=d(n,["timeLeft"]);return t!=null&&h(e,["timeLeft"],t),e}function ez(n){const e={},t=d(n,["newHandle"]);t!=null&&h(e,["newHandle"],t);const i=d(n,["resumable"]);i!=null&&h(e,["resumable"],i);const s=d(n,["lastConsumedClientMessageIndex"]);return s!=null&&h(e,["lastConsumedClientMessageIndex"],s),e}function tz(n){const e={},t=d(n,["setupComplete"]);t!=null&&h(e,["setupComplete"],jB(t));const i=d(n,["serverContent"]);i!=null&&h(e,["serverContent"],KB(i));const s=d(n,["toolCall"]);s!=null&&h(e,["toolCall"],JB(s));const r=d(n,["toolCallCancellation"]);r!=null&&h(e,["toolCallCancellation"],XB(r));const o=d(n,["usageMetadata"]);o!=null&&h(e,["usageMetadata"],QB(o));const a=d(n,["goAway"]);a!=null&&h(e,["goAway"],ZB(a));const l=d(n,["sessionResumptionUpdate"]);return l!=null&&h(e,["sessionResumptionUpdate"],ez(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nz(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function iz(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function sz(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function rz(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],nz(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],iz(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],sz(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function _h(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>rz(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function oz(n){const e={},t=d(n,["anyOf"]);t!=null&&h(e,["anyOf"],t);const i=d(n,["default"]);i!=null&&h(e,["default"],i);const s=d(n,["description"]);s!=null&&h(e,["description"],s);const r=d(n,["enum"]);r!=null&&h(e,["enum"],r);const o=d(n,["example"]);o!=null&&h(e,["example"],o);const a=d(n,["format"]);a!=null&&h(e,["format"],a);const l=d(n,["items"]);l!=null&&h(e,["items"],l);const c=d(n,["maxItems"]);c!=null&&h(e,["maxItems"],c);const u=d(n,["maxLength"]);u!=null&&h(e,["maxLength"],u);const f=d(n,["maxProperties"]);f!=null&&h(e,["maxProperties"],f);const m=d(n,["maximum"]);m!=null&&h(e,["maximum"],m);const y=d(n,["minItems"]);y!=null&&h(e,["minItems"],y);const v=d(n,["minLength"]);v!=null&&h(e,["minLength"],v);const _=d(n,["minProperties"]);_!=null&&h(e,["minProperties"],_);const x=d(n,["minimum"]);x!=null&&h(e,["minimum"],x);const T=d(n,["nullable"]);T!=null&&h(e,["nullable"],T);const S=d(n,["pattern"]);S!=null&&h(e,["pattern"],S);const C=d(n,["properties"]);C!=null&&h(e,["properties"],C);const D=d(n,["propertyOrdering"]);D!=null&&h(e,["propertyOrdering"],D);const F=d(n,["required"]);F!=null&&h(e,["required"],F);const V=d(n,["title"]);V!=null&&h(e,["title"],V);const I=d(n,["type"]);return I!=null&&h(e,["type"],I),e}function az(n){const e={};if(d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=d(n,["category"]);t!=null&&h(e,["category"],t);const i=d(n,["threshold"]);return i!=null&&h(e,["threshold"],i),e}function lz(n){const e={},t=d(n,["behavior"]);t!=null&&h(e,["behavior"],t);const i=d(n,["description"]);i!=null&&h(e,["description"],i);const s=d(n,["name"]);s!=null&&h(e,["name"],s);const r=d(n,["parameters"]);r!=null&&h(e,["parameters"],r);const o=d(n,["parametersJsonSchema"]);o!=null&&h(e,["parametersJsonSchema"],o);const a=d(n,["response"]);a!=null&&h(e,["response"],a);const l=d(n,["responseJsonSchema"]);return l!=null&&h(e,["responseJsonSchema"],l),e}function cz(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function uz(n){const e={},t=d(n,["timeRangeFilter"]);if(t!=null&&h(e,["timeRangeFilter"],cz(t)),d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function dz(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function hz(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],dz(t)),e}function fz(){return{}}function pz(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function mz(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>lz(c))),h(e,["functionDeclarations"],l)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearch"]);i!=null&&h(e,["googleSearch"],uz(i));const s=d(n,["googleSearchRetrieval"]);if(s!=null&&h(e,["googleSearchRetrieval"],hz(s)),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(n,["urlContext"])!=null&&h(e,["urlContext"],fz());const o=d(n,["computerUse"]);o!=null&&h(e,["computerUse"],pz(o));const a=d(n,["codeExecution"]);return a!=null&&h(e,["codeExecution"],a),e}function gz(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);return i!=null&&h(e,["allowedFunctionNames"],i),e}function yz(n){const e={},t=d(n,["latitude"]);t!=null&&h(e,["latitude"],t);const i=d(n,["longitude"]);return i!=null&&h(e,["longitude"],i),e}function vz(n){const e={},t=d(n,["latLng"]);t!=null&&h(e,["latLng"],yz(t));const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function wz(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&h(e,["functionCallingConfig"],gz(t));const i=d(n,["retrievalConfig"]);return i!=null&&h(e,["retrievalConfig"],vz(i)),e}function _z(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function JC(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],_z(t)),e}function bz(n){const e={},t=d(n,["speaker"]);t!=null&&h(e,["speaker"],t);const i=d(n,["voiceConfig"]);return i!=null&&h(e,["voiceConfig"],JC(i)),e}function xz(n){const e={},t=d(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>bz(s))),h(e,["speakerVoiceConfigs"],i)}return e}function Tz(n){const e={},t=d(n,["voiceConfig"]);t!=null&&h(e,["voiceConfig"],JC(t));const i=d(n,["multiSpeakerVoiceConfig"]);i!=null&&h(e,["multiSpeakerVoiceConfig"],xz(i));const s=d(n,["languageCode"]);return s!=null&&h(e,["languageCode"],s),e}function Ez(n){const e={},t=d(n,["includeThoughts"]);t!=null&&h(e,["includeThoughts"],t);const i=d(n,["thinkingBudget"]);return i!=null&&h(e,["thinkingBudget"],i),e}function Az(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&h(t,["systemInstruction"],_h(Zt(s)));const r=d(e,["temperature"]);r!=null&&h(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&h(i,["topP"],o);const a=d(e,["topK"]);a!=null&&h(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(i,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&h(i,["maxOutputTokens"],c);const u=d(e,["stopSequences"]);u!=null&&h(i,["stopSequences"],u);const f=d(e,["responseLogprobs"]);f!=null&&h(i,["responseLogprobs"],f);const m=d(e,["logprobs"]);m!=null&&h(i,["logprobs"],m);const y=d(e,["presencePenalty"]);y!=null&&h(i,["presencePenalty"],y);const v=d(e,["frequencyPenalty"]);v!=null&&h(i,["frequencyPenalty"],v);const _=d(e,["seed"]);_!=null&&h(i,["seed"],_);const x=d(e,["responseMimeType"]);x!=null&&h(i,["responseMimeType"],x);const T=d(e,["responseSchema"]);T!=null&&h(i,["responseSchema"],oz(Iy(T)));const S=d(e,["responseJsonSchema"]);if(S!=null&&h(i,["responseJsonSchema"],S),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(t!==void 0&&C!=null){let M=C;Array.isArray(M)&&(M=M.map(L=>az(L))),h(t,["safetySettings"],M)}const D=d(e,["tools"]);if(t!==void 0&&D!=null){let M=_a(D);Array.isArray(M)&&(M=M.map(L=>mz(wa(L)))),h(t,["tools"],M)}const F=d(e,["toolConfig"]);if(t!==void 0&&F!=null&&h(t,["toolConfig"],wz(F)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const V=d(e,["cachedContent"]);t!==void 0&&V!=null&&h(t,["cachedContent"],Yi(n,V));const I=d(e,["responseModalities"]);I!=null&&h(i,["responseModalities"],I);const E=d(e,["mediaResolution"]);E!=null&&h(i,["mediaResolution"],E);const A=d(e,["speechConfig"]);if(A!=null&&h(i,["speechConfig"],Tz(Cy(A))),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);return N!=null&&h(i,["thinkingConfig"],Ez(N)),i}function Lb(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>_h(a))),h(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["generationConfig"],Az(n,r,t)),t}function Iz(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&h(e,["requests[]","taskType"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&h(e,["requests[]","title"],s);const r=d(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&h(e,["requests[]","outputDimensionality"],r),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Cz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);s!=null&&h(t,["requests[]","content"],MC(n,s));const r=d(e,["config"]);r!=null&&h(t,["config"],Iz(r,t));const o=d(e,["model"]);return o!==void 0&&h(t,["requests[]","model"],ze(n,o)),t}function Sz(n,e){const t={};if(d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&h(e,["parameters","sampleCount"],i);const s=d(n,["aspectRatio"]);e!==void 0&&s!=null&&h(e,["parameters","aspectRatio"],s);const r=d(n,["guidanceScale"]);if(e!==void 0&&r!=null&&h(e,["parameters","guidanceScale"],r),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&h(e,["parameters","safetySetting"],o);const a=d(n,["personGeneration"]);e!==void 0&&a!=null&&h(e,["parameters","personGeneration"],a);const l=d(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&h(e,["parameters","includeSafetyAttributes"],l);const c=d(n,["includeRaiReason"]);e!==void 0&&c!=null&&h(e,["parameters","includeRaiReason"],c);const u=d(n,["language"]);e!==void 0&&u!=null&&h(e,["parameters","language"],u);const f=d(n,["outputMimeType"]);e!==void 0&&f!=null&&h(e,["parameters","outputOptions","mimeType"],f);const m=d(n,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&h(e,["parameters","outputOptions","compressionQuality"],m),d(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const y=d(n,["imageSize"]);if(e!==void 0&&y!=null&&h(e,["parameters","sampleImageSize"],y),d(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Pz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["prompt"]);s!=null&&h(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&h(t,["config"],Sz(r,t)),t}function kz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","name"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function Rz(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&h(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&h(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&h(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&h(t,["_url","models_url"],FC(n,a)),i}function Nz(n,e){const t={},i=d(e,["config"]);return i!=null&&h(t,["config"],Rz(n,i,t)),t}function Mz(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&h(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&h(e,["defaultCheckpointId"],r),t}function Dz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","name"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],Mz(s,t)),t}function Lz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","name"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function Fz(n){const e={};if(d(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Vz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>_h(a))),h(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["config"],Fz(r)),t}function Oz(n){const e={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=d(n,["imageBytes"]);t!=null&&h(e,["bytesBase64Encoded"],qr(t));const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Uz(n,e){const t={},i=d(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&h(e,["parameters","sampleCount"],i),d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=d(n,["durationSeconds"]);if(e!==void 0&&s!=null&&h(e,["parameters","durationSeconds"],s),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=d(n,["aspectRatio"]);if(e!==void 0&&r!=null&&h(e,["parameters","aspectRatio"],r),d(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const o=d(n,["personGeneration"]);if(e!==void 0&&o!=null&&h(e,["parameters","personGeneration"],o),d(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=d(n,["negativePrompt"]);e!==void 0&&a!=null&&h(e,["parameters","negativePrompt"],a);const l=d(n,["enhancePrompt"]);if(e!==void 0&&l!=null&&h(e,["parameters","enhancePrompt"],l),d(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(d(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(d(n,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(d(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Bz(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["prompt"]);s!=null&&h(t,["instances[0]","prompt"],s);const r=d(e,["image"]);if(r!=null&&h(t,["instances[0]","image"],Oz(r)),d(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const o=d(e,["config"]);return o!=null&&h(t,["config"],Uz(o,t)),t}function zz(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function jz(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["data"]);i!=null&&h(e,["data"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function qz(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["fileUri"]);i!=null&&h(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function Hz(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],zz(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],jz(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],qz(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function xa(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Hz(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function Gz(n){const e={},t=d(n,["anyOf"]);t!=null&&h(e,["anyOf"],t);const i=d(n,["default"]);i!=null&&h(e,["default"],i);const s=d(n,["description"]);s!=null&&h(e,["description"],s);const r=d(n,["enum"]);r!=null&&h(e,["enum"],r);const o=d(n,["example"]);o!=null&&h(e,["example"],o);const a=d(n,["format"]);a!=null&&h(e,["format"],a);const l=d(n,["items"]);l!=null&&h(e,["items"],l);const c=d(n,["maxItems"]);c!=null&&h(e,["maxItems"],c);const u=d(n,["maxLength"]);u!=null&&h(e,["maxLength"],u);const f=d(n,["maxProperties"]);f!=null&&h(e,["maxProperties"],f);const m=d(n,["maximum"]);m!=null&&h(e,["maximum"],m);const y=d(n,["minItems"]);y!=null&&h(e,["minItems"],y);const v=d(n,["minLength"]);v!=null&&h(e,["minLength"],v);const _=d(n,["minProperties"]);_!=null&&h(e,["minProperties"],_);const x=d(n,["minimum"]);x!=null&&h(e,["minimum"],x);const T=d(n,["nullable"]);T!=null&&h(e,["nullable"],T);const S=d(n,["pattern"]);S!=null&&h(e,["pattern"],S);const C=d(n,["properties"]);C!=null&&h(e,["properties"],C);const D=d(n,["propertyOrdering"]);D!=null&&h(e,["propertyOrdering"],D);const F=d(n,["required"]);F!=null&&h(e,["required"],F);const V=d(n,["title"]);V!=null&&h(e,["title"],V);const I=d(n,["type"]);return I!=null&&h(e,["type"],I),e}function $z(n){const e={},t=d(n,["featureSelectionPreference"]);return t!=null&&h(e,["featureSelectionPreference"],t),e}function Wz(n){const e={},t=d(n,["method"]);t!=null&&h(e,["method"],t);const i=d(n,["category"]);i!=null&&h(e,["category"],i);const s=d(n,["threshold"]);return s!=null&&h(e,["threshold"],s),e}function Kz(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&h(e,["description"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["parameters"]);s!=null&&h(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&h(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&h(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&h(e,["responseJsonSchema"],a),e}function Yz(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function Jz(n){const e={},t=d(n,["timeRangeFilter"]);t!=null&&h(e,["timeRangeFilter"],Yz(t));const i=d(n,["excludeDomains"]);return i!=null&&h(e,["excludeDomains"],i),e}function Xz(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function Qz(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],Xz(t)),e}function Zz(n){const e={},t=d(n,["excludeDomains"]);return t!=null&&h(e,["excludeDomains"],t),e}function ej(n){const e={},t=d(n,["apiKeyString"]);return t!=null&&h(e,["apiKeyString"],t),e}function tj(n){const e={},t=d(n,["apiKeyConfig"]);t!=null&&h(e,["apiKeyConfig"],ej(t));const i=d(n,["authType"]);i!=null&&h(e,["authType"],i);const s=d(n,["googleServiceAccountConfig"]);s!=null&&h(e,["googleServiceAccountConfig"],s);const r=d(n,["httpBasicAuthConfig"]);r!=null&&h(e,["httpBasicAuthConfig"],r);const o=d(n,["oauthConfig"]);o!=null&&h(e,["oauthConfig"],o);const a=d(n,["oidcConfig"]);return a!=null&&h(e,["oidcConfig"],a),e}function nj(n){const e={},t=d(n,["authConfig"]);return t!=null&&h(e,["authConfig"],tj(t)),e}function ij(){return{}}function sj(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function XC(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(m=>Kz(m))),h(e,["functionDeclarations"],f)}const i=d(n,["retrieval"]);i!=null&&h(e,["retrieval"],i);const s=d(n,["googleSearch"]);s!=null&&h(e,["googleSearch"],Jz(s));const r=d(n,["googleSearchRetrieval"]);r!=null&&h(e,["googleSearchRetrieval"],Qz(r));const o=d(n,["enterpriseWebSearch"]);o!=null&&h(e,["enterpriseWebSearch"],Zz(o));const a=d(n,["googleMaps"]);a!=null&&h(e,["googleMaps"],nj(a)),d(n,["urlContext"])!=null&&h(e,["urlContext"],ij());const c=d(n,["computerUse"]);c!=null&&h(e,["computerUse"],sj(c));const u=d(n,["codeExecution"]);return u!=null&&h(e,["codeExecution"],u),e}function rj(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);return i!=null&&h(e,["allowedFunctionNames"],i),e}function oj(n){const e={},t=d(n,["latitude"]);t!=null&&h(e,["latitude"],t);const i=d(n,["longitude"]);return i!=null&&h(e,["longitude"],i),e}function aj(n){const e={},t=d(n,["latLng"]);t!=null&&h(e,["latLng"],oj(t));const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function lj(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&h(e,["functionCallingConfig"],rj(t));const i=d(n,["retrievalConfig"]);return i!=null&&h(e,["retrievalConfig"],aj(i)),e}function cj(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function uj(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],cj(t)),e}function dj(n){const e={},t=d(n,["voiceConfig"]);if(t!=null&&h(e,["voiceConfig"],uj(t)),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=d(n,["languageCode"]);return i!=null&&h(e,["languageCode"],i),e}function hj(n){const e={},t=d(n,["includeThoughts"]);t!=null&&h(e,["includeThoughts"],t);const i=d(n,["thinkingBudget"]);return i!=null&&h(e,["thinkingBudget"],i),e}function fj(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&h(t,["systemInstruction"],xa(Zt(s)));const r=d(e,["temperature"]);r!=null&&h(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&h(i,["topP"],o);const a=d(e,["topK"]);a!=null&&h(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&h(i,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&h(i,["maxOutputTokens"],c);const u=d(e,["stopSequences"]);u!=null&&h(i,["stopSequences"],u);const f=d(e,["responseLogprobs"]);f!=null&&h(i,["responseLogprobs"],f);const m=d(e,["logprobs"]);m!=null&&h(i,["logprobs"],m);const y=d(e,["presencePenalty"]);y!=null&&h(i,["presencePenalty"],y);const v=d(e,["frequencyPenalty"]);v!=null&&h(i,["frequencyPenalty"],v);const _=d(e,["seed"]);_!=null&&h(i,["seed"],_);const x=d(e,["responseMimeType"]);x!=null&&h(i,["responseMimeType"],x);const T=d(e,["responseSchema"]);T!=null&&h(i,["responseSchema"],Gz(Iy(T)));const S=d(e,["responseJsonSchema"]);S!=null&&h(i,["responseJsonSchema"],S);const C=d(e,["routingConfig"]);C!=null&&h(i,["routingConfig"],C);const D=d(e,["modelSelectionConfig"]);D!=null&&h(i,["modelConfig"],$z(D));const F=d(e,["safetySettings"]);if(t!==void 0&&F!=null){let oe=F;Array.isArray(oe)&&(oe=oe.map(Y=>Wz(Y))),h(t,["safetySettings"],oe)}const V=d(e,["tools"]);if(t!==void 0&&V!=null){let oe=_a(V);Array.isArray(oe)&&(oe=oe.map(Y=>XC(wa(Y)))),h(t,["tools"],oe)}const I=d(e,["toolConfig"]);t!==void 0&&I!=null&&h(t,["toolConfig"],lj(I));const E=d(e,["labels"]);t!==void 0&&E!=null&&h(t,["labels"],E);const A=d(e,["cachedContent"]);t!==void 0&&A!=null&&h(t,["cachedContent"],Yi(n,A));const N=d(e,["responseModalities"]);N!=null&&h(i,["responseModalities"],N);const M=d(e,["mediaResolution"]);M!=null&&h(i,["mediaResolution"],M);const L=d(e,["speechConfig"]);L!=null&&h(i,["speechConfig"],dj(Cy(L)));const R=d(e,["audioTimestamp"]);R!=null&&h(i,["audioTimestamp"],R);const G=d(e,["thinkingConfig"]);return G!=null&&h(i,["thinkingConfig"],hj(G)),i}function Fb(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>xa(a))),h(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["generationConfig"],fj(n,r,t)),t}function pj(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&h(e,["instances[]","task_type"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&h(e,["instances[]","title"],s);const r=d(n,["outputDimensionality"]);e!==void 0&&r!=null&&h(e,["parameters","outputDimensionality"],r);const o=d(n,["mimeType"]);e!==void 0&&o!=null&&h(e,["instances[]","mimeType"],o);const a=d(n,["autoTruncate"]);return e!==void 0&&a!=null&&h(e,["parameters","autoTruncate"],a),t}function mj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);s!=null&&h(t,["instances[]","content"],MC(n,s));const r=d(e,["config"]);return r!=null&&h(t,["config"],pj(r,t)),t}function gj(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&h(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const c=d(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&h(e,["parameters","safetySetting"],c);const u=d(n,["personGeneration"]);e!==void 0&&u!=null&&h(e,["parameters","personGeneration"],u);const f=d(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&h(e,["parameters","includeSafetyAttributes"],f);const m=d(n,["includeRaiReason"]);e!==void 0&&m!=null&&h(e,["parameters","includeRaiReason"],m);const y=d(n,["language"]);e!==void 0&&y!=null&&h(e,["parameters","language"],y);const v=d(n,["outputMimeType"]);e!==void 0&&v!=null&&h(e,["parameters","outputOptions","mimeType"],v);const _=d(n,["outputCompressionQuality"]);e!==void 0&&_!=null&&h(e,["parameters","outputOptions","compressionQuality"],_);const x=d(n,["addWatermark"]);e!==void 0&&x!=null&&h(e,["parameters","addWatermark"],x);const T=d(n,["imageSize"]);e!==void 0&&T!=null&&h(e,["parameters","sampleImageSize"],T);const S=d(n,["enhancePrompt"]);return e!==void 0&&S!=null&&h(e,["parameters","enhancePrompt"],S),t}function yj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["prompt"]);s!=null&&h(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&h(t,["config"],gj(r,t)),t}function Ji(n){const e={},t=d(n,["gcsUri"]);t!=null&&h(e,["gcsUri"],t);const i=d(n,["imageBytes"]);i!=null&&h(e,["bytesBase64Encoded"],qr(i));const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function vj(n){const e={},t=d(n,["maskMode"]);t!=null&&h(e,["maskMode"],t);const i=d(n,["segmentationClasses"]);i!=null&&h(e,["maskClasses"],i);const s=d(n,["maskDilation"]);return s!=null&&h(e,["dilation"],s),e}function wj(n){const e={},t=d(n,["controlType"]);t!=null&&h(e,["controlType"],t);const i=d(n,["enableControlImageComputation"]);return i!=null&&h(e,["computeControl"],i),e}function _j(n){const e={},t=d(n,["styleDescription"]);return t!=null&&h(e,["styleDescription"],t),e}function bj(n){const e={},t=d(n,["subjectType"]);t!=null&&h(e,["subjectType"],t);const i=d(n,["subjectDescription"]);return i!=null&&h(e,["subjectDescription"],i),e}function xj(n){const e={},t=d(n,["referenceImage"]);t!=null&&h(e,["referenceImage"],Ji(t));const i=d(n,["referenceId"]);i!=null&&h(e,["referenceId"],i);const s=d(n,["referenceType"]);s!=null&&h(e,["referenceType"],s);const r=d(n,["maskImageConfig"]);r!=null&&h(e,["maskImageConfig"],vj(r));const o=d(n,["controlImageConfig"]);o!=null&&h(e,["controlImageConfig"],wj(o));const a=d(n,["styleImageConfig"]);a!=null&&h(e,["styleImageConfig"],_j(a));const l=d(n,["subjectImageConfig"]);return l!=null&&h(e,["subjectImageConfig"],bj(l)),e}function Tj(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&h(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&h(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&h(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&h(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&h(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&h(e,["parameters","seed"],l);const c=d(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&h(e,["parameters","safetySetting"],c);const u=d(n,["personGeneration"]);e!==void 0&&u!=null&&h(e,["parameters","personGeneration"],u);const f=d(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&h(e,["parameters","includeSafetyAttributes"],f);const m=d(n,["includeRaiReason"]);e!==void 0&&m!=null&&h(e,["parameters","includeRaiReason"],m);const y=d(n,["language"]);e!==void 0&&y!=null&&h(e,["parameters","language"],y);const v=d(n,["outputMimeType"]);e!==void 0&&v!=null&&h(e,["parameters","outputOptions","mimeType"],v);const _=d(n,["outputCompressionQuality"]);e!==void 0&&_!=null&&h(e,["parameters","outputOptions","compressionQuality"],_);const x=d(n,["addWatermark"]);e!==void 0&&x!=null&&h(e,["parameters","addWatermark"],x);const T=d(n,["editMode"]);e!==void 0&&T!=null&&h(e,["parameters","editMode"],T);const S=d(n,["baseSteps"]);return e!==void 0&&S!=null&&h(e,["parameters","editConfig","baseSteps"],S),t}function Ej(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["prompt"]);s!=null&&h(t,["instances[0]","prompt"],s);const r=d(e,["referenceImages"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>xj(l))),h(t,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&h(t,["config"],Tj(o,t)),t}function Aj(n,e){const t={},i=d(n,["includeRaiReason"]);e!==void 0&&i!=null&&h(e,["parameters","includeRaiReason"],i);const s=d(n,["outputMimeType"]);e!==void 0&&s!=null&&h(e,["parameters","outputOptions","mimeType"],s);const r=d(n,["outputCompressionQuality"]);e!==void 0&&r!=null&&h(e,["parameters","outputOptions","compressionQuality"],r);const o=d(n,["enhanceInputImage"]);e!==void 0&&o!=null&&h(e,["parameters","upscaleConfig","enhanceInputImage"],o);const a=d(n,["imagePreservationFactor"]);e!==void 0&&a!=null&&h(e,["parameters","upscaleConfig","imagePreservationFactor"],a);const l=d(n,["numberOfImages"]);e!==void 0&&l!=null&&h(e,["parameters","sampleCount"],l);const c=d(n,["mode"]);return e!==void 0&&c!=null&&h(e,["parameters","mode"],c),t}function Ij(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["image"]);s!=null&&h(t,["instances[0]","image"],Ji(s));const r=d(e,["upscaleFactor"]);r!=null&&h(t,["parameters","upscaleConfig","upscaleFactor"],r);const o=d(e,["config"]);return o!=null&&h(t,["config"],Aj(o,t)),t}function Cj(n){const e={},t=d(n,["productImage"]);return t!=null&&h(e,["image"],Ji(t)),e}function Sj(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&h(e,["instances[0]","prompt"],i);const s=d(n,["personImage"]);e!==void 0&&s!=null&&h(e,["instances[0]","personImage","image"],Ji(s));const r=d(n,["productImages"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>Cj(a))),h(e,["instances[0]","productImages"],o)}return t}function Pj(n,e){const t={},i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&h(e,["parameters","sampleCount"],i);const s=d(n,["baseSteps"]);e!==void 0&&s!=null&&h(e,["parameters","editConfig","baseSteps"],s);const r=d(n,["outputGcsUri"]);e!==void 0&&r!=null&&h(e,["parameters","storageUri"],r);const o=d(n,["seed"]);e!==void 0&&o!=null&&h(e,["parameters","seed"],o);const a=d(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&h(e,["parameters","safetySetting"],a);const l=d(n,["personGeneration"]);e!==void 0&&l!=null&&h(e,["parameters","personGeneration"],l);const c=d(n,["outputMimeType"]);e!==void 0&&c!=null&&h(e,["parameters","outputOptions","mimeType"],c);const u=d(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&h(e,["parameters","outputOptions","compressionQuality"],u);const f=d(n,["enhancePrompt"]);return e!==void 0&&f!=null&&h(e,["parameters","enhancePrompt"],f),t}function kj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["source"]);s!=null&&h(t,["config"],Sj(s,t));const r=d(e,["config"]);return r!=null&&h(t,["config"],Pj(r,t)),t}function Rj(n){const e={},t=d(n,["image"]);return t!=null&&h(e,["image"],Ji(t)),e}function Nj(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&h(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&h(e,["instances[0]","image"],Ji(s));const r=d(n,["scribbleImage"]);return e!==void 0&&r!=null&&h(e,["instances[0]","scribble"],Rj(r)),t}function Mj(n,e){const t={},i=d(n,["mode"]);e!==void 0&&i!=null&&h(e,["parameters","mode"],i);const s=d(n,["maxPredictions"]);e!==void 0&&s!=null&&h(e,["parameters","maxPredictions"],s);const r=d(n,["confidenceThreshold"]);e!==void 0&&r!=null&&h(e,["parameters","confidenceThreshold"],r);const o=d(n,["maskDilation"]);e!==void 0&&o!=null&&h(e,["parameters","maskDilation"],o);const a=d(n,["binaryColorThreshold"]);return e!==void 0&&a!=null&&h(e,["parameters","binaryColorThreshold"],a),t}function Dj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["source"]);s!=null&&h(t,["config"],Nj(s,t));const r=d(e,["config"]);return r!=null&&h(t,["config"],Mj(r,t)),t}function Lj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","name"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function Fj(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&h(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&h(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&h(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&h(t,["_url","models_url"],FC(n,a)),i}function Vj(n,e){const t={},i=d(e,["config"]);return i!=null&&h(t,["config"],Fj(n,i,t)),t}function Oj(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&h(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&h(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&h(e,["defaultCheckpointId"],r),t}function Uj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],Oj(s,t)),t}function Bj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","name"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],s),t}function zj(n,e){const t={},i=d(n,["systemInstruction"]);e!==void 0&&i!=null&&h(e,["systemInstruction"],xa(Zt(i)));const s=d(n,["tools"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>XC(a))),h(e,["tools"],o)}const r=d(n,["generationConfig"]);return e!==void 0&&r!=null&&h(e,["generationConfig"],r),t}function jj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>xa(a))),h(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["config"],zj(r,t)),t}function qj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["contents"]);if(s!=null){let o=On(s);Array.isArray(o)&&(o=o.map(a=>xa(a))),h(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&h(t,["config"],r),t}function Hj(n){const e={},t=d(n,["uri"]);t!=null&&h(e,["gcsUri"],t);const i=d(n,["videoBytes"]);i!=null&&h(e,["bytesBase64Encoded"],qr(i));const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function Gj(n){const e={},t=d(n,["image"]);t!=null&&h(e,["image"],Ji(t));const i=d(n,["referenceType"]);return i!=null&&h(e,["referenceType"],i),e}function $j(n,e){const t={},i=d(n,["numberOfVideos"]);e!==void 0&&i!=null&&h(e,["parameters","sampleCount"],i);const s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&h(e,["parameters","storageUri"],s);const r=d(n,["fps"]);e!==void 0&&r!=null&&h(e,["parameters","fps"],r);const o=d(n,["durationSeconds"]);e!==void 0&&o!=null&&h(e,["parameters","durationSeconds"],o);const a=d(n,["seed"]);e!==void 0&&a!=null&&h(e,["parameters","seed"],a);const l=d(n,["aspectRatio"]);e!==void 0&&l!=null&&h(e,["parameters","aspectRatio"],l);const c=d(n,["resolution"]);e!==void 0&&c!=null&&h(e,["parameters","resolution"],c);const u=d(n,["personGeneration"]);e!==void 0&&u!=null&&h(e,["parameters","personGeneration"],u);const f=d(n,["pubsubTopic"]);e!==void 0&&f!=null&&h(e,["parameters","pubsubTopic"],f);const m=d(n,["negativePrompt"]);e!==void 0&&m!=null&&h(e,["parameters","negativePrompt"],m);const y=d(n,["enhancePrompt"]);e!==void 0&&y!=null&&h(e,["parameters","enhancePrompt"],y);const v=d(n,["generateAudio"]);e!==void 0&&v!=null&&h(e,["parameters","generateAudio"],v);const _=d(n,["lastFrame"]);e!==void 0&&_!=null&&h(e,["instances[0]","lastFrame"],Ji(_));const x=d(n,["referenceImages"]);if(e!==void 0&&x!=null){let S=x;Array.isArray(S)&&(S=S.map(C=>Gj(C))),h(e,["instances[0]","referenceImages"],S)}const T=d(n,["compressionQuality"]);return e!==void 0&&T!=null&&h(e,["parameters","compressionQuality"],T),t}function Wj(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["_url","model"],ze(n,i));const s=d(e,["prompt"]);s!=null&&h(t,["instances[0]","prompt"],s);const r=d(e,["image"]);r!=null&&h(t,["instances[0]","image"],Ji(r));const o=d(e,["video"]);o!=null&&h(t,["instances[0]","video"],Hj(o));const a=d(e,["config"]);return a!=null&&h(t,["config"],$j(a,t)),t}function Kj(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function Yj(n){const e={},t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Jj(n){const e={},t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function Xj(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],Kj(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],Yj(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],Jj(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function Qj(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Xj(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function Zj(n){const e={},t=d(n,["citationSources"]);return t!=null&&h(e,["citations"],t),e}function eq(n){const e={},t=d(n,["retrievedUrl"]);t!=null&&h(e,["retrievedUrl"],t);const i=d(n,["urlRetrievalStatus"]);return i!=null&&h(e,["urlRetrievalStatus"],i),e}function tq(n){const e={},t=d(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>eq(s))),h(e,["urlMetadata"],i)}return e}function nq(n){const e={},t=d(n,["content"]);t!=null&&h(e,["content"],Qj(t));const i=d(n,["citationMetadata"]);i!=null&&h(e,["citationMetadata"],Zj(i));const s=d(n,["tokenCount"]);s!=null&&h(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&h(e,["finishReason"],r);const o=d(n,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],tq(o));const a=d(n,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=d(n,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const c=d(n,["index"]);c!=null&&h(e,["index"],c);const u=d(n,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(n,["safetyRatings"]);return f!=null&&h(e,["safetyRatings"],f),e}function Vb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>nq(c))),h(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&h(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&h(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&h(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&h(e,["usageMetadata"],a),e}function iq(n){const e={},t=d(n,["values"]);return t!=null&&h(e,["values"],t),e}function sq(){return{}}function rq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>iq(o))),h(e,["embeddings"],r)}return d(n,["metadata"])!=null&&h(e,["metadata"],sq()),e}function oq(n){const e={},t=d(n,["bytesBase64Encoded"]);t!=null&&h(e,["imageBytes"],qr(t));const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function QC(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&h(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&h(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&h(e,["contentType"],s),e}function aq(n){const e={},t=d(n,["_self"]);t!=null&&h(e,["image"],oq(t));const i=d(n,["raiFilteredReason"]);i!=null&&h(e,["raiFilteredReason"],i);const s=d(n,["_self"]);return s!=null&&h(e,["safetyAttributes"],QC(s)),e}function lq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>aq(o))),h(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&h(e,["positivePromptSafetyAttributes"],QC(s)),e}function cq(n){const e={},t=d(n,["baseModel"]);t!=null&&h(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&h(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&h(e,["updateTime"],s),e}function om(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["description"]);s!=null&&h(e,["description"],s);const r=d(n,["version"]);r!=null&&h(e,["version"],r);const o=d(n,["_self"]);o!=null&&h(e,["tunedModelInfo"],cq(o));const a=d(n,["inputTokenLimit"]);a!=null&&h(e,["inputTokenLimit"],a);const l=d(n,["outputTokenLimit"]);l!=null&&h(e,["outputTokenLimit"],l);const c=d(n,["supportedGenerationMethods"]);return c!=null&&h(e,["supportedActions"],c),e}function uq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=VC(s);Array.isArray(r)&&(r=r.map(o=>om(o))),h(e,["models"],r)}return e}function dq(){return{}}function hq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);i!=null&&h(e,["totalTokens"],i);const s=d(n,["cachedContentTokenCount"]);return s!=null&&h(e,["cachedContentTokenCount"],s),e}function fq(n){const e={},t=d(n,["video","uri"]);t!=null&&h(e,["uri"],t);const i=d(n,["video","encodedVideo"]);i!=null&&h(e,["videoBytes"],qr(i));const s=d(n,["encoding"]);return s!=null&&h(e,["mimeType"],s),e}function pq(n){const e={},t=d(n,["_self"]);return t!=null&&h(e,["video"],fq(t)),e}function mq(n){const e={},t=d(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>pq(o))),h(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&h(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&h(e,["raiMediaFilteredReasons"],s),e}function gq(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["metadata"]);i!=null&&h(e,["metadata"],i);const s=d(n,["done"]);s!=null&&h(e,["done"],s);const r=d(n,["error"]);r!=null&&h(e,["error"],r);const o=d(n,["response","generateVideoResponse"]);return o!=null&&h(e,["response"],mq(o)),e}function yq(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function vq(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["data"]);i!=null&&h(e,["data"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function wq(n){const e={},t=d(n,["displayName"]);t!=null&&h(e,["displayName"],t);const i=d(n,["fileUri"]);i!=null&&h(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function _q(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],yq(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],vq(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],wq(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function bq(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>_q(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function xq(n){const e={},t=d(n,["citations"]);return t!=null&&h(e,["citations"],t),e}function Tq(n){const e={},t=d(n,["retrievedUrl"]);t!=null&&h(e,["retrievedUrl"],t);const i=d(n,["urlRetrievalStatus"]);return i!=null&&h(e,["urlRetrievalStatus"],i),e}function Eq(n){const e={},t=d(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Tq(s))),h(e,["urlMetadata"],i)}return e}function Aq(n){const e={},t=d(n,["content"]);t!=null&&h(e,["content"],bq(t));const i=d(n,["citationMetadata"]);i!=null&&h(e,["citationMetadata"],xq(i));const s=d(n,["finishMessage"]);s!=null&&h(e,["finishMessage"],s);const r=d(n,["finishReason"]);r!=null&&h(e,["finishReason"],r);const o=d(n,["urlContextMetadata"]);o!=null&&h(e,["urlContextMetadata"],Eq(o));const a=d(n,["avgLogprobs"]);a!=null&&h(e,["avgLogprobs"],a);const l=d(n,["groundingMetadata"]);l!=null&&h(e,["groundingMetadata"],l);const c=d(n,["index"]);c!=null&&h(e,["index"],c);const u=d(n,["logprobsResult"]);u!=null&&h(e,["logprobsResult"],u);const f=d(n,["safetyRatings"]);return f!=null&&h(e,["safetyRatings"],f),e}function Ob(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>Aq(u))),h(e,["candidates"],c)}const s=d(n,["createTime"]);s!=null&&h(e,["createTime"],s);const r=d(n,["modelVersion"]);r!=null&&h(e,["modelVersion"],r);const o=d(n,["promptFeedback"]);o!=null&&h(e,["promptFeedback"],o);const a=d(n,["responseId"]);a!=null&&h(e,["responseId"],a);const l=d(n,["usageMetadata"]);return l!=null&&h(e,["usageMetadata"],l),e}function Iq(n){const e={},t=d(n,["truncated"]);t!=null&&h(e,["truncated"],t);const i=d(n,["token_count"]);return i!=null&&h(e,["tokenCount"],i),e}function Cq(n){const e={},t=d(n,["values"]);t!=null&&h(e,["values"],t);const i=d(n,["statistics"]);return i!=null&&h(e,["statistics"],Iq(i)),e}function Sq(n){const e={},t=d(n,["billableCharacterCount"]);return t!=null&&h(e,["billableCharacterCount"],t),e}function Pq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["predictions[]","embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Cq(o))),h(e,["embeddings"],r)}const s=d(n,["metadata"]);return s!=null&&h(e,["metadata"],Sq(s)),e}function ZC(n){const e={},t=d(n,["gcsUri"]);t!=null&&h(e,["gcsUri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&h(e,["imageBytes"],qr(i));const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function eS(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&h(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&h(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&h(e,["contentType"],s),e}function bh(n){const e={},t=d(n,["_self"]);t!=null&&h(e,["image"],ZC(t));const i=d(n,["raiFilteredReason"]);i!=null&&h(e,["raiFilteredReason"],i);const s=d(n,["_self"]);s!=null&&h(e,["safetyAttributes"],eS(s));const r=d(n,["prompt"]);return r!=null&&h(e,["enhancedPrompt"],r),e}function kq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>bh(o))),h(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&h(e,["positivePromptSafetyAttributes"],eS(s)),e}function Rq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>bh(r))),h(e,["generatedImages"],s)}return e}function Nq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>bh(r))),h(e,["generatedImages"],s)}return e}function Mq(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>bh(s))),h(e,["generatedImages"],i)}return e}function Dq(n){const e={},t=d(n,["label"]);t!=null&&h(e,["label"],t);const i=d(n,["score"]);return i!=null&&h(e,["score"],i),e}function Lq(n){const e={},t=d(n,["_self"]);t!=null&&h(e,["mask"],ZC(t));const i=d(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>Dq(r))),h(e,["labels"],s)}return e}function Fq(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Lq(s))),h(e,["generatedMasks"],i)}return e}function Vq(n){const e={},t=d(n,["endpoint"]);t!=null&&h(e,["name"],t);const i=d(n,["deployedModelId"]);return i!=null&&h(e,["deployedModelId"],i),e}function Oq(n){const e={},t=d(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&h(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&h(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&h(e,["updateTime"],s),e}function Uq(n){const e={},t=d(n,["checkpointId"]);t!=null&&h(e,["checkpointId"],t);const i=d(n,["epoch"]);i!=null&&h(e,["epoch"],i);const s=d(n,["step"]);return s!=null&&h(e,["step"],s),e}function am(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["displayName"]);i!=null&&h(e,["displayName"],i);const s=d(n,["description"]);s!=null&&h(e,["description"],s);const r=d(n,["versionId"]);r!=null&&h(e,["version"],r);const o=d(n,["deployedModels"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(m=>Vq(m))),h(e,["endpoints"],f)}const a=d(n,["labels"]);a!=null&&h(e,["labels"],a);const l=d(n,["_self"]);l!=null&&h(e,["tunedModelInfo"],Oq(l));const c=d(n,["defaultCheckpointId"]);c!=null&&h(e,["defaultCheckpointId"],c);const u=d(n,["checkpoints"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(m=>Uq(m))),h(e,["checkpoints"],f)}return e}function Bq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=VC(s);Array.isArray(r)&&(r=r.map(o=>am(o))),h(e,["models"],r)}return e}function zq(){return{}}function jq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);return i!=null&&h(e,["totalTokens"],i),e}function qq(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["tokensInfo"]);return i!=null&&h(e,["tokensInfo"],i),e}function Hq(n){const e={},t=d(n,["gcsUri"]);t!=null&&h(e,["uri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&h(e,["videoBytes"],qr(i));const s=d(n,["mimeType"]);return s!=null&&h(e,["mimeType"],s),e}function Gq(n){const e={},t=d(n,["_self"]);return t!=null&&h(e,["video"],Hq(t)),e}function $q(n){const e={},t=d(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Gq(o))),h(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&h(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&h(e,["raiMediaFilteredReasons"],s),e}function Wq(n){const e={},t=d(n,["name"]);t!=null&&h(e,["name"],t);const i=d(n,["metadata"]);i!=null&&h(e,["metadata"],i);const s=d(n,["done"]);s!=null&&h(e,["done"],s);const r=d(n,["error"]);r!=null&&h(e,["error"],r);const o=d(n,["response"]);return o!=null&&h(e,["response"],$q(o)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kq="Content-Type",Yq="X-Server-Timeout",Jq="User-Agent",lm="x-goog-api-client",Xq="1.15.0",Qq=`google-genai-sdk/${Xq}`,Zq="v1beta1",eH="v1beta",Ub=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tH{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Zq,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:eH,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))s.searchParams.append(o,String(a));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(t))typeof r=="object"?i[s]=Object.assign(Object.assign({},i[s]),r):r!==void 0&&(i[s]=r);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const s=new AbortController,r=s.signal;if(t.timeout&&t?.timeout>0){const o=setTimeout(()=>s.abort(),t.timeout);o&&typeof o.unref=="function"&&o.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=r}return t&&t.extraBody!==null&&nH(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await Bb(s),new tm(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await Bb(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Co(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield Xe(s.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=r.decode(l,{stream:!0});try{const f=JSON.parse(c);if("error"in f){const m=JSON.parse(JSON.stringify(f.error)),y=m.status,v=m.code,_=`got status: ${y}. ${JSON.stringify(f)}`;if(v>=400&&v<600)throw new wh({message:_,status:v})}}catch(f){if(f.name==="ApiError")throw f}o+=c;let u=o.match(Ub);for(;u;){const f=u[1];try{const m=new Response(f,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Xe(new tm(m)),o=o.slice(u[0].length),u=o.match(Ub)}catch(m){throw new Error(`exception parsing stream chunk ${f}. ${m}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=Qq+" "+this.clientOptions.userAgentExtra;return e[Jq]=t,e[lm]=t,e[Kq]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))t.append(i,s);e.timeout&&e.timeout>0&&t.append(Yq,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,o=await r.stat(e);s.sizeBytes=String(o.size);const a=(i=t?.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const l=await this.fetchUploadUrl(s,t);return r.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},o=await this.request({path:ue("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(i=o?.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function Bb(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new wh({message:s,status:t}):new Error(s)}}function nH(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const r=JSON.parse(n.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,o){const a=Object.assign({},r);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const c=o[l],u=a[l];c&&typeof c=="object"&&!Array.isArray(c)&&u&&typeof u=="object"&&!Array.isArray(u)?a[l]=i(u,c):(u&&c&&typeof u!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof u}, New type: ${typeof c}. Overwriting.`),a[l]=c)}return a}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iH="mcp_used/unknown";let sH=!1;function tS(n){for(const e of n)if(rH(e)||typeof e=="object"&&"inputSchema"in e)return!0;return sH}function nS(n){var e;const t=(e=n[lm])!==null&&e!==void 0?e:"";n[lm]=(t+` ${iH}`).trimStart()}function rH(n){return n!==null&&typeof n=="object"&&n instanceof Py}function oH(n,e=100){return Co(this,arguments,function*(){let i,s=0;for(;s<e;){const r=yield Xe(n.listTools({cursor:i}));for(const o of r.tools)yield yield Xe(o),s++;if(!r.nextCursor)break;i=r.nextCursor}})}class Py{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Py(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const r={},o=[];for(const u of this.mcpClients)try{for(var a=!0,l=(t=void 0,Cl(oH(u))),c;c=await l.next(),e=c.done,!e;a=!0){s=c.value,a=!1;const f=s;o.push(f);const m=f.name;if(r[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);r[m]=u}}catch(f){t={error:f}}finally{try{!a&&!e&&(i=l.return)&&await i.call(l)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),VO(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const o=await s.callTool({name:i.name,arguments:i.args},void 0,r);t.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aH(n,e,t){const i=new PO;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data);const r=zB(s);Object.assign(i,r),e(i)}class lH{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=dH(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${a}`;let c=()=>{};const u=new Promise(C=>{c=C}),f=e.callbacks,m=function(){c({})},y=this.apiClient,v={onopen:m,onmessage:C=>{aH(y,f.onmessage,C)},onerror:(t=f?.onerror)!==null&&t!==void 0?t:function(C){},onclose:(i=f?.onclose)!==null&&i!==void 0?i:function(C){}},_=this.webSocketFactory.create(l,uH(o),v);_.connect(),await u;const x=ze(this.apiClient,e.model),T=KC({model:x}),S=rm({setup:T});return _.send(JSON.stringify(S)),new cH(_,this.apiClient)}}class cH{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=O9(e),i=YC(t);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=U9(e),i=rm(t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const t=rm({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(yo.PLAY)}pause(){this.sendPlaybackControl(yo.PAUSE)}stop(){this.sendPlaybackControl(yo.STOP)}resetContext(){this.sendPlaybackControl(yo.RESET_CONTEXT)}close(){this.conn.close()}}function uH(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function dH(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hH="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function fH(n,e,t){const i=new SO;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const r=JSON.parse(s);if(n.isVertexAI()){const o=tz(r);Object.assign(i,o)}else{const o=NB(r);Object.assign(i,o)}e(i)}class pH{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new lH(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,r,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let u;const f=this.apiClient.getHeaders();e.config&&e.config.tools&&tS(e.config.tools)&&nS(f);const m=vH(f);if(this.apiClient.isVertexAI())u=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const A=this.apiClient.getApiKey();let N="BidiGenerateContent",M="key";A?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",M="access_token"),u=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${N}?${M}=${A}`}let y=()=>{};const v=new Promise(A=>{y=A}),_=e.callbacks,x=function(){var A;(A=_?.onopen)===null||A===void 0||A.call(_),y({})},T=this.apiClient,S={onopen:x,onmessage:A=>{fH(T,_.onmessage,A)},onerror:(t=_?.onerror)!==null&&t!==void 0?t:function(A){},onclose:(i=_?.onclose)!==null&&i!==void 0?i:function(A){}},C=this.webSocketFactory.create(u,yH(m),S);C.connect(),await v;let D=ze(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const A=this.apiClient.getProject(),N=this.apiClient.getLocation();D=`projects/${A}/locations/${N}/`+D}let F={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[yd.AUDIO]}:e.config.responseModalities=[yd.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const V=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],I=[];for(const A of V)if(this.isCallableTool(A)){const N=A;I.push(await N.tool())}else I.push(A);I.length>0&&(e.config.tools=I);const E={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=fB(this.apiClient,E):F=D9(this.apiClient,E),delete F.config,C.send(JSON.stringify(F)),new gH(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const mH={turnComplete:!0};class gH{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=On(t.turns),e.isVertexAI()?i=i.map(s=>xa(s)):i=i.map(s=>_h(s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(hH)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},mH),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:gB(e)}:t={realtimeInput:V9(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function yH(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function vH(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zb=10;function jb(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(So(o)){s=!0;break}if(!s)return!0;const r=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function So(n){return"callTool"in n&&typeof n.callTool=="function"}function wH(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>So(s)))!==null&&i!==void 0?i:!1}function _H(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!So(s)))!==null&&i!==void 0?i:!1}function qb(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bH extends jr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,r,o,a;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!wH(t)||jb(t.config))return await this.generateContentInternal(l);if(_H(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let c,u;const f=On(l.contents),m=(r=(s=(i=l.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:zb;let y=0;for(;y<m&&(c=await this.generateContentInternal(l),!(!c.functionCalls||c.functionCalls.length===0));){const v=c.candidates[0].content,_=[];for(const x of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(So(x)){const S=await x.callTool(c.functionCalls);_.push(...S)}y++,u={role:"user",parts:_},l.contents=On(l.contents),l.contents.push(v),l.contents.push(u),qb(l.config)&&(f.push(v),f.push(u))}return qb(l.config)&&(c.automaticFunctionCallingHistory=f),c},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),jb(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let r;const o=[];if(i?.generatedImages)for(const l of i.generatedImages)l&&l?.safetyAttributes&&((s=l?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=l?.safetyAttributes:o.push(l);let a;return r?a={generatedImages:o,positivePromptSafetyAttributes:r,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async t=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Dc(Mr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const o=await Promise.all(r.map(async l=>So(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&tS(e.config.tools)){const l=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),nS(c),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return a}async initAfcToolsMap(e){var t,i,s;const r=new Map;for(const o of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(So(o)){const a=o,l=await a.tool();for(const c of(s=l.functionDeclarations)!==null&&s!==void 0?s:[]){if(!c.name)throw new Error("Function declaration name is required.");if(r.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);r.set(c.name,a)}}return r}async processAfcStream(e){var t,i,s;const r=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:zb;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return(function(c,u,f){var m,y;return Co(this,arguments,function*(){for(var v,_,x,T;a<r;){o&&(a++,o=!1);const F=yield Xe(c.processParamsMaybeAddMcpUsage(f)),V=yield Xe(c.generateContentStreamInternal(F)),I=[],E=[];try{for(var S=!0,C=(_=void 0,Cl(V)),D;D=yield Xe(C.next()),v=D.done,!v;S=!0){T=D.value,S=!1;const A=T;if(yield yield Xe(A),A.candidates&&(!((m=A.candidates[0])===null||m===void 0)&&m.content)){E.push(A.candidates[0].content);for(const N of(y=A.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(a<r&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(N.functionCall.name)){const M=yield Xe(u.get(N.functionCall.name).callTool([N.functionCall]));I.push(...M)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(A){_={error:A}}finally{try{!S&&!v&&(x=C.return)&&(yield Xe(x.call(C)))}finally{if(_)throw _.error}}if(I.length>0){o=!0;const A=new Ya;A.candidates=[{content:{role:"user",parts:I}}],yield yield Xe(A);const N=[];N.push(...E),N.push({role:"user",parts:I});const M=On(f.contents).concat(N);f.contents=M}else break}})})(this,l,e)}async generateContentInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Fb(this.apiClient,e);return a=ue("{model}:generateContent",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=Ob(u),m=new Ya;return Object.assign(m,f),m})}else{const c=Lb(this.apiClient,e);return a=ue("{model}:generateContent",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=Vb(u),m=new Ya;return Object.assign(m,f),m})}}async generateContentStreamInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Fb(this.apiClient,e);return a=ue("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(f){return Co(this,arguments,function*(){var m,y,v,_;try{for(var x=!0,T=Cl(f),S;S=yield Xe(T.next()),m=S.done,!m;x=!0){_=S.value,x=!1;const C=_,D=Ob(yield Xe(C.json()));D.sdkHttpResponse={headers:C.headers};const F=new Ya;Object.assign(F,D),yield yield Xe(F)}}catch(C){y={error:C}}finally{try{!x&&!m&&(v=T.return)&&(yield Xe(v.call(T)))}finally{if(y)throw y.error}}})})}else{const c=Lb(this.apiClient,e);return a=ue("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(f){return Co(this,arguments,function*(){var m,y,v,_;try{for(var x=!0,T=Cl(f),S;S=yield Xe(T.next()),m=S.done,!m;x=!0){_=S.value,x=!1;const C=_,D=Vb(yield Xe(C.json()));D.sdkHttpResponse={headers:C.headers};const F=new Ya;Object.assign(F,D),yield yield Xe(F)}}catch(C){y={error:C}}finally{try{!x&&!m&&(v=T.return)&&(yield Xe(v.call(T)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=mj(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=Pq(u),m=new fb;return Object.assign(m,f),m})}else{const c=Cz(this.apiClient,e);return a=ue("{model}:batchEmbedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=rq(u),m=new fb;return Object.assign(m,f),m})}}async generateImagesInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=yj(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=kq(u),m=new pb;return Object.assign(m,f),m})}else{const c=Pz(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=lq(u),m=new pb;return Object.assign(m,f),m})}}async editImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Ej(this.apiClient,e);return r=ue("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>{const c=Rq(l),u=new _O;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Ij(this.apiClient,e);return r=ue("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>{const c=Nq(l),u=new bO;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=kj(this.apiClient,e);return r=ue("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const c=Mq(l),u=new xO;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Dj(this.apiClient,e);return r=ue("{model}:predict",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const c=Fq(l),u=new TO;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Lj(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>am(u))}else{const c=kz(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>om(u))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Vj(this.apiClient,e);return a=ue("{models_url}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=Bq(u),m=new mb;return Object.assign(m,f),m})}else{const c=Nz(this.apiClient,e);return a=ue("{models_url}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=uq(u),m=new mb;return Object.assign(m,f),m})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Uj(this.apiClient,e);return a=ue("{model}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>am(u))}else{const c=Dz(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>om(u))}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Bj(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(()=>{const u=zq(),f=new gb;return Object.assign(f,u),f})}else{const c=Lz(this.apiClient,e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(()=>{const u=dq(),f=new gb;return Object.assign(f,u),f})}}async countTokens(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=jj(this.apiClient,e);return a=ue("{model}:countTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=jq(u),m=new yb;return Object.assign(m,f),m})}else{const c=Vz(this.apiClient,e);return a=ue("{model}:countTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=hq(u),m=new yb;return Object.assign(m,f),m})}}async computeTokens(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=qj(this.apiClient,e);return r=ue("{model}:computeTokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>{const c=qq(l),u=new EO;return Object.assign(u,c),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=Wj(this.apiClient,e);return a=ue("{model}:predictLongRunning",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const f=Wq(u),m=new vd;return Object.assign(m,f),m})}else{const c=Bz(this.apiClient,e);return a=ue("{model}:predictLongRunning",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const f=gq(u),m=new vd;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xH(n){const e={},t=d(n,["operationName"]);t!=null&&h(e,["_url","operationName"],t);const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function TH(n){const e={},t=d(n,["operationName"]);t!=null&&h(e,["_url","operationName"],t);const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function EH(n){const e={},t=d(n,["operationName"]);t!=null&&h(e,["operationName"],t);const i=d(n,["resourceName"]);i!=null&&h(e,["_url","resourceName"],i);const s=d(n,["config"]);return s!=null&&h(e,["config"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AH extends jr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=TH(e);return a=ue("{operationName}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o}else{const c=xH(e);return a=ue("{operationName}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o}}async fetchPredictVideosOperationInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=EH(e);return r=ue("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IH(n){const e={},t=d(n,["voiceName"]);return t!=null&&h(e,["voiceName"],t),e}function iS(n){const e={},t=d(n,["prebuiltVoiceConfig"]);return t!=null&&h(e,["prebuiltVoiceConfig"],IH(t)),e}function CH(n){const e={},t=d(n,["speaker"]);t!=null&&h(e,["speaker"],t);const i=d(n,["voiceConfig"]);return i!=null&&h(e,["voiceConfig"],iS(i)),e}function SH(n){const e={},t=d(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>CH(s))),h(e,["speakerVoiceConfigs"],i)}return e}function PH(n){const e={},t=d(n,["voiceConfig"]);t!=null&&h(e,["voiceConfig"],iS(t));const i=d(n,["multiSpeakerVoiceConfig"]);i!=null&&h(e,["multiSpeakerVoiceConfig"],SH(i));const s=d(n,["languageCode"]);return s!=null&&h(e,["languageCode"],s),e}function kH(n){const e={},t=d(n,["fps"]);t!=null&&h(e,["fps"],t);const i=d(n,["endOffset"]);i!=null&&h(e,["endOffset"],i);const s=d(n,["startOffset"]);return s!=null&&h(e,["startOffset"],s),e}function RH(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["data"]);t!=null&&h(e,["data"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function NH(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&h(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&h(e,["mimeType"],i),e}function MH(n){const e={},t=d(n,["videoMetadata"]);t!=null&&h(e,["videoMetadata"],kH(t));const i=d(n,["thought"]);i!=null&&h(e,["thought"],i);const s=d(n,["inlineData"]);s!=null&&h(e,["inlineData"],RH(s));const r=d(n,["fileData"]);r!=null&&h(e,["fileData"],NH(r));const o=d(n,["thoughtSignature"]);o!=null&&h(e,["thoughtSignature"],o);const a=d(n,["codeExecutionResult"]);a!=null&&h(e,["codeExecutionResult"],a);const l=d(n,["executableCode"]);l!=null&&h(e,["executableCode"],l);const c=d(n,["functionCall"]);c!=null&&h(e,["functionCall"],c);const u=d(n,["functionResponse"]);u!=null&&h(e,["functionResponse"],u);const f=d(n,["text"]);return f!=null&&h(e,["text"],f),e}function DH(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>MH(r))),h(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&h(e,["role"],i),e}function LH(n){const e={},t=d(n,["behavior"]);t!=null&&h(e,["behavior"],t);const i=d(n,["description"]);i!=null&&h(e,["description"],i);const s=d(n,["name"]);s!=null&&h(e,["name"],s);const r=d(n,["parameters"]);r!=null&&h(e,["parameters"],r);const o=d(n,["parametersJsonSchema"]);o!=null&&h(e,["parametersJsonSchema"],o);const a=d(n,["response"]);a!=null&&h(e,["response"],a);const l=d(n,["responseJsonSchema"]);return l!=null&&h(e,["responseJsonSchema"],l),e}function FH(n){const e={},t=d(n,["startTime"]);t!=null&&h(e,["startTime"],t);const i=d(n,["endTime"]);return i!=null&&h(e,["endTime"],i),e}function VH(n){const e={},t=d(n,["timeRangeFilter"]);if(t!=null&&h(e,["timeRangeFilter"],FH(t)),d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function OH(n){const e={},t=d(n,["mode"]);t!=null&&h(e,["mode"],t);const i=d(n,["dynamicThreshold"]);return i!=null&&h(e,["dynamicThreshold"],i),e}function UH(n){const e={},t=d(n,["dynamicRetrievalConfig"]);return t!=null&&h(e,["dynamicRetrievalConfig"],OH(t)),e}function BH(){return{}}function zH(n){const e={},t=d(n,["environment"]);return t!=null&&h(e,["environment"],t),e}function jH(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>LH(c))),h(e,["functionDeclarations"],l)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearch"]);i!=null&&h(e,["googleSearch"],VH(i));const s=d(n,["googleSearchRetrieval"]);if(s!=null&&h(e,["googleSearchRetrieval"],UH(s)),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");d(n,["urlContext"])!=null&&h(e,["urlContext"],BH());const o=d(n,["computerUse"]);o!=null&&h(e,["computerUse"],zH(o));const a=d(n,["codeExecution"]);return a!=null&&h(e,["codeExecution"],a),e}function qH(n){const e={},t=d(n,["handle"]);if(t!=null&&h(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Hb(){return{}}function HH(n){const e={},t=d(n,["disabled"]);t!=null&&h(e,["disabled"],t);const i=d(n,["startOfSpeechSensitivity"]);i!=null&&h(e,["startOfSpeechSensitivity"],i);const s=d(n,["endOfSpeechSensitivity"]);s!=null&&h(e,["endOfSpeechSensitivity"],s);const r=d(n,["prefixPaddingMs"]);r!=null&&h(e,["prefixPaddingMs"],r);const o=d(n,["silenceDurationMs"]);return o!=null&&h(e,["silenceDurationMs"],o),e}function GH(n){const e={},t=d(n,["automaticActivityDetection"]);t!=null&&h(e,["automaticActivityDetection"],HH(t));const i=d(n,["activityHandling"]);i!=null&&h(e,["activityHandling"],i);const s=d(n,["turnCoverage"]);return s!=null&&h(e,["turnCoverage"],s),e}function $H(n){const e={},t=d(n,["targetTokens"]);return t!=null&&h(e,["targetTokens"],t),e}function WH(n){const e={},t=d(n,["triggerTokens"]);t!=null&&h(e,["triggerTokens"],t);const i=d(n,["slidingWindow"]);return i!=null&&h(e,["slidingWindow"],$H(i)),e}function KH(n){const e={},t=d(n,["proactiveAudio"]);return t!=null&&h(e,["proactiveAudio"],t),e}function YH(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&h(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&h(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&h(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&h(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&h(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&h(e,["setup","generationConfig","maxOutputTokens"],l);const c=d(n,["mediaResolution"]);e!==void 0&&c!=null&&h(e,["setup","generationConfig","mediaResolution"],c);const u=d(n,["seed"]);e!==void 0&&u!=null&&h(e,["setup","generationConfig","seed"],u);const f=d(n,["speechConfig"]);e!==void 0&&f!=null&&h(e,["setup","generationConfig","speechConfig"],PH(Sy(f)));const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&h(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&h(e,["setup","systemInstruction"],DH(Zt(y)));const v=d(n,["tools"]);if(e!==void 0&&v!=null){let F=_a(v);Array.isArray(F)&&(F=F.map(V=>jH(wa(V)))),h(e,["setup","tools"],F)}const _=d(n,["sessionResumption"]);e!==void 0&&_!=null&&h(e,["setup","sessionResumption"],qH(_));const x=d(n,["inputAudioTranscription"]);e!==void 0&&x!=null&&h(e,["setup","inputAudioTranscription"],Hb());const T=d(n,["outputAudioTranscription"]);e!==void 0&&T!=null&&h(e,["setup","outputAudioTranscription"],Hb());const S=d(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&h(e,["setup","realtimeInputConfig"],GH(S));const C=d(n,["contextWindowCompression"]);e!==void 0&&C!=null&&h(e,["setup","contextWindowCompression"],WH(C));const D=d(n,["proactivity"]);return e!==void 0&&D!=null&&h(e,["setup","proactivity"],KH(D)),t}function JH(n,e){const t={},i=d(e,["model"]);i!=null&&h(t,["setup","model"],ze(n,i));const s=d(e,["config"]);return s!=null&&h(t,["config"],YH(s,t)),t}function XH(n,e,t){const i={},s=d(e,["expireTime"]);t!==void 0&&s!=null&&h(t,["expireTime"],s);const r=d(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&h(t,["newSessionExpireTime"],r);const o=d(e,["uses"]);t!==void 0&&o!=null&&h(t,["uses"],o);const a=d(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&h(t,["bidiGenerateContentSetup"],JH(n,a));const l=d(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&h(t,["fieldMask"],l),i}function QH(n,e){const t={},i=d(e,["config"]);return i!=null&&h(t,["config"],XH(n,i,t)),t}function ZH(n){const e={},t=d(n,["name"]);return t!=null&&h(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eG(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(r=>`${t}.${r}`);e.push(...s)}else e.push(t)}return e.join(",")}function tG(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(n.bidiGenerateContentSetup=r,t=r):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const r=eG(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)r?n.fieldMask=r:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(c=>o.includes(c)?`generationConfig.${c}`:c));const l=[];r&&l.push(r),a.length>0&&l.push(...a),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class nG extends jr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=QH(this.apiClient,e);r=ue("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=tG(a,e.config);return s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),s.then(c=>ZH(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iG(n){const e={},t=d(n,["name"]);t!=null&&h(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function sG(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const r=d(n,["filter"]);return e!==void 0&&r!=null&&h(e,["_query","filter"],r),t}function rG(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],sG(t,e)),e}function oG(n){const e={},t=d(n,["textInput"]);t!=null&&h(e,["textInput"],t);const i=d(n,["output"]);return i!=null&&h(e,["output"],i),e}function aG(n){const e={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=d(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>oG(s))),h(e,["examples","examples"],i)}return e}function lG(n,e){const t={};if(d(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&h(e,["displayName"],i),d(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(n,["epochCount"]);e!==void 0&&s!=null&&h(e,["tuningTask","hyperparameters","epochCount"],s);const r=d(n,["learningRateMultiplier"]);if(r!=null&&h(t,["tuningTask","hyperparameters","learningRateMultiplier"],r),d(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=d(n,["batchSize"]);e!==void 0&&o!=null&&h(e,["tuningTask","hyperparameters","batchSize"],o);const a=d(n,["learningRate"]);return e!==void 0&&a!=null&&h(e,["tuningTask","hyperparameters","learningRate"],a),t}function cG(n){const e={},t=d(n,["baseModel"]);t!=null&&h(e,["baseModel"],t);const i=d(n,["preTunedModel"]);i!=null&&h(e,["preTunedModel"],i);const s=d(n,["trainingDataset"]);s!=null&&h(e,["tuningTask","trainingData"],aG(s));const r=d(n,["config"]);return r!=null&&h(e,["config"],lG(r,e)),e}function uG(n){const e={},t=d(n,["name"]);t!=null&&h(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&h(e,["config"],i),e}function dG(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&h(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);e!==void 0&&s!=null&&h(e,["_query","pageToken"],s);const r=d(n,["filter"]);return e!==void 0&&r!=null&&h(e,["_query","filter"],r),t}function hG(n){const e={},t=d(n,["config"]);return t!=null&&h(e,["config"],dG(t,e)),e}function fG(n,e){const t={},i=d(n,["gcsUri"]);e!==void 0&&i!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],i);const s=d(n,["vertexDatasetResource"]);if(e!==void 0&&s!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],s),d(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function pG(n,e){const t={},i=d(n,["gcsUri"]);i!=null&&h(t,["validationDatasetUri"],i);const s=d(n,["vertexDatasetResource"]);return e!==void 0&&s!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],s),t}function mG(n,e){const t={},i=d(n,["validationDataset"]);e!==void 0&&i!=null&&h(e,["supervisedTuningSpec"],pG(i,t));const s=d(n,["tunedModelDisplayName"]);e!==void 0&&s!=null&&h(e,["tunedModelDisplayName"],s);const r=d(n,["description"]);e!==void 0&&r!=null&&h(e,["description"],r);const o=d(n,["epochCount"]);e!==void 0&&o!=null&&h(e,["supervisedTuningSpec","hyperParameters","epochCount"],o);const a=d(n,["learningRateMultiplier"]);e!==void 0&&a!=null&&h(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=d(n,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&h(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const c=d(n,["preTunedModelCheckpointId"]);c!=null&&h(t,["preTunedModel","checkpointId"],c);const u=d(n,["adapterSize"]);if(e!==void 0&&u!=null&&h(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),d(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function gG(n){const e={},t=d(n,["baseModel"]);t!=null&&h(e,["baseModel"],t);const i=d(n,["preTunedModel"]);i!=null&&h(e,["preTunedModel"],i);const s=d(n,["trainingDataset"]);s!=null&&h(e,["supervisedTuningSpec","trainingDatasetUri"],fG(s,e));const r=d(n,["config"]);return r!=null&&h(e,["config"],mG(r,e)),e}function yG(n){const e={},t=d(n,["name"]);t!=null&&h(e,["model"],t);const i=d(n,["name"]);return i!=null&&h(e,["endpoint"],i),e}function sS(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["state"]);s!=null&&h(e,["state"],DC(s));const r=d(n,["createTime"]);r!=null&&h(e,["createTime"],r);const o=d(n,["tuningTask","startTime"]);o!=null&&h(e,["startTime"],o);const a=d(n,["tuningTask","completeTime"]);a!=null&&h(e,["endTime"],a);const l=d(n,["updateTime"]);l!=null&&h(e,["updateTime"],l);const c=d(n,["description"]);c!=null&&h(e,["description"],c);const u=d(n,["baseModel"]);u!=null&&h(e,["baseModel"],u);const f=d(n,["_self"]);f!=null&&h(e,["tunedModel"],yG(f));const m=d(n,["customBaseModel"]);m!=null&&h(e,["customBaseModel"],m);const y=d(n,["experiment"]);y!=null&&h(e,["experiment"],y);const v=d(n,["labels"]);v!=null&&h(e,["labels"],v);const _=d(n,["outputUri"]);_!=null&&h(e,["outputUri"],_);const x=d(n,["pipelineJob"]);x!=null&&h(e,["pipelineJob"],x);const T=d(n,["serviceAccount"]);T!=null&&h(e,["serviceAccount"],T);const S=d(n,["tunedModelDisplayName"]);return S!=null&&h(e,["tunedModelDisplayName"],S),e}function vG(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["tunedModels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>sS(o))),h(e,["tuningJobs"],r)}return e}function wG(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["metadata"]);s!=null&&h(e,["metadata"],s);const r=d(n,["done"]);r!=null&&h(e,["done"],r);const o=d(n,["error"]);return o!=null&&h(e,["error"],o),e}function _G(n){const e={},t=d(n,["checkpointId"]);t!=null&&h(e,["checkpointId"],t);const i=d(n,["epoch"]);i!=null&&h(e,["epoch"],i);const s=d(n,["step"]);s!=null&&h(e,["step"],s);const r=d(n,["endpoint"]);return r!=null&&h(e,["endpoint"],r),e}function bG(n){const e={},t=d(n,["model"]);t!=null&&h(e,["model"],t);const i=d(n,["endpoint"]);i!=null&&h(e,["endpoint"],i);const s=d(n,["checkpoints"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>_G(o))),h(e,["checkpoints"],r)}return e}function cm(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&h(e,["name"],i);const s=d(n,["state"]);s!=null&&h(e,["state"],DC(s));const r=d(n,["createTime"]);r!=null&&h(e,["createTime"],r);const o=d(n,["startTime"]);o!=null&&h(e,["startTime"],o);const a=d(n,["endTime"]);a!=null&&h(e,["endTime"],a);const l=d(n,["updateTime"]);l!=null&&h(e,["updateTime"],l);const c=d(n,["error"]);c!=null&&h(e,["error"],c);const u=d(n,["description"]);u!=null&&h(e,["description"],u);const f=d(n,["baseModel"]);f!=null&&h(e,["baseModel"],f);const m=d(n,["tunedModel"]);m!=null&&h(e,["tunedModel"],bG(m));const y=d(n,["preTunedModel"]);y!=null&&h(e,["preTunedModel"],y);const v=d(n,["supervisedTuningSpec"]);v!=null&&h(e,["supervisedTuningSpec"],v);const _=d(n,["tuningDataStats"]);_!=null&&h(e,["tuningDataStats"],_);const x=d(n,["encryptionSpec"]);x!=null&&h(e,["encryptionSpec"],x);const T=d(n,["partnerModelTuningSpec"]);T!=null&&h(e,["partnerModelTuningSpec"],T);const S=d(n,["customBaseModel"]);S!=null&&h(e,["customBaseModel"],S);const C=d(n,["experiment"]);C!=null&&h(e,["experiment"],C);const D=d(n,["labels"]);D!=null&&h(e,["labels"],D);const F=d(n,["outputUri"]);F!=null&&h(e,["outputUri"],F);const V=d(n,["pipelineJob"]);V!=null&&h(e,["pipelineJob"],V);const I=d(n,["serviceAccount"]);I!=null&&h(e,["serviceAccount"],I);const E=d(n,["tunedModelDisplayName"]);return E!=null&&h(e,["tunedModelDisplayName"],E),e}function xG(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&h(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&h(e,["nextPageToken"],i);const s=d(n,["tuningJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>cm(o))),h(e,["tuningJobs"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TG extends jr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Dc(Mr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel},s=Object.assign(Object.assign({},t),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),s=await this.tuneMldevInternal(i);let r="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?r=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(r=s.name.split("/operations/")[0]),{name:r,state:em.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=uG(e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>cm(u))}else{const c=iG(e);return a=ue("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>sS(u))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=hG(e);return a=ue("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=xG(u),m=new wb;return Object.assign(m,f),m})}else{const c=rG(e);return a=ue("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:u.headers},m})),o.then(u=>{const f=vG(u),m=new wb;return Object.assign(m,f),m})}}async tuneInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=gG(e);return r=ue("tuningJobs",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>cm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cG(e);return r=ue("tunedModels",a._url),o=a._query,delete a.config,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(c=>{const u=c;return u.sdkHttpResponse={headers:l.headers},u})),s.then(l=>wG(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EG{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const AG=1024*1024*8,IG=3,CG=1e3,SG=2,bf="x-goog-upload-status";async function PG(n,e,t){var i,s,r;let o=0,a=0,l=new tm(new Response),c="upload";for(o=n.size;a<o;){const f=Math.min(AG,o-a),m=n.slice(a,a+f);a+f>=o&&(c+=", finalize");let y=0,v=CG;for(;y<IG&&(l=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(f)}}}),!(!((i=l?.headers)===null||i===void 0)&&i[bf]));)y++,await RG(v),v=v*SG;if(a+=f,((s=l?.headers)===null||s===void 0?void 0:s[bf])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const u=await l?.json();if(((r=l?.headers)===null||r===void 0?void 0:r[bf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return u.file}async function kG(n){return{size:n.size,type:n.type}}function RG(n){return new Promise(e=>setTimeout(e,n))}class NG{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await PG(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await kG(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MG{create(e,t,i){return new DG(e,t,i)}}class DG{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gb="x-goog-api-key";class LG{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Gb)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Gb,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FG="gl-node/";class $b{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=wO(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const s=new LG(this.apiKey);this.apiClient=new tH({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:FG+"web",uploader:new NG,downloader:new EG}),this.models=new bH(this.apiClient),this.live=new pH(this.apiClient,s,new MG),this.batches=new H7(this.apiClient),this.chats=new JU(this.models,this.apiClient),this.caches=new WU(this.apiClient),this.files=new c9(this.apiClient),this.operations=new AH(this.apiClient),this.authTokens=new nG(this.apiClient),this.tunings=new TG(this.apiClient)}}const cr=[{id:"merge-pdf",title:"tool.merge-pdf.title",description:"tool.merge-pdf.description",Icon:A8,color:"bg-orange-500",hoverColor:"hover:bg-orange-600",textColor:"text-orange-600",category:"organize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"split-pdf",title:"tool.split-pdf.title",description:"tool.split-pdf.description",Icon:I8,color:"bg-orange-500",hoverColor:"hover:bg-orange-600",textColor:"text-orange-600",category:"organize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"organize-pdf",title:"tool.organize-pdf.title",description:"tool.organize-pdf.description",Icon:uO,color:"bg-orange-500",hoverColor:"hover:bg-orange-600",textColor:"text-orange-600",category:"organize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"rotate-pdf",title:"tool.rotate-pdf.title",description:"tool.rotate-pdf.description",Icon:M8,color:"bg-indigo-500",hoverColor:"hover:bg-indigo-600",textColor:"text-indigo-600",category:"organize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"zip-maker",title:"tool.zip-maker.title",description:"tool.zip-maker.description",Icon:X8,color:"bg-amber-500",hoverColor:"hover:bg-amber-600",textColor:"text-amber-600",category:"organize",isNew:!0,accept:{},api:{category:"utility"},fileTypeDisplayName:"files",fileTypeNounPlural:"files here"},{id:"compress-pdf",title:"tool.compress-pdf.title",description:"tool.compress-pdf.description",Icon:w_,color:"bg-green-500",hoverColor:"hover:bg-green-600",textColor:"text-green-600",category:"optimize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"repair-pdf",title:"tool.repair-pdf.title",description:"tool.repair-pdf.description",Icon:F8,color:"bg-lime-500",hoverColor:"hover:bg-lime-600",textColor:"text-lime-600",isPremium:!0,category:"optimize",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"jpg-to-pdf",title:"tool.jpg-to-pdf.title",description:"tool.jpg-to-pdf.description",Icon:P8,color:"bg-yellow-400",hoverColor:"hover:bg-yellow-500",textColor:"text-yellow-600",isNew:!0,category:"convert-to",accept:{"image/jpeg":[".jpeg",".jpg"],"image/png":[".png"]},api:{category:"pdf"},fileTypeDisplayName:"JPG",fileTypeNounPlural:"images"},{id:"psd-to-pdf",title:"tool.psd-to-pdf.title",description:"tool.psd-to-pdf.description",Icon:K8,color:"bg-sky-500",hoverColor:"hover:bg-sky-600",textColor:"text-sky-600",isNew:!0,category:"convert-to",accept:{"image/vnd.adobe.photoshop":[".psd"],"application/octet-stream":[".psd"]},api:{category:"pdf"},fileTypeDisplayName:"PSD",fileTypeNounPlural:"files"},{id:"word-to-pdf",title:"tool.word-to-pdf.title",description:"tool.word-to-pdf.description",Icon:__,color:"bg-blue-500",hoverColor:"hover:bg-blue-600",textColor:"text-blue-600",category:"convert-to",accept:{"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]},api:{category:"pdf"},fileTypeDisplayName:"WORD",fileTypeNounPlural:"files"},{id:"powerpoint-to-pdf",title:"powerpoint to pdf",description:"tool.powerpoint-to-pdf.description",Icon:b_,color:"bg-red-500",hoverColor:"hover:bg-red-600",textColor:"text-red-600",category:"convert-to",accept:{"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]},api:{category:"pdf"},fileTypeDisplayName:"POWERPOINT",fileTypeNounPlural:"slideshows"},{id:"excel-to-pdf",title:"tool.excel-to-pdf.title",description:"tool.excel-to-pdf.description",Icon:x_,color:"bg-green-500",hoverColor:"hover:bg-green-600",textColor:"text-green-600",category:"convert-to",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},api:{category:"pdf"},fileTypeDisplayName:"EXCEL",fileTypeNounPlural:"files"},{id:"document-scanner",title:"tool.document-scanner.title",description:"tool.document-scanner.description",Icon:fO,color:"bg-cyan-500",hoverColor:"hover:bg-cyan-600",textColor:"text-cyan-600",isNew:!0,category:"convert-to",accept:{},api:{category:"utility"},fileTypeDisplayName:"images",fileTypeNounPlural:"to scan"},{id:"pdf-to-jpg",title:"tool.pdf-to-jpg.title",description:"tool.pdf-to-jpg.description",Icon:S8,color:"bg-yellow-400",hoverColor:"hover:bg-yellow-500",textColor:"text-yellow-600",category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"pdf-to-png",title:"tool.pdf-to-png.title",description:"tool.pdf-to-png.description",Icon:Y8,color:"bg-lime-500",hoverColor:"hover:bg-lime-600",textColor:"text-lime-600",isNew:!0,category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"pdf-to-word",title:"tool.pdf-to-word.title",description:"tool.pdf-to-word.description",Icon:__,color:"bg-blue-500",hoverColor:"hover:bg-blue-600",textColor:"text-blue-600",category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"pdf-to-powerpoint",title:"tool.pdf-to-powerpoint.title",description:"tool.pdf-to-powerpoint.description",Icon:b_,color:"bg-red-500",hoverColor:"hover:bg-red-600",textColor:"text-red-600",isPremium:!0,category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"pdf-to-excel",title:"tool.pdf-to-excel.title",description:"tool.pdf-to-excel.description",Icon:x_,color:"bg-green-500",hoverColor:"hover:bg-green-600",textColor:"text-green-600",category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"extract-text",title:"tool.extract-text.title",description:"tool.extract-text.description",Icon:E_,color:"bg-red-500",hoverColor:"hover:bg-red-600",textColor:"text-red-600",category:"convert-from",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"edit-pdf",title:"tool.edit-pdf.title",description:"tool.edit-pdf.description",Icon:C8,color:"bg-purple-500",hoverColor:"hover:bg-purple-600",textColor:"text-purple-600",isPremium:!0,isNew:!0,category:"edit",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"page-numbers",title:"tool.page-numbers.title",description:"tool.page-numbers.description",Icon:V8,color:"bg-fuchsia-500",hoverColor:"hover:bg-fuchsia-600",textColor:"text-fuchsia-600",isPremium:!0,category:"edit",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"crop-pdf",title:"tool.crop-pdf.title",description:"tool.crop-pdf.description",Icon:O8,color:"bg-rose-500",hoverColor:"hover:bg-rose-600",textColor:"text-rose-600",isPremium:!0,category:"edit",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"ocr-pdf",title:"tool.ocr-pdf.title",description:"tool.ocr-pdf.description",Icon:E_,color:"bg-teal-500",hoverColor:"hover:bg-teal-600",textColor:"text-teal-600",isPremium:!0,category:"edit",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"ai-question-generator",title:"tool.ai-question-generator.title",description:"tool.ai-question-generator.description",Icon:bC,color:"bg-purple-500",hoverColor:"hover:bg-purple-600",textColor:"text-purple-600",isNew:!0,category:"business"},{id:"invoice-generator",title:"tool.invoice-generator.title",description:"tool.invoice-generator.description",Icon:_C,color:"bg-teal-500",hoverColor:"hover:bg-teal-600",textColor:"text-teal-600",isNew:!0,category:"business"},{id:"cv-generator",title:"tool.cv-generator.title",description:"tool.cv-generator.description",Icon:J8,color:"bg-cyan-500",hoverColor:"hover:bg-cyan-600",textColor:"text-cyan-600",isNew:!0,category:"business"},{id:"lesson-plan-creator",title:"tool.lesson-plan-creator.title",description:"tool.lesson-plan-creator.description",Icon:yh,color:"bg-indigo-500",hoverColor:"hover:bg-indigo-600",textColor:"text-indigo-600",isNew:!0,category:"business"},{id:"unlock-pdf",title:"tool.unlock-pdf.title",description:"tool.unlock-pdf.description",Icon:D8,color:"bg-cyan-500",hoverColor:"hover:bg-cyan-600",textColor:"text-cyan-600",category:"security",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"protect-pdf",title:"tool.protect-pdf.title",description:"tool.protect-pdf.description",Icon:L8,color:"bg-blue-500",hoverColor:"hover:bg-blue-600",textColor:"text-blue-600",category:"security",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"sign-pdf",title:"tool.sign-pdf.title",description:"tool.sign-pdf.description",Icon:pC,color:"bg-blue-500",hoverColor:"hover:bg-blue-600",textColor:"text-blue-600",isPremium:!0,category:"security",api:{category:"signature"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"watermark-pdf",title:"tool.watermark-pdf.title",description:"tool.watermark-pdf.description",Icon:T_,color:"bg-purple-500",hoverColor:"hover:bg-purple-600",textColor:"text-purple-600",category:"security",api:{category:"pdf"},fileTypeDisplayName:"PDF",fileTypeNounPlural:"files"},{id:"remove-background",title:"tool.remove-background.title",description:"tool.remove-background.description",Icon:wC,color:"bg-green-500",hoverColor:"hover:bg-green-600",textColor:"text-green-600",category:"edit",accept:{"image/*":[".png",".jpg",".jpeg",".webp"]},api:{category:"image"},fileTypeDisplayName:"image",fileTypeNounPlural:"files"},{id:"compress-image",title:"tool.compress-image.title",description:"tool.compress-image.description",Icon:w_,color:"bg-green-500",hoverColor:"hover:bg-green-600",textColor:"text-green-600",category:"optimize",accept:{"image/*":[".png",".jpg",".jpeg"]},api:{category:"image"},fileTypeDisplayName:"image",fileTypeNounPlural:"files"},{id:"watermark-image",title:"tool.watermark-image.title",description:"tool.watermark-image.description",Icon:T_,color:"bg-purple-500",hoverColor:"hover:bg-purple-600",textColor:"text-purple-600",category:"edit",accept:{"image/*":[".png",".jpg",".jpeg"]},api:{category:"image"},fileTypeDisplayName:"image",fileTypeNounPlural:"files"}],VG=[{slug:"nepal-bans-facebook-social-media",title:"Nepal Bans Facebook and Major Social Media Platforms Over Non-Compliance",date:"September 5, 2025",excerpt:"An analysis of Nepal's social media regulation landscape, the Supreme Court's directive for platform registration, and the profound consequences of the 2025 ban on creators, businesses, and citizens.",content:"<h2>Background of Social Media Regulation in Nepal</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Timeline of Government Notices and Deadlines</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Platforms Banned vs Platforms Allowed</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>The Legal Foundation: Supreme Court Directive</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Government Rationale: Accountability and Sovereignty</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Criticism from Civil Society and Opposition</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Impact on Journalists, Creators, and Businesses</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Economic Consequences and ISP Challenges</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Social and Cultural Implications</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Comparisons with Other Countries’ Policies</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>Technical Implications: VPNs, DNS, and Access Workarounds</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><h2>The Future of Digital Regulation in Nepal</h2><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p><p>Nepal’s social media landscape reflects broader global challenges in balancing digital freedom with regulation. The government argues that registration is essential to curb fake accounts, cybercrime, and misinformation. Civil society, however, stresses that such regulation risks suppressing free expression and innovation. The Supreme Court’s directive mandating registration marked a turning point. For the first time, platforms were told that without compliance, they could not legally operate in Nepal. Notices began in 2023, culminating in the ban of 2025. This has profound consequences. Content creators relying on monetization are hit hard, ISPs face losses, and ordinary citizens lose vital communication tools. Migrant families especially suffer, as many rely on these apps to stay connected.</p>",image:"https://ik.imagekit.io/fonepay/social%20media%20band%20in%20nepal%20ilovepdfly.png?updatedAt=1757078313764",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Social Media Ban","Facebook Ban","Digital Rights","Internet Freedom"]},{slug:"neb-class-12-result-2081-2082",title:"NEB Class 12 Result 2082/2081 (2025): The Ultimate Guide to Check Your Marksheet Online",date:"July 15, 2025",excerpt:"The complete guide to checking your NEB Class 12 Result for 2081/2082. Find official websites like neb.gov.np and ntc.net.np, SMS methods, IVR, and step-by-step instructions to view your results with marksheet. Understand the new grading system and get answers to all your FAQs. Your one-stop resource for the 2025 NEB results is here.",content:`The long wait is almost over for the hundreds of thousands of students who appeared for the National Examinations Board (NEB) Class 12 examinations in 2081/2082. This result is a pivotal moment, serving as the gateway to higher education and future career paths. The anticipation can be overwhelming, with students and parents eagerly searching for the fastest and most reliable ways to check the results. To ease this process, we have created the ultimate, comprehensive guide with all the verified information you need to check your NEB Class 12 Result 2081/2082 the moment it is published.

This guide provides direct links to official websites, step-by-step instructions for checking results via SMS, IVR, and USSD, and detailed information on the latest grading system. We understand that on result day, official websites can be slow or unresponsive due to high traffic. That's why we've compiled a list of alternative methods and multiple web portals to ensure you get your result without delay.

<a href="https://neb.ntc.net.np/" target="_blank" rel="noopener noreferrer" class="inline-block bg-brand-red hover:bg-brand-red-dark text-white font-bold py-3 px-8 rounded-lg my-6 no-underline text-lg">Check NEB Class 12 Result Now</a>

<h2>When Will the NEB Class 12 Result 2081/2082 Be Published?</h2>
<p>While the National Examinations Board (NEB) has not announced an exact date, based on previous years' trends, the results for the Class 12 examinations are typically published by the end of Shrawan or the first week of Bhadra. The board is currently in the final stages of checking and tabulating the results. We recommend students to stay updated through the official NEB website (neb.gov.np) and reliable news portals. You can also bookmark this page, as we will update it with the latest information as soon as it becomes available.</p>

<h2>5 Easy Methods to Check Your NEB Class 12 Result</h2>
<p>Here are the most reliable and fastest methods to check your result with your marksheet. Make sure you have your Symbol Number and Date of Birth (in BS format: YYYY-MM-DD) ready.</p>

<h3>1. Official Websites</h3>
<p>The most reliable way to check your NEB result is by visiting the official websites. This method provides a complete marksheet which you can download and print.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Go to one of the official websites listed in the table below.</li>
    <li>Look for the link that says "NEB Class 12 Result 2081" or something similar.</li>
    <li>Enter your Symbol Number and Date of Birth (in BS format).</li>
    <li>Click the "Submit" or "View Result" button.</li>
    <li>Your result, along with a detailed marksheet, will appear on the screen. It is highly recommended to download or print it for future reference.</li>
</ol>
<div class="overflow-x-auto my-4 rounded-lg border border-gray-200 dark:border-gray-700">
  <table class="min-w-full bg-white dark:bg-black">
    <thead class="bg-gray-100 dark:bg-gray-800">
      <tr>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Website Name</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">URL</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
      <tr><td class="px-4 py-2">NEB Official Website</td><td class="px-4 py-2"><a href="http://www.neb.gov.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">www.neb.gov.np</a></td></tr>
      <tr><td class="px-4 py-2">Nepal Telecom Portal</td><td class="px-4 py-2"><a href="http://neb.ntc.net.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">neb.ntc.net.np</a></td></tr>
      <tr><td class="px-4 py-2">PDFBullet Result Hub</td><td class="px-4 py-2"><a href="https://pdfbullet.com/blog/neb-class-12-result-2081-2082" class="text-brand-red hover:underline">pdfbullet.com (You are here!)</a></td></tr>
      <tr><td class="px-4 py-2">Edusanjal</td><td class="px-4 py-2"><a href="http://see.edusanjal.com" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">see.edusanjal.com</a></td></tr>
      <tr><td class="px-4 py-2">Kantipur Publications</td><td class="px-4 py-2"><a href="http://results.ekantipur.com/" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">results.ekantipur.com</a></td></tr>
    </tbody>
  </table>
</div>

<h3>2. SMS Method (Nepal Telecom)</h3>
<p>If you don’t have internet access or if the websites are down, you can easily check your result by sending an SMS from your NTC SIM card.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Open your phone’s messaging app.</li>
    <li>Compose a new message and type: <strong>NEB &lt;space&gt; Your_Symbol_Number</strong></li>
    <li>Send the message to <strong>1600</strong>.</li>
    <li>For example: If your symbol number is 12345678, you would type <strong>NEB 12345678</strong>.</li>
    <li>Shortly after, you will receive an SMS with your GPA and overall result.</li>
</ol>
<div class="my-4 p-4 bg-yellow-100 dark:bg-yellow-900/50 border-l-4 border-yellow-400 text-yellow-800 dark:text-yellow-300">
    <strong>Did You Know?</strong> Over 400,000 students appear for the NEB Class 12 exam every year in Nepal. That’s why websites often slow down or crash on result day. Using SMS, USSD, or apps like Khalti and eSewa can help you get results faster without delay!
</div>


<h3>3. IVR Method (Interactive Voice Response)</h3>
<p>Another offline option is to call the IVR system from any NTC mobile or landline to listen to your result.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Dial <strong>1601</strong> from your NTC phone.</li>
    <li>Follow the voice instructions provided by the operator.</li>
    <li>Enter your symbol number when prompted.</li>
    <li>Wait for a few moments as the system announces your result.</li>
</ol>

<h3>4. USSD Code Service</h3>
<p>You can also use the USSD service to check your grade 12 result. This method is fast and does not require an internet connection or balance (it's free on the NTC network).</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Open your phone's dialer.</li>
    <li>Dial <strong>*1601#</strong> and press the call button.</li>
    <li>Follow the on-screen instructions that appear.</li>
    <li>Enter your symbol number.</li>
    <li>Your result will be instantly displayed on your phone screen.</li>
</ol>

<h3>5. Mobile Apps: Khalti and eSewa</h3>
<p>Popular digital wallets like Khalti and eSewa offer easy result-checking features directly within their apps. This method is user-friendly and convenient if you already use these apps for payments.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Open the Khalti or eSewa app on your smartphone.</li>
    <li>Navigate to the 'Education' or 'NEB Result' section (it's usually on the homepage during result season).</li>
    <li>Enter your symbol number and date of birth.</li>
    <li>Tap the 'View Result' button to see your marksheet.</li>
</ol>

<h2>Understanding the NEB Class 12 Grading System</h2>
<p>The NEB uses a letter grading system with a corresponding Grade Point Average (GPA). It's crucial to understand this system to interpret your marksheet correctly. Here is the detailed breakdown:</p>
<div class="overflow-x-auto my-4 rounded-lg border border-gray-200 dark:border-gray-700">
  <table class="min-w-full bg-white dark:bg-black">
    <thead class="bg-gray-100 dark:bg-gray-800">
      <tr>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Percentage (%)</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Grade</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Description</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Grade Point</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
      <tr><td class="px-4 py-2">90 to 100</td><td class="px-4 py-2 font-bold">A+</td><td class="px-4 py-2">Outstanding</td><td class="px-4 py-2">4.0</td></tr>
      <tr><td class="px-4 py-2">80 to below 90</td><td class="px-4 py-2 font-bold">A</td><td class="px-4 py-2">Excellent</td><td class="px-4 py-2">3.6</td></tr>
      <tr><td class="px-4 py-2">70 to below 80</td><td class="px-4 py-2 font-bold">B+</td><td class="px-4 py-2">Very Good</td><td class="px-4 py-2">3.2</td></tr>
      <tr><td class="px-4 py-2">60 to below 70</td><td class="px-4 py-2 font-bold">B</td><td class="px-4 py-2">Good</td><td class="px-4 py-2">2.8</td></tr>
      <tr><td class="px-4 py-2">50 to below 60</td><td class="px-4 py-2 font-bold">C+</td><td class="px-4 py-2">Satisfactory</td><td class="px-4 py-2">2.4</td></tr>
      <tr><td class="px-4 py-2">40 to below 50</td><td class="px-4 py-2 font-bold">C</td><td class="px-4 py-2">Acceptable</td><td class="px-4 py-2">2.0</td></tr>
      <tr><td class="px-4 py-2">35 to below 40</td><td class="px-4 py-2 font-bold">D</td><td class="px-4 py-2">Basic</td><td class="px-4 py-2">1.6</td></tr>
      <tr><td class="px-4 py-2" colspan="4">Below 35% in theory subjects is considered 'Non-Graded (NG)' and the final GPA will not be calculated.</td></tr>
    </tbody>
  </table>
</div>

<h2>Frequently Asked Questions (FAQs)</h2>
<div class="space-y-4 mt-6">
  <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
    <h4 class="font-semibold text-lg">What is the minimum GPA required to pass Class 12?</h4>
    <p>To be eligible for higher studies, a student must obtain a minimum of a 'D' grade (1.6 GPA) in all theory subjects and a 'C' grade in practical subjects. Additionally, students must not have an 'NG' (Non-Graded) result in any subject.</p>
  </div>
  <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
    <h4 class="font-semibold text-lg">What does 'NG' (Non-Graded) mean?</h4>
    <p>'NG' means that a student has scored below the minimum required marks (35%) in a theory subject. If you have an 'NG' in any subject, your final GPA will not be awarded, and you will need to appear for a supplementary (grade improvement) exam for that subject.</p>
  </div>
  <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
    <h4 class="font-semibold text-lg">How can I apply for a re-totaling or re-checking?</h4>
    <p>If you are not satisfied with your result, the NEB provides an opportunity to apply for re-totaling. The notice for this is usually published along with the results on the official NEB website. You will have to fill out a form and pay a nominal fee per subject within a specified timeframe.</p>
  </div>
   <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
    <h4 class="font-semibold text-lg">When will I get my official transcript and certificate?</h4>
    <p>The original academic transcript and migration certificate are usually distributed to schools/colleges a few weeks after the results are published. You should contact your college administration for information on when you can collect them.</p>
  </div>
</div>`,image:"https://ik.imagekit.io/fonepay/class%2012%20result.png?updatedAt=1753244853921",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["NEB Result","Class 12","Education","Nepal","Result 2082"]},{slug:"build-a-professional-cv-in-minutes-with-ai",title:"Build a Professional CV in Minutes with Our New AI-Powered Generator",date:"August 10, 2025",excerpt:"Landing your dream job starts with a perfect CV. Our new free CV Generator helps you create a polished, professional resume in minutes. Choose from modern templates, fill in your details, and download a job-ready PDF.",content:`<h2>The First Impression Matters Most</h2>
<p>In today's competitive job market, your Curriculum Vitae (CV) is often the very first impression you make on a potential employer. A well-structured, professional, and error-free CV can be the difference between landing an interview and being overlooked. However, creating one from scratch can be a daunting task. Which template should you use? What information is most important? How do you format it correctly?</p>

<h2>Introducing the PDFBullet CV Generator</h2>
<p>We're excited to introduce a powerful new tool to our suite: the free <a href="/cv-generator" class="text-brand-red hover:underline">CV Generator</a>. We've taken the stress and guesswork out of resume building by creating an intuitive, step-by-step process that guides you toward a perfect, job-winning CV.</p>

<h2>Key Features of the CV Generator</h2>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Professionally Designed Templates:</strong> Choose from a selection of clean, modern templates that are proven to be effective and easy for recruiters to read. No more struggling with Word formatting!</li>
    <li><strong>Guided Sections:</strong> Our tool walks you through every essential section: personal details, professional summary, work experience, education, skills, and projects. Just fill in the blanks.</li>
    <li><strong>Easy Editing:</strong> Add, remove, and reorder sections with ease. Our live preview shows you exactly what your final CV will look like as you type.</li>
    <li><strong>Instant PDF Download:</strong> Once you're finished, download your CV as a high-quality, universally compatible PDF file, ready to be sent to employers.</li>
</ul>

<h2>How to Create Your CV in 5 Simple Steps</h2>
<p>Ready to build your new CV? It's incredibly simple:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Navigate to the Tool:</strong> Go to the <a href="/cv-generator" class="text-brand-red hover:underline">CV Generator</a> page.</li>
    <li><strong>Fill in Your Details:</strong> Enter your information into the guided form on the left panel, covering everything from your contact info to your work history.</li>
    <li><strong>Upload a Professional Photo (Optional):</strong> Add a professional headshot to give your CV a personal touch.</li>
    <li><strong>Choose Your Design:</strong> Select a template and an accent color that best represents your professional brand.</li>
    <li><strong>Download Your PDF:</strong> Click the "Download PDF" button to instantly save your polished, professional CV.</li>
</ol>
<p>Stop letting CV formatting stand in the way of your career goals. Create a document that makes you stand out and land the interview you deserve. Try our free CV Generator today!</p>`,image:"https://ik.imagekit.io/fonepay/ilovepdfly%20blog.png?updatedAt=1753465347545",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["CV Generator","Resume Builder","Job Search","Career","Free CV Maker","How To"]},{slug:"ai-lesson-plan-creator-for-teachers",title:"Your New Teaching Assistant: The AI Lesson Plan Creator",date:"August 9, 2025",excerpt:"Teachers, reclaim your time! Our new AI Lesson Plan Creator generates detailed, engaging, and curriculum-aligned lesson plans for any subject in seconds. Spend less time on paperwork and more time inspiring your students.",content:`<h2>The Challenge of Modern Teaching</h2>
<p>Educators are the backbone of our society, but the demands on their time are immense. Lesson planning, in particular, is a critical but incredibly time-consuming task. Crafting engaging, effective, and curriculum-aligned plans for every class can take hours each week—hours that could be spent interacting with students or focusing on professional development.</p>

<h2>Save Time with the AI Lesson Plan Creator</h2>
<p>We believe technology should empower teachers, not add to their workload. That’s why we’re thrilled to launch the <a href="/lesson-plan-creator" class="text-brand-red hover:underline">AI Lesson Plan Creator</a>, a revolutionary tool designed to be every teacher's new favorite assistant.</p>
<p>Simply provide a few key details—grade level, subject, topic, and class duration—and our AI will generate a comprehensive and structured lesson plan in seconds. It's designed to give you a high-quality, editable foundation that you can adapt to your unique classroom needs.</p>

<h2>What Does a Generated Lesson Plan Include?</h2>
<p>Our AI doesn't just give you a vague outline. It creates a complete, actionable plan with all the essential components:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Clear Objectives:</strong> Concrete learning goals for students to achieve.</li>
    <li><strong>Engaging Introduction:</strong> A creative "hook" to capture your students' attention from the start.</li>
    <li><strong>Step-by-Step Activities:</strong> Detailed main teaching activities, including suggestions for group work and interaction.</li>
    <li><strong>Assessment Ideas:</strong> Practical ways to check for understanding, from quick quizzes to group discussions.</li>
    <li><strong>Homework Assignments:</strong> Relevant and meaningful practice for students to complete after class.</li>
    <li><strong>Materials List:</strong> A checklist of all the resources you'll need for the lesson.</li>
</ul>

<h2>How It Works</h2>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Go to the Tool:</strong> Visit the <a href="/lesson-plan-creator" class="text-brand-red hover:underline">AI Lesson Plan Creator</a>.</li>
    <li><strong>Enter Your Lesson Details:</strong> Specify the grade, subject, topic, and duration. You can even suggest a teaching style (e.g., "Interactive & Hands-on").</li>
    <li><strong>Generate the Plan:</strong> Click the "Generate" button and watch as the AI crafts your lesson plan in real-time.</li>
    <li><strong>Review and Refine:</strong> Use the generated plan as-is, or copy and paste it into your favorite editor to tweak and personalize it for your students.</li>
</ol>
<p>The AI Lesson Plan Creator is more than a tool; it's a partner in education. It's here to help you reduce prep time, overcome creative blocks, and focus on what you do best: teaching. Give it a try and revolutionize your planning process today!</p>`,image:"https://ik.imagekit.io/fonepay/4B237CD5-C59B-4982-9ED4-E9A479E8BDA1.png?updatedAt=1753468582689",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Lesson Plan Creator","AI for Teachers","Education","EdTech","Teaching Tools","Productivity"]},{slug:"turn-any-text-into-a-quiz-ai-question-generator",title:"Study Smarter: Turn Any Text into a Quiz with Our AI Question Generator",date:"August 8, 2025",excerpt:"Transform your study materials instantly! Our new AI Question Generator takes any text—from articles to textbook chapters—and automatically creates a variety of quiz questions to help you learn and retain information more effectively.",content:`<h2>The Power of Active Recall in Learning</h2>
<p>Reading and highlighting text is a common study method, but research shows that one of the most effective ways to learn and remember information is through "active recall"—the process of actively retrieving information from your memory. In other words, quizzing yourself is one of the best ways to study.</p>
<p>But creating good questions takes time and effort. What if you could instantly generate a quiz from any text you're studying? Now you can.</p>

<h2>Introducing the AI Question Generator</h2>
<p>We are excited to launch our <a href="/ai-question-generator" class="text-brand-red hover:underline">AI Question Generator</a>, a powerful tool for students, teachers, and lifelong learners. Simply paste any text into the tool, and our AI will analyze the content and generate a diverse set of questions to test your knowledge.</p>

<h2>How Can It Help You?</h2>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>For Students:</strong> Instantly create a practice quiz from your lecture notes, textbook chapters, or online articles. Test your understanding before an exam and identify areas where you need to review.</li>
    <li><strong>For Teachers:</strong> Quickly generate questions for a pop quiz, a worksheet, or a study guide. Save valuable prep time while still providing valuable learning materials for your students.</li>
    <li><strong>For Anyone:</strong> Want to make sure you understood that dense news article or business report? Paste it in and get a set of questions to confirm your comprehension.</li>
</ul>

<h2>A Variety of Question Types</h2>
<p>To ensure a comprehensive review, our AI generates a mix of question formats based on your text, including:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Multiple Choice:</strong> Test your knowledge with several options.</li>
    <li><strong>True/False:</strong> Verify key facts and statements.</li>
    <li><strong>Short Answer:</strong> Challenge yourself to recall specific information and concepts.</li>
</ul>
<p>Each question comes with the correct answer, so you can check your work immediately. Stop just reading and start actively learning. Turn your study material into an interactive learning experience with the AI Question Generator today!</p>`,image:"https://ik.imagekit.io/fonepay/7543789B-8C56-4BF2-9952-6D6C2F17BA25.png?updatedAt=1753468583193",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["AI Question Generator","Study Tools","Education","Quiz Maker","Learning","Productivity","AI"]},{slug:"you-can-now-edit-images-in-pdfbullet",title:"You can now edit images in PDFBullet",date:"August 4, 2025",excerpt:"Exciting news! PDFBullet is expanding beyond PDFs. Discover our powerful new image editing tools, including a one-click Background Remover, designed to streamline your creative workflow. Edit your images and convert them to PDF all in one place.",content:`<h2>More Than Just PDFs: Welcome to Image Editing!</h2>
<p>We've always been your go-to solution for everything PDF, but we know your projects often involve more than just documents. That's why we're thrilled to announce that PDFBullet is expanding its toolkit to include powerful, easy-to-use image editing features!</p>
<p>Now, you can manage both your documents and your images in one convenient place, streamlining your workflow and boosting your productivity. Say goodbye to switching between different apps—your complete toolkit is right here.</p>

<h2>Introducing a Game-Changer: One-Click Background Removal</h2>
<p>Have you ever needed to isolate a subject from its background for a presentation, a product photo, or a creative project? Our new <a href="/remove-background" class="text-brand-red hover:underline">Remove Background tool</a> makes this complex task incredibly simple.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Effortless and Automatic:</strong> Simply upload your image (PNG or JPG), and our AI will automatically detect and remove the background with precision.</li>
    <li><strong>Perfect for Any Project:</strong> Create clean product images for your e-commerce store, professional headshots for your profile, or stunning graphics for your presentations.</li>
    <li><strong>High-Quality Results:</strong> Get a crisp, clean cutout with a transparent background, ready to be used anywhere.</li>
</ul>
<p>No more tedious manual selection or expensive software. It's professional-grade background removal, and it's free to use.</p>

<h2>A Complete Image-to-Document Workflow</h2>
<p>Our new image tools are designed to work seamlessly with our existing PDF features, creating a complete workflow from image to final document.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Edit Your Image:</strong> Start by perfecting your image. Use the <a href="/remove-background" class="text-brand-red hover:underline">Remove Background</a> tool to get a clean cutout.</li>
    <li><strong>Convert to PDF:</strong> Once your image is ready, use our trusted <a href="/jpg-to-pdf" class="text-brand-red hover:underline">JPG to PDF</a> tool to convert single or multiple images into a high-quality PDF document.</li>
    <li><strong>Organize and Share:</strong> Need to add the new image PDF to an existing report? Use our <a href="/merge-pdf" class="text-brand-red hover:underline">Merge PDF</a> tool to combine it with other documents. Your polished, professional document is now ready to be shared.</li>
</ol>
<p>This makes it easier than ever to digitize and manage your visual content.</p>

<h2>What's Next?</h2>
<p>This is just the beginning of our journey into image editing. We're committed to building the most comprehensive and user-friendly toolkit for all your digital needs. We can't wait for you to try out these new features and hear your feedback!</p>
<p>Ready to get started? Explore our new image tools today!</p>`,image:"https://www.ilovepdf.com/storage/blog/55-1623331581-iOS-mobile-app@348w.jpeg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Image Editing","New Feature","Productivity","Remove Background","Photo Editor","Design"]},{slug:"the-best-free-graphic-design-software-2025",title:"The best free graphic design software: 32 must-have tools (2025)",date:"January 4, 2024",excerpt:"Explore graphic design tools ranging from color pallets & AI image generators to photo editing software & file management tools.",content:`<p>Looking for the best free graphic design tools? We’ve done the research so you don’t have to. Check out this list containing some of the best tools for creating professional designs without the professional price tags.</p>
<p>The difficulty levels of the tools varies from motivated amateurs to perfectionist professionals, so you can choose the graphic design software that suits your needs and level.</p>
<p>This post will break down the graphic design software tools into 10 useful categories, from AI image generators to file management tools.</p>
<h2>AI image generators</h2>
<p>Text-to-image generators are a hot topic that’s taking off in 2023. Artificial intelligence is changing the way we approach graphic design, and proving to be controversial in its journey.</p>
<p>These powerful tools use machine learning algorithms to create unique and eye-catching graphics in just a few clicks. Whether you're looking to generate patterns, logos, or photo-realistic images - AI image generators are captivating creative tools.</p>
<p>The software might not give you the perfect professional results every time as we are still in the early stages of this AI explosion. Nevertheless, these tools show incredible potential and can be used for content creation or to push your ideas and imagination to the max.</p>
<h3>DALL-E from OpenAI</h3>
<p>DALL-E from OpenAI (the same people who made the headline-smashing ChatGPT) is a clear front-runner in the race for AI image generators. The free AI image tool is great at taking precise inputs to create multiple variations that let you select the best from the bunch.</p>
<p>It’s most effective when choosing a style for the images, for example an expressive oil painting, a pencil drawing, or a watercolor painting. This feature makes it possible to create unique, professional-looking images with ease.</p>
<p>The software is being updated and improved on a regular basis, so keep watching these AI image generators as many changes and new features are undoubtedly around the corner.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678104291-6.-Dalle.png" alt="DALL-E AI Image Generator" class="my-4 rounded-lg shadow-md" />
<h3>Midjourney</h3>
<p>Midjourney creates high-quality designs compared to many of its competitors, with styles that are futuristic and atmospheric. Considering the early stages of the development, like DALL-E, it’s incredible how far these tools have come in such a short amount of time with such impressive results.</p>
<p>However, despite its impressive capabilities, the biggest drawback is its usability. The process to create an image is complicated and time-consuming—you have to enter Discord, find a new “newbies channel”, and then use the “/imagine” command in a chaotic chat with images flying through the chat.</p>
<p>Aside from the difficult usability, once you have understood the process the results of this AI art generator are remarkable.</p>
<h3>DeepAI</h3>
<p>DeepAI is fun AI image generator that lacks some finishing touches. It’s a great tool to get some inspiration on specific ideas, with a simple search bar that is easy to use, and a number of free styles to choose from.</p>
<p>While the results produced by its text-to-image converter may not be as polished and professional as those produced by other AI image generators. DeepAI has a lot of potential, and is a playful tool with a number of free styles to choose from, giving users plenty to experiment with.</p>
<h2>Color palette generators</h2>
<p>This chapter is all about color. We'll explore the best free graphic design software options specifically made to help you create stunning color palettes.</p>
<p>Whether you're a seasoned designer or just starting out, these tools make it easy to experiment with color, select a harmonious scheme, and set the scene for your color scheme. So, let's dive in and discover the best free color palette tools.</p>
<h3>Coolors</h3>
<p>See what’s hot with trending color palettes, generate colors, and select colors from photos with this well-designed website that helps you get into the creative mood from the get-go. Coolors is easy to use and palettes are simple to export, with many options for sharing your chosen colors.</p>
<p>Whether you want to find warm color palettes and share them with your team or save them for future projects, this tool has a smooth workflow that makes it easy to work on multiple new projects while organizing the old ones.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678103451-1.-Coolors.png" alt="Coolors Color Palette Generator" class="my-4 rounded-lg shadow-md" />
<h3>Color Space</h3>
<p>Color Space is a useful color palette generator to develop your ideas for a design that starts with a single color. Put your desired color in and the site generates a variety of color palettes including gradient and random shades.</p>
<p>It’s simple to create basic gradients, and has recently released the option to make 3 Color Gradients, which are extremely easy to edit and play around with.</p>
<p>The drawback is that you are limited in the amount of palettes that you can explore, especially if you’re starting from scratch and don’t have a color palette already in mind.</p>
<h3>Adobe Capture</h3>
<p>Adobe Capture is a color palette generator that offers ten free tasks before having to register. This is a superb mobile app that takes real-time images and lets you create a color palette from whatever you see around you.</p>
<p>The app is a useful addition that makes it easy to generate a color palette from an image, whether you choose to use a live camera view or select a saved photo. You can also create shapes and patterns as interesting artistic features.</p>
<h2>Image editing tools</h2>
<p>Photo editing is an essential aspect of graphic design. Whether it's adjusting the angle, changing the brightness and contrast, or adding special filters, having the right image editing software makes all the difference to your final results.</p>
<p>In this section, we'll explore some of the best free image editors available to help elevate your design work and give it that professional touch. Image editing tools can be difficult to use, so we've also included some that are more straightforward.</p>
<h3>iLoveIMG Editor</h3>
<p>The iLoveIMG's Photo Editor is by far the easiest of these free photo editing software. It is a simple yet versatile tool with a range of editing options that allow you to draw on images and add more image files. Users can easily crop, resize, add filters, frames, and effects to add a professional finish to designs.</p>
<p>If you’re looking for a basic photo editor that’s easy and quick to use for some basic editing, then this is the perfect option.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678103763-2.1-iLoveIMG-Edit-tool.png" alt="iLoveIMG Photo Editor" class="my-4 rounded-lg shadow-md" />
<h3>Photopea</h3>
<p>Acting as a close alternative to Photoshop, Photopea is an online tool that provides many design features, without the need to download any expensive software.</p>
<p>It's worth pointing out that as an online tool it may run slowly if you’re working with heavy editing tasks. Also, if you are used to other editing software then it will take some time to learn its features.</p>
<p>Despite these challenges, Photopea is a fantastic free editing tool for designers who want professional features to bring their creative visions to life.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678103850-2.-Photopea.png" alt="Photopea Online Editor" class="my-4 rounded-lg shadow-md" />
<h3>GIMP</h3>
<p>GIMP is a fantastic open-source image editing software that provides powerful image editing tools and offers an impressive variety of file formats, all completely free.</p>
<p>The workspace is slightly cluttered and it can be difficult to navigate all of the features, especially for beginners, but once you’ve mastered the basics this is an amazing feature-packed photo editor and another free alternative to Photoshop.</p>
<h3>Adobe creative cloud (free trial)</h3>
<p>Adobe graphic design software isn’t the easiest if you’re just starting out, but it takes the top spot for the most in-depth software for image and video editing.</p>
<p>For professionals, this is the industry standard for quality editing, and within the Creative Cloud you have access to multiple Adobe products, including Photoshop, After Effects, and Premiere Pro just to name a few.</p>
<p>Perfect if you aren’t needing them long term, there are free trials for many of the tools. While a 7-day free trial is available, the software can be expensive if you’re looking for a longer-term editing solution.</p>
<h2>Font generators</h2>
<p>Welcome to the world of font generators. For anyone working or playing around with designs, typography plays a crucial role in making your work stand out with the right style.</p>
<p>Free font generators help you find custom typefaces for your projects without the need for extensive design knowledge and expensive font licenses. Experiment with different styles and letterforms until you find the perfect look for your design.</p>
<h3>Fontspring</h3>
<p>Fontspring offers multiple categories that help you find the right free font download. It is also simple to sort the fonts by ‘Most Favorited’ to see what’s trending, as well as 'Best Of’ lists to investigate the most popular selection from previous years.</p>
<p>Frustratingly, when browsing the fonts some are listed as containing free versions when in reality they are only available as icons, which is misleading. If you don’t mind spending time finding the free ones, this is a valuable resource.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678105548-3.-Fontspring.png" alt="Fontspring Font Generator" class="my-4 rounded-lg shadow-md" />
<h3>WhatTheFont/MyFonts</h3>
<p>WhatTheFont (also known as MyFonts) has high-quality downloads that are searchable within useful categories. Are you trying to identify a font you’ve spotted? MyFonts can also scan an uploaded image to find and identify the font you want to identify.</p>
<p>Frustratingly, free fonts are often hidden among the paid options, requiring you to scroll through the listings to download the font you need. Despite this, MyFonts remains a great tool for anyone looking for a free font generator.</p>
<h3>Google Fonts</h3>
<p>Google Fonts provides an extremely popular free font browser that offers typography in multiple languages and design styles. There is a user-friendly interface that offers fonts that are free for personal and commercial use.</p>
<p>A drawback is that the range of types is not as diverse as other font browsers, with limited options within a chosen fonts style. If you're looking for a more specific font style, you may need to look elsewhere.</p>
<h2>Icon downloads</h2>
<p>Icons play a critical role in creating a professional and polished look for websites, mobile applications, and other digital platforms. In this section, we'll be exploring the best free icon downloads so you can find the perfect designs for your next project.</p>
<p>From modern designs and classic looks to simple social media icon downloads - the ability to browse and use royalty-free icons is key for any digital designer or marketer looking to create a cohesive brand experience.</p>
<p>We've compiled a list of the top free graphic design software that gives you quality icon libraries to complement your designs.</p>
<h3>Flaticon</h3>
<p>Flaticon gives users a robust library of high-quality designs, where you can find PNG, SVG, Android, and iOS versions of the most popular fonts. Selected fonts also have different styles with changing colors and contrast.</p>
<p>Free users are restricted to downloading certain icons as a PNG, and the SVG version of the icon is sometimes only available with the Premium service.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678105567-4.-Flaticon.png" alt="Flaticon Icon Downloads" class="my-4 rounded-lg shadow-md" />
<h3>Noun Project</h3>
<p>The Noun Project is a well-designed platform that offers a more creative and inclusive range of free icons to what we’re used to.</p>
<p>With its user-friendly interface, easily find individual icons or browse through various icon collections to find the perfect fit for your project.</p>
<p>The basic free download option only provides icons in black, but the premium downloads are cost-effective and allow for more customization. If you’re looking for basic but creative and inclusive icons, then Noun Project is a great choice.</p>
<h3>Google Icons within Fonts</h3>
<p>We’re back to Google Fonts, but this time for downloading free icons. Google Icons offers an extensive library of high-quality icons that are perfect for UI design, allowing for the customization of Fill, Weight, Grade, and Optical Size.</p>
<p>Icons are available in SVG or PNG formats for download, as well as the information on the 'Variable Icon Font' configuration for CSS, making it easy for designers to integrate their icons into their web projects.</p>
<h2>3D & 2D Animation software</h2>
<p>Bring your ideas to life with 3D and 2D Animation software. Whether you're creating a short clip for a commercial, designing characters for a video game, or adding some movement to your graphics - free animation software takes your designs to the next level.</p>
<p>We’ve found some of the best animation software that published professionals and aspiring amateurs can all enjoy.</p>
<h3>Blender</h3>
<p>Boasting an intuitive interface, Blender animation software is a widely acclaimed free and open-source tool that’s best for intermediate or professional animators.</p>
<p>It’s loved for its 3D pipeline editing, including 3D and 2D animation, and has an impressive array of animation features that you’d expect to see in the best premium animators.</p>
<p>Despite some occasional lag and slow render times, the software is regularly updated and continues to receive improvements, making it one of the best free animation software options available.</p>
<p>With its versatile tools, Blender is widely used in the creation of animations, models, and artwork, providing a one-stop solution for artists and designers.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678105589-5.-Blender.jpeg" alt="Blender Animation Software" class="my-4 rounded-lg shadow-md" />
<h3>Piskel</h3>
<p>Piskel is a perfect option for those just starting out with animation. As a beginner’s tool, the basic and straightforward interface makes it a breeze to use.</p>
<p>The focus of Piskel is on creating 2D animated pixel art and sprite animations, so it's a great choice for game designers and hobbyists.</p>
<p>This 2D animation software offers a wide range of tools and functions, including customizable color palettes, layers, frame management, and more. That being said, for more professional applications, it's unlikely to have all the features and tools required.</p>
<h3>Animaker</h3>
<p>Animaker is another tool that makes it easy to get started with 3D animation software. It has a lot of template characters and customization options that can build a professional final project, as well as sharing options that let you integrate it with other programs.</p>
<p>Within one free animation tool, you have everything you need to create your content within a single tool by adding music and effects, and even the option to create voiceovers from text.</p>
<p>It has various pricing plans if you find that the limited number of free version downloads aren’t enough.</p>
<h2>Find inspiration for your designs</h2>
<p>Stuck for inspiration? It isn’t easy creating content, and being able to keep your designs fresh and interesting will require finding inspiration for your projects.</p>
<p>When you know where to look, the internet is a creative goldmine that’s waiting to be explored. Kick off your next project by browsing the best design inspiration websites.</p>
<p>In this section, we'll outline interesting websites to look for design ideas, including some comments on the more professional sources that are more specifically aimed at graphic designers.</p>
<h3>Behance</h3>
<p>Behance is a leading online platform for graphic designers to showcase their work and connect with the design community. It offers a wealth of inspiration and opportunities for collaboration, with a diverse range of projects and designers to discover, and it has a more professional feel than Pinterest.</p>
<p>With its easy-to-use interface, Behance lets you search by Creative Tools, Colors, and Source Categories so you can narrow your search even further.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678105849-7.-Behance-.png" alt="Behance for Design Inspiration" class="my-4 rounded-lg shadow-md" />
<h3>Pinterest</h3>
<p>Pinterest is a straightforward way to research, save, and send new ideas on whatever you’re working on. You can build a network of profiles that you enjoy to follow the latest updates from creators that inspire you, or go through current trending topics.</p>
<p>It also allows you to create boards for your own work, making it an excellent portfolio tool, as well as a research tool.</p>
<h3>Dribbble</h3>
<p>Dribbble is a popular platform with a focus on design. Each category shows trending designs and techniques, and like our other examples, it also provides the chance for graphic designers to share their work and get feedback from the design community.</p>
<p>Browse and follow your favorite designers to keep yourself inspired. When selecting a profile you can see their designs neatly organized into Projects and Collections, as well as the liked designs which have inspired them.</p>
<h2>Stock images</h2>
<p>Are you searching for free stock images? Not everyone has access to professional photography equipment, which is why high-quality stock images are so key for creative roles.</p>
<p>Finding copyright-free images can take up a lot of time that would be better spent elsewhere. This section will look at the best free stock images for commercial use that offer landscapes, people shots, graphics, illustrations. and more.</p>
<h3>Pexels</h3>
<p>Pexels has high-quality content that doesn’t leave you worrying about copyright issues. You can search for images and videos using different categories, but there are no advanced search features for more technical and specific content, so the results can sometimes be slightly repetitive.</p>
<p>In general, the design of the categories and popular collections could be improved to make browsing the stock photos a little more user-friendly. That being said, it’s easy to download the content you require without being bombarded with premium restrictions and payment obligations, which is a big plus.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678106190-8.-Pexels.png" alt="Pexels Stock Images" class="my-4 rounded-lg shadow-md" />
<h3>Unsplash</h3>
<p>A fantastic resource for royalty-free, high-quality stock photos, Unsplash has a vast collection of over a million images. Easily browsable categories and a simple website can save you time when you’re looking for free image downloads.</p>
<p>Depending on your theme and niche, the variety of results can be limited, but for general topics it is worth your time. If you don’t have a budget for paid images, then this is a great source for professional content.</p>
<h3>Kaboompics</h3>
<p>From the get-go Kaboompics has a great design that draws you into the site. You can easily select the orientation from the search bar, there is the extremely useful feature of the color palette search also available from the main page, and you can include a custom aspect ratio when downloading.</p>
<p>While the library for Kaboompics isn’t as large as some of its competitors, the usability of the site and the quality of the free stock photos are fantastic. Available for commercial or personal use, you can edit, post, and use them as you require.</p>
<h2>File management</h2>
<p>File management is an essential aspect of graphic design, and having the right software can make all the difference in keeping your work organized and accessible.</p>
<p>Every designer knows the struggles of working with large image files and the compatibility issues that arise when using different image types.</p>
<p>Here we’ll be showcasing the best free file management software to keep your workflow streamlined and efficient. These software solutions are packed with features to keep your work organized, accessible, and secure.</p>
<h3>Compress PDF files with iLovePDF</h3>
<p>The Compress PDF tool is a lifesaver when it comes to helping you save, share, or design your portfolio. You can reduce the file size of your PDF files for free with this PDF compressor to make them easier to send, store, and upload.</p>
<p>Are you struggling to share or upload files because of large file sizes? Use the free Compress PDF tool to drastically make your files smaller and more manageable. This is especially useful for design students trying to submit their files for assessment.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678110276-9.-iLovePDF-Compress-%281%29.png" alt="I Love PDFLY Compress PDF" class="my-4 rounded-lg shadow-md" />
<h3>iLoveIMG Compress Image tool</h3>
<p>This free image compressor takes your pictures and reduces the file size while keeping as much quality as possible. When you’re creating designs, large file sizes lead to web designers struggling with storage, upload issues, and slow loading times for website and online content—this is a perfect solution.</p>
<p>Quickly and easily reduce the size of your images with a user-friendly tool that can complete your task in under a minute from start to finish. It can also batch convert JPG to PDF along with the other image files it accepts, including PNG, SVG, and GIF.</p>
<h3>iLovePDF JPG to PDF converter</h3>
<p>Transform your JPG files into professional PDF documents with ease and precision, thanks to iLovePDF's free JPG to PDF converter.</p>
<p>Whether you're working with one file or a batch of JPGs, this fast and convenient tool will save you time and ensure your designs are ready for printing, presenting, or sharing in a format famed for its accuracy.</p>
<h3>iLovePDF/IMG Watermark tools</h3>
<p>Protect your valuable designs and ensure they are not used without your permission with the iLoveIMG and iLovePDF Watermark tools. With user-friendly interfaces, adding a custom watermark to your images or PDFs has never been easier.</p>
<p>Overall, it’s recommended that you use the iLovePDF tool for a wider range of features. The free watermark tools allow you to add a text box with editable fonts, sizes, color, and more.</p>
<p>Whether you're an artist, designer, photographer, or any other creative professional, these tools keep your designs protected.</p>
<h2>Bonus chapter: Simple design tools for content creation</h2>
<p>You don’t have to be a design expert to create content for social media that looks professional and creative. This section is focused on graphic design tools for beginners that can be used to create content across various platforms like Instagram, LinkedIn, and TikTok.</p>
<p>A lot of design software now has entire sections for the creation of this content, with sizes, templates, and pre-made features meaning you can create without being a Photoshop and video-editing expert.</p>
<h3>Canva</h3>
<p>Canva is an outstanding way to edit high-quality templates or create your designs completely from scratch. It is extremely easy to use, and boasts a huge variety collection of templates, images, and graphics that simplify the design process and save you time, with intuitive editing features that take no time at all to get your head around.</p>
<p>It offers a seamless and accessible design experience, enabling designers of all levels to effortlessly craft visually appealing graphics and visual content.</p>
<p>It has a section designed specifically for social media that enable you to work with the correct aspect ratio relative to the platform you want to post on.</p>
<img src="https://www.ilovepdf.com/storage/blog/205-1678110794-10.-Canva.png" alt="Canva Design Tool" class="my-4 rounded-lg shadow-md" />
<h3>Capcut</h3>
<p>Another user-friendly tool, Capcut is designed especially for creating professional videos for your social media content. It provides the tools to craft captivating and professional-looking videos that will grab the attention of your audience with very little previous experience.</p>
<p>The web version may experience some issues with lag, so downloading the app and creating videos directly from your mobile device is a good idea if you come across this problem.</p>`,image:"https://www.ilovepdf.com/storage/blog/205-1678104167-Graphic-Design-Software.jpg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Graphic Design","Software","Free Tools","AI","Productivity","Design"]},{slug:"how-to-convert-html-to-pdf",title:"How to convert HTML websites into PDF files",date:"August 3, 2025",excerpt:"Have you tried to download a webpage before, only to be left with a faulty file that's cut the most important graph in half? Use this online tool to accurately convert web pages into PDF documents.",content:`<h2>The Problem with Saving Webpages</h2>
<p>Have you ever tried to save an important webpage for offline use—like an online receipt, a travel itinerary, or a fascinating article—only to end up with a mess? Using the browser's "Save As" feature can result in broken layouts and missing images. Taking screenshots often means stitching together multiple images and losing the ability to select text. The "Print to PDF" function can be even worse, awkwardly cutting off content and ruining the formatting of tables and graphs.</p>

<h2>The Perfect Solution: HTML to PDF Conversion</h2>
<p>Our <a href="/html-to-pdf" class="text-brand-red hover:underline">HTML to PDF converter</a> is designed to solve this problem perfectly. It accurately captures the entire content of a live webpage—including all text, images, and layout elements—and preserves it in a single, high-quality PDF document. This method is incredibly useful for:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Archiving Articles:</strong> Save news articles or blog posts for offline reading or research.</li>
    <li><strong>Saving Online Receipts:</strong> Keep a clean, readable record of your online purchases.</li>
    <li><strong>Creating Offline Reading Material:</strong> Compile tutorials, guides, and documentation into a portable format.</li>
    <li><strong>Sharing Web Content:</strong> Share a static, unchangeable version of a webpage with colleagues or clients.</li>
</ul>

<h2>How to Convert a Webpage to PDF</h2>
<p>The process is incredibly simple and takes just a few seconds. Follow these steps:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Find the webpage:</strong> Open the webpage you want to convert in your browser and copy its URL from the address bar.</li>
    <li><strong>Go to our tool:</strong> Navigate to the <a href="/html-to-pdf" class="text-brand-red hover:underline">HTML to PDF tool</a>.</li>
    <li><strong>Paste the URL:</strong> Paste the copied URL into the input field provided.</li>
    <li><strong>Click 'Convert to PDF':</strong> Our tool will instantly fetch the webpage, render it, and convert it into a perfectly formatted PDF.</li>
    <li><strong>Download your file:</strong> Your new PDF will be ready for download immediately.</li>
</ol>
<p>Say goodbye to awkward screenshots and incomplete printouts. With our HTML to PDF converter, you can reliably save any webpage as a clean, professional, and portable document.</p>`,image:"https://images.minitool.com/minitool.com/images/uploads/2021/04/html-to-pdf-thumbnail.png",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["HTML to PDF","Convert to PDF","Webpage to PDF","How To","Archive","Productivity"]},{slug:"how-to-add-password-to-pdf",title:"How to add a password to a PDF",date:"August 2, 2025",excerpt:'Find out how to keep your sensitive data secure by adding a password to your PDF document. In an age where data privacy is paramount, protecting your documents is more important than ever. Our "Protect PDF" tool offers a simple yet robust solution to encrypt your files.',content:`<h2>Why Add a Password to Your PDF?</h2>
<p>In an age where data privacy is paramount, protecting your documents is more important than ever. Whether you're sharing confidential business reports, sending personal identification, or archiving sensitive financial records, adding a password provides a critical layer of security. It ensures that only authorized individuals with the correct password can open and view the contents of your PDF file.</p>
<p>Password protection uses encryption to scramble the data within the PDF, making it unreadable without the key (your password). This is the most effective way to prevent unauthorized access and maintain confidentiality.</p>

<h2>How to Password Protect a PDF Online for Free</h2>
<p>Our <a href="/protect-pdf" class="text-brand-red hover:underline">Protect PDF tool</a> offers a simple, fast, and secure way to encrypt your files. Follow these easy steps:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Go to the Protect PDF tool:</strong> Navigate to the tool page to get started.</li>
    <li><strong>Upload your PDF file:</strong> Select the PDF document you want to secure from your device, Google Drive, or Dropbox.</li>
    <li><strong>Set a strong password:</strong> In the options panel on the right, type your desired password. You will be asked to type it a second time to confirm and avoid typos. Choose a password that is strong and not easily guessable.</li>
    <li><strong>Click 'Protect PDF':</strong> Once you've set your password, click the button to start the encryption process.</li>
    <li><strong>Download your secure file:</strong> Your PDF is now password-protected. Click the download button to save it. Anyone who tries to open this file will now be prompted to enter the password you set.</li>
</ol>

<h2>Your Security is Our Priority</h2>
<p>We understand the importance of the documents you process with us. The entire password protection process is handled securely. Your files are uploaded over an encrypted connection, and they are automatically and permanently deleted from our servers within a few hours. This guarantees that your privacy is always respected.</p>
<p>Using our "Protect PDF" tool is the perfect way to share documents with peace of mind, knowing that your sensitive information is safe.</p>`,image:"https://www.ilovepdf.com/storage/blog/54-1623250400-Secure-remote-working@348w.jpeg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Protect PDF","Password","Security","Encryption","How To","Data Privacy"]},{slug:"are-digital-signatures-legally-binding",title:"Are digital signatures legally binding?",date:"August 1, 2025",excerpt:"Digital signatures are a top choice for cross-border business transactions. But are they legally binding? The short answer is yes, in many parts of the world. This guide explains the legal frameworks, the technology behind them, and how our Sign PDF tool can help.",content:`<h2>The Short Answer: Yes, They Are.</h2>
<p>In an increasingly digital world, signing documents electronically has become the norm. But a common question remains: are digital signatures actually legally binding? The short answer is yes, in most countries around the world, digital signatures carry the same legal weight as a traditional handwritten signature. Laws like the <strong>ESIGN Act</strong> in the United States and the <strong>eIDAS Regulation</strong> in the European Union have established solid legal frameworks that validate their use in commerce and legal proceedings.</p>

<h2>Understanding the Difference: Electronic vs. Digital Signatures</h2>
<p>While often used interchangeably, there's a key distinction between a standard "electronic signature" and a more secure "digital signature."</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li>An <strong>electronic signature</strong> can be as simple as a typed name at the end of an email or an image of a handwritten signature. It indicates intent to sign but has limited security.</li>
    <li>A <strong>digital signature</strong> is a highly secure type of electronic signature. It uses cryptographic technology to embed a unique, verifiable 'fingerprint' into the document. This makes it far more secure and legally robust.</li>
</ul>

<h2>The Three Pillars of a Secure Digital Signature</h2>
<p>A true digital signature provides three critical guarantees that make it legally sound:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li><strong>Authentication:</strong> It cryptographically verifies that the person signing is who they claim to be, preventing forgery.</li>
    <li><strong>Integrity:</strong> It creates a tamper-evident seal. If the document is altered in any way after being signed, the signature becomes invalid.</li>
    <li><strong>Non-repudiation:</strong> The cryptographic link between the signature and the document means the signer cannot later deny their involvement in the signing process.</li>
</ol>

<h2>How PDFBullet Helps</h2>
<p>Our <a href="/sign-pdf" class="text-brand-red hover:underline">Sign PDF tool</a> is designed to create secure and verifiable digital signatures. It provides a complete audit trail, including timestamps and IP addresses, which strengthens the legal standing of your signed documents. Whether you're signing a simple agreement or a critical business contract, our tool provides the security and validity you need.</p>

<h2>Final Recommendation</h2>
<p>While digital signatures are widely accepted, regulations can vary by jurisdiction and the nature of the document. For highly sensitive or regulated transactions, it's always a good practice to consult with a legal professional to ensure full compliance with local laws. For the vast majority of business and personal needs, a secure digital signature provides a reliable and legally binding solution.</p>`,image:"https://www.ilovepdf.com/storage/blog/43-1623746170-Digital-Signature@348w.jpeg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Digital Signature","eSign","Legally Binding","Security","Sign PDF","How To"]},{slug:"smart-ocr-tips-get-most-out-of-scanned-documents",title:"Smart OCR tips: how to get the most out of your scanned documents",date:"July 31, 2025",excerpt:"Boost your OCR results with smart scanning techniques. Learn how resolution, contrast, and language support affect text recognition accuracy. Optical Character Recognition (OCR) is a powerful technology, but its accuracy depends on the quality of the source image. This guide provides tips on how to scan your documents to achieve the best possible OCR results, ensuring your text is searchable and selectable with high fidelity.",content:`<h2>Why Scan Quality is Everything for OCR</h2>
<p>Optical Character Recognition (OCR) is a fantastic technology that transforms flat, non-interactive images of text (like a scanned document) into fully searchable, selectable, and editable text. It's the magic behind making your paper archives digital. However, the accuracy of OCR is highly dependent on one thing: the quality of the source scan. A blurry, skewed, or low-resolution scan will result in jumbled text and poor recognition. To get the most out of our <a href="/ocr-pdf" class="text-brand-red hover:underline">OCR PDF tool</a>, follow these smart scanning tips.</p>

<h2>1. Aim for the Right Resolution (DPI)</h2>
<p>DPI, or Dots Per Inch, is a measure of a scanner's resolution. For OCR, the sweet spot is generally <strong>300 DPI</strong>. Here’s why:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Too Low (e.g., 150 DPI):</strong> The characters might be too pixelated for the OCR engine to recognize them accurately, leading to errors.</li>
    <li><strong>Just Right (300 DPI):</strong> This provides enough detail for clear character recognition without creating an unnecessarily large file. It's the industry standard for archiving documents.</li>
    <li><strong>Too High (e.g., 600+ DPI):</strong> While it provides more detail, it often doesn't significantly improve OCR accuracy for standard text and results in a much larger file size, which takes longer to process.</li>
</ul>

<h2>2. Optimize Contrast and Brightness</h2>
<p>Clarity is key. The OCR engine works best when there is a sharp contrast between the text and the background. The ideal document is crisp black text on a clean white background.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Adjust Scanner Settings:</strong> Before scanning, use your scanner's preview function to adjust brightness and contrast. Increase the contrast to make the text darker and the background whiter.</li>
    <li><strong>Avoid Shadows and Stains:</strong> Ensure your document is flat on the scanner bed to avoid shadows. Stains, wrinkles, or highlighter marks can interfere with recognition, so use the cleanest copy of the document you can find.</li>
</ul>

<h2>3. Keep it Straight (Deskewing)</h2>
<p>A document that was scanned at an angle (skewed) can be difficult for an OCR engine to read. The lines of text should be perfectly horizontal.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Align Carefully:</strong> Take an extra second to make sure your paper is aligned perfectly with the guides on your scanner.</li>
    <li><strong>Use Auto-Straighten Features:</strong> Most modern scanners and our OCR tool have a "deskew" or "auto-straighten" feature. Make sure it's enabled to automatically correct slight misalignments.</li>
</ul>

<h2>4. Choose the Right Color Mode</h2>
<p>Your scanner will likely offer three modes: Color, Grayscale, and Black & White (Monochrome).</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Black & White (Monochrome):</strong> This is the best option for simple, high-contrast text documents. It produces the smallest file size and the sharpest distinction between text and background.</li>
    <li><strong>Grayscale:</strong> Use this if your document has light-colored text or images with shades of gray that are important.</li>
    <li><strong>Color:</strong> Only use this mode if the color of the text or images is essential to the document's meaning. It produces the largest file size and can sometimes reduce contrast for standard black text.</li>
</ul>

<h2>5. Select the Correct Language</h2>
<p>An OCR engine uses a dictionary and character set specific to a language to achieve the best results. If you're scanning a document in French, telling the OCR tool that the language is French will allow it to recognize characters like 'é', 'à', and 'ç' correctly.</p>
<p>Our <a href="/ocr-pdf" class="text-brand-red hover:underline">OCR PDF tool</a> supports multiple languages. Always make sure you select the correct language from the options before starting the process to maximize accuracy.</p>

<h2>Conclusion: A Great Scan Means a Great Result</h2>
<p>By taking a few extra moments to prepare your documents and configure your scanner settings, you can dramatically improve the quality of your OCR results. A clean, high-contrast, 300 DPI scan will transform your paper documents into accurate, searchable, and highly usable digital files. Happy scanning!</p>`,image:"https://www.ilovepdf.com/storage/blog/49-1623244532-how-to-scan-and-convert-text@348w.jpeg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["OCR","Scanning","Productivity","How To","Tips","Document Management"]},{slug:"how-to-edit-pdf-text-online",title:"How to edit text directly in your PDF files online",date:"July 30, 2025",excerpt:"Need to fix a typo or update a date in a PDF? Our advanced PDF editor makes it possible. This post walks you through the process, showing you how to select and edit text just like you would in a word processor, saving you the hassle of converting the file back and forth.",content:`<h2>The Challenge of Editing PDF Text</h2>
<p>PDFs are designed for reliability and consistency across platforms, which is great for sharing, but historically made them difficult to edit. Changing even a simple word often required converting the PDF to an editable format like Word, making the changes, and then converting it back to PDF—a process that can mess up formatting.</p>

<h2>Introducing the PDFBullet Editor: Edit Text Directly</h2>
<p>Our powerful PDF Editor tool changes the game. It allows you to edit text directly within your PDF file, just as you would in a word processor. Here's how it works and what makes it so effective:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Automatic Font Detection:</strong> When you select text to edit, our tool automatically detects the original font, size, and color, ensuring that your changes blend in seamlessly.</li>
    <li><strong>Full Formatting Control:</strong> Want to change the style? You have full control to customize the font, size, color, and apply bold or italic formatting to your new text.</li>
    <li><strong>Simple and Intuitive:</strong> No complex menus or tools to learn. Just upload your PDF, click on the text you want to change, and start typing.</li>
</ul>

<h2>How to Edit Text in a PDF Online for Free</h2>
<p>Follow these simple steps to edit the text in your PDF document in just a few clicks:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Go to the <a href="/edit-pdf" class="text-brand-red hover:underline">Edit PDF tool</a>.</li>
    <li>Upload your PDF file from your device, Google Drive, or Dropbox.</li>
    <li>Once the file is loaded in the editor, select the <strong>'Edit text'</strong> option from the toolbar.</li>
    <li>Click on the text you want to modify. A bounding box will appear around the text block.</li>
    <li>Start typing to replace the existing text. Use the formatting toolbar that appears to adjust the font, size, color, and style as needed.</li>
    <li>After making all your changes, click the 'Save' button.</li>
    <li>Download your edited PDF file.</li>
</ol>
<p>That's it! You've successfully edited your PDF without losing quality or wasting time on conversions. Whether you need to correct a small typo, update an address, or revise a paragraph, the PDFBullet Editor is the fastest and easiest way to get it done online.</p>`,image:"https://www.ilovepdf.com/storage/blog/41-1623230784-Add-text-to-PDF@348w.png",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Edit PDF","PDF Editor","Text Editing","How To","Productivity","Online Tools"]},{slug:"pdfbullet-web-vs-desktop-vs-mobile-which-is-for-you",title:"PDFBullet Web vs. Desktop vs. Mobile: Which One Is for You?",date:"July 29, 2025",excerpt:"Confused about which PDFBullet version to use? This guide breaks down the key differences between our Web, Desktop, and Mobile platforms. Discover which tool is best for your specific needs, whether you prioritize online convenience, offline power, or on-the-go document management.",content:`Choosing the right tool for the job is key to maximizing productivity. At PDFBullet, we offer three powerful platforms designed to fit different workflows: Web, Desktop, and Mobile. Each has its unique strengths, and understanding them will help you manage your documents more effectively than ever before. Let's break down the differences.

<h2>PDFBullet Web: Instant Access, Anywhere</h2>
<p>The Web version is the heart of our service. It's the ultimate tool for convenience and accessibility.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>No Installation Needed:</strong> Access our full suite of tools directly from any web browser (Chrome, Firefox, Safari, etc.) on any operating system (Windows, Mac, Linux).</li>
    <li><strong>Client-Side Processing:</strong> For most tools, your files are processed directly in your browser, ensuring maximum privacy and speed as nothing needs to be uploaded.</li>
    <li><strong>Always Up-to-Date:</strong> You are always using the latest version with the newest features and security enhancements, no updates required.</li>
    <li><strong>Best For:</strong> Quick, one-off tasks, users who work on multiple devices, and those who prioritize privacy and don't want to install software.</li>
</ul>

<h2>PDFBullet Desktop: Power and Offline Performance</h2>
<p>For professionals and power users who handle large volumes of documents, the Desktop app is a game-changer.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>Work Completely Offline:</strong> Process your documents without an internet connection. Your files never leave your computer, offering an unparalleled level of security.</li>
    <li><strong>Enhanced Performance:</strong> The Desktop app is optimized to use your computer's full processing power, making it ideal for large files and heavy-duty tasks like batch processing.</li>
    <li><strong>No File Size Limits:</strong> Handle massive PDF files without worrying about browser or internet limitations.</li>
    <li><strong>Best For:</strong> Professionals who need to process sensitive or large documents, users with unstable internet connections, and anyone who wants the fastest possible performance.</li>
</ul>

<h2>PDFBullet Mobile: Your On-the-Go PDF Toolkit</h2>
<p>Turn your smartphone into a powerful document management tool with the PDFBullet Mobile app.</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li><strong>PDF Scanner:</strong> Use your phone's camera to scan physical documents and save them as high-quality PDFs.</li>
    <li><strong>Edit and Annotate:</strong> Add text, highlight, draw, and comment on your PDFs directly from your phone or tablet.</li>
    <li><strong>Sign on the Go:</strong> Sign documents with your finger or a stylus, or request signatures from others, no matter where you are.</li>
    <li><strong>Cloud Integration:</strong> Easily import files from and save them to Google Drive and Dropbox for a seamless workflow between your devices.</li>
    <li><strong>Best For:</strong> Students, remote workers, and anyone who needs to manage documents while away from their desk.</li>
</ul>

<h2>Which One Should You Choose?</h2>
<p>The best version of PDFBullet depends on your needs:</p>
<ul class="list-disc list-inside space-y-2 my-4">
    <li>For <strong>ultimate convenience and accessibility</strong>, use the <strong>Web</strong> version.</li>
    <li>For <strong>maximum power, security, and offline work</strong>, download the <strong>Desktop</strong> app.</li>
    <li>For <strong>managing documents on the move</strong>, the <strong>Mobile</strong> app is your perfect companion.</li>
</ul>
<p>Many of our users find that a combination of the platforms works best, using each for what it does best. The choice is yours, and no matter which you pick, you'll be equipped with the best tools to handle any PDF task.</p>`,image:"https://www.ilovepdf.com/storage/blog/34-1623144469-Organize-PDF@348w.jpg",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["Web App","Desktop App","Mobile App","Productivity","PDF Tools","Comparison","Offline PDF","On-the-go"]},{slug:"introducing-pdfbullet-chatgpt-custom-pdf-gpt",title:"Introducing PDFBullet + ChatGPT: The Custom PDF GPT",date:"July 28, 2025",excerpt:"Meet your new PDF assistant! PDFBullet integrates with ChatGPT, allowing you to summarize, translate, and ask questions about your documents using natural language. Upload any PDF and interact with it like never before, saving time and working smarter.",content:`Use ChatGPT as your PDF assistant with PDFBullet—no software needed. Just upload, describe, and go.

We are excited to announce an innovative integration that combines the power of our PDF tools with the intelligence of ChatGPT. Now you can summarize, translate, or ask questions about your PDF content using natural language. This feature is set to revolutionize how you interact with your documents.

Imagine you have a dense, 50-page research paper. Instead of spending hours reading it, you can simply upload it to our AI Assistant, and ask, "What are the key findings of this study?". Our tool will analyze the document and provide a concise summary in seconds.

This isn't just about saving time; it's about making information more accessible and allowing you to work smarter, not harder.

The integration is seamless. There are no complex settings or configurations. It's designed to be as intuitive as having a conversation. Whether you're a student preparing for an exam, a professional analyzing a report, or just someone curious about a document's contents, our AI Assistant is here to help.

We believe this is the future of document management, and we're thrilled to be at the forefront of this technology.`,image:"https://www.ilovepdf.com/storage/blog/310-1744202844-iLovePDF%27s-OpenAI-PDF-GPT.png",author:"The PDFBullet Team",authorImage:"/logo.svg",tags:["ChatGPT","AI Assistant","PDF GPT","Summarize PDF","Translate PDF","Productivity","New Feature"]},{slug:"see-result-2081-2082",title:"How to Check SEE Result 2081/2082?",date:"July 25, 2025",excerpt:"Eagerly awaiting your SEE (Secondary Education Examination) result for 2081/2082? You're in the right place! This comprehensive guide provides everything you need to check your NEB SEE result quickly, easily, and securely. We've compiled all the official websites, SMS services, and the complete grading system to help you and your guardians navigate the result-checking process without any stress.",content:`Eagerly awaiting your SEE (Secondary Education Examination) result for 2081/2082? You're in the right place! This comprehensive guide provides everything you need to check your NEB SEE result quickly, easily, and securely. We've compiled all the official websites, SMS services, and the complete grading system to help you and your guardians navigate the result-checking process without any stress. The National Examination Board (NEB) will be publishing the results soon, and this guide is your one-stop resource to get your score the moment it's live.

<a href="https://see.ntc.net.np/" target="_blank" rel="noopener noreferrer" class="inline-block bg-brand-red hover:bg-brand-red-dark text-white font-bold py-3 px-8 rounded-lg my-6 no-underline text-lg">Check SEE Result Now</a>

<h2>How to Check Your SEE Result 2081/2082</h2>
<p>There are multiple ways to check your result. Below are the most reliable methods provided by the NEB and other trusted organizations.</p>

<h3>1. Check SEE Result via Official Websites</h3>
<p>The fastest way to view your results online is through the official portals. Simply click on a link from the table below, and have your Symbol Number and Date of Birth ready.</p>

<div class="my-6 rounded-lg shadow-md overflow-hidden border border-gray-200 dark:border-gray-700">
  <table class="min-w-full border-collapse">
    <thead class="bg-gray-50 dark:bg-gray-800">
      <tr>
        <th scope="col" class="px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-700">Name of the Organization</th>
        <th scope="col" class="px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-700">Website</th>
      </tr>
    </thead>
    <tbody class="bg-white dark:bg-gray-900">
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">Edusanjal</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://see.edusanjal.com" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">see.edusanjal.com</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">National Examination Board (NEB), Grade 10</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://www.see.gov.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">www.see.gov.np</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">National Examination Board (NEB), Sanothimi</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://www.neb.gov.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">www.neb.gov.np</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">Nepal Telecom</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://www.see.ntc.net.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">www.see.ntc.net.np</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">Ekantipur</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://results.ekantipur.com" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">results.ekantipur.com</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">The Connect Plus</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="https://theconnectplus.com" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">https://theconnectplus.com</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">E-Sewa</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://see.esewa.com.np" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">see.esewa.com.np</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">Khalti</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="https://khalti.com/app" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">https://khalti.com/app</a></td></tr>
        <tr><td class="px-6 py-4 text-sm text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700">College Info Nepal</td><td class="px-6 py-4 text-sm border border-gray-300 dark:border-gray-700"><a href="http://collegeinfonepal.com/see" target="_blank" rel="noopener noreferrer" class="text-brand-red hover:underline">collegeinfonepal.com/see</a></td></tr>
    </tbody>
  </table>
</div>

<h3>2. Check SEE Result via SMS</h3>
<p>For students without easy internet access, the SMS service is a reliable alternative. Follow these simple steps:</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Open the messaging app on your phone.</li>
    <li>Compose a new message and type: <strong>SEE &lt;space&gt; Your_Symbol_Number</strong></li>
    <li>Send this message to <strong>1600</strong>.</li>
    <li>Example: If your symbol number is 1234567A, type <strong>SEE 1234567A</strong>.</li>
    <li>You will receive your result with GPA via SMS shortly.</li>
</ol>

<h3>3. Check SEE Result via IVR Service</h3>
<p>You can also listen to your result through the Interactive Voice Response (IVR) system from any Nepal Telecom phone.</p>
<ol class="list-decimal list-inside space-y-2 my-4">
    <li>Dial <strong>1601</strong> from your NTC mobile or landline.</li>
    <li>Follow the instructions provided by the automated system.</li>
    <li>Enter your symbol number when prompted to hear your result.</li>
</ol>

<h2>Understanding the SEE Grading System</h2>
<p>The SEE result is published using a letter grading system. It's important to understand what each grade means:</p>
<div class="overflow-x-auto my-4 rounded-lg border border-gray-200 dark:border-gray-700">
  <table class="min-w-full bg-white dark:bg-black">
    <thead class="bg-gray-100 dark:bg-gray-800">
      <tr>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Percentage Range</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Grade</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Grade Point</th>
        <th class="px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-200">Description</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
      <tr><td class="px-4 py-2">90 - 100</td><td class="px-4 py-2 font-bold">A+</td><td class="px-4 py-2">4.0</td><td class="px-4 py-2">Outstanding</td></tr>
      <tr><td class="px-4 py-2">80 - 89</td><td class="px-4 py-2 font-bold">A</td><td class="px-4 py-2">3.6</td><td class="px-4 py-2">Excellent</td></tr>
      <tr><td class="px-4 py-2">70 - 79</td><td class="px-4 py-2 font-bold">B+</td><td class="px-4 py-2">3.2</td><td class="px-4 py-2">Very Good</td></tr>
      <tr><td class="px-4 py-2">60 - 69</td><td class="px-4 py-2 font-bold">B</td><td class="px-4 py-2">2.8</td><td class="px-4 py-2">Good</td></tr>
      <tr><td class="px-4 py-2">50 - 59</td><td class="px-4 py-2 font-bold">C+</td><td class="px-4 py-2">2.4</td><td class="px-4 py-2">Satisfactory</td></tr>
      <tr><td class="px-4 py-2">40 - 49</td><td class="px-4 py-2 font-bold">C</td><td class="px-4 py-2">2.0</td><td class="px-4 py-2">Acceptable</td></tr>
      <tr><td class="px-4 py-2">35 - 39</td><td class="px-4 py-2 font-bold">D</td><td class="px-4 py-2">1.6</td><td class="px-4 py-2">Basic</td></tr>
      <tr><td class="px-4 py-2" colspan="4">Below 35% in theory subjects is considered 'Non-Graded (NG)'.</td></tr>
    </tbody>
  </table>
</div>

<p>We wish all SEE students the very best of luck with their results!</p>`,image:"https://ik.imagekit.io/fonepay/result%20copy.jpg?updatedAt=1753159229021",author:"The PDF Bullet Team",authorImage:"/logo.svg",tags:["SEE Result","Class 10","Education","Nepal","Result 2082"]}],sc=({className:n,variant:e})=>{const{theme:t}=Sm(),i=e||t;return p.jsx("img",{src:"https://ik.imagekit.io/fonepay/logo%20(2).png?updatedAt=1758997939639",alt:"PDFBullet Logo",className:`${n} ${i==="dark"?"logo-img-dark":""}`})},OG=({className:n})=>p.jsx("svg",{className:n,stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})}),UG=({onOpenProfileImageModal:n,onOpenSearchModal:e,onOpenChangePasswordModal:t,onOpenQrCodeModal:i,isPwa:s,unreadCount:r,justReceivedNotification:o,onNotificationAnimationEnd:a})=>{const[l,c]=P.useState(!1),[u,f]=P.useState(!1),[m,y]=P.useState(!1),[v,_]=P.useState(!1),[x,T]=P.useState(!1),[S,C]=P.useState(!1),[D,F]=P.useState(null),[V,I]=P.useState("main"),[E,A]=P.useState(!1),N=P.useRef(null),M=P.useRef(null),L=P.useRef(null),R=P.useRef(null),{theme:G,toggleTheme:oe}=Sm(),{user:Y,logout:ie,auth:W}=Nn(),{locale:H,setLocale:te,t:re}=Nc(),be=ia(),{canInstall:le,promptInstall:ee}=ya();P.useEffect(()=>{if(o){A(!0);const z=setTimeout(()=>{A(!1),a()},3e3);return()=>clearTimeout(z)}},[o,a]);const ye=W.currentUser?.providerData.some(z=>z.providerId==="password"),Ee=Y&&!Y.isPremium&&Y.trialEnds&&Y.trialEnds>Date.now(),ge=Ee?Math.ceil((Y.trialEnds-Date.now())/(1e3*60*60*24)):0,Se=z=>{F(D===z?null:z)};P.useEffect(()=>{const z=()=>{const De=sessionStorage.getItem("isAdminAuthenticated")==="true";C(De)};return z(),window.addEventListener("storage",z),()=>{window.removeEventListener("storage",z)}},[]),P.useEffect(()=>{const z=De=>{N.current&&!N.current.contains(De.target)&&c(!1),M.current&&!M.current.contains(De.target)&&f(!1)};return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[]),P.useEffect(()=>(document.body.style.overflow=m?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[m]);const pe=()=>{c(!1),f(!1),y(!1),_(!1),T(!1),I("main"),F(null)},mt=(z,De)=>{De.current&&(clearTimeout(De.current),De.current=null),z(!0)},Nt=(z,De)=>{De.current=window.setTimeout(()=>{z(!1)},200)},ct=cr.filter(z=>z.category==="convert-to"),Qn=cr.filter(z=>z.category==="convert-from"),xn=[{to:"/merge-pdf",labelKey:"header.merge_pdf"},{to:"/split-pdf",labelKey:"header.split_pdf"},{to:"/compress-pdf",labelKey:"header.compress_pdf"}],Xi=P.useMemo(()=>new Map(cr.map(z=>[z.id,z])),[]),Hs=P.useMemo(()=>[{title:"ORGANIZE PDF",tools:["merge-pdf","split-pdf","organize-pdf"]},{title:"OPTIMIZE PDF",tools:["compress-pdf","repair-pdf","ocr-pdf"]},{title:"CONVERT TO PDF",tools:["jpg-to-pdf","word-to-pdf","powerpoint-to-pdf","excel-to-pdf"]},{title:"CONVERT FROM PDF",tools:["pdf-to-word","pdf-to-powerpoint","pdf-to-excel"]},{title:"EDIT PDF",tools:["rotate-pdf","page-numbers","watermark-pdf","edit-pdf"]},{title:"PDF SECURITY",tools:["unlock-pdf","protect-pdf","sign-pdf"]}],[]),pn=P.useMemo(()=>({products:[{title:"PDFBullet-Sign",description:"e-Signing made simple",to:"/workflows",icon:wf,iconColor:"bg-blue-600"},{title:"PDFBullet API",description:"Document automation for developers",to:"/developer",icon:wf,iconColor:"bg-teal-500"}],solutions:[{title:"Business",description:"Streamlined PDF editing and workflows for business teams",to:"/business",icon:lO,iconColor:"bg-red-500"}],applications:[{title:"Desktop App",description:"Available for Mac and Windows",onClick:ee,icon:sO,iconColor:"bg-red-600"},{title:"Mobile App",description:"Download the APK for Android",href:"https://github.com/pdfbullet/pdfbullet/releases/download/v1.0/app-release-signed.apk",download:"app-release-signed.apk",icon:rO,iconColor:"bg-red-700"}],links:[{title:"Pricing",to:"/pricing",icon:xC},{title:"Developer",to:"/developer",icon:iO},{title:"Security",to:"/security-policy",icon:CC},{title:"Features",to:"/features",icon:Qp},{title:"About us",to:"/about",icon:wf}],bottomLinks:[{title:"Help",onClick:()=>I("help"),icon:_f},{title:"Admin Access",to:"/developer-access",icon:IC}]}),[ee]),Gs=[{title:"FAQ",to:"/faq",icon:bC},{title:"Tools",to:"/how-to-use",icon:yh},{title:"Legal & Privacy",to:"/legal",icon:EC},{title:"Contact",to:"/contact",icon:gh}],zn=new Set(["remove-background","compress-image","watermark-image"]),Zn=[{key:"organize",title:"Organize PDF"},{key:"optimize",title:"Optimize PDF"},{key:"convert-to",title:"Convert to PDF"},{key:"convert-from",title:"Convert from PDF"},{key:"edit",title:"Edit PDF"},{key:"security",title:"PDF Security"},{key:"business",title:"Business & AI Tools"}],Kr=P.useMemo(()=>[...Zn.map(z=>({title:z.title,tools:cr.filter(De=>De.category===z.key&&!zn.has(De.id))})),{title:"Image Tools",tools:cr.filter(z=>zn.has(z.id))}].filter(z=>z.tools.length>0),[zn]),$s=({item:z})=>{const De=p.jsxs("div",{className:`flex items-start gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors group ${z.bordered?"border border-gray-200 dark:border-gray-700":""}`,children:[p.jsx("div",{className:`${z.iconColor?`${z.iconColor} p-1.5 rounded-md`:""}`,children:p.jsx(z.icon,{className:`h-5 w-5 ${z.iconColor?"text-white":"text-gray-500 dark:text-gray-400"}`})}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200 text-sm",children:z.title}),p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:z.description})]})]});return z.onClick?p.jsx("button",{onClick:()=>{z.onClick(),pe()},className:"w-full text-left",children:De}):z.to?p.jsx(Be,{to:z.to,onClick:pe,children:De}):p.jsx("a",{href:z.href,onClick:pe,target:z.href?.startsWith("http")?"_blank":"_self",rel:"noopener noreferrer",download:z.download,children:De})},Ei=({item:z,isSubItem:De})=>{const gt=p.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors group",children:[p.jsx(z.icon,{className:`h-5 w-5 ${De?"":"text-gray-500 dark:text-gray-400"}`}),p.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200 text-sm",children:z.title})]});return z.onClick?p.jsx("button",{onClick:z.onClick,className:"w-full text-left",children:gt}):z.to?p.jsx(Be,{to:z.to,onClick:pe,children:gt}):p.jsx("a",{href:z.href,onClick:pe,target:z.href.startsWith("http")?"_blank":"_self",rel:"noopener noreferrer",children:gt})},X=v_,ve=X.slice(0,Math.ceil(X.length/3)),Pe=X.slice(Math.ceil(X.length/3),2*Math.ceil(X.length/3)),Me=X.slice(2*Math.ceil(X.length/3));return p.jsxs(p.Fragment,{children:[p.jsx("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-gray-800 sticky top-0 z-50",children:p.jsx("div",{className:"px-4 sm:px-6 py-2",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("div",{className:"lg:hidden",children:p.jsx("button",{onClick:()=>y(!0),className:"text-gray-600 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors","aria-label":"Open main menu",title:"Open main menu",children:p.jsx(OG,{className:"h-6 w-6"})})}),p.jsx("a",{href:"/",className:"flex items-center text-gray-800 dark:text-gray-100",title:"PDFBullet Home",children:p.jsx(sc,{className:"h-8 md:h-10 w-auto"})}),p.jsxs("nav",{className:"hidden lg:flex items-center space-x-1",children:[xn.map(z=>p.jsx(Be,{to:z.to,onClick:pe,title:re(z.labelKey),className:"px-2 2xl:px-3 py-2 text-gray-800 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors rounded-md text-xs 2xl:text-sm font-semibold text-center",children:re(z.labelKey)},z.to)),p.jsx(Be,{to:"/developer",onClick:pe,title:"Developer API",className:"px-2 2xl:px-3 py-2 text-gray-800 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors rounded-md text-xs 2xl:text-sm font-semibold text-center",children:re("header.developer")}),p.jsxs("div",{className:"relative",onMouseEnter:()=>mt(_,L),onMouseLeave:()=>Nt(_,L),children:[p.jsxs("button",{title:"Convert PDF Tools",className:"flex items-center px-2 2xl:px-3 py-2 text-gray-800 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors rounded-md text-xs 2xl:text-sm font-semibold",children:[p.jsx("span",{children:re("header.convert_pdf")}),p.jsx(vf,{className:`h-4 w-4 ml-1 transition-transform duration-200 ${v?"rotate-180":""}`})]}),p.jsx("div",{className:`absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-6 z-20 transition-all duration-200 ease-out origin-top ${v?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:p.jsxs("div",{className:"grid grid-cols-2 gap-x-8",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"px-2 pb-2 text-sm font-bold text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700 uppercase",children:"Convert to PDF"}),p.jsx("div",{className:"mt-2 space-y-1",children:ct.map(z=>p.jsxs(Be,{to:`/${z.id}`,onClick:pe,title:re(z.title),className:"flex items-center gap-3 p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[p.jsx(z.Icon,{className:`h-5 w-5 flex-shrink-0 ${z.textColor}`}),p.jsx("span",{className:"font-semibold text-sm whitespace-nowrap",children:re(z.title)})]},z.id))})]}),p.jsxs("div",{children:[p.jsx("h4",{className:"px-2 pb-2 text-sm font-bold text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700 uppercase",children:"Convert from PDF"}),p.jsx("div",{className:"mt-2 space-y-1",children:Qn.map(z=>p.jsxs(Be,{to:`/${z.id}`,onClick:pe,title:re(z.title),className:"flex items-center gap-3 p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[p.jsx(z.Icon,{className:`h-5 w-5 flex-shrink-0 ${z.textColor}`}),p.jsx("span",{className:"font-semibold text-sm whitespace-nowrap",children:re(z.title)})]},z.id))})]})]})})]}),p.jsxs("div",{onMouseEnter:()=>mt(T,R),onMouseLeave:()=>Nt(T,R),children:[p.jsxs("button",{title:"All PDF Tools",className:"flex items-center px-2 2xl:px-3 py-2 text-red-600 dark:text-red-400 transition-colors rounded-md text-xs 2xl:text-sm font-semibold",children:[p.jsx("span",{children:re("header.all_pdf_tools")}),p.jsx(vf,{className:`h-4 w-4 ml-1 transition-transform duration-200 ${x?"rotate-180":""}`})]}),p.jsx("div",{className:`absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max max-w-[calc(100vw-2rem)] bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl z-50 transition-all duration-200 ease-out origin-top ${x?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"} overflow-x-auto no-scrollbar`,children:p.jsx("div",{className:"p-6 grid grid-cols-6 gap-x-4",children:Hs.map(z=>p.jsxs("div",{className:"pr-4 border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:[p.jsx("h4",{className:"pb-2 text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:z.title}),p.jsx("div",{className:"mt-2 space-y-1",children:z.tools.map(De=>{const gt=Xi.get(De);return gt?p.jsxs(Be,{to:`/${gt.id}`,onClick:pe,title:re(gt.title),className:"flex items-center gap-3 p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[p.jsx(gt.Icon,{className:`h-5 w-5 flex-shrink-0 ${gt.textColor}`}),p.jsx("span",{className:"font-semibold text-sm",children:re(gt.title)})]},gt.id):null})})]},z.title))})})]})]})]}),p.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[p.jsx("button",{onClick:e,className:"text-gray-600 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors p-2 rounded-full","aria-label":"Search",title:"Search",children:p.jsx(Ey,{className:"h-6 w-6"})}),p.jsx("button",{onClick:i,className:"hidden md:block text-gray-600 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors p-2 rounded-full","aria-label":"Share page via QR code",title:"Share page via QR code",children:p.jsx(nO,{className:"h-6 w-6"})}),le&&p.jsxs("button",{onClick:ee,className:"hidden sm:flex items-center gap-2 bg-brand-red text-white font-bold py-1.5 px-3 text-sm rounded-md hover:bg-brand-red-dark transition-colors",title:"Install App",children:[p.jsx(Mc,{className:"h-5 w-5"}),p.jsx("span",{children:"Install"})]}),!s&&p.jsxs("button",{onClick:oe,title:`Switch to ${G==="light"?"dark":"light"} mode`,"aria-label":"Toggle theme",className:`relative inline-flex items-center h-7 w-14 shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-brand-red focus:ring-offset-2 dark:focus:ring-offset-black ${G==="dark"?"bg-gray-700":"bg-gray-200"}`,children:[p.jsx("span",{className:"sr-only",children:"Toggle theme"}),p.jsx("span",{"aria-hidden":"true",className:`pointer-events-none inline-block h-6 w-6 transform rounded-full bg-white shadow-lg ring-0 transition duration-200 ease-in-out flex items-center justify-center ${G==="dark"?"translate-x-7":"translate-x-0.5"}`,children:G==="dark"?p.jsx(B8,{className:"h-4 w-4 text-gray-700"}):p.jsx(U8,{className:"h-4 w-4 text-yellow-500"})})]}),Y?p.jsxs("div",{className:"relative",ref:M,children:[p.jsx("button",{onClick:()=>f(!u),className:"block h-8 w-8 sm:h-10 sm:w-10 rounded-full overflow-hidden border-2 border-transparent hover:border-brand-red transition","aria-label":"Open user profile menu",title:"Open user profile menu",children:Y.profileImage?p.jsx("img",{src:Y.profileImage,alt:"Profile",className:"h-full w-full object-cover"}):p.jsx(gC,{className:"h-full w-full text-gray-500 dark:text-gray-400"})}),u&&p.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl py-2",children:[p.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:re("header.signed_in_as")}),p.jsxs("div",{className:"flex items-center justify-between mt-1",children:[p.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white truncate",children:Y.username}),Y.isPremium?p.jsxs("span",{className:"flex items-center gap-1 bg-yellow-100 text-yellow-800 text-xs font-semibold px-2 py-0.5 rounded-full border border-yellow-400 dark:bg-yellow-900/50 dark:text-yellow-300 dark:border-yellow-600",children:[p.jsx(gd,{className:"h-3 w-3"}),"Premium"]}):Ee?p.jsxs("span",{className:"flex items-center gap-1 bg-green-100 text-green-800 text-xs font-semibold px-2 py-0.5 rounded-full border border-green-400 dark:bg-green-900/50 dark:text-green-300 dark:border-green-600",children:["Trial (",ge,"d left)"]}):null]})]}),p.jsxs("div",{className:"py-1",children:[p.jsxs("button",{onClick:()=>{n(),pe()},title:re("header.change_photo"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(yC,{className:"h-5 w-5"}),p.jsx("span",{children:re("header.change_photo")})]}),p.jsxs("button",{onClick:()=>{be("/account-settings"),pe()},title:re("header.account_settings"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(vh,{className:"h-5 w-5"}),p.jsx("span",{children:re("header.account_settings")})]}),ye&&p.jsxs("button",{onClick:()=>{t(),pe()},title:re("header.change_password"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(Ty,{className:"h-5 w-5"}),p.jsx("span",{children:re("header.change_password")})]})]}),p.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 py-1",children:p.jsxs("button",{onClick:()=>{ie(),pe()},title:re("header.logout"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(vC,{className:"h-5 w-5"}),p.jsx("span",{children:re("header.logout")})]})})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"hidden sm:flex items-center space-x-2 md:space-x-4",children:[p.jsx(Be,{to:"/login",title:re("header.login"),className:"text-gray-800 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors font-semibold px-2 text-sm",children:re("header.login")}),p.jsx(Be,{to:"/signup",title:re("header.signup"),className:"bg-brand-red hover:bg-brand-red-dark text-white font-bold py-1.5 px-3 text-sm rounded-md transition-colors",children:re("header.signup")})]}),p.jsx("div",{className:"sm:hidden",children:p.jsx(Be,{to:"/login",className:"text-gray-600 dark:text-gray-300 hover:text-brand-red","aria-label":"Login or sign up",title:"Login or sign up",children:p.jsx($n,{className:"h-7 w-7"})})})]}),s&&p.jsxs(Be,{to:"/notifications",className:`relative text-gray-600 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors p-2 rounded-full ${E?"animate-shake":""}`,"aria-label":"Notifications",title:"Notifications",children:[p.jsx(ic,{className:"h-6 w-6"}),r>0&&p.jsx("span",{className:"absolute top-1 right-1 block h-4 w-4 text-xs flex items-center justify-center rounded-full ring-2 ring-white dark:ring-black bg-brand-red text-white",children:r>9?"9+":r})]}),p.jsxs("div",{className:"relative",ref:N,children:[p.jsx("button",{onClick:()=>c(!l),className:"text-gray-600 dark:text-gray-300 hover:text-brand-red dark:hover:text-brand-red transition-colors p-2 rounded-full","aria-label":"Open all tools and options",title:"Open all tools and options",children:p.jsx(Qp,{className:"h-7 w-7 lg:h-8 lg:w-8"})}),l&&p.jsx("div",{className:"absolute top-full right-0 mt-2 z-20",children:p.jsxs("div",{className:"w-[calc(100vw-2rem)] max-w-sm md:max-w-2xl lg:max-w-[52rem] bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-xl shadow-2xl overflow-hidden",children:[V==="main"&&p.jsxs("div",{className:"p-4 overflow-y-auto max-h-[80vh]",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[p.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 px-2",children:"PRODUCTS"}),pn.products.map(z=>p.jsx($s,{item:z},z.title))]}),p.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[p.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 px-2",children:"SOLUTIONS"}),pn.solutions.map(z=>p.jsx($s,{item:z},z.title)),p.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 px-2 pt-2",children:"APPLICATIONS"}),pn.applications.map(z=>p.jsx($s,{item:z},z.title))]}),p.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[p.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 px-2",children:"COMPANY"}),p.jsx("div",{className:"space-y-1",children:pn.links.map(z=>p.jsx(Ei,{item:z},z.title))})]})]}),p.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-1 md:grid-cols-2 gap-x-4",children:pn.bottomLinks.map(z=>p.jsx(Ei,{item:z},z.title))})]}),V==="help"&&p.jsxs("div",{className:"p-4",children:[p.jsxs("button",{onClick:()=>I("main"),className:"flex items-center gap-2 font-semibold text-sm mb-4",children:[p.jsx(_f,{className:"h-4 w-4"})," Back to main menu"]}),p.jsx("div",{className:"space-y-1",children:Gs.map(z=>p.jsx(Ei,{item:z,isSubItem:!0},z.title))})]}),V==="language"&&p.jsxs("div",{className:"p-4",children:[p.jsxs("button",{onClick:()=>I("main"),className:"flex items-center gap-2 font-semibold text-sm mb-4",children:[p.jsx(_f,{className:"h-4 w-4"})," Back to main menu"]}),p.jsxs("div",{className:"grid grid-cols-3 gap-x-4",children:[p.jsx("div",{className:"space-y-1",children:ve.map(z=>p.jsx("button",{onClick:()=>{te(z.code),pe()},className:`w-full text-left p-2 rounded-md text-sm ${H===z.code?"font-bold bg-gray-100 dark:bg-gray-800":"hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:z.name},z.code))}),p.jsx("div",{className:"space-y-1",children:Pe.map(z=>p.jsx("button",{onClick:()=>{te(z.code),pe()},className:`w-full text-left p-2 rounded-md text-sm ${H===z.code?"font-bold bg-gray-100 dark:bg-gray-800":"hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:z.name},z.code))}),p.jsx("div",{className:"space-y-1",children:Me.map(z=>p.jsx("button",{onClick:()=>{te(z.code),pe()},className:`w-full text-left p-2 rounded-md text-sm ${H===z.code?"font-bold bg-gray-100 dark:bg-gray-800":"hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:z.name},z.code))})]})]}),p.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 p-3 border-t border-gray-200 dark:border-gray-700",children:p.jsxs("button",{onClick:()=>I("language"),className:"flex items-center gap-2 text-sm font-semibold text-gray-600 dark:text-gray-300 hover:text-brand-red transition-colors",children:[p.jsx(Ay,{className:"h-5 w-5"})," ",v_.find(z=>z.code===H)?.name||"Language"," ",p.jsx(k8,{className:"h-4 w-4 -rotate-90"})]})})]})})]})]})]})})}),p.jsx("div",{className:`fixed inset-0 z-[60] bg-black/50 transition-opacity lg:hidden ${m?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:pe}),p.jsx("div",{className:`fixed top-0 left-0 bottom-0 z-[70] w-full max-w-xs bg-white dark:bg-black shadow-2xl transition-transform duration-300 ease-in-out lg:hidden ${m?"translate-x-0":"-translate-x-full"}`,children:p.jsxs("div",{className:"flex flex-col h-full",children:[p.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("a",{href:"/",onClick:pe,children:p.jsx(sc,{className:"h-8 w-auto"})}),p.jsx("button",{onClick:pe,className:"text-gray-500 hover:text-brand-red",children:p.jsx(Ki,{className:"h-6 w-6"})})]}),p.jsx("div",{className:"overflow-y-auto flex-grow p-4",children:p.jsxs("nav",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("button",{onClick:()=>Se("tools"),className:"w-full flex justify-between items-center font-bold text-lg text-gray-800 dark:text-gray-100",children:["Tools ",p.jsx(vf,{className:`h-5 w-5 transition-transform ${D==="tools"?"rotate-180":""}`})]}),p.jsx("div",{className:`overflow-hidden transition-all duration-300 ${D==="tools"?"max-h-[1000px] mt-2":"max-h-0"}`,children:Kr.map(z=>p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-gray-500 mt-3 mb-1",children:z.title}),p.jsx("div",{className:"space-y-1",children:z.tools.map(De=>p.jsxs(Be,{to:`/${De.id}`,onClick:pe,className:"flex items-center gap-3 p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800",children:[p.jsx(De.Icon,{className:`h-5 w-5 flex-shrink-0 ${De.textColor}`}),p.jsx("span",{className:"font-semibold text-sm",children:re(De.title)})]},De.id))})]},z.title))})]}),p.jsx("div",{children:p.jsx(Be,{to:"/pricing",onClick:pe,className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:"Pricing"})}),p.jsx("div",{children:p.jsx(Be,{to:"/developer",onClick:pe,className:"font-bold text-lg text-gray-800 dark:text-gray-100",children:"Developer"})})]})}),p.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:!Y&&p.jsxs("div",{className:"flex gap-4",children:[p.jsx(Be,{to:"/login",onClick:pe,className:"flex-1 text-center font-semibold border border-gray-300 dark:border-gray-600 py-2 rounded-md",children:"Log In"}),p.jsx(Be,{to:"/signup",onClick:pe,className:"flex-1 text-center font-semibold bg-brand-red text-white py-2 rounded-md",children:"Sign Up"})]})})]})})]})},BG=P.memo(UG),zG=({onOpenSearchModal:n,unreadCount:e,justReceivedNotification:t,onNotificationAnimationEnd:i,onOpenProfileImageModal:s,onOpenChangePasswordModal:r})=>{const{title:o}=E8(),{user:a,logout:l,auth:c}=Nn(),{t:u}=Nc(),f=ia(),[m,y]=P.useState(!1),[v,_]=P.useState(!1),x=P.useRef(null),T=c.currentUser?.providerData.some(C=>C.providerId==="password");P.useEffect(()=>{const C=D=>{x.current&&!x.current.contains(D.target)&&_(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),P.useEffect(()=>{if(t){y(!0);const C=setTimeout(()=>{y(!1),i()},820);return()=>clearTimeout(C)}},[t,i]);const S=()=>_(!1);return p.jsxs("header",{className:"fixed top-0 left-0 right-0 h-[60px] bg-white/80 dark:bg-black/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800 z-40 flex items-center justify-between px-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"relative",ref:x,children:[p.jsx("button",{onClick:()=>_(C=>!C),className:"flex-shrink-0 block h-8 w-8 rounded-full overflow-hidden border-2 border-transparent hover:border-brand-red transition",children:a?.profileImage?p.jsx("img",{src:a.profileImage,alt:"Profile",className:"h-full w-full object-cover"}):p.jsx(gC,{className:"h-full w-full text-gray-500 dark:text-gray-400"})}),v&&p.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl py-2 z-50",children:[p.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("p",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:u("header.signed_in_as")}),p.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white truncate",children:a?.username})]}),p.jsxs("div",{className:"py-1",children:[p.jsxs("button",{onClick:()=>{s(),S()},title:u("header.change_photo"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(yC,{className:"h-5 w-5"}),p.jsx("span",{children:u("header.change_photo")})]}),p.jsxs("button",{onClick:()=>{f("/account-settings"),S()},title:u("header.account_settings"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(vh,{className:"h-5 w-5"}),p.jsx("span",{children:u("header.account_settings")})]}),T&&p.jsxs("button",{onClick:()=>{r(),S()},title:u("header.change_password"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(Ty,{className:"h-5 w-5"}),p.jsx("span",{children:u("header.change_password")})]})]}),p.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 py-1",children:p.jsxs("button",{onClick:()=>{l(),S()},title:u("header.logout"),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-brand-red transition-colors",children:[p.jsx(vC,{className:"h-5 w-5"}),p.jsx("span",{children:u("header.logout")})]})})]})]}),p.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 truncate",children:o})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:n,className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full","aria-label":"Search",title:"Search",children:p.jsx(Ey,{className:"h-6 w-6"})}),p.jsxs(Be,{to:"/notifications",className:`relative p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full ${m?"animate-shake":""}`,"aria-label":"Notifications",title:"Notifications",children:[p.jsx(ic,{className:"h-6 w-6"}),e>0&&p.jsx("span",{className:"absolute top-1.5 right-1.5 block h-2.5 w-2.5 rounded-full bg-brand-red ring-2 ring-white dark:ring-black"})]})]})]})};var Wb={};const jG=({onOpenCalendarModal:n,onOpenProblemReportModal:e})=>{const[t,i]=P.useState(""),[s,r]=P.useState(""),{t:o}=Nc(),{promptInstall:a}=ya(),l=[{path:"/merge-pdf",nameKey:"footer.top_tools.merge_pdf"},{path:"/compress-pdf",nameKey:"footer.top_tools.compress_pdf"},{path:"/jpg-to-pdf",nameKey:"footer.top_tools.jpg_to_pdf"},{path:"/edit-pdf",nameKey:"footer.top_tools.edit_pdf"},{path:"/pdf-to-word",nameKey:"footer.top_tools.pdf_to_word"}],c=[{path:"/education",nameKey:"footer.solution_links.education"},{path:"/business",nameKey:"footer.solution_links.business"},{path:"/how-to-use",nameKey:"footer.solution_links.how_to"}],u=[{path:"/about",nameKey:"footer.company_links.about"},{path:"/blog",nameKey:"footer.company_links.blog"},{path:"/press",nameKey:"footer.company_links.press"},{path:"/contact",nameKey:"footer.company_links.contact"},{path:"/ceo",nameKey:"footer.company_links.ceo_message"}],f=[{path:"/legal",nameKey:"footer.legal_links.legal_hub"},{path:"/privacy-policy",nameKey:"footer.legal_links.privacy"},{path:"/terms-of-service",nameKey:"footer.legal_links.terms"},{path:"/cookies-policy",nameKey:"footer.legal_links.cookies"},{path:"/user-data-deletion",nameKey:"footer.legal_links.data_deletion"}],m=p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex space-x-4 mt-5",children:[p.jsx("a",{href:"https://www.facebook.com/share/16sdjGNVGr/?mibextid=wwXIfr",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors","aria-label":"Facebook",title:"Facebook",children:p.jsx(j8,{className:"h-6 w-6"})}),p.jsx("a",{href:"https://wa.me/message/JYA22CVSYSZ4N1",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors","aria-label":"WhatsApp",title:"WhatsApp",children:p.jsx(z8,{className:"h-6 w-6"})}),p.jsx("a",{href:"https://www.youtube.com/@btmobilecare",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors","aria-label":"YouTube",title:"YouTube",children:p.jsx(q8,{className:"h-6 w-6"})})]}),p.jsxs("div",{className:"mt-6 space-y-2",children:[p.jsx("p",{className:"text-gray-400 text-sm font-semibold",children:"Get the app"}),p.jsxs("a",{href:"https://github.com/pdfbullet/pdfbullet/releases/download/v1.0/app-release-signed.apk",download:!0,className:"flex items-center gap-2 w-full max-w-[160px] text-left bg-black border border-gray-600 p-2 rounded-lg hover:bg-gray-800 text-white transition-transform hover:scale-105",children:[p.jsx(cO,{className:"h-7 w-7"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-xs leading-tight",children:"DOWNLOAD APK"}),p.jsx("p",{className:"font-semibold text-lg leading-tight",children:"Android"})]})]}),p.jsxs("button",{onClick:a,className:"flex items-center gap-2 w-full max-w-[160px] text-left bg-black border border-gray-600 p-2 rounded-lg hover:bg-gray-800 text-white transition-transform hover:scale-105",children:[p.jsx(W8,{className:"h-7 w-7"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-xs leading-tight",children:"Download on the"}),p.jsx("p",{className:"font-semibold text-lg leading-tight",children:"App Store"})]})]})]})]});return p.jsx("footer",{className:"bg-black text-white w-full",children:p.jsxs("div",{className:"px-6 py-12",children:[p.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-8",children:[p.jsxs("div",{className:"col-span-2 lg:col-span-2",children:[p.jsx("a",{href:"/",title:"PDFBullet Home",children:p.jsx(sc,{className:"h-10 w-auto mb-3",variant:"dark"})}),p.jsx("p",{className:"text-gray-400 text-sm max-w-xs",children:o("footer.slogan")}),m]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-lg mb-4",children:o("footer.tools")}),p.jsx("ul",{className:"space-y-2 text-gray-400 text-sm",children:l.map(y=>p.jsx("li",{children:p.jsx(Be,{to:y.path,title:o(y.nameKey),className:"hover:text-white",children:o(y.nameKey)})},y.path))})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-lg mb-4",children:o("footer.solutions")}),p.jsx("ul",{className:"space-y-2 text-gray-400 text-sm",children:c.map(y=>p.jsx("li",{children:p.jsx(Be,{to:y.path,title:o(y.nameKey),className:"hover:text-white",children:o(y.nameKey)})},y.path))})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-lg mb-4",children:o("footer.company")}),p.jsxs("ul",{className:"space-y-2 text-gray-400 text-sm",children:[u.map(y=>p.jsx("li",{children:p.jsx(Be,{to:y.path,title:o(y.nameKey),className:"hover:text-white",children:o(y.nameKey)})},y.path)),p.jsx("li",{children:p.jsx("button",{onClick:e,title:o("footer.company_links.report_problem"),className:"hover:text-white text-left",children:o("footer.company_links.report_problem")})})]})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-lg mb-4",children:o("footer.legal")}),p.jsx("ul",{className:"space-y-2 text-gray-400 text-sm",children:f.map(y=>p.jsx("li",{children:p.jsx(Be,{to:y.path,title:o(y.nameKey),className:"hover:text-white",children:o(y.nameKey)})},y.path))})]})]}),p.jsxs("div",{className:"mt-12 border-t border-gray-700 pt-6 flex flex-col sm:flex-row justify-between items-center text-gray-400 text-sm",children:[p.jsxs("p",{className:"order-2 sm:order-1 mt-4 sm:mt-0",children:[o("footer.copyright",{year:new Date().getFullYear()})," ",Wb.APP_VERSION&&`- v${Wb.APP_VERSION}`]}),p.jsx("div",{className:"order-1 sm:order-2",children:p.jsx(Be,{to:"/sitemap",title:"Sitemap",className:"hover:text-white transition-colors",children:"Sitemap"})})]})]})})},qG=P.memo(jG),HG=()=>{const[n,e]=P.useState(!1),t=()=>{window.pageYOffset>300?e(!0):e(!1)},i=()=>{window.scrollTo({top:0,behavior:"smooth"})};return P.useEffect(()=>(window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}),[]),p.jsx("button",{onClick:i,className:`fixed bottom-6 right-6 z-50 text-brand-red filter drop-shadow-lg hover:text-brand-red-dark transition-all duration-300 ease-in-out transform hover:scale-110 ${n?"opacity-100 scale-100":"opacity-0 scale-0"}`,"aria-label":"Scroll to top",title:"Scroll to top",children:p.jsx("svg",{className:"h-14 w-14",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9v6c0 3.87 3.13 7 7 7s7-3.13 7-7V9c0-3.87-3.13-7-7-7zm0 2c2.76 0 5 2.24 5 5v6c0 2.76-2.24 5-5 5s-5-2.24-5-5V9c0-2.76 2.24-5 5-5zm-1 2v4h2V6h-2z"})})})};var xf={exports:{}},Tf,Kb;function GG(){if(Kb)return Tf;Kb=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Tf=n,Tf}var Ef,Yb;function $G(){if(Yb)return Ef;Yb=1;var n=GG();function e(){}function t(){}return t.resetWarningCache=e,Ef=function(){function i(o,a,l,c,u,f){if(f!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function s(){return i}var r={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return r.PropTypes=r,r},Ef}var Jb;function WG(){return Jb||(Jb=1,xf.exports=$G()()),xf.exports}var KG=WG();const $e=cc(KG);function Hr(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(f){o(f)}}function l(u){try{c(i.throw(u))}catch(f){o(f)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}const YG=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Zo(n,e,t){const i=JG(n),{webkitRelativePath:s}=n,r=typeof e=="string"?e:typeof s=="string"&&s.length>0?s:`./${n.name}`;return typeof i.path!="string"&&Xb(i,"path",r),Xb(i,"relativePath",r),i}function JG(n){const{name:e}=n;if(e&&e.lastIndexOf(".")!==-1&&!n.type){const i=e.split(".").pop().toLowerCase(),s=YG.get(i);s&&Object.defineProperty(n,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return n}function Xb(n,e,t){Object.defineProperty(n,e,{value:t,writable:!1,configurable:!1,enumerable:!0})}const XG=[".DS_Store","Thumbs.db"];function QG(n){return Hr(this,void 0,void 0,function*(){return _d(n)&&ZG(n.dataTransfer)?i$(n.dataTransfer,n.type):e$(n)?t$(n):Array.isArray(n)&&n.every(e=>"getFile"in e&&typeof e.getFile=="function")?n$(n):[]})}function ZG(n){return _d(n)}function e$(n){return _d(n)&&_d(n.target)}function _d(n){return typeof n=="object"&&n!==null}function t$(n){return um(n.target.files).map(e=>Zo(e))}function n$(n){return Hr(this,void 0,void 0,function*(){return(yield Promise.all(n.map(t=>t.getFile()))).map(t=>Zo(t))})}function i$(n,e){return Hr(this,void 0,void 0,function*(){if(n.items){const t=um(n.items).filter(s=>s.kind==="file");if(e!=="drop")return t;const i=yield Promise.all(t.map(s$));return Qb(rS(i))}return Qb(um(n.files).map(t=>Zo(t)))})}function Qb(n){return n.filter(e=>XG.indexOf(e.name)===-1)}function um(n){if(n===null)return[];const e=[];for(let t=0;t<n.length;t++){const i=n[t];e.push(i)}return e}function s$(n){if(typeof n.webkitGetAsEntry!="function")return Zb(n);const e=n.webkitGetAsEntry();return e&&e.isDirectory?oS(e):Zb(n,e)}function rS(n){return n.reduce((e,t)=>[...e,...Array.isArray(t)?rS(t):[t]],[])}function Zb(n,e){return Hr(this,void 0,void 0,function*(){var t;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const r=yield n.getAsFileSystemHandle();if(r===null)throw new Error(`${n} is not a File`);if(r!==void 0){const o=yield r.getFile();return o.handle=r,Zo(o)}}const i=n.getAsFile();if(!i)throw new Error(`${n} is not a File`);return Zo(i,(t=e?.fullPath)!==null&&t!==void 0?t:void 0)})}function r$(n){return Hr(this,void 0,void 0,function*(){return n.isDirectory?oS(n):o$(n)})}function oS(n){const e=n.createReader();return new Promise((t,i)=>{const s=[];function r(){e.readEntries(o=>Hr(this,void 0,void 0,function*(){if(o.length){const a=Promise.all(o.map(r$));s.push(a),r()}else try{const a=yield Promise.all(s);t(a)}catch(a){i(a)}}),o=>{i(o)})}r()})}function o$(n){return Hr(this,void 0,void 0,function*(){return new Promise((e,t)=>{n.file(i=>{const s=Zo(i,n.fullPath);e(s)},i=>{t(i)})})})}var mu={},ex;function a$(){return ex||(ex=1,mu.__esModule=!0,mu.default=function(n,e){if(n&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var i=n.name||"",s=(n.type||"").toLowerCase(),r=s.replace(/\/.*$/,"");return t.some(function(o){var a=o.trim().toLowerCase();return a.charAt(0)==="."?i.toLowerCase().endsWith(a):a.endsWith("/*")?r===a.replace(/\/.*$/,""):s===a})}return!0}),mu}var l$=a$();const Af=cc(l$);function tx(n){return d$(n)||u$(n)||lS(n)||c$()}function c$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u$(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function d$(n){if(Array.isArray(n))return dm(n)}function nx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function ix(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nx(Object(t),!0).forEach(function(i){aS(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function aS(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rc(n,e){return p$(n)||f$(n,e)||lS(n,e)||h$()}function h$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lS(n,e){if(n){if(typeof n=="string")return dm(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dm(n,e)}}function dm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function f$(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],s=!0,r=!1,o,a;try{for(t=t.call(n);!(s=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));s=!0);}catch(l){r=!0,a=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(r)throw a}}return i}}function p$(n){if(Array.isArray(n))return n}var m$=typeof Af=="function"?Af:Af.default,g$="file-invalid-type",y$="file-too-large",v$="file-too-small",w$="too-many-files",_$=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=e.split(","),i=t.length>1?"one of ".concat(t.join(", ")):t[0];return{code:g$,message:"File type must be ".concat(i)}},sx=function(e){return{code:y$,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},rx=function(e){return{code:v$,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},b$={code:w$,message:"Too many files"};function cS(n,e){var t=n.type==="application/x-moz-file"||m$(n,e);return[t,t?null:_$(e)]}function uS(n,e,t){if(ur(n.size))if(ur(e)&&ur(t)){if(n.size>t)return[!1,sx(t)];if(n.size<e)return[!1,rx(e)]}else{if(ur(e)&&n.size<e)return[!1,rx(e)];if(ur(t)&&n.size>t)return[!1,sx(t)]}return[!0,null]}function ur(n){return n!=null}function x$(n){var e=n.files,t=n.accept,i=n.minSize,s=n.maxSize,r=n.multiple,o=n.maxFiles,a=n.validator;return!r&&e.length>1||r&&o>=1&&e.length>o?!1:e.every(function(l){var c=cS(l,t),u=rc(c,1),f=u[0],m=uS(l,i,s),y=rc(m,1),v=y[0],_=a?a(l):null;return f&&v&&!_})}function bd(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function gu(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!n.target&&!!n.target.files}function ox(n){n.preventDefault()}function T$(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function E$(n){return n.indexOf("Edge/")!==-1}function A$(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return T$(n)||E$(n)}function ei(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(i){for(var s=arguments.length,r=new Array(s>1?s-1:0),o=1;o<s;o++)r[o-1]=arguments[o];return e.some(function(a){return!bd(i)&&a&&a.apply(void 0,[i].concat(r)),bd(i)})}}function I$(){return"showOpenFilePicker"in window}function C$(n){if(ur(n)){var e=Object.entries(n).filter(function(t){var i=rc(t,2),s=i[0],r=i[1],o=!0;return dS(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(r)||!r.every(hS))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(t,i){var s=rc(i,2),r=s[0],o=s[1];return ix(ix({},t),{},aS({},r,o))},{});return[{description:"Files",accept:e}]}return n}function S$(n){if(ur(n))return Object.entries(n).reduce(function(e,t){var i=rc(t,2),s=i[0],r=i[1];return[].concat(tx(e),[s],tx(r))},[]).filter(function(e){return dS(e)||hS(e)}).join(",")}function P$(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function k$(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function dS(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function hS(n){return/^.*\.[\w]+$/.test(n)}var R$=["children"],N$=["open"],M$=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],D$=["refKey","onChange","onClick"];function L$(n){return O$(n)||V$(n)||fS(n)||F$()}function F$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V$(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function O$(n){if(Array.isArray(n))return hm(n)}function If(n,e){return z$(n)||B$(n,e)||fS(n,e)||U$()}function U$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fS(n,e){if(n){if(typeof n=="string")return hm(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hm(n,e)}}function hm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function B$(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],s=!0,r=!1,o,a;try{for(t=t.call(n);!(s=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));s=!0);}catch(l){r=!0,a=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(r)throw a}}return i}}function z$(n){if(Array.isArray(n))return n}function ax(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function rt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ax(Object(t),!0).forEach(function(i){fm(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ax(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function fm(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xd(n,e){if(n==null)return{};var t=j$(n,e),i,s;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function j$(n,e){if(n==null)return{};var t={},i=Object.keys(n),s,r;for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}var ky=P.forwardRef(function(n,e){var t=n.children,i=xd(n,R$),s=mS(i),r=s.open,o=xd(s,N$);return P.useImperativeHandle(e,function(){return{open:r}},[r]),Ad.createElement(P.Fragment,null,t(rt(rt({},o),{},{open:r})))});ky.displayName="Dropzone";var pS={disabled:!1,getFilesFromEvent:QG,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};ky.defaultProps=pS;ky.propTypes={children:$e.func,accept:$e.objectOf($e.arrayOf($e.string)),multiple:$e.bool,preventDropOnDocument:$e.bool,noClick:$e.bool,noKeyboard:$e.bool,noDrag:$e.bool,noDragEventsBubbling:$e.bool,minSize:$e.number,maxSize:$e.number,maxFiles:$e.number,disabled:$e.bool,getFilesFromEvent:$e.func,onFileDialogCancel:$e.func,onFileDialogOpen:$e.func,useFsAccessApi:$e.bool,autoFocus:$e.bool,onDragEnter:$e.func,onDragLeave:$e.func,onDragOver:$e.func,onDrop:$e.func,onDropAccepted:$e.func,onDropRejected:$e.func,onError:$e.func,validator:$e.func};var pm={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function mS(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=rt(rt({},pS),n),t=e.accept,i=e.disabled,s=e.getFilesFromEvent,r=e.maxSize,o=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,f=e.onDragOver,m=e.onDrop,y=e.onDropAccepted,v=e.onDropRejected,_=e.onFileDialogCancel,x=e.onFileDialogOpen,T=e.useFsAccessApi,S=e.autoFocus,C=e.preventDropOnDocument,D=e.noClick,F=e.noKeyboard,V=e.noDrag,I=e.noDragEventsBubbling,E=e.onError,A=e.validator,N=P.useMemo(function(){return S$(t)},[t]),M=P.useMemo(function(){return C$(t)},[t]),L=P.useMemo(function(){return typeof x=="function"?x:lx},[x]),R=P.useMemo(function(){return typeof _=="function"?_:lx},[_]),G=P.useRef(null),oe=P.useRef(null),Y=P.useReducer(q$,pm),ie=If(Y,2),W=ie[0],H=ie[1],te=W.isFocused,re=W.isFileDialogActive,be=P.useRef(typeof window<"u"&&window.isSecureContext&&T&&I$()),le=function(){!be.current&&re&&setTimeout(function(){if(oe.current){var ve=oe.current.files;ve.length||(H({type:"closeDialog"}),R())}},300)};P.useEffect(function(){return window.addEventListener("focus",le,!1),function(){window.removeEventListener("focus",le,!1)}},[oe,re,R,be]);var ee=P.useRef([]),ye=function(ve){G.current&&G.current.contains(ve.target)||(ve.preventDefault(),ee.current=[])};P.useEffect(function(){return C&&(document.addEventListener("dragover",ox,!1),document.addEventListener("drop",ye,!1)),function(){C&&(document.removeEventListener("dragover",ox),document.removeEventListener("drop",ye))}},[G,C]),P.useEffect(function(){return!i&&S&&G.current&&G.current.focus(),function(){}},[G,S,i]);var Ee=P.useCallback(function(X){E?E(X):console.error(X)},[E]),ge=P.useCallback(function(X){X.preventDefault(),X.persist(),Zn(X),ee.current=[].concat(L$(ee.current),[X.target]),gu(X)&&Promise.resolve(s(X)).then(function(ve){if(!(bd(X)&&!I)){var Pe=ve.length,Me=Pe>0&&x$({files:ve,accept:N,minSize:o,maxSize:r,multiple:a,maxFiles:l,validator:A}),z=Pe>0&&!Me;H({isDragAccept:Me,isDragReject:z,isDragActive:!0,type:"setDraggedFiles"}),c&&c(X)}}).catch(function(ve){return Ee(ve)})},[s,c,Ee,I,N,o,r,a,l,A]),Se=P.useCallback(function(X){X.preventDefault(),X.persist(),Zn(X);var ve=gu(X);if(ve&&X.dataTransfer)try{X.dataTransfer.dropEffect="copy"}catch{}return ve&&f&&f(X),!1},[f,I]),pe=P.useCallback(function(X){X.preventDefault(),X.persist(),Zn(X);var ve=ee.current.filter(function(Me){return G.current&&G.current.contains(Me)}),Pe=ve.indexOf(X.target);Pe!==-1&&ve.splice(Pe,1),ee.current=ve,!(ve.length>0)&&(H({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),gu(X)&&u&&u(X))},[G,u,I]),mt=P.useCallback(function(X,ve){var Pe=[],Me=[];X.forEach(function(z){var De=cS(z,N),gt=If(De,2),Ta=gt[0],Ai=gt[1],Yr=uS(z,o,r),Ws=If(Yr,2),Ks=Ws[0],Ea=Ws[1],Aa=A?A(z):null;if(Ta&&Ks&&!Aa)Pe.push(z);else{var Ys=[Ai,Ea];Aa&&(Ys=Ys.concat(Aa)),Me.push({file:z,errors:Ys.filter(function(Oc){return Oc})})}}),(!a&&Pe.length>1||a&&l>=1&&Pe.length>l)&&(Pe.forEach(function(z){Me.push({file:z,errors:[b$]})}),Pe.splice(0)),H({acceptedFiles:Pe,fileRejections:Me,isDragReject:Me.length>0,type:"setFiles"}),m&&m(Pe,Me,ve),Me.length>0&&v&&v(Me,ve),Pe.length>0&&y&&y(Pe,ve)},[H,a,N,o,r,l,m,y,v,A]),Nt=P.useCallback(function(X){X.preventDefault(),X.persist(),Zn(X),ee.current=[],gu(X)&&Promise.resolve(s(X)).then(function(ve){bd(X)&&!I||mt(ve,X)}).catch(function(ve){return Ee(ve)}),H({type:"reset"})},[s,mt,Ee,I]),ct=P.useCallback(function(){if(be.current){H({type:"openDialog"}),L();var X={multiple:a,types:M};window.showOpenFilePicker(X).then(function(ve){return s(ve)}).then(function(ve){mt(ve,null),H({type:"closeDialog"})}).catch(function(ve){P$(ve)?(R(ve),H({type:"closeDialog"})):k$(ve)?(be.current=!1,oe.current?(oe.current.value=null,oe.current.click()):Ee(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Ee(ve)});return}oe.current&&(H({type:"openDialog"}),L(),oe.current.value=null,oe.current.click())},[H,L,R,T,mt,Ee,M,a]),Qn=P.useCallback(function(X){!G.current||!G.current.isEqualNode(X.target)||(X.key===" "||X.key==="Enter"||X.keyCode===32||X.keyCode===13)&&(X.preventDefault(),ct())},[G,ct]),xn=P.useCallback(function(){H({type:"focus"})},[]),Xi=P.useCallback(function(){H({type:"blur"})},[]),Hs=P.useCallback(function(){D||(A$()?setTimeout(ct,0):ct())},[D,ct]),pn=function(ve){return i?null:ve},Gs=function(ve){return F?null:pn(ve)},zn=function(ve){return V?null:pn(ve)},Zn=function(ve){I&&ve.stopPropagation()},Kr=P.useMemo(function(){return function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ve=X.refKey,Pe=ve===void 0?"ref":ve,Me=X.role,z=X.onKeyDown,De=X.onFocus,gt=X.onBlur,Ta=X.onClick,Ai=X.onDragEnter,Yr=X.onDragOver,Ws=X.onDragLeave,Ks=X.onDrop,Ea=xd(X,M$);return rt(rt(fm({onKeyDown:Gs(ei(z,Qn)),onFocus:Gs(ei(De,xn)),onBlur:Gs(ei(gt,Xi)),onClick:pn(ei(Ta,Hs)),onDragEnter:zn(ei(Ai,ge)),onDragOver:zn(ei(Yr,Se)),onDragLeave:zn(ei(Ws,pe)),onDrop:zn(ei(Ks,Nt)),role:typeof Me=="string"&&Me!==""?Me:"presentation"},Pe,G),!i&&!F?{tabIndex:0}:{}),Ea)}},[G,Qn,xn,Xi,Hs,ge,Se,pe,Nt,F,V,i]),$s=P.useCallback(function(X){X.stopPropagation()},[]),Ei=P.useMemo(function(){return function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ve=X.refKey,Pe=ve===void 0?"ref":ve,Me=X.onChange,z=X.onClick,De=xd(X,D$),gt=fm({accept:N,multiple:a,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:pn(ei(Me,Nt)),onClick:pn(ei(z,$s)),tabIndex:-1},Pe,oe);return rt(rt({},gt),De)}},[oe,t,a,Nt,i]);return rt(rt({},W),{},{isFocused:te&&!i,getRootProps:Kr,getInputProps:Ei,rootRef:G,inputRef:oe,open:pn(ct)})}function q$(n,e){switch(e.type){case"focus":return rt(rt({},n),{},{isFocused:!0});case"blur":return rt(rt({},n),{},{isFocused:!1});case"openDialog":return rt(rt({},pm),{},{isFileDialogActive:!0});case"closeDialog":return rt(rt({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return rt(rt({},n),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return rt(rt({},n),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return rt({},pm);default:return n}}function lx(){}const cx=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(null),[s,r]=P.useState(null),[o,a]=P.useState(""),[l,c]=P.useState(!1),{user:u,updateProfileImage:f}=Nn(),m=P.useCallback((S,C)=>{if(a(""),C.length>0){a("Please upload a valid image file (PNG, JPG, etc.) under 2MB.");return}if(S.length>0){const D=S[0];i(D);const F=new FileReader;F.onloadend=()=>{r(F.result)},F.readAsDataURL(D)}},[]),{getRootProps:y,getInputProps:v,isDragActive:_}=mS({onDrop:m,accept:{"image/*":[".jpeg",".png",".gif",".jpg",".webp"]},maxSize:2*1024*1024,multiple:!1}),x=async()=>{if(!(!t||!u)){c(!0),a("");try{await f(t),T()}catch(S){a(S.message||"Failed to save image.")}finally{c(!1)}}},T=()=>{i(null),r(null),a(""),c(!1),e()};return P.useEffect(()=>{if(!n)return;const S=C=>{C.key==="Escape"&&T()};return document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}},[n,T]),n?p.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 z-[100] flex items-center justify-center p-4 animate-fade-in-down",style:{animationDuration:"300ms"},onClick:T,role:"dialog","aria-modal":"true","aria-labelledby":"profile-image-modal-title",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full max-w-lg flex flex-col rounded-xl shadow-2xl",onClick:S=>S.stopPropagation(),children:[p.jsx("header",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-t-xl border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{id:"profile-image-modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Change Profile Photo"}),p.jsx("button",{onClick:T,className:"p-1 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors","aria-label":"Close modal",children:p.jsx(Ki,{className:"h-6 w-6"})})]})}),p.jsxs("main",{className:"p-8",children:[o&&p.jsx("p",{className:"text-center text-sm text-red-500 bg-red-100 dark:bg-red-900/30 p-3 rounded-md mb-4",children:o}),s?p.jsxs("div",{className:"text-center",children:[p.jsx("img",{src:s,alt:"Preview",className:"w-40 h-40 rounded-full mx-auto object-cover border-4 border-gray-200 dark:border-gray-700"}),p.jsx("button",{onClick:()=>{i(null),r(null)},className:"mt-4 text-sm text-brand-red hover:underline",children:"Choose a different photo"})]}):p.jsxs("div",{...y(),className:`relative flex flex-col items-center justify-center p-12 border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-300 ${_?"border-brand-red bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800"}`,children:[p.jsx("input",{...v()}),p.jsx(R8,{className:"h-12 w-12 text-gray-400"}),p.jsx("p",{className:"mt-4 font-semibold text-gray-700 dark:text-gray-200",children:"Drag & drop or click to upload"}),p.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 2MB"})]})]}),p.jsxs("footer",{className:"flex justify-end gap-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-b-xl",children:[p.jsx("button",{onClick:T,className:"px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),p.jsx("button",{onClick:x,disabled:!t||l,className:"px-4 py-2 text-sm font-semibold text-white bg-brand-red rounded-md hover:bg-brand-red-dark transition-colors disabled:bg-red-300 dark:disabled:bg-red-800 disabled:cursor-not-allowed",children:l?"Saving...":"Save Changes"})]})]})}):null},H$=[{path:"/about",title:"About Us",description:"Learn about our mission, values, and the story behind I Love PDFLY.",Icon:$n,color:"bg-blue-500"},{path:"/contact",title:"Contact",description:"Get in touch with our team for support or inquiries.",Icon:$n,color:"bg-green-500"},{path:"/faq",title:"FAQ",description:"Find answers to frequently asked questions about our tools and services.",Icon:$n,color:"bg-yellow-500"},{path:"/pricing",title:"Pricing",description:"View our flexible pricing plans for users.",Icon:gd,color:"bg-purple-500"},{path:"/developer",title:"Developer Hub",description:"Integrate our powerful tools into your applications with our REST API.",Icon:IC,color:"bg-teal-500"},{path:"/sitemap",title:"Sitemap",description:"A complete overview of all pages and tools available on our site.",Icon:$n,color:"bg-gray-500"},{path:"/ceo",title:"Message from the CEO",description:"Read a letter from our founder, Bishal Mishra.",Icon:$n,color:"bg-indigo-500"},{path:"/legal",title:"Legal & Privacy Hub",description:"Find our Terms of Service, Privacy Policy, and Cookie Policy.",Icon:EC,color:"bg-slate-500"},{path:"/education",title:"For Education",description:"Solutions and tools tailored for students and educators.",Icon:Z8,color:"bg-pink-500"},{path:"/business",title:"For Business",description:"Streamline document workflows for your company.",Icon:TC,color:"bg-cyan-500"},{path:"/press",title:"Press Kit",description:"Media kits, logos, and information for the press.",Icon:xC,color:"bg-rose-500"},{path:"/features",title:"Features",description:"Explore all the powerful features of our platform.",Icon:$n,color:"bg-fuchsia-500"},{path:"/api-pricing",title:"API Pricing",description:"View pricing plans for our developer API.",Icon:gd,color:"bg-purple-500"},{path:"/api-reference",title:"API Reference",description:"Detailed documentation for all API endpoints and libraries.",Icon:yh,color:"bg-gray-500"}],ux=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(""),s=P.useRef(null),{t:r}=Nc(),o=P.useMemo(()=>{const l=cr.map(f=>({type:"tool",path:`/${f.id}`,title:r(f.title),description:r(f.description),Icon:f.Icon,color:f.color})),c=VG.map(f=>({type:"blog",path:`/blog/${f.slug}`,title:f.title,description:f.excerpt,Icon:yh,color:"bg-orange-500"})),u=H$.map(f=>({type:"page",...f}));return[...l,...c,...u]},[r]),a=P.useMemo(()=>{if(!t.trim())return[];const l=t.toLowerCase();return o.filter(c=>c.title.toLowerCase().includes(l)||c.description.toLowerCase().includes(l))},[t,o]);return P.useEffect(()=>{if(n){i(""),setTimeout(()=>s.current?.focus(),100);const l=c=>{c.key==="Escape"&&e()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)}},[n,e]),n?p.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 z-[100] flex items-start justify-center p-4 pt-[10vh]",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"search-modal-title",children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-2xl rounded-xl shadow-2xl transform transition-all animate-fade-in-down",style:{animationDuration:"300ms"},onClick:l=>l.stopPropagation(),children:[p.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center",children:[p.jsx("h2",{id:"search-modal-title",className:"sr-only",children:"Search Site"}),p.jsx(Ey,{className:"h-5 w-5 text-gray-400 mr-3"}),p.jsx("input",{ref:s,type:"text",value:t,onChange:l=>i(l.target.value),placeholder:"Search for tools, articles, and pages...",className:"w-full bg-transparent focus:outline-none text-gray-800 dark:text-gray-100"})]}),p.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:a.length>0?p.jsx("ul",{children:a.map(l=>p.jsx("li",{children:p.jsxs(Be,{to:l.path,onClick:e,className:"flex items-center gap-4 p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[p.jsx("div",{className:`p-2 rounded-lg ${l.color||"bg-gray-500"}`,children:p.jsx(l.Icon,{className:"h-6 w-6 text-white"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-100",children:l.title}),p.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l.description})]})]})},`${l.type}-${l.path}`))}):t.trim()?p.jsx("div",{className:"p-8 text-center text-gray-500",children:p.jsxs("p",{children:['No results found for "',t,'"']})}):p.jsx("div",{className:"p-8 text-center text-gray-500",children:p.jsx("p",{children:"Start typing to search for anything on the site."})})})]})}):null},dx=()=>sessionStorage.getItem("isAdminAuthenticated")==="true"?p.jsx(Cm,{}):p.jsx(ST,{to:"/developer-access"}),hx=()=>{const{user:n,loading:e}=Nn(),t=Ti();return e?p.jsx(nc,{}):n?p.jsx(Cm,{}):p.jsx(ST,{to:"/login",state:{from:t},replace:!0})},G$=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[p.jsx("path",{d:"M0 0h24v24H0V0z",fill:"none"}),p.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"})]}),$$=({className:n})=>p.jsxs("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[p.jsx("path",{d:"M0 0h24v24H0V0z",fill:"none"}),p.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"})]}),W$=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(new Date);if(P.useEffect(()=>{if(!n)return;const y=v=>{v.key==="Escape"&&e()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n,e]),!n)return null;const s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=new Date,o=t.getMonth(),a=t.getFullYear(),l=new Date(a,o,1).getDay(),c=new Date(a,o+1,0).getDate(),u=()=>i(new Date(a,o-1,1)),f=()=>i(new Date(a,o+1,1)),m=()=>{const y=[];for(let v=0;v<l;v++)y.push(p.jsx("div",{className:"p-2"},`empty-prev-${v}`));for(let v=1;v<=c;v++){const _=r.getDate()===v&&r.getMonth()===o&&r.getFullYear()===a;y.push(p.jsx("div",{className:`p-2 text-center rounded-full flex items-center justify-center font-semibold h-10 w-10
                    ${_?"bg-brand-red text-white":"text-gray-700 dark:text-gray-300"}`,children:v},v))}return y};return p.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 z-[100] flex items-center justify-center p-4",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"calendar-modal-title",children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-lg rounded-xl shadow-2xl animated-border",onClick:y=>y.stopPropagation(),children:[p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("button",{onClick:u,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Previous month",children:p.jsx(G$,{className:"h-6 w-6"})}),p.jsx("h2",{id:"calendar-modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:t.toLocaleString("default",{month:"long",year:"numeric"})}),p.jsx("button",{onClick:f,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Next month",children:p.jsx($$,{className:"h-6 w-6"})})]}),p.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-sm text-gray-500 dark:text-gray-400 mb-2",children:s.map(y=>p.jsx("div",{children:y},y))}),p.jsx("div",{className:"grid grid-cols-7 gap-2",children:m()})]}),p.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 text-center rounded-b-xl",children:p.jsx("button",{onClick:e,className:"text-brand-red font-semibold hover:underline",children:"Close"})})]})})},K$=()=>{const[n,e]=P.useState(!1);P.useEffect(()=>{try{if(!localStorage.getItem("cookie_consent")){const s=setTimeout(()=>{e(!0)},500);return()=>clearTimeout(s)}}catch(i){console.error("Could not access localStorage:",i);const s=setTimeout(()=>{e(!0)},500);return()=>clearTimeout(s)}},[]);const t=()=>{try{localStorage.setItem("cookie_consent","true")}catch(i){console.error("Could not set localStorage item:",i)}e(!1)};return n?p.jsx("div",{className:"fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 bg-white/80 dark:bg-black/80 backdrop-blur-sm border border-gray-200 dark:border-gray-700 p-4 sm:p-5 rounded-lg shadow-2xl z-[100] animate-fade-in-up max-w-lg",children:p.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[p.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"We use cookies to enhance your experience. By continuing to visit this site you agree to our use of cookies."}),p.jsxs("button",{onClick:t,className:"flex-shrink-0 w-full sm:w-auto bg-brand-red hover:bg-brand-red-dark text-white font-bold py-2 px-6 rounded-lg transition-colors flex items-center justify-center gap-2",children:[p.jsx(va,{className:"h-5 w-5"}),"Accept"]})]})}):null},fx=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(""),[s,r]=P.useState(""),[o,a]=P.useState(""),[l,c]=P.useState(""),[u,f]=P.useState(""),[m,y]=P.useState(!1),{user:v,changePassword:_}=Nn(),x=P.useRef(null),T=async C=>{if(C.preventDefault(),c(""),f(""),s!==o){c("New passwords do not match.");return}if(s.length<6){c("Password must be at least 6 characters long.");return}if(!v){c("You must be logged in to change your password.");return}y(!0);try{await _(t,s),f("Password changed successfully! You can now close this window."),i(""),r(""),a("")}catch(D){c(D.message||"Failed to change password.")}finally{y(!1)}},S=()=>{i(""),r(""),a(""),c(""),f(""),y(!1),e()};return P.useEffect(()=>{if(n){setTimeout(()=>x.current?.focus(),100);const C=D=>{D.key==="Escape"&&S()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)}},[n,S]),n?p.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 z-[100] flex items-center justify-center p-4 animate-fade-in-down",style:{animationDuration:"300ms"},onClick:S,role:"dialog","aria-modal":"true","aria-labelledby":"change-password-modal-title",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full max-w-lg flex flex-col rounded-xl shadow-2xl",onClick:C=>C.stopPropagation(),children:[p.jsx("header",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-t-xl border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{id:"change-password-modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Change Password"}),p.jsx("button",{onClick:S,className:"p-1 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors","aria-label":"Close modal",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),p.jsxs("form",{onSubmit:T,children:[p.jsxs("main",{className:"p-8 space-y-4",children:[l&&p.jsx("p",{className:"text-center text-sm text-red-500 bg-red-100 dark:bg-red-900/30 p-3 rounded-md",children:l}),u&&p.jsx("p",{className:"text-center text-sm text-green-600 bg-green-100 dark:bg-green-900/30 p-3 rounded-md",children:u}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"old-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Old Password"}),p.jsx("input",{ref:x,type:"password",id:"old-password",value:t,onChange:C=>i(C.target.value),required:!0,className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-brand-red focus:border-brand-red text-gray-800 dark:text-gray-200"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Password"}),p.jsx("input",{type:"password",id:"new-password",value:s,onChange:C=>r(C.target.value),required:!0,className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-brand-red focus:border-brand-red text-gray-800 dark:text-gray-200"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm New Password"}),p.jsx("input",{type:"password",id:"confirm-password",value:o,onChange:C=>a(C.target.value),required:!0,className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-brand-red focus:border-brand-red text-gray-800 dark:text-gray-200"})]})]}),p.jsxs("footer",{className:"flex justify-end gap-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-b-xl",children:[p.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),p.jsx("button",{type:"submit",disabled:m||!!u,className:"px-4 py-2 text-sm font-semibold text-white bg-brand-red rounded-md hover:bg-brand-red-dark transition-colors disabled:bg-red-300 dark:disabled:bg-red-800 disabled:cursor-not-allowed",children:m?"Saving...":"Save Changes"})]})]})]})}):null},px=()=>{const{canInstall:n,promptInstall:e}=ya(),[t,i]=P.useState(!1);P.useEffect(()=>{const o=sessionStorage.getItem("pwa_install_dismissed");if(n&&!o){const a=setTimeout(()=>{i(!0)},5e3);return()=>clearTimeout(a)}else i(!1)},[n]);const s=()=>{e(),i(!1)},r=()=>{i(!1);try{sessionStorage.setItem("pwa_install_dismissed","true")}catch(o){console.error("Could not set sessionStorage item:",o)}};return t?p.jsx("div",{className:"fixed bottom-24 right-4 z-[100] bg-white/80 dark:bg-black/80 backdrop-blur-sm p-4 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-800 animate-fade-in-up w-full max-w-sm",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"flex-shrink-0 bg-brand-red p-3 rounded-lg mt-1",children:p.jsx(Mc,{className:"h-6 w-6 text-white"})}),p.jsxs("div",{className:"flex-grow",children:[p.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:"Install PDFBullet App"}),p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Get a faster, offline-capable experience on your device."}),p.jsxs("div",{className:"mt-4 flex gap-2",children:[p.jsx("button",{onClick:s,className:"bg-brand-red hover:bg-brand-red-dark text-white font-bold py-2 px-6 rounded-lg transition-colors flex-shrink-0 text-sm",children:"Install"}),p.jsx("button",{onClick:r,className:"bg-transparent hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 font-bold py-2 px-4 rounded-lg transition-colors text-sm",children:"Later"})]})]}),p.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 absolute top-2 right-2","aria-label":"Dismiss install prompt",children:p.jsx(Ki,{className:"h-5 w-5"})})]})}):null},Y$=({isOpen:n,onClose:e})=>{const{user:t,auth:i,submitProblemReport:s}=Nn(),[r,o]=P.useState(""),[a,l]=P.useState("Tool Not Working"),[c,u]=P.useState(!1),[f,m]=P.useState(""),[y,v]=P.useState(!1),_=async T=>{T.preventDefault(),u(!0),m(""),v(!1);try{await s({email:i.currentUser?.email||"Not logged in",url:window.location.href,description:r.trim(),problemType:a}),v(!0),setTimeout(()=>x(),3e3)}catch(S){m(S.message||"Failed to submit report. Please try again.")}finally{u(!1)}},x=()=>{o(""),l("Tool Not Working"),m(""),v(!1),u(!1),e()};return n?p.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 z-[100] flex items-center justify-center p-4 animate-fade-in-down",style:{animationDuration:"300ms"},onClick:x,children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-lg rounded-xl shadow-2xl",onClick:T=>T.stopPropagation(),children:[p.jsx("header",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-t-xl border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Report a Problem"}),p.jsx("button",{onClick:x,className:"p-1 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors","aria-label":"Close modal",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),y?p.jsxs("div",{className:"p-8 text-center",children:[p.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/50 mb-6",children:p.jsx(va,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),p.jsx("h3",{className:"text-lg font-bold",children:"Report Submitted"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Thank you for your feedback! Our team will look into it."})]}):p.jsxs("form",{onSubmit:_,noValidate:!0,children:[p.jsxs("main",{className:"p-6 space-y-4",children:[p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Found an issue? Please describe it below. The current page URL and your user info (if logged in) will be included automatically."}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"problemType",className:"block text-sm font-bold mb-1 text-gray-700 dark:text-gray-300",children:"Problem Type"}),p.jsxs("select",{id:"problemType",value:a,onChange:T=>l(T.target.value),className:"w-full p-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md",children:[p.jsx("option",{children:"Tool Not Working"}),p.jsx("option",{children:"Visual Bug"}),p.jsx("option",{children:"Login Issue"}),p.jsx("option",{children:"Payment Problem"}),p.jsx("option",{children:"Other"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"description",className:"block text-sm font-bold mb-1 text-gray-700 dark:text-gray-300",children:"Description*"}),p.jsx("textarea",{id:"description",value:r,onChange:T=>o(T.target.value),rows:4,required:!0,className:"w-full p-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md"})]}),f&&p.jsx("div",{className:"text-sm text-red-500 bg-red-100 dark:bg-red-900/30 p-2 rounded-md",children:f})]}),p.jsxs("footer",{className:"flex justify-end gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-b-xl",children:[p.jsx("button",{type:"button",onClick:x,className:"px-6 py-2 text-sm font-semibold border rounded-md bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600",children:"Cancel"}),p.jsxs("button",{type:"submit",disabled:c,className:"flex items-center gap-2 bg-brand-red text-white font-bold py-2 px-6 rounded-md disabled:bg-red-300 hover:bg-brand-red-dark",children:[p.jsx(mC,{className:"h-5 w-5"}),c?"Submitting...":"Submit Report"]})]})]})]})}):null};var lo={},Cf,mx;function J$(){return mx||(mx=1,Cf=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Cf}var Sf={},os={},gx;function Gr(){if(gx)return os;gx=1;let n;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return os.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},os.getSymbolTotalCodewords=function(i){return e[i]},os.getBCHDigit=function(t){let i=0;for(;t!==0;)i++,t>>>=1;return i},os.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');n=i},os.isKanjiModeEnabled=function(){return typeof n<"u"},os.toSJIS=function(i){return n(i)},os}var Pf={},yx;function Ry(){return yx||(yx=1,(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},n.from=function(i,s){if(n.isValid(i))return i;try{return e(i)}catch{return s}}})(Pf)),Pf}var kf,vx;function X$(){if(vx)return kf;vx=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let i=0;i<t;i++)this.putBit((e>>>t-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},kf=n,kf}var Rf,wx;function Q$(){if(wx)return Rf;wx=1;function n(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return n.prototype.set=function(e,t,i,s){const r=e*this.size+t;this.data[r]=i,s&&(this.reservedBit[r]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,i){this.data[e*this.size+t]^=i},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},Rf=n,Rf}var Nf={},_x;function Z$(){return _x||(_x=1,(function(n){const e=Gr().getSymbolSize;n.getRowColCoords=function(i){if(i===1)return[];const s=Math.floor(i/7)+2,r=e(i),o=r===145?26:Math.ceil((r-13)/(2*s-2))*2,a=[r-7];for(let l=1;l<s-1;l++)a[l]=a[l-1]-o;return a.push(6),a.reverse()},n.getPositions=function(i){const s=[],r=n.getRowColCoords(i),o=r.length;for(let a=0;a<o;a++)for(let l=0;l<o;l++)a===0&&l===0||a===0&&l===o-1||a===o-1&&l===0||s.push([r[a],r[l]]);return s}})(Nf)),Nf}var Mf={},bx;function eW(){if(bx)return Mf;bx=1;const n=Gr().getSymbolSize,e=7;return Mf.getPositions=function(i){const s=n(i);return[[0,0],[s-e,0],[0,s-e]]},Mf}var Df={},xx;function tW(){return xx||(xx=1,(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},n.from=function(s){return n.isValid(s)?parseInt(s,10):void 0},n.getPenaltyN1=function(s){const r=s.size;let o=0,a=0,l=0,c=null,u=null;for(let f=0;f<r;f++){a=l=0,c=u=null;for(let m=0;m<r;m++){let y=s.get(f,m);y===c?a++:(a>=5&&(o+=e.N1+(a-5)),c=y,a=1),y=s.get(m,f),y===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=y,l=1)}a>=5&&(o+=e.N1+(a-5)),l>=5&&(o+=e.N1+(l-5))}return o},n.getPenaltyN2=function(s){const r=s.size;let o=0;for(let a=0;a<r-1;a++)for(let l=0;l<r-1;l++){const c=s.get(a,l)+s.get(a,l+1)+s.get(a+1,l)+s.get(a+1,l+1);(c===4||c===0)&&o++}return o*e.N2},n.getPenaltyN3=function(s){const r=s.size;let o=0,a=0,l=0;for(let c=0;c<r;c++){a=l=0;for(let u=0;u<r;u++)a=a<<1&2047|s.get(c,u),u>=10&&(a===1488||a===93)&&o++,l=l<<1&2047|s.get(u,c),u>=10&&(l===1488||l===93)&&o++}return o*e.N3},n.getPenaltyN4=function(s){let r=0;const o=s.data.length;for(let l=0;l<o;l++)r+=s.data[l];return Math.abs(Math.ceil(r*100/o/5)-10)*e.N4};function t(i,s,r){switch(i){case n.Patterns.PATTERN000:return(s+r)%2===0;case n.Patterns.PATTERN001:return s%2===0;case n.Patterns.PATTERN010:return r%3===0;case n.Patterns.PATTERN011:return(s+r)%3===0;case n.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(r/3))%2===0;case n.Patterns.PATTERN101:return s*r%2+s*r%3===0;case n.Patterns.PATTERN110:return(s*r%2+s*r%3)%2===0;case n.Patterns.PATTERN111:return(s*r%3+(s+r)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}n.applyMask=function(s,r){const o=r.size;for(let a=0;a<o;a++)for(let l=0;l<o;l++)r.isReserved(l,a)||r.xor(l,a,t(s,l,a))},n.getBestMask=function(s,r){const o=Object.keys(n.Patterns).length;let a=0,l=1/0;for(let c=0;c<o;c++){r(c),n.applyMask(c,s);const u=n.getPenaltyN1(s)+n.getPenaltyN2(s)+n.getPenaltyN3(s)+n.getPenaltyN4(s);n.applyMask(c,s),u<l&&(l=u,a=c)}return a}})(Df)),Df}var yu={},Tx;function gS(){if(Tx)return yu;Tx=1;const n=Ry(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return yu.getBlocksCount=function(s,r){switch(r){case n.L:return e[(s-1)*4+0];case n.M:return e[(s-1)*4+1];case n.Q:return e[(s-1)*4+2];case n.H:return e[(s-1)*4+3];default:return}},yu.getTotalCodewordsCount=function(s,r){switch(r){case n.L:return t[(s-1)*4+0];case n.M:return t[(s-1)*4+1];case n.Q:return t[(s-1)*4+2];case n.H:return t[(s-1)*4+3];default:return}},yu}var Lf={},Ja={},Ex;function nW(){if(Ex)return Ja;Ex=1;const n=new Uint8Array(512),e=new Uint8Array(256);return(function(){let i=1;for(let s=0;s<255;s++)n[s]=i,e[i]=s,i<<=1,i&256&&(i^=285);for(let s=255;s<512;s++)n[s]=n[s-255]})(),Ja.log=function(i){if(i<1)throw new Error("log("+i+")");return e[i]},Ja.exp=function(i){return n[i]},Ja.mul=function(i,s){return i===0||s===0?0:n[e[i]+e[s]]},Ja}var Ax;function iW(){return Ax||(Ax=1,(function(n){const e=nW();n.mul=function(i,s){const r=new Uint8Array(i.length+s.length-1);for(let o=0;o<i.length;o++)for(let a=0;a<s.length;a++)r[o+a]^=e.mul(i[o],s[a]);return r},n.mod=function(i,s){let r=new Uint8Array(i);for(;r.length-s.length>=0;){const o=r[0];for(let l=0;l<s.length;l++)r[l]^=e.mul(s[l],o);let a=0;for(;a<r.length&&r[a]===0;)a++;r=r.slice(a)}return r},n.generateECPolynomial=function(i){let s=new Uint8Array([1]);for(let r=0;r<i;r++)s=n.mul(s,new Uint8Array([1,e.exp(r)]));return s}})(Lf)),Lf}var Ff,Ix;function sW(){if(Ix)return Ff;Ix=1;const n=iW();function e(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(i){this.degree=i,this.genPoly=n.generateECPolynomial(this.degree)},e.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(i.length+this.degree);s.set(i);const r=n.mod(s,this.genPoly),o=this.degree-r.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(r,o),a}return r},Ff=e,Ff}var Vf={},Of={},Uf={},Cx;function yS(){return Cx||(Cx=1,Uf.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),Uf}var ti={},Sx;function vS(){if(Sx)return ti;Sx=1;const n="[0-9]+",e="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;ti.KANJI=new RegExp(t,"g"),ti.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ti.BYTE=new RegExp(i,"g"),ti.NUMERIC=new RegExp(n,"g"),ti.ALPHANUMERIC=new RegExp(e,"g");const s=new RegExp("^"+t+"$"),r=new RegExp("^"+n+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ti.testKanji=function(l){return s.test(l)},ti.testNumeric=function(l){return r.test(l)},ti.testAlphanumeric=function(l){return o.test(l)},ti}var Px;function $r(){return Px||(Px=1,(function(n){const e=yS(),t=vS();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(r,o){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?r.ccBits[0]:o<27?r.ccBits[1]:r.ccBits[2]},n.getBestModeForData=function(r){return t.testNumeric(r)?n.NUMERIC:t.testAlphanumeric(r)?n.ALPHANUMERIC:t.testKanji(r)?n.KANJI:n.BYTE},n.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},n.isValid=function(r){return r&&r.bit&&r.ccBits};function i(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+s)}}n.from=function(r,o){if(n.isValid(r))return r;try{return i(r)}catch{return o}}})(Of)),Of}var kx;function rW(){return kx||(kx=1,(function(n){const e=Gr(),t=gS(),i=Ry(),s=$r(),r=yS(),o=7973,a=e.getBCHDigit(o);function l(m,y,v){for(let _=1;_<=40;_++)if(y<=n.getCapacity(_,v,m))return _}function c(m,y){return s.getCharCountIndicator(m,y)+4}function u(m,y){let v=0;return m.forEach(function(_){const x=c(_.mode,y);v+=x+_.getBitsLength()}),v}function f(m,y){for(let v=1;v<=40;v++)if(u(m,v)<=n.getCapacity(v,y,s.MIXED))return v}n.from=function(y,v){return r.isValid(y)?parseInt(y,10):v},n.getCapacity=function(y,v,_){if(!r.isValid(y))throw new Error("Invalid QR Code version");typeof _>"u"&&(_=s.BYTE);const x=e.getSymbolTotalCodewords(y),T=t.getTotalCodewordsCount(y,v),S=(x-T)*8;if(_===s.MIXED)return S;const C=S-c(_,y);switch(_){case s.NUMERIC:return Math.floor(C/10*3);case s.ALPHANUMERIC:return Math.floor(C/11*2);case s.KANJI:return Math.floor(C/13);case s.BYTE:default:return Math.floor(C/8)}},n.getBestVersionForData=function(y,v){let _;const x=i.from(v,i.M);if(Array.isArray(y)){if(y.length>1)return f(y,x);if(y.length===0)return 1;_=y[0]}else _=y;return l(_.mode,_.getLength(),x)},n.getEncodedBits=function(y){if(!r.isValid(y)||y<7)throw new Error("Invalid QR Code version");let v=y<<12;for(;e.getBCHDigit(v)-a>=0;)v^=o<<e.getBCHDigit(v)-a;return y<<12|v}})(Vf)),Vf}var Bf={},Rx;function oW(){if(Rx)return Bf;Rx=1;const n=Gr(),e=1335,t=21522,i=n.getBCHDigit(e);return Bf.getEncodedBits=function(r,o){const a=r.bit<<3|o;let l=a<<10;for(;n.getBCHDigit(l)-i>=0;)l^=e<<n.getBCHDigit(l)-i;return(a<<10|l)^t},Bf}var zf={},jf,Nx;function aW(){if(Nx)return jf;Nx=1;const n=$r();function e(t){this.mode=n.NUMERIC,this.data=t.toString()}return e.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let s,r,o;for(s=0;s+3<=this.data.length;s+=3)r=this.data.substr(s,3),o=parseInt(r,10),i.put(o,10);const a=this.data.length-s;a>0&&(r=this.data.substr(s),o=parseInt(r,10),i.put(o,a*3+1))},jf=e,jf}var qf,Mx;function lW(){if(Mx)return qf;Mx=1;const n=$r(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(i){this.mode=n.ALPHANUMERIC,this.data=i}return t.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){let r;for(r=0;r+2<=this.data.length;r+=2){let o=e.indexOf(this.data[r])*45;o+=e.indexOf(this.data[r+1]),s.put(o,11)}this.data.length%2&&s.put(e.indexOf(this.data[r]),6)},qf=t,qf}var Hf,Dx;function cW(){if(Dx)return Hf;Dx=1;const n=$r();function e(t){this.mode=n.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return e.getBitsLength=function(i){return i*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(t){for(let i=0,s=this.data.length;i<s;i++)t.put(this.data[i],8)},Hf=e,Hf}var Gf,Lx;function uW(){if(Lx)return Gf;Lx=1;const n=$r(),e=Gr();function t(i){this.mode=n.KANJI,this.data=i}return t.getBitsLength=function(s){return s*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let s;for(s=0;s<this.data.length;s++){let r=e.toSJIS(this.data[s]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),i.put(r,13)}},Gf=t,Gf}var $f={exports:{}},Fx;function dW(){return Fx||(Fx=1,(function(n){var e={single_source_shortest_paths:function(t,i,s){var r={},o={};o[i]=0;var a=e.PriorityQueue.make();a.push(i,0);for(var l,c,u,f,m,y,v,_,x;!a.empty();){l=a.pop(),c=l.value,f=l.cost,m=t[c]||{};for(u in m)m.hasOwnProperty(u)&&(y=m[u],v=f+y,_=o[u],x=typeof o[u]>"u",(x||_>v)&&(o[u]=v,a.push(u,v),r[u]=c))}if(typeof s<"u"&&typeof o[s]>"u"){var T=["Could not find a path from ",i," to ",s,"."].join("");throw new Error(T)}return r},extract_shortest_path_from_predecessor_list:function(t,i){for(var s=[],r=i;r;)s.push(r),t[r],r=t[r];return s.reverse(),s},find_path:function(t,i,s){var r=e.single_source_shortest_paths(t,i,s);return e.extract_shortest_path_from_predecessor_list(r,s)},PriorityQueue:{make:function(t){var i=e.PriorityQueue,s={},r;t=t||{};for(r in i)i.hasOwnProperty(r)&&(s[r]=i[r]);return s.queue=[],s.sorter=t.sorter||i.default_sorter,s},default_sorter:function(t,i){return t.cost-i.cost},push:function(t,i){var s={value:t,cost:i};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})($f)),$f.exports}var Vx;function hW(){return Vx||(Vx=1,(function(n){const e=$r(),t=aW(),i=lW(),s=cW(),r=uW(),o=vS(),a=Gr(),l=dW();function c(T){return unescape(encodeURIComponent(T)).length}function u(T,S,C){const D=[];let F;for(;(F=T.exec(C))!==null;)D.push({data:F[0],index:F.index,mode:S,length:F[0].length});return D}function f(T){const S=u(o.NUMERIC,e.NUMERIC,T),C=u(o.ALPHANUMERIC,e.ALPHANUMERIC,T);let D,F;return a.isKanjiModeEnabled()?(D=u(o.BYTE,e.BYTE,T),F=u(o.KANJI,e.KANJI,T)):(D=u(o.BYTE_KANJI,e.BYTE,T),F=[]),S.concat(C,D,F).sort(function(I,E){return I.index-E.index}).map(function(I){return{data:I.data,mode:I.mode,length:I.length}})}function m(T,S){switch(S){case e.NUMERIC:return t.getBitsLength(T);case e.ALPHANUMERIC:return i.getBitsLength(T);case e.KANJI:return r.getBitsLength(T);case e.BYTE:return s.getBitsLength(T)}}function y(T){return T.reduce(function(S,C){const D=S.length-1>=0?S[S.length-1]:null;return D&&D.mode===C.mode?(S[S.length-1].data+=C.data,S):(S.push(C),S)},[])}function v(T){const S=[];for(let C=0;C<T.length;C++){const D=T[C];switch(D.mode){case e.NUMERIC:S.push([D,{data:D.data,mode:e.ALPHANUMERIC,length:D.length},{data:D.data,mode:e.BYTE,length:D.length}]);break;case e.ALPHANUMERIC:S.push([D,{data:D.data,mode:e.BYTE,length:D.length}]);break;case e.KANJI:S.push([D,{data:D.data,mode:e.BYTE,length:c(D.data)}]);break;case e.BYTE:S.push([{data:D.data,mode:e.BYTE,length:c(D.data)}])}}return S}function _(T,S){const C={},D={start:{}};let F=["start"];for(let V=0;V<T.length;V++){const I=T[V],E=[];for(let A=0;A<I.length;A++){const N=I[A],M=""+V+A;E.push(M),C[M]={node:N,lastCount:0},D[M]={};for(let L=0;L<F.length;L++){const R=F[L];C[R]&&C[R].node.mode===N.mode?(D[R][M]=m(C[R].lastCount+N.length,N.mode)-m(C[R].lastCount,N.mode),C[R].lastCount+=N.length):(C[R]&&(C[R].lastCount=N.length),D[R][M]=m(N.length,N.mode)+4+e.getCharCountIndicator(N.mode,S))}}F=E}for(let V=0;V<F.length;V++)D[F[V]].end=0;return{map:D,table:C}}function x(T,S){let C;const D=e.getBestModeForData(T);if(C=e.from(S,D),C!==e.BYTE&&C.bit<D.bit)throw new Error('"'+T+'" cannot be encoded with mode '+e.toString(C)+`.
 Suggested mode is: `+e.toString(D));switch(C===e.KANJI&&!a.isKanjiModeEnabled()&&(C=e.BYTE),C){case e.NUMERIC:return new t(T);case e.ALPHANUMERIC:return new i(T);case e.KANJI:return new r(T);case e.BYTE:return new s(T)}}n.fromArray=function(S){return S.reduce(function(C,D){return typeof D=="string"?C.push(x(D,null)):D.data&&C.push(x(D.data,D.mode)),C},[])},n.fromString=function(S,C){const D=f(S,a.isKanjiModeEnabled()),F=v(D),V=_(F,C),I=l.find_path(V.map,"start","end"),E=[];for(let A=1;A<I.length-1;A++)E.push(V.table[I[A]].node);return n.fromArray(y(E))},n.rawSplit=function(S){return n.fromArray(f(S,a.isKanjiModeEnabled()))}})(zf)),zf}var Ox;function fW(){if(Ox)return Sf;Ox=1;const n=Gr(),e=Ry(),t=X$(),i=Q$(),s=Z$(),r=eW(),o=tW(),a=gS(),l=sW(),c=rW(),u=oW(),f=$r(),m=hW();function y(V,I){const E=V.size,A=r.getPositions(I);for(let N=0;N<A.length;N++){const M=A[N][0],L=A[N][1];for(let R=-1;R<=7;R++)if(!(M+R<=-1||E<=M+R))for(let G=-1;G<=7;G++)L+G<=-1||E<=L+G||(R>=0&&R<=6&&(G===0||G===6)||G>=0&&G<=6&&(R===0||R===6)||R>=2&&R<=4&&G>=2&&G<=4?V.set(M+R,L+G,!0,!0):V.set(M+R,L+G,!1,!0))}}function v(V){const I=V.size;for(let E=8;E<I-8;E++){const A=E%2===0;V.set(E,6,A,!0),V.set(6,E,A,!0)}}function _(V,I){const E=s.getPositions(I);for(let A=0;A<E.length;A++){const N=E[A][0],M=E[A][1];for(let L=-2;L<=2;L++)for(let R=-2;R<=2;R++)L===-2||L===2||R===-2||R===2||L===0&&R===0?V.set(N+L,M+R,!0,!0):V.set(N+L,M+R,!1,!0)}}function x(V,I){const E=V.size,A=c.getEncodedBits(I);let N,M,L;for(let R=0;R<18;R++)N=Math.floor(R/3),M=R%3+E-8-3,L=(A>>R&1)===1,V.set(N,M,L,!0),V.set(M,N,L,!0)}function T(V,I,E){const A=V.size,N=u.getEncodedBits(I,E);let M,L;for(M=0;M<15;M++)L=(N>>M&1)===1,M<6?V.set(M,8,L,!0):M<8?V.set(M+1,8,L,!0):V.set(A-15+M,8,L,!0),M<8?V.set(8,A-M-1,L,!0):M<9?V.set(8,15-M-1+1,L,!0):V.set(8,15-M-1,L,!0);V.set(A-8,8,1,!0)}function S(V,I){const E=V.size;let A=-1,N=E-1,M=7,L=0;for(let R=E-1;R>0;R-=2)for(R===6&&R--;;){for(let G=0;G<2;G++)if(!V.isReserved(N,R-G)){let oe=!1;L<I.length&&(oe=(I[L]>>>M&1)===1),V.set(N,R-G,oe),M--,M===-1&&(L++,M=7)}if(N+=A,N<0||E<=N){N-=A,A=-A;break}}}function C(V,I,E){const A=new t;E.forEach(function(G){A.put(G.mode.bit,4),A.put(G.getLength(),f.getCharCountIndicator(G.mode,V)),G.write(A)});const N=n.getSymbolTotalCodewords(V),M=a.getTotalCodewordsCount(V,I),L=(N-M)*8;for(A.getLengthInBits()+4<=L&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const R=(L-A.getLengthInBits())/8;for(let G=0;G<R;G++)A.put(G%2?17:236,8);return D(A,V,I)}function D(V,I,E){const A=n.getSymbolTotalCodewords(I),N=a.getTotalCodewordsCount(I,E),M=A-N,L=a.getBlocksCount(I,E),R=A%L,G=L-R,oe=Math.floor(A/L),Y=Math.floor(M/L),ie=Y+1,W=oe-Y,H=new l(W);let te=0;const re=new Array(L),be=new Array(L);let le=0;const ee=new Uint8Array(V.buffer);for(let pe=0;pe<L;pe++){const mt=pe<G?Y:ie;re[pe]=ee.slice(te,te+mt),be[pe]=H.encode(re[pe]),te+=mt,le=Math.max(le,mt)}const ye=new Uint8Array(A);let Ee=0,ge,Se;for(ge=0;ge<le;ge++)for(Se=0;Se<L;Se++)ge<re[Se].length&&(ye[Ee++]=re[Se][ge]);for(ge=0;ge<W;ge++)for(Se=0;Se<L;Se++)ye[Ee++]=be[Se][ge];return ye}function F(V,I,E,A){let N;if(Array.isArray(V))N=m.fromArray(V);else if(typeof V=="string"){let oe=I;if(!oe){const Y=m.rawSplit(V);oe=c.getBestVersionForData(Y,E)}N=m.fromString(V,oe||40)}else throw new Error("Invalid data");const M=c.getBestVersionForData(N,E);if(!M)throw new Error("The amount of data is too big to be stored in a QR Code");if(!I)I=M;else if(I<M)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+M+`.
`);const L=C(I,E,N),R=n.getSymbolSize(I),G=new i(R);return y(G,I),v(G),_(G,I),T(G,E,0),I>=7&&x(G,I),S(G,L),isNaN(A)&&(A=o.getBestMask(G,T.bind(null,G,E))),o.applyMask(A,G),T(G,E,A),{modules:G,version:I,errorCorrectionLevel:E,maskPattern:A,segments:N}}return Sf.create=function(I,E){if(typeof I>"u"||I==="")throw new Error("No input text");let A=e.M,N,M;return typeof E<"u"&&(A=e.from(E.errorCorrectionLevel,e.M),N=c.from(E.version),M=o.from(E.maskPattern),E.toSJISFunc&&n.setToSJISFunction(E.toSJISFunc)),F(I,N,A,M)},Sf}var Wf={},Kf={},Ux;function wS(){return Ux||(Ux=1,(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let i=t.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+t);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(r){return[r,r]}))),i.length===6&&i.push("F","F");const s=parseInt(i.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+i.slice(0,6).join("")}}n.getOptions=function(i){i||(i={}),i.color||(i.color={});const s=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,r=i.width&&i.width>=21?i.width:void 0,o=i.scale||4;return{width:r,scale:r?4:o,margin:s,color:{dark:e(i.color.dark||"#000000ff"),light:e(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},n.getScale=function(i,s){return s.width&&s.width>=i+s.margin*2?s.width/(i+s.margin*2):s.scale},n.getImageWidth=function(i,s){const r=n.getScale(i,s);return Math.floor((i+s.margin*2)*r)},n.qrToImageData=function(i,s,r){const o=s.modules.size,a=s.modules.data,l=n.getScale(o,r),c=Math.floor((o+r.margin*2)*l),u=r.margin*l,f=[r.color.light,r.color.dark];for(let m=0;m<c;m++)for(let y=0;y<c;y++){let v=(m*c+y)*4,_=r.color.light;if(m>=u&&y>=u&&m<c-u&&y<c-u){const x=Math.floor((m-u)/l),T=Math.floor((y-u)/l);_=f[a[x*o+T]?1:0]}i[v++]=_.r,i[v++]=_.g,i[v++]=_.b,i[v]=_.a}}})(Kf)),Kf}var Bx;function pW(){return Bx||(Bx=1,(function(n){const e=wS();function t(s,r,o){s.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=o,r.width=o,r.style.height=o+"px",r.style.width=o+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(r,o,a){let l=a,c=o;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),o||(c=i()),l=e.getOptions(l);const u=e.getImageWidth(r.modules.size,l),f=c.getContext("2d"),m=f.createImageData(u,u);return e.qrToImageData(m.data,r,l),t(f,c,u),f.putImageData(m,0,0),c},n.renderToDataURL=function(r,o,a){let l=a;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),l||(l={});const c=n.render(r,o,l),u=l.type||"image/png",f=l.rendererOpts||{};return c.toDataURL(u,f.quality)}})(Wf)),Wf}var Yf={},zx;function mW(){if(zx)return Yf;zx=1;const n=wS();function e(s,r){const o=s.a/255,a=r+'="'+s.hex+'"';return o<1?a+" "+r+'-opacity="'+o.toFixed(2).slice(1)+'"':a}function t(s,r,o){let a=s+r;return typeof o<"u"&&(a+=" "+o),a}function i(s,r,o){let a="",l=0,c=!1,u=0;for(let f=0;f<s.length;f++){const m=Math.floor(f%r),y=Math.floor(f/r);!m&&!c&&(c=!0),s[f]?(u++,f>0&&m>0&&s[f-1]||(a+=c?t("M",m+o,.5+y+o):t("m",l,0),l=0,c=!1),m+1<r&&s[f+1]||(a+=t("h",u),u=0)):l++}return a}return Yf.render=function(r,o,a){const l=n.getOptions(o),c=r.modules.size,u=r.modules.data,f=c+l.margin*2,m=l.color.light.a?"<path "+e(l.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",y="<path "+e(l.color.dark,"stroke")+' d="'+i(u,c,l.margin)+'"/>',v='viewBox="0 0 '+f+" "+f+'"',x='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+v+' shape-rendering="crispEdges">'+m+y+`</svg>
`;return typeof a=="function"&&a(null,x),x},Yf}var jx;function gW(){if(jx)return lo;jx=1;const n=J$(),e=fW(),t=pW(),i=mW();function s(r,o,a,l,c){const u=[].slice.call(arguments,1),f=u.length,m=typeof u[f-1]=="function";if(!m&&!n())throw new Error("Callback required as last argument");if(m){if(f<2)throw new Error("Too few arguments provided");f===2?(c=a,a=o,o=l=void 0):f===3&&(o.getContext&&typeof c>"u"?(c=l,l=void 0):(c=l,l=a,a=o,o=void 0))}else{if(f<1)throw new Error("Too few arguments provided");return f===1?(a=o,o=l=void 0):f===2&&!o.getContext&&(l=a,a=o,o=void 0),new Promise(function(y,v){try{const _=e.create(a,l);y(r(_,o,l))}catch(_){v(_)}})}try{const y=e.create(a,l);c(null,r(y,o,l))}catch(y){c(y)}}return lo.create=e.create,lo.toCanvas=s.bind(null,t.render),lo.toDataURL=s.bind(null,t.renderToDataURL),lo.toString=s.bind(null,function(r,o,a){return i.render(r,a)}),lo}var Ny=gW();const yW=cc(Ny),MX=yT({__proto__:null,default:yW},[Ny]),vW=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(""),[s,r]=P.useState(""),[o,a]=P.useState(!1),l=Ti();P.useEffect(()=>{if(n){const u=window.location.href;r(u),Ny.toDataURL(u,{width:256,margin:2,errorCorrectionLevel:"H"}).then(f=>{i(f)}).catch(f=>{console.error("Failed to generate QR code",f)})}},[n,l]);const c=()=>{navigator.clipboard.writeText(s).then(()=>{a(!0),setTimeout(()=>a(!1),2e3)})};return P.useEffect(()=>{if(n){const u=f=>{f.key==="Escape"&&e()};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)}},[n,e]),n?p.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"qr-code-modal-title",children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-md rounded-xl shadow-2xl transform transition-all animate-fade-in-down",style:{animationDuration:"300ms"},onClick:u=>u.stopPropagation(),children:[p.jsx("header",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-t-xl border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{id:"qr-code-modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Share Page"}),p.jsx("button",{onClick:e,className:"p-1 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 transition-colors","aria-label":"Close modal",children:p.jsx(Ki,{className:"h-6 w-6"})})]})}),p.jsxs("main",{className:"p-6 text-center",children:[p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Scan the QR code to open this page on your mobile device."}),p.jsx("div",{className:"p-4 bg-white inline-block rounded-lg border dark:border-gray-700",children:t?p.jsx("img",{src:t,alt:"QR Code for current page",width:"256",height:"256"}):p.jsx("div",{className:"w-64 h-64 bg-gray-200 dark:bg-gray-800 animate-pulse rounded-md flex items-center justify-center",children:p.jsx("p",{className:"text-gray-500",children:"Generating..."})})}),p.jsxs("div",{className:"mt-4",children:[p.jsx("label",{htmlFor:"page-url",className:"sr-only",children:"Page URL"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{id:"page-url",type:"text",readOnly:!0,value:s,className:"w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md p-2 pr-10 text-sm text-gray-700 dark:text-gray-300"}),p.jsx("button",{onClick:c,className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-brand-red",title:"Copy URL",children:o?p.jsx(va,{className:"h-5 w-5 text-green-500"}):p.jsx(G8,{className:"h-5 w-5"})})]})]})]})]})}):null},qx=()=>{const{showInstallInstructions:n,closeInstallInstructions:e}=ya();return n?p.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4",onClick:e,children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-md rounded-lg shadow-xl",onClick:t=>t.stopPropagation(),children:[p.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[p.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[p.jsx(Mc,{className:"h-6 w-6"}),"How to Install App"]}),p.jsx("button",{onClick:e,"aria-label":"Close modal",className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white transition-colors",children:p.jsx(Ki,{className:"h-6 w-6"})})]}),p.jsxs("main",{className:"p-6 space-y-4",children:[p.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"This app can be installed directly from your browser for a faster, offline experience."}),p.jsxs("div",{className:"prose dark:prose-invert max-w-none text-sm text-gray-600 dark:text-gray-400",children:[p.jsx("p",{children:p.jsx("strong",{children:"Installation steps:"})}),p.jsxs("ol",{children:[p.jsx("li",{children:"Open your browser's menu (usually three dots or lines in the corner)."}),p.jsx("li",{children:'Look for an option like "Install App", "Add to Home Screen", or "Install PDFBullet".'}),p.jsx("li",{children:"Follow the on-screen prompts to complete the installation."})]}),p.jsx("p",{className:"mt-4 text-xs",children:"Note: This feature is supported on most modern browsers like Chrome, Edge, and Safari on mobile devices."})]})]})]})}):null},Hx=window.location.hostname,wW="PDFBullet",oc="pdfbullet_passkeys";function Gx(n){const e="===".slice(0,(4-n.length%4)%4),t=(n+e).replace(/-/g,"+").replace(/_/g,"/"),i=atob(t),s=new Uint8Array(i.length);for(let r=0;r<i.length;r++)s[r]=i.charCodeAt(r);return s.buffer}function _W(n){const e=new Uint8Array(n);let t="";for(let i=0;i<e.byteLength;i++)t+=String.fromCharCode(e[i]);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const Jf=n=>{try{return JSON.parse(localStorage.getItem(oc)||"{}")[n]||[]}catch{return[]}},bW=(n,e)=>{try{const t=JSON.parse(localStorage.getItem(oc)||"{}"),i=t[n]||[];t[n]=[...i,e],localStorage.setItem(oc,JSON.stringify(t))}catch(t){console.error("Failed to save passkey to localStorage",t)}},xW=(n,e)=>{try{const t=JSON.parse(localStorage.getItem(oc)||"{}");t[n]&&(t[n]=t[n].filter(i=>i.id!==e),localStorage.setItem(oc,JSON.stringify(t)))}catch(t){console.error("Failed to remove passkey from localStorage",t)}},TW=()=>{const{user:n}=Nn(),e=typeof window<"u"&&!!(window.PublicKeyCredential&&navigator.credentials);return{register:async o=>{if(!e)throw new Error("WebAuthn is not supported on this device.");const a=new Uint8Array(32);window.crypto.getRandomValues(a);const l=new Uint8Array(16);window.crypto.getRandomValues(l);const c=Jf(o),u={challenge:a,rp:{name:wW,id:Hx},user:{id:l,name:o,displayName:o},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257}],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required",residentKey:"required"},timeout:6e4,attestation:"none",excludeCredentials:c.map(y=>({type:"public-key",id:Gx(y.id)}))},f=await navigator.credentials.create({publicKey:u});if(!f)throw new Error("Credential creation was cancelled or failed.");const m={id:_W(f.rawId),name:`Passkey (${new Date().toLocaleDateString()})`,createdAt:new Date().toISOString()};return bW(o,m),{success:!0}},login:async o=>{if(!e)throw new Error("WebAuthn is not supported on this device.");const a=new Uint8Array(32);window.crypto.getRandomValues(a);const l=Jf(o);if(l.length===0)throw new Error("No passkey found for this email. Please register a passkey first or try another login method.");const c={challenge:a,rpId:Hx,allowCredentials:l.map(m=>({type:"public-key",id:Gx(m.id)})),userVerification:"required",timeout:6e4};if(!await navigator.credentials.get({publicKey:c}))throw new Error("Login was cancelled or failed.");return{token:`mock-jwt-for-${o}-${Date.now()}`}},isWebAuthnSupported:e,getCredentials:async()=>!n||!n.email?[]:Jf(n.email),removeCredential:async o=>{if(!n||!n.email)throw new Error("User not found");xW(n.email,o)}}},EW=n=>{const e=/iPhone|iPad|iPod/i.test(navigator.userAgent),t=/Android/i.test(navigator.userAgent);return n?e?"Sign in with Face ID / Touch ID":t?"Sign in with Fingerprint":"Sign in with Passkey":e?"Sign up with Face ID / Touch ID":t?"Sign up with Fingerprint":"Sign up with Passkey"},AW=({onOpenForgotPasswordModal:n})=>{const[e,t]=P.useState(!0),[i,s]=P.useState(""),[r,o]=P.useState(""),[a,l]=P.useState(""),[c,u]=P.useState(""),[f,m]=P.useState(!1),{loginOrSignupWithGoogle:y,signInWithEmail:v,loginOrSignupWithGithub:_,signInWithCustomToken:x}=Nn(),{register:T,login:S,isWebAuthnSupported:C}=TW(),D=async E=>{l(""),m(!0);try{E==="google"&&await y(),E==="github"&&await _()}catch(A){A.code!=="auth/popup-closed-by-user"&&l(A.message||`Failed to sign in with ${E}.`)}finally{m(!1)}},F=async E=>{if(E.preventDefault(),l(""),u(""),!e){l("Please sign up using Google, GitHub, or a Passkey.");return}m(!0);try{await v(i,r)}catch(A){let N="An error occurred. Please try again.";A.code==="auth/user-not-found"||A.code==="auth/wrong-password"||A.code==="auth/invalid-credential"||A.code==="auth/invalid-email"?N="Invalid username/email or password.":N=A.message,l(N)}finally{m(!1)}},V=async()=>{if(!i){l("Please enter your email to use a passkey.");return}l(""),u(""),m(!0);try{if(e){const E=await S(i);if(E.token)await x(E.token);else throw new Error("Passkey login succeeded but no auth token was returned.")}else await T(i),u("Passkey registered! You can now log in.")}catch(E){l(E.message||"Passkey operation failed.")}finally{m(!1)}},I=EW(e);return p.jsx("div",{className:"fixed inset-0 bg-gray-100 dark:bg-gray-900 z-[200] flex flex-col items-center justify-center p-6 text-gray-900 dark:text-white",children:p.jsxs("div",{className:"w-full max-w-sm",children:[p.jsx(sc,{className:"h-10 w-auto mx-auto mb-6"}),p.jsx("h1",{className:"text-2xl font-bold text-center mb-2",children:"Welcome to PDFBullet"}),p.jsx("p",{className:"text-center text-gray-600 dark:text-gray-400 mb-6",children:e?"Log in to continue":"Create an account to get started"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("button",{onClick:()=>D("google"),className:"w-full flex justify-center items-center gap-2 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-black py-2.5 px-4 font-semibold hover:bg-gray-50 dark:hover:bg-gray-800",children:[p.jsx(tO,{className:"h-5 w-5"})," Continue with Google"]}),p.jsxs("button",{onClick:()=>D("github"),className:"w-full flex justify-center items-center gap-2 rounded-md bg-gray-800 dark:bg-gray-700 py-2.5 px-4 font-semibold text-white hover:bg-gray-900 dark:hover:bg-gray-600",children:[p.jsx(H8,{className:"h-5 w-5"})," Continue with GitHub"]})]}),p.jsxs("div",{className:"relative my-6",children:[p.jsx("div",{className:"absolute inset-0 flex items-center",children:p.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-700"})}),p.jsx("div",{className:"relative flex justify-center text-sm",children:p.jsx("span",{className:"bg-gray-100 dark:bg-gray-900 px-2 text-gray-500 dark:text-gray-400",children:"OR"})})]}),a&&p.jsx("p",{className:"text-center text-sm text-red-500 mb-4",children:a}),c&&p.jsx("p",{className:"text-center text-sm text-green-600 mb-4",children:c}),e?p.jsxs("form",{onSubmit:F,className:"space-y-4",children:[p.jsxs("div",{className:"relative",children:[p.jsx($n,{className:"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),p.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),required:!0,placeholder:"Username or Email",className:"w-full pl-10 pr-3 py-2.5 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-black"})]}),p.jsxs("div",{className:"relative",children:[p.jsx(Ty,{className:"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),p.jsx("input",{type:"password",value:r,onChange:E=>o(E.target.value),required:!0,placeholder:"Password",className:"w-full pl-10 pr-3 py-2.5 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-black"})]}),p.jsx("div",{className:"text-right text-sm",children:p.jsx("button",{type:"button",onClick:n,className:"font-medium text-brand-red hover:text-brand-red-dark",children:"Forgot password?"})}),p.jsx("button",{type:"submit",disabled:f,className:"w-full bg-brand-red text-white font-bold py-2.5 rounded-md hover:bg-brand-red-dark disabled:opacity-50",children:f?"Loading...":"Log In"})]}):p.jsxs("div",{className:"space-y-4",children:[p.jsx("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:"Enter your email to register with a Passkey."}),p.jsxs("div",{className:"relative",children:[p.jsx(gh,{className:"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),p.jsx("input",{type:"email",value:i,onChange:E=>s(E.target.value),required:!0,placeholder:"Email for Passkey",className:"w-full pl-10 pr-3 py-2.5 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-black"})]})]}),C&&p.jsx("div",{className:"mt-4",children:p.jsxs("button",{onClick:V,disabled:f,className:"w-full flex justify-center items-center gap-2 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-black py-2.5 px-4 font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 disabled:opacity-50",children:[p.jsx(hO,{className:"h-5 w-5"})," ",I]})}),p.jsxs("p",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:[e?"Don't have an account?":"Already have an account?"," ",p.jsx("button",{onClick:()=>{t(!e),l(""),u("")},className:"font-medium text-brand-red hover:text-brand-red-dark",children:e?"Sign up":"Log in"})]})]})})},IW=({children:n,onOpenForgotPasswordModal:e})=>{const{user:t,loading:i}=Nn(),[s,r]=P.useState(!1);return P.useEffect(()=>{if(!i){const a=(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)&&!t;r(a)}},[t,i]),i?p.jsx(nc,{}):s?p.jsx(AW,{onOpenForgotPasswordModal:e}):p.jsx(p.Fragment,{children:n})},$x=()=>{const[n,e]=P.useState(!1),{promptInstall:t}=ya();P.useEffect(()=>{const o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,a=sessionStorage.getItem("welcome_install_modal_shown");if(!o&&!a){const l=setTimeout(()=>{e(!0)},3e3);return()=>clearTimeout(l)}},[]);const i=()=>{e(!1),sessionStorage.setItem("welcome_install_modal_shown","true")},s=()=>{t(),i()};if(!n)return null;const r=["Unlimited document tasks","Process multiple files at once","Ad-free experience","Access to all Premium tools"];return p.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",onClick:i,children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden relative animate-popup",onClick:o=>o.stopPropagation(),children:[p.jsxs("div",{className:"relative p-6 text-center bg-gradient-to-br from-brand-red to-orange-500 text-white",children:[p.jsx(sc,{className:"h-7 w-auto mx-auto mb-2",variant:"dark"}),p.jsx("h2",{className:"text-xl font-extrabold",children:"Get the Full PDFBullet Experience"}),p.jsx("p",{className:"mt-1 text-xs opacity-90",children:"Install the app for faster, offline access and unlock exclusive trial features."})]}),p.jsxs("div",{className:"p-6 space-y-4",children:[p.jsxs("div",{className:"text-left",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(gd,{className:"h-5 w-5 text-yellow-400"}),p.jsx("h3",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:"7-Day Premium Trial on Install"})]}),p.jsx("ul",{className:"mt-2 space-y-1 text-xs text-gray-600 dark:text-gray-300 pl-4",children:r.map(o=>p.jsxs("li",{className:"flex items-center gap-2",children:[p.jsx(va,{className:"h-4 w-4 text-green-500"}),p.jsx("span",{children:o})]},o))})]}),p.jsx(Be,{to:"/remove-background",onClick:i,className:"block p-2 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-left group hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors",children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"p-1.5 bg-purple-200 dark:bg-purple-800 rounded-full",children:p.jsx(wC,{className:"h-4 w-4 text-purple-600 dark:text-purple-300"})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-sm text-purple-800 dark:text-purple-200",children:"Try our new AI Tool"}),p.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:"Remove image backgrounds instantly."})]}),p.jsx(aO,{className:"h-5 w-5 ml-auto text-purple-500 group-hover:translate-x-1 transition-transform"})]})}),p.jsxs("div",{className:"space-y-2 pt-2",children:[p.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 bg-brand-red hover:bg-brand-red-dark text-white font-bold py-3 px-3 rounded-lg text-sm transition-colors",children:[p.jsx(Mc,{className:"h-5 w-5"}),"Install App & Get Free Trial"]}),p.jsx("button",{onClick:i,className:"w-full text-center text-xs font-semibold text-gray-500 dark:text-gray-400 hover:text-brand-red dark:hover:text-brand-red transition-colors py-2",children:"Continue without Installing"})]})]}),p.jsx("button",{onClick:i,className:"absolute top-2 right-2 text-white/70 hover:text-white bg-black/20 rounded-full p-1 transition-colors","aria-label":"Close",children:p.jsx(Ki,{className:"h-4 w-4"})})]})})},vu=({to:n,icon:e,label:t})=>{const i=Ti(),s=i.pathname===n||n==="/articles"&&i.pathname.startsWith("/blog");return p.jsxs(Be,{to:n,className:`flex flex-col items-center justify-center w-full h-full pt-2 pb-1 transition-colors duration-200 ${s?"text-brand-red":"text-gray-500 dark:text-gray-400 hover:text-brand-red"}`,children:[p.jsx(e,{className:"h-6 w-6 mb-1"}),p.jsx("span",{className:"text-xs font-medium",children:t})]})},CW=()=>p.jsxs("div",{className:"fixed bottom-0 left-0 right-0 h-[72px] z-50 pointer-events-none",children:[p.jsxs("nav",{className:"absolute bottom-0 left-0 right-0 h-[72px] bg-white dark:bg-black border-t border-gray-200 dark:border-gray-800 flex items-center justify-around pointer-events-auto",children:[p.jsx("div",{className:"w-1/5 flex justify-center",children:p.jsx(vu,{to:"/",icon:fC,label:"Home"})}),p.jsx("div",{className:"w-1/5 flex justify-center",children:p.jsx(vu,{to:"/tools",icon:Qp,label:"Tools"})}),p.jsx("div",{className:"w-1/5"}),p.jsx("div",{className:"w-1/5 flex justify-center",children:p.jsx(vu,{to:"/storage",icon:dO,label:"Storage"})}),p.jsx("div",{className:"w-1/5 flex justify-center",children:p.jsx(vu,{to:"/settings",icon:vh,label:"More"})})]}),p.jsxs("div",{className:"absolute left-1/2 top-0 -translate-x-1/2 -translate-y-1/3 text-center pointer-events-auto",children:[p.jsx(Be,{to:"/remove-background",className:"inline-block w-16 h-16 rounded-full shadow-lg transform hover:scale-110 transition-all duration-200 bg-brand-red","aria-label":"Remove Background",children:p.jsx("img",{src:"https://ik.imagekit.io/fonepay/bg%20remove%20icon.png?updatedAt=1760067581051",alt:"BG Remover",className:"w-full h-full object-cover rounded-full"})}),p.jsx("span",{className:"block text-xs font-semibold text-gray-700 dark:text-gray-200 mt-1 pointer-events-none",children:"BG Remover"})]})]}),SW=({name:n,path:e,icon:t,disabled:i})=>{const s=Ti(),o=`flex items-center gap-3 p-2 rounded-md text-sm font-medium transition-colors ${e!=="/"&&s.pathname.startsWith(e)?"bg-red-100 text-brand-red dark:bg-red-900/30":i?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,a=p.jsxs(p.Fragment,{children:[p.jsx(t,{className:"h-5 w-5"}),p.jsx("span",{children:n})]});return i?p.jsx("div",{className:o,children:a}):p.jsx(Be,{to:e,className:o,children:a})},Wx=()=>{const{user:n}=Nn(),e=[{group:"Profile",items:[{name:"My account",path:"/account-settings",icon:$n},{name:"Security",path:"/security",icon:CC},{name:"Team",path:"/team",icon:A_}]},{group:"Settings",items:[{name:"Workflows",path:"/workflows",icon:Q8},{name:"Last tasks",path:"/last-tasks",icon:xy}]},{group:"Signatures",items:[{name:"Overview",path:"/signatures-overview",icon:pC},{name:"Sent",path:"/sent",icon:mC},{name:"Inbox",path:"/inbox",icon:gh},{name:"Signed",path:"/signed",icon:va},{name:"Templates",path:"/templates",icon:N8},{name:"Contacts",path:"/contacts",icon:A_},{name:"Settings",path:"/signature-settings",icon:vh}]},{group:"Billing",items:[{name:"Plans & Packages",path:"/plans-packages",icon:eO},{name:"Business details",path:"/business-details",icon:TC},{name:"Invoices",path:"/invoices",icon:_C}]}];return p.jsx("div",{className:"bg-gray-50 dark:bg-soft-dark",children:p.jsx("div",{className:"container mx-auto px-6 py-8",children:p.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[p.jsx("aside",{className:"md:w-64 lg:w-72 flex-shrink-0",children:p.jsx("div",{className:"bg-white dark:bg-surface-dark rounded-lg shadow-sm border border-gray-200 dark:border-gray-800 h-full",children:p.jsxs("div",{className:"p-4",children:[p.jsxs("div",{className:"flex items-center gap-3 pb-4 mb-4 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("div",{className:"h-12 w-12 rounded-full overflow-hidden bg-gray-200 border-2 border-brand-red/50",children:n?.profileImage?p.jsx("img",{src:n.profileImage,alt:"Profile",className:"h-full w-full object-cover"}):p.jsx($n,{className:"h-full w-full text-gray-500 p-2"})}),p.jsxs("div",{children:[p.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100 truncate",children:n?.username}),p.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"Registered"})]})]}),p.jsx("nav",{className:"space-y-4",children:e.map(t=>p.jsxs("div",{children:[p.jsx("h3",{className:"px-2 text-xs font-bold uppercase text-gray-400 tracking-wider mb-2",children:t.group}),p.jsx("div",{className:"space-y-1",children:t.items.map(i=>p.jsx(SW,{...i},i.name))})]},t.group))})]})})}),p.jsx("main",{className:"flex-grow w-full md:w-auto overflow-hidden",children:p.jsx(Cm,{})})]})})})},Kx=({title:n,children:e})=>p.jsxs("div",{className:"w-full",children:[p.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-800 dark:text-gray-100 mb-4",children:n}),p.jsx("div",{className:"bg-white dark:bg-surface-dark p-8 md:p-12 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800 text-center",children:e||p.jsxs(p.Fragment,{children:[p.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400",children:"This feature is coming soon!"}),p.jsx("p",{className:"mt-2 text-gray-500",children:"We're working hard to bring you this functionality. Stay tuned for updates."})]})})]}),Yx=()=>(P.useEffect(()=>{document.title="404 Page Not Found | PDFBullet"},[]),p.jsx("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] text-center px-6 py-12 bg-white dark:bg-black overflow-hidden",children:p.jsxs("div",{className:"relative w-full max-w-lg",children:[p.jsx("div",{className:"absolute -top-16 -left-16 w-48 h-48 bg-red-200 dark:bg-red-900/30 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),p.jsx("div",{className:"absolute -bottom-16 -right-16 w-48 h-48 bg-yellow-200 dark:bg-yellow-900/30 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),p.jsx("div",{className:"absolute -bottom-8 left-24 w-40 h-40 bg-blue-200 dark:bg-blue-900/30 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"}),p.jsxs("div",{className:"relative z-10",children:[p.jsx("h1",{className:"text-9xl font-extrabold text-brand-red tracking-wider",children:"404"}),p.jsx("h2",{className:"mt-4 text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Page Not Found"}),p.jsx("p",{className:"mt-4 text-lg text-gray-600 dark:text-gray-400",children:"Oops! The page you're looking for doesn't exist. It might have been moved or deleted."}),p.jsx("div",{className:"mt-10 flex flex-col sm:flex-row items-center justify-center gap-4",children:p.jsxs(Be,{to:"/",className:"inline-flex items-center justify-center gap-2 px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-brand-red hover:bg-brand-red-dark transition-colors shadow-lg",children:[p.jsx(fC,{className:"h-5 w-5"}),"Go back home"]})})]})]})})),PW=({notifications:n,markAllAsRead:e,clearAll:t})=>{P.useEffect(()=>{document.title="Notifications | PDFBullet",e()},[e]);const i=s=>{const r=Math.floor((new Date().getTime()-s)/1e3);let o=r/31536e3;return o>1?`${Math.floor(o)} years ago`:(o=r/2592e3,o>1?`${Math.floor(o)} months ago`:(o=r/86400,o>1?`${Math.floor(o)} days ago`:(o=r/3600,o>1?`${Math.floor(o)} hours ago`:(o=r/60,o>1?`${Math.floor(o)} minutes ago`:`${Math.floor(r)} seconds ago`))))};return p.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-4",children:[p.jsxs("div",{className:"flex justify-between items-center mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Notifications"}),n.length>0&&p.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-sm font-semibold text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:[p.jsx(AC,{className:"h-4 w-4"})," Clear All"]})]}),n.length>0?p.jsx("ul",{className:"space-y-4",children:n.map(s=>p.jsx("li",{className:"p-4 rounded-lg shadow-sm border bg-white dark:bg-black border-gray-200 dark:border-gray-800",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"flex-shrink-0 mt-1",children:p.jsx(ic,{className:"h-5 w-5 text-gray-400"})}),p.jsxs("div",{className:"flex-grow",children:[p.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:s.title}),p.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:s.message}),p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:i(s.timestamp)})]}),p.jsxs("div",{className:"flex-shrink-0 flex flex-col items-end gap-2",children:[s.url&&p.jsxs(Be,{to:s.url,className:"flex items-center gap-2 px-3 py-1 bg-blue-500 text-white text-xs font-semibold rounded-md text-center hover:bg-blue-600 transition-colors",children:[p.jsx(oO,{className:"h-3 w-3"})," View"]}),s.attachmentUrl&&p.jsxs("a",{href:s.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1 bg-gray-600 text-white text-xs font-semibold rounded-md text-center hover:bg-gray-700 transition-colors",children:[p.jsx(Mc,{className:"h-3 w-3"})," Download"]})]})]})},s.id))}):p.jsxs("div",{className:"text-center py-16 text-gray-500",children:[p.jsx(ic,{className:"h-12 w-12 mx-auto mb-4"}),p.jsx("p",{children:"You have no notifications yet."})]})]})},Jx=({notification:n,onClose:e})=>{const t=ia();if(P.useEffect(()=>{if(n){const s=setTimeout(e,7e3);return()=>clearTimeout(s)}},[n,e]),!n)return null;const i=()=>{n.url?t(n.url):t("/notifications"),e()};return p.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[110] w-full max-w-md p-4 animate-fade-in-down cursor-pointer",onClick:i,children:p.jsxs("div",{className:"bg-white/90 dark:bg-black/90 backdrop-blur-sm p-4 rounded-lg shadow-2xl border border-gray-200 dark:border-gray-700 flex items-start gap-4",children:[p.jsx("div",{className:"flex-shrink-0 bg-brand-red/10 p-2 rounded-full mt-1",children:p.jsx(ic,{className:"h-5 w-5 text-brand-red"})}),p.jsxs("div",{className:"flex-grow",children:[p.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:n.title}),p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:n.message})]}),p.jsx("button",{onClick:s=>{s.stopPropagation(),e()},className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 flex-shrink-0",children:p.jsx(Ki,{className:"h-5 w-5"})})]})})},kW=P.createContext({setShowFooter:()=>{}}),RW=()=>p.jsx("div",{className:"main-background-svg-container",children:p.jsxs("svg",{className:"main-background-svg",width:"1389",height:"1479",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[p.jsxs("g",{children:[p.jsx("mask",{id:"a",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"1389",height:"1479",children:p.jsx("path",{fill:"#D9D9D9",d:"M0 0h1389v1479H0z"})}),p.jsxs("g",{mask:"url(#a)",children:[p.jsx("ellipse",{opacity:".5",cy:"1007.5",rx:"160",ry:"160.5",fill:"url(#b)"}),p.jsx("circle",{opacity:".5",cx:"857.242",cy:"375.085",r:"91.111",fill:"url(#c)"}),p.jsx("rect",{opacity:".5",x:"-.664",y:"273.555",width:"386.866",height:"386.866",rx:"24",transform:"rotate(-45 -.664 273.555)",fill:"url(#d)"}),p.jsx("rect",{opacity:".5",x:"288.662",y:"1179.43",width:"718.993",height:"424.487",rx:"32",transform:"rotate(-45 288.662 1179.43)",fill:"url(#e)"}),p.jsx("circle",{opacity:".5",cx:"1389.13",cy:"530.129",r:"220.13",fill:"url(#f)"}),p.jsx("circle",{opacity:".5",cx:"1205.72",cy:"1387.95",r:"91.111",fill:"url(#g)"})]})]}),p.jsxs("defs",{children:[p.jsxs("linearGradient",{id:"b",x1:"-61.873",y1:"861.062",x2:".372",y2:"1167.92",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{stopColor:"#E5322d"}),p.jsx("stop",{offset:".993",stopColor:"#F5F5FA"})]}),p.jsxs("linearGradient",{id:"c",x1:"766.131",y1:"250.722",x2:"857.242",y2:"466.196",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{stopColor:"#E5322d"}),p.jsx("stop",{offset:"1",stopColor:"#F5F5FA"})]}),p.jsxs("linearGradient",{id:"d",x1:"117.967",y1:"290.503",x2:"192.769",y2:"660.421",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{stopColor:"#E5322d"}),p.jsx("stop",{offset:".993",stopColor:"#F5F5FA"})]}),p.jsxs("linearGradient",{id:"e",x1:"616.714",y1:"1247.46",x2:"920.97",y2:"1639.19",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{offset:".091",stopColor:"#F5F5FA"}),p.jsx("stop",{offset:".948",stopColor:"#E5322d"})]}),p.jsxs("linearGradient",{id:"f",x1:"1456.96",y1:"604.614",x2:"1389.13",y2:"750.259",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{stopColor:"#E5322d"}),p.jsx("stop",{offset:".993",stopColor:"#F5F5FA"})]}),p.jsxs("linearGradient",{id:"g",x1:"1242.3",y1:"1427.85",x2:"1140.55",y2:"1333.41",gradientUnits:"userSpaceOnUse",children:[p.jsx("stop",{stopColor:"#E5322d"}),p.jsx("stop",{offset:"1",stopColor:"#F5F5FA"})]})]})]})}),Xx=()=>(Ad.useEffect(()=>{document.title="User Data Deletion | PDFBullet"},[]),p.jsx("div",{className:"py-16 md:py-24",children:p.jsx("div",{className:"px-6",children:p.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-black p-8 md:p-12 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[p.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-800 dark:text-gray-100 mb-8",children:"User Data Deletion Request"}),p.jsxs("div",{className:"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300",children:[p.jsx("p",{children:"We are committed to protecting your privacy and giving you control over your personal data. If you wish to delete your account and all associated data from our systems, please follow the instructions below."}),p.jsx("h3",{children:"How to Delete Your Data"}),p.jsx("p",{children:"You can permanently delete your account and all associated data directly from your account settings. This is the fastest and most secure way to delete your data."}),p.jsxs("ol",{children:[p.jsx("li",{children:"Log in to your PDFBullet account."}),p.jsxs("li",{children:["Navigate to the ",p.jsx(Be,{to:"/account-settings",className:"text-brand-red hover:underline",children:"Account Settings"})," page."]}),p.jsx("li",{children:'Scroll down to the "Danger Zone" section.'}),p.jsx("li",{children:'Click on "Delete My Account" and follow the on-screen instructions to confirm the deletion.'})]}),p.jsx("h3",{className:"mt-6",children:"Alternative Method"}),p.jsx("p",{children:'If you are unable to access your account, you can request data deletion by sending an email to our support team with the subject line "Data Deletion Request".'}),p.jsxs("p",{children:[p.jsx("strong",{children:"Email:"})," ",p.jsx("a",{href:"mailto:Support@pdfbullet.com",className:"text-brand-red hover:underline",children:"Support@pdfbullet.com"})]}),p.jsx("p",{children:"Please include the username and email address associated with your account in your message."})]})]})})})),Qx=({isOpen:n,onClose:e})=>{const[t,i]=P.useState(""),[s,r]=P.useState(""),[o,a]=P.useState(""),[l,c]=P.useState(!1),{auth:u}=Nn(),f=P.useRef(null);P.useEffect(()=>{n&&(i(""),r(""),a(""),c(!1),setTimeout(()=>f.current?.focus(),100))},[n]);const m=async y=>{y.preventDefault(),r(""),a(""),c(!0);try{await u.sendPasswordResetEmail(t),a(`Password reset link sent to ${t}. Please check your inbox (and spam folder).`)}catch(v){v.code==="auth/user-not-found"?r("No account found with this email address."):r(v.message||"Failed to send reset email. Please try again.")}finally{c(!1)}};return n?p.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4 animate-fade-in-down",style:{animationDuration:"300ms"},onClick:e,children:p.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-lg rounded-xl shadow-2xl",onClick:y=>y.stopPropagation(),children:[p.jsx("header",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-t-xl border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"Reset Password"}),p.jsx("button",{onClick:e,"aria-label":"Close modal",className:"p-1 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition-colors",children:p.jsx(Ki,{className:"h-6 w-6"})})]})}),o?p.jsxs("div",{className:"p-8 text-center",children:[p.jsx(va,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),p.jsx("p",{className:"text-green-700 dark:text-green-300",children:o}),p.jsx("button",{onClick:e,className:"mt-6 w-full bg-brand-red text-white font-bold py-2 px-4 rounded-md",children:"Close"})]}):p.jsxs("form",{onSubmit:m,children:[p.jsxs("main",{className:"p-6 space-y-4",children:[p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter your account's email address and we will send you a password reset link."}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"reset-email",className:"sr-only",children:"Email address"}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:p.jsx(gh,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{ref:f,type:"email",id:"reset-email",value:t,onChange:y=>i(y.target.value),required:!0,placeholder:"you@example.com",className:"w-full pl-10 pr-3 py-2 border rounded-md bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 focus:ring-brand-red focus:border-brand-red"})]})]}),s&&p.jsx("p",{className:"text-sm text-red-500",children:s})]}),p.jsxs("footer",{className:"flex justify-end gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-b-xl",children:[p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-semibold border rounded-md bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600",children:"Cancel"}),p.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-semibold text-white bg-brand-red rounded-md disabled:bg-red-300 hover:bg-brand-red-dark",children:l?"Sending...":"Send Reset Link"})]})]})]})}):null},NW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18z"})}),MW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})}),DW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M6 12a2 2 0 11-4 0 2 2 0 014 0zm8 0a2 2 0 11-4 0 2 2 0 014 0zm8 0a2 2 0 11-4 0 2 2 0 014 0z"})}),LW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"})}),FW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v-2h-2z"})}),VW=({className:n})=>p.jsx("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"})}),Xf="pdfbullet_chat_history_v2",Qf={role:"model",text:"Hello! I am Bishal, your support assistant for PDFBullet. How can I help you today?"},OW=[{q:"How do I merge PDF files?",icon:"📄"},{q:"Is this service secure?",icon:"🔒"},{q:"Can I edit a PDF?",icon:"✏️"},{q:"What about pricing?",icon:"💰"}],UW=({text:n,sources:e})=>{const t=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/(\s|^)(\/[a-z0-9-]+)/g,(i,s,r)=>`${s}<a href="${r}" class="text-brand-red hover:underline">${r}</a>`);return p.jsxs("div",{children:[p.jsx("div",{style:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:t}}),e&&e.length>0&&p.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300 dark:border-gray-600",children:[p.jsxs("h4",{className:"text-xs font-bold text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[p.jsx(Ay,{className:"h-4 w-4"})," Sources:"]}),p.jsx("ul",{className:"list-none pl-0 text-xs mt-1 space-y-1",children:e.map((i,s)=>p.jsx("li",{children:p.jsx("a",{href:i.uri,target:"_blank",rel:"noopener noreferrer",className:"block p-1.5 bg-blue-50 dark:bg-blue-900/30 rounded-md text-blue-600 dark:text-blue-400 hover:underline truncate",title:i.uri,children:i.title||i.uri})},s))})]})]})},Zx=({isOpen:n,onClose:e,onOpen:t,showFab:i,isPwa:s})=>{const[r,o]=P.useState([Qf]),[a,l]=P.useState([]),[c,u]=P.useState(""),[f,m]=P.useState(!1),[y,v]=P.useState(""),[_,x]=P.useState(null),[T,S]=P.useState(!1),[C,D]=P.useState(!1),[F,V]=P.useState(null),[I,E]=P.useState(!1),[A,N]=P.useState(!1),{user:M}=Nn(),{t:L}=Nc(),R=P.useRef(null),G=P.useRef(null);P.useEffect(()=>{try{const ee=localStorage.getItem(Xf);if(ee){const ye=JSON.parse(ee);l(ye),ye.length>0&&o(ye[ye.length-1].messages)}}catch(ee){console.error("Failed to load chat history",ee)}},[]);const oe=()=>{try{const ee="AIzaSyCuhbxmzoOTGS6UtX7OZjLwBiMfQNrOzJA",Ee=new $b({apiKey:ee}).chats.create({model:"gemini-2.5-flash",config:{systemInstruction:`You are an expert, friendly, and helpful customer support assistant for a website called 'PDFBullet'. Your name is Bishal, and you represent the company. Your goal is to provide accurate information, guide users on how to use the site, and answer frequently asked questions based *only* on the extensive information provided below.

**Core Mission & Values:**
- **Website:** The official website is pdfbullet.com.
- **Mission:** To provide a comprehensive online toolkit for PDF and image management that is FREE, fast, secure, and private.
- **Key Feature - Privacy:** The cornerstone of PDFBullet is **client-side processing**. This means most file operations happen directly in the user's browser. Files are NOT uploaded to servers for most tools, guaranteeing 100% privacy. This is a major advantage and should be mentioned when relevant.
- **Key Feature - Speed:** Because of client-side processing, there are no upload delays, making the tools incredibly fast.
- **Key Feature - Free Access:** Most tools are completely free to use without limits.

**Available Tools (Organized by Category):**
- **Organize PDF:** Merge, Split, Organize, Rotate PDF, Create ZIP files.
- **Optimize PDF:** Compress PDF, Repair PDF (a premium tool to fix corrupted files).
- **Convert to PDF:** JPG to PDF, Word to PDF, PowerPoint to PDF, Excel to PDF, PSD to PDF, and Scan to PDF (using a device camera).
- **Convert from PDF:** PDF to JPG, PDF to PNG, PDF to Word, PDF to PowerPoint (premium), PDF to Excel, Extract Text (OCR).
- **Edit PDF:** Edit PDF (premium), Add Page Numbers (premium), Crop PDF (premium), OCR PDF (premium, to make scanned text selectable).
- **PDF Security:** Unlock PDF, Protect PDF (add password), Sign PDF (premium), Watermark PDF.
- **Image Tools:** Remove Background, Compress Image, Watermark Image.
- **Business & AI Tools:** AI Question Generator, Invoice Generator, CV Generator, Lesson Plan Creator.

**Premium Features & Pricing:**
- Premium plans unlock advanced features like OCR, batch processing, higher file limits, no ads, team features, and access to premium tools like Edit PDF and PDF to PowerPoint.
- Pricing information can be found at /pricing.

**Company & Support:**
- **Founder & CEO:** Bishal Mishra.
- **Support:** The primary support email is Support@pdfbullet.com. Human support is available via WhatsApp for urgent issues.
- **Developer API:** A REST API is available for developers at /developer.

**Interaction Guidelines:**
- **Be Friendly & Professional:** Use emojis sparingly to add warmth ✨.
- **Provide Links:** When mentioning a tool or page, provide the relative path (e.g., "You can use our /merge-pdf tool for that."). Format them as simple text paths.
- **Use Markdown:** Use double asterisks for bolding: \`**this is bold**\`. This helps highlight important information.
- **Stay Focused:** Only answer questions related to PDFBullet. If asked about competitors (like 'Smallpdf'), politely state you only have information about PDFBullet and its features.`,thinkingConfig:{thinkingBudget:0}}});return x(Ee),Ee}catch(ee){return console.error("Failed to initialize Gemini Chat:",ee),v("Could not connect to the AI assistant. Please try again later."),null}};P.useEffect(()=>{n&&!_&&oe()},[n,_]),P.useEffect(()=>{if(typeof window<"u"&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){const ee=window.SpeechRecognition||window.webkitSpeechRecognition,ye=new ee;ye.continuous=!1,ye.interimResults=!1,ye.lang="en-US",ye.onresult=Ee=>u(Ee.results[0][0].transcript),ye.onerror=Ee=>v(`Voice recognition error: ${Ee.error}`),ye.onend=()=>D(!1),G.current=ye}},[]),P.useEffect(()=>{R.current&&(R.current.scrollTop=R.current.scrollHeight)},[r,f]);const Y=()=>{if(r.length>1){const ee={id:Date.now(),messages:r,timestamp:Date.now()},ye=[...a,ee];l(ye),localStorage.setItem(Xf,JSON.stringify(ye))}},ie=async ee=>{const ye=(ee||c).trim();if(!ye||f)return;const Ee={role:"user",text:ye};o(ge=>[...ge,Ee]),u(""),m(!0),v("");try{const ge="AIzaSyCuhbxmzoOTGS6UtX7OZjLwBiMfQNrOzJA",Se=new $b({apiKey:ge});if(T){const pe=await Se.models.generateContent({model:"gemini-2.5-flash",contents:ye,config:{tools:[{googleSearch:{}}]}}),Nt=pe.candidates?.[0]?.groundingMetadata?.groundingChunks?.map(ct=>ct.web).filter(ct=>!!ct?.uri)||[];o(ct=>[...ct,{role:"model",text:pe.text,sources:Nt.length>0?Nt:void 0}])}else{let pe=_;if(!pe&&(pe=oe(),!pe))throw new Error("Chat could not be re-initialized.");const mt=await pe.sendMessageStream({message:ye});let Nt="";o(ct=>[...ct,{role:"model",text:""}]);for await(const ct of mt)Nt+=ct.text,o(Qn=>{const xn=[...Qn];return xn.length>0&&(xn[xn.length-1].text=Nt),xn})}}catch(ge){console.error("Gemini API error:",ge);const Se="Sorry, I couldn't get a response. Please check your connection or try again later.";v(Se),o(pe=>[...pe,{role:"model",text:Se}])}finally{m(!1)}},W=()=>{C||!G.current||(D(!0),v(""),G.current.start())},H=()=>{Y(),o([Qf]),x(null),E(!1),oe()},te=()=>{window.confirm("Are you sure you want to delete all chat history? This action cannot be undone.")&&(o([Qf]),l([]),localStorage.removeItem(Xf),E(!1),x(null),oe())},re=ee=>{Y(),o(ee.messages),x(null),E(!1),oe()},be=r.length>1,le=s?"bottom-24 right-4 sm:bottom-6 sm:right-6":"bottom-4 right-4";return p.jsxs("div",{className:`fixed z-[99] pointer-events-none ${le}`,children:[p.jsx("div",{className:`transition-all duration-300 ease-in-out ${n?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-4 pointer-events-none"}`,children:p.jsxs("div",{className:"w-full max-w-[calc(100vw-2rem)] sm:w-80 h-[60vh] max-h-[480px] sm:max-h-[500px] bg-white/90 dark:bg-black/80 backdrop-blur-lg rounded-2xl shadow-2xl flex flex-col border border-gray-200/30 dark:border-gray-700/30 overflow-hidden",onMouseEnter:()=>N(!0),onClick:()=>N(!0),children:[p.jsxs("div",{className:"flex-shrink-0 p-4 flex justify-between items-center bg-gradient-to-r from-red-600 to-orange-500 rounded-t-2xl",children:[p.jsx("p",{className:"font-bold text-white",children:"PDFBullet Support"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:()=>E(!0),className:"p-1.5 rounded-md border border-white/30 text-white/80 hover:bg-white/10 hover:text-white transition-colors","aria-label":"Open menu",title:"Open menu",children:p.jsx(DW,{className:"h-5 w-5"})}),p.jsx("button",{onClick:e,className:"text-white/70 hover:text-white","aria-label":"Close chat widget",title:"Close chat widget",children:p.jsx(Ki,{className:"h-6 w-6"})})]})]}),p.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden relative",children:[p.jsxs("div",{ref:R,className:"flex-grow p-4 overflow-y-auto space-y-4",children:[r.map((ee,ye)=>p.jsxs("div",{className:`flex items-end gap-2.5 ${ee.role==="user"?"justify-end":"justify-start"}`,children:[ee.role==="model"&&p.jsx("img",{src:"https://i.ibb.co/RpStGhqm/IMG-5251-Original.jpg",alt:"Support",className:"w-8 h-8 rounded-full object-cover flex-shrink-0 border-2 border-white shadow-md"}),p.jsx("div",{className:`max-w-[80%] p-3 rounded-2xl text-sm relative group ${ee.role==="user"?"bg-blue-500 text-white rounded-br-none":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-bl-none"}`,children:p.jsx(UW,{text:ee.text,sources:ee.sources})})]},ye)),f&&p.jsxs("div",{className:"flex items-end gap-2.5 justify-start",children:[p.jsx("img",{src:"https://i.ibb.co/RpStGhqm/IMG-5251-Original.jpg",alt:"Support",className:"w-8 h-8 rounded-full object-cover flex-shrink-0 border-2 border-white shadow-md"}),p.jsxs("div",{className:"p-3 rounded-2xl bg-gray-200 dark:bg-gray-700 flex items-center rounded-bl-none",children:[p.jsx("span",{className:"h-2 w-2 bg-gray-500 rounded-full animate-bounce [animation-delay:-0.3s]"}),p.jsx("span",{className:"h-2 w-2 bg-gray-500 rounded-full animate-bounce [animation-delay:-0.15s] mx-1.5"}),p.jsx("span",{className:"h-2 w-2 bg-gray-500 rounded-full animate-bounce"})]})]}),!be&&!f&&p.jsxs("div",{className:"pt-2",children:[p.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:"Or ask about:"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:OW.map((ee,ye)=>p.jsxs("button",{onClick:()=>ie(ee.q),className:"flex items-center gap-2 text-xs text-left bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 p-2 rounded-lg transition-colors",children:[p.jsx("span",{children:ee.icon}),p.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:ee.q})]},ye))})]})]}),y&&p.jsx("p",{className:"text-xs text-red-500 text-center px-4 pb-2",children:y}),p.jsxs("div",{className:"flex-shrink-0 p-3 border-t border-gray-200/50 dark:border-gray-700/50",children:[p.jsxs("a",{href:"https://wa.me/9779827801575",target:"_blank",rel:"noopener noreferrer",className:"mb-2 w-full text-center bg-green-500 hover:bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-full flex items-center justify-center gap-2 transition-colors",children:[p.jsx($n,{className:"h-4 w-4"}),p.jsx("span",{children:"Talk to human support"})]}),p.jsxs("div",{className:"relative flex items-center",children:[p.jsx("button",{type:"button",onClick:W,disabled:f||C,className:`absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-brand-red transition-colors disabled:opacity-50 ${C?"text-red-500 animate-pulse":""}`,"aria-label":"Use voice input",title:"Use voice input",children:p.jsx($8,{className:"h-5 w-5"})}),p.jsx("input",{type:"text",value:c,onChange:ee=>u(ee.target.value),onKeyPress:ee=>ee.key==="Enter"&&ie(),placeholder:C?"Listening...":"Type a message...",className:"flex-grow w-full px-4 py-2 pl-10 bg-gray-100 dark:bg-gray-800 border border-transparent rounded-full focus:ring-brand-red focus:border-brand-red text-sm",disabled:f||C}),p.jsx("button",{onClick:()=>ie(),disabled:f||!c.trim(),className:"p-2.5 ml-2 bg-brand-red text-white rounded-full disabled:bg-red-300 transition-colors flex-shrink-0",children:p.jsx(MW,{className:"h-5 w-5"})})]}),p.jsx("div",{className:"mt-2 flex items-center justify-center gap-2",children:p.jsxs("label",{htmlFor:"google-search-toggle",className:"flex items-center cursor-pointer",children:[p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"checkbox",id:"google-search-toggle",className:"sr-only",checked:T,onChange:()=>S(!T)}),p.jsx("div",{className:"block bg-gray-200 dark:bg-gray-700 w-10 h-6 rounded-full"}),p.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${T?"translate-x-full bg-brand-red":""}`})]}),p.jsxs("div",{className:"ml-2 text-xs text-gray-600 dark:text-gray-300 font-semibold flex items-center gap-1",children:[p.jsx(Ay,{className:"h-4 w-4"})," Search with Google"]})]})})]}),p.jsxs("div",{className:`absolute inset-0 bg-white dark:bg-black flex flex-col transition-transform duration-300 ease-in-out ${I?"translate-x-0":"-translate-x-full"}`,children:[p.jsxs("div",{className:"flex-shrink-0 p-4 flex items-center border-b border-gray-200 dark:border-gray-700",children:[p.jsx("button",{onClick:()=>E(!1),className:"mr-4 text-gray-500 hover:text-gray-800",children:p.jsx(LW,{className:"h-6 w-6"})}),p.jsx("h3",{className:"font-bold text-lg",children:"Menu"})]}),p.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[p.jsxs("button",{onClick:H,className:"w-full text-left flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 font-semibold",children:[p.jsx(xy,{className:"h-5 w-5 text-brand-red"})," New Chat"]}),p.jsxs("button",{onClick:te,className:"w-full text-left flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 font-semibold",children:[p.jsx(AC,{className:"h-5 w-5 text-brand-red"})," Clear History"]}),p.jsxs("div",{className:"mt-4",children:[p.jsxs("h4",{className:"px-3 text-sm font-bold text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[p.jsx(FW,{className:"h-4 w-4"})," History"]}),p.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto",children:a.length>0?[...a].reverse().map(ee=>p.jsxs("button",{onClick:()=>re(ee),className:"w-full text-left p-3 text-sm rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:[p.jsx("p",{className:"truncate font-medium",children:ee.messages[1]?.text||"New Conversation"}),p.jsx("p",{className:"text-xs text-gray-400",children:new Date(ee.timestamp).toLocaleString()})]},ee.id)):p.jsx("p",{className:"p-3 text-sm text-gray-400",children:"No past conversations."})})]}),p.jsxs("div",{className:"mt-4",children:[p.jsxs("h4",{className:"px-3 text-sm font-bold text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[p.jsx(VW,{className:"h-4 w-4"})," Quick Tools"]}),p.jsx("div",{className:"mt-2 space-y-1",children:cr.slice(0,4).map(ee=>p.jsxs(Be,{to:`/${ee.id}`,onClick:()=>E(!1),className:"w-full text-left flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:[p.jsx(ee.Icon,{className:`h-5 w-5 ${ee.textColor}`}),p.jsx("span",{className:"font-semibold text-sm",children:L(ee.title)})]},ee.id))})]})]})]})]})]})}),i&&(s?p.jsx("button",{onClick:t,className:`pointer-events-auto transition-all duration-300 ease-in-out transform hover:scale-110 hover:brightness-110 ${n?"opacity-0 translate-y-4 pointer-events-none":"opacity-100 translate-y-0"}`,"aria-label":"Open Chat Support",title:"Open Chat Support",children:p.jsx("img",{src:"https://ik.imagekit.io/fonepay/chatbot%20icon.png?updatedAt=1760017579423",alt:"Chat Support",className:"w-16 h-16 rounded-full shadow-lg"})}):p.jsxs("button",{onClick:t,className:`relative transition-all duration-300 ease-in-out bg-brand-red text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center transform hover:scale-110 pointer-events-auto animate-wave-float ${n?"opacity-0 translate-y-4 pointer-events-none":"opacity-100 translate-y-0"}`,"aria-label":"Open chat support",title:"Open chat support",children:[p.jsx("span",{className:"absolute inline-flex h-full w-full rounded-full bg-brand-red opacity-75 animate-ping-slow"}),p.jsx(NW,{className:"h-6 w-6 relative"})]}))]})},BW=P.lazy(()=>fe(()=>import("./HomePage-BwyNz2w0.js"),__vite__mapDeps([0,1,2,3]))),e1=P.lazy(()=>fe(()=>import("./ToolPage-D2vKHn6-.js"),__vite__mapDeps([4,5,6,7,8,3]))),t1=P.lazy(()=>fe(()=>import("./AboutPage-LQ8wBZ68.js"),__vite__mapDeps([9,3]))),n1=P.lazy(()=>fe(()=>import("./BlogPage-BTgUaOkw.js"),__vite__mapDeps([10,3]))),i1=P.lazy(()=>fe(()=>import("./BlogPostPage-DJ3LB65F.js"),__vite__mapDeps([11,3]))),s1=P.lazy(()=>fe(()=>import("./ContactPage-DpBNNG_h.js"),__vite__mapDeps([12,3]))),zW=P.lazy(()=>fe(()=>import("./LoginPage-B_kRHxSu.js"),__vite__mapDeps([13,3]))),jW=P.lazy(()=>fe(()=>import("./SignUpPage-DcUMoK7Q.js"),__vite__mapDeps([14,3]))),r1=P.lazy(()=>fe(()=>import("./DeveloperPage-C9OuG6yH.js"),__vite__mapDeps([15,3]))),o1=P.lazy(()=>fe(()=>import("./FaqPage-B9oU0kdy.js"),__vite__mapDeps([16,3]))),a1=P.lazy(()=>fe(()=>import("./SitemapPage-BN7GUX2J.js"),__vite__mapDeps([17,3]))),l1=P.lazy(()=>fe(()=>import("./InvoiceGeneratorPage-D2SP2KF-.js"),__vite__mapDeps([18,6,19,20,3]))),c1=P.lazy(()=>fe(()=>import("./CVGeneratorPage-DhKzPsBr.js"),__vite__mapDeps([21,6,19,20,3]))),u1=P.lazy(()=>fe(()=>import("./LessonPlanCreatorPage-D12dAxUP.js"),__vite__mapDeps([22,23,19,3]))),d1=P.lazy(()=>fe(()=>import("./AIQuestionGeneratorPage-WwxudB7p.js"),__vite__mapDeps([24,3]))),h1=P.lazy(()=>fe(()=>import("./ImageGeneratorPage-_JPTBUQF.js"),__vite__mapDeps([25,3]))),f1=P.lazy(()=>fe(()=>import("./PricingPage-CLydEL4d.js"),__vite__mapDeps([26,3]))),p1=P.lazy(()=>fe(()=>import("./ApiPricingPage-84S0nyt9.js"),__vite__mapDeps([27,3]))),m1=P.lazy(()=>fe(()=>import("./PremiumFeaturePage-Vmv4IFUW.js"),__vite__mapDeps([28,3]))),g1=P.lazy(()=>fe(()=>import("./PaymentPage-BhUebUmf.js"),__vite__mapDeps([29,3]))),y1=P.lazy(()=>fe(()=>import("./DeveloperAccessPage-D3DI3fI4.js"),__vite__mapDeps([30,3]))),v1=P.lazy(()=>fe(()=>import("./AdminDashboardPage-DPWEMh55.js"),__vite__mapDeps([31,3]))),w1=P.lazy(()=>fe(()=>import("./HowToUsePage-DUkf25dz.js"),__vite__mapDeps([32,3]))),_1=P.lazy(()=>fe(()=>import("./EducationPage-CZQITu9Y.js"),__vite__mapDeps([33,3]))),b1=P.lazy(()=>fe(()=>import("./BusinessPage-Cd8XkXyM.js"),__vite__mapDeps([34,3]))),x1=P.lazy(()=>fe(()=>import("./PrivacyPolicyPage-BUKeTlij.js"),__vite__mapDeps([35,3]))),T1=P.lazy(()=>fe(()=>import("./TermsOfServicePage-DFQTn1Cm.js"),__vite__mapDeps([36,3]))),E1=P.lazy(()=>fe(()=>import("./CookiesPolicyPage-CFYiEixx.js"),__vite__mapDeps([37,3]))),A1=P.lazy(()=>fe(()=>import("./CeoPage-D-GmPZUD.js"),__vite__mapDeps([38,3]))),I1=P.lazy(()=>fe(()=>import("./PressPage-c6CEqfnH.js"),__vite__mapDeps([39,3]))),C1=P.lazy(()=>fe(()=>import("./LegalPage-Y4e1pSiN.js"),__vite__mapDeps([40,3]))),S1=P.lazy(()=>fe(()=>import("./SecurityPolicyPage-DrR_ysEY.js"),__vite__mapDeps([41,3]))),P1=P.lazy(()=>fe(()=>import("./FeaturesPage-CThrNTsD.js"),__vite__mapDeps([42,3]))),k1=P.lazy(()=>fe(()=>import("./ApiReferencePage-DSrCVhiu.js"),__vite__mapDeps([43,3]))),R1=P.lazy(()=>fe(()=>import("./ApiPdfPage-uK2azTaX.js"),__vite__mapDeps([44,3]))),N1=P.lazy(()=>fe(()=>import("./ApiImagePage-BGh_aB6E.js"),__vite__mapDeps([45,3]))),M1=P.lazy(()=>fe(()=>import("./ApiSignaturePage-BtKFhAPw.js"),__vite__mapDeps([46,3]))),D1=P.lazy(()=>fe(()=>import("./AccountSettingsPage-BAbfM8Kv.js"),__vite__mapDeps([47,3]))),L1=P.lazy(()=>fe(()=>import("./WorkflowsPage-IBonzB4c.js"),__vite__mapDeps([48,2,3]))),F1=P.lazy(()=>fe(()=>import("./CreateWorkflowPage-D7Uvdsl9.js"),__vite__mapDeps([49,2,3]))),V1=P.lazy(()=>fe(()=>import("./SecurityPage-A6i5e3Aj.js"),__vite__mapDeps([50,3]))),O1=P.lazy(()=>fe(()=>import("./TeamPage-CBWpMZ9p.js"),__vite__mapDeps([51,3]))),U1=P.lazy(()=>fe(()=>import("./LastTasksPage-wbqL_OHo.js"),__vite__mapDeps([52,8,3]))),B1=P.lazy(()=>fe(()=>import("./SignaturesOverviewPage-BnAsyVaQ.js"),__vite__mapDeps([53,5,6,7,8,3]))),z1=P.lazy(()=>fe(()=>import("./SentPage-B4aHCqwc.js"),__vite__mapDeps([54,5,6,3]))),j1=P.lazy(()=>fe(()=>import("./InboxPage-4wfn3aCP.js"),__vite__mapDeps([55,5,6,3]))),q1=P.lazy(()=>fe(()=>import("./SignedPage-CYOUZKU_.js"),__vite__mapDeps([56,19,7,8,3]))),H1=P.lazy(()=>fe(()=>import("./TemplatesPage-ChXbrgz8.js"),__vite__mapDeps([57,5,6,3]))),G1=P.lazy(()=>fe(()=>import("./ContactsPage-BgwSKmXF.js"),__vite__mapDeps([58,5,6,59,3]))),$1=P.lazy(()=>fe(()=>import("./SignatureSettingsPage-BvfZR-Mv.js"),__vite__mapDeps([60,3]))),W1=P.lazy(()=>fe(()=>import("./PlansAndPackagesPage-DuN4Y8VK.js"),__vite__mapDeps([61,3]))),K1=P.lazy(()=>fe(()=>import("./BusinessDetailsPage-BjDo9GtA.js"),__vite__mapDeps([62,3]))),Y1=P.lazy(()=>fe(()=>import("./InvoicesPage-zV3kzEQm.js"),__vite__mapDeps([63,19,3]))),qW=P.lazy(()=>fe(()=>import("./PwaHomePage-Dwed_ECd.js"),__vite__mapDeps([64,1,8,3]))),HW=P.lazy(()=>fe(()=>import("./PwaToolsPage-BgMWIcZQ.js"),__vite__mapDeps([65,1,3]))),GW=P.lazy(()=>fe(()=>import("./PwaArticlesPage-UL9RfPmi.js"),__vite__mapDeps([66,3]))),$W=P.lazy(()=>fe(()=>import("./PwaSettingsPage-BR3AAJFo.js"),__vite__mapDeps([67,3]))),WW=P.lazy(()=>fe(()=>import("./PwaStoragePage-BHCUnkvn.js"),__vite__mapDeps([68,3])));function KW(){const n=Ti(),e=ia(),{user:t,loading:i}=Nn(),{isPwa:s}=ya(),[r,o]=P.useState(!1),[a,l]=P.useState(!1),[c,u]=P.useState(!1),[f,m]=P.useState(!1),[y,v]=P.useState(!1),[_,x]=P.useState(!1),[T,S]=P.useState(!1),[C,D]=P.useState(!1),[F,V]=P.useState(!0),I=P.useMemo(()=>({setShowFooter:V}),[V]),[E,A]=P.useState([]),[N,M]=P.useState(0),[L,R]=P.useState(!1),[G,oe]=P.useState(null),Y=P.useRef(0),ie="read_notification_ids";P.useEffect(()=>{if(!s)return;const le=dt.collection("pwa_notifications").orderBy("timestamp","desc").onSnapshot(ee=>{const ye=new Set(JSON.parse(localStorage.getItem(ie)||"[]")),Ee=ee.docs.map(Se=>{const pe=Se.data();return{id:Se.id,title:pe.title||"Notification",message:pe.message,timestamp:pe.timestamp?pe.timestamp.toDate().getTime():Date.now(),read:ye.has(Se.id),url:pe.url,attachmentUrl:pe.attachmentUrl}}),ge=Ee.filter(Se=>!Se.read).length;if("setAppBadge"in navigator&&navigator.setAppBadge(ge).catch(Se=>{console.error("Failed to set app badge:",Se)}),Ee.length>Y.current&&Y.current>0){const Se=Ee[0];Se&&!Se.read&&(R(!0),oe(Se))}A(Ee),M(ge),Y.current=Ee.length},ee=>{console.error("Error listening to notifications:",ee)});return()=>le()},[s]);const W=P.useCallback(()=>{try{const le=E.map(ee=>ee.id);localStorage.setItem(ie,JSON.stringify(le)),A(ee=>ee.map(ye=>({...ye,read:!0}))),M(0),"clearAppBadge"in navigator&&navigator.clearAppBadge().catch(ee=>{console.error("Failed to clear app badge:",ee)})}catch(le){console.error("Failed to mark notifications as read",le)}},[E]),H=P.useCallback(()=>{window.confirm("Are you sure you want to clear all notifications? This will mark them all as read.")&&W()},[W]);P.useEffect(()=>{const le=sessionStorage.getItem("redirect");le&&le!==n.pathname&&(sessionStorage.removeItem("redirect"),e(le,{replace:!0}))},[e,n.pathname]),P.useEffect(()=>{window.scrollTo(0,0)},[n.pathname]),P.useEffect(()=>{if(!i&&t){const le=sessionStorage.getItem("postLoginRedirect");if(le){sessionStorage.removeItem("postLoginRedirect");const ee=JSON.parse(le),ye=sessionStorage.getItem("pendingInvoiceDataRedirect");ye?(sessionStorage.removeItem("pendingInvoiceDataRedirect"),e("/invoice-generator",{state:{restoredData:JSON.parse(ye)},replace:!0})):ee.from==="pricing"?e("/payment",{state:{plan:ee.plan}}):ee.from==="developer"?e("/developer"):ee.from==="workflows_create"?e("/workflows/create"):(n.pathname==="/login"||n.pathname==="/signup")&&e("/")}else(n.pathname==="/login"||n.pathname==="/signup")&&e("/")}},[t,i,e,n.pathname]);const te=p.jsxs(Wv,{children:[p.jsx(q,{path:"/",element:p.jsx(qW,{})}),p.jsx(q,{path:"/tools",element:p.jsx(HW,{})}),p.jsx(q,{path:"/articles",element:p.jsx(GW,{})}),p.jsx(q,{path:"/settings",element:p.jsx($W,{})}),p.jsx(q,{path:"/storage",element:p.jsx(WW,{})}),p.jsx(q,{path:"/notifications",element:p.jsx(PW,{notifications:E,markAllAsRead:W,clearAll:H})}),p.jsx(q,{path:"/blog/:slug",element:p.jsx(i1,{})}),p.jsx(q,{path:"/blog",element:p.jsx(n1,{})}),p.jsx(q,{path:"/pricing",element:p.jsx(f1,{})}),p.jsx(q,{path:"/developer",element:p.jsx(r1,{})}),p.jsx(q,{path:"/payment",element:p.jsx(g1,{})}),p.jsx(q,{path:"/invoice-generator",element:p.jsx(l1,{})}),p.jsx(q,{path:"/cv-generator",element:p.jsx(c1,{})}),p.jsx(q,{path:"/lesson-plan-creator",element:p.jsx(u1,{})}),p.jsx(q,{path:"/ai-question-generator",element:p.jsx(d1,{})}),p.jsx(q,{path:"/image-generator",element:p.jsx(h1,{})}),p.jsx(q,{path:"/about",element:p.jsx(t1,{})}),p.jsx(q,{path:"/contact",element:p.jsx(s1,{})}),p.jsx(q,{path:"/press",element:p.jsx(I1,{})}),p.jsx(q,{path:"/ceo",element:p.jsx(A1,{})}),p.jsx(q,{path:"/education",element:p.jsx(_1,{})}),p.jsx(q,{path:"/business",element:p.jsx(b1,{})}),p.jsx(q,{path:"/legal",element:p.jsx(C1,{})}),p.jsx(q,{path:"/privacy-policy",element:p.jsx(x1,{})}),p.jsx(q,{path:"/terms-of-service",element:p.jsx(T1,{})}),p.jsx(q,{path:"/cookies-policy",element:p.jsx(E1,{})}),p.jsx(q,{path:"/user-data-deletion",element:p.jsx(Xx,{})}),p.jsx(q,{path:"/security-policy",element:p.jsx(S1,{})}),p.jsx(q,{path:"/features",element:p.jsx(P1,{})}),p.jsx(q,{path:"/how-to-use",element:p.jsx(w1,{})}),p.jsx(q,{path:"/developer-access",element:p.jsx(y1,{})}),p.jsx(q,{path:"/faq",element:p.jsx(o1,{})}),p.jsx(q,{path:"/sitemap",element:p.jsx(a1,{})}),p.jsx(q,{path:"/api-pricing",element:p.jsx(p1,{})}),p.jsx(q,{path:"/premium-feature",element:p.jsx(m1,{})}),p.jsx(q,{path:"/api-reference",element:p.jsx(k1,{})}),p.jsx(q,{path:"/api-pdf",element:p.jsx(R1,{})}),p.jsx(q,{path:"/api-image",element:p.jsx(N1,{})}),p.jsx(q,{path:"/api-signature",element:p.jsx(M1,{})}),p.jsx(q,{element:p.jsx(dx,{}),children:p.jsx(q,{path:"/admin-dashboard",element:p.jsx(v1,{})})}),p.jsxs(q,{element:p.jsx(hx,{}),children:[p.jsxs(q,{element:p.jsx(Wx,{}),children:[p.jsx(q,{path:"/account-settings",element:p.jsx(D1,{})}),p.jsx(q,{path:"/workflows",element:p.jsx(L1,{})}),p.jsx(q,{path:"/security",element:p.jsx(V1,{})}),p.jsx(q,{path:"/team",element:p.jsx(O1,{})}),p.jsx(q,{path:"/last-tasks",element:p.jsx(U1,{})}),p.jsx(q,{path:"/signatures-overview",element:p.jsx(B1,{})}),p.jsx(q,{path:"/sent",element:p.jsx(z1,{})}),p.jsx(q,{path:"/inbox",element:p.jsx(j1,{})}),p.jsx(q,{path:"/signed",element:p.jsx(q1,{})}),p.jsx(q,{path:"/templates",element:p.jsx(H1,{})}),p.jsx(q,{path:"/contacts",element:p.jsx(G1,{})}),p.jsx(q,{path:"/signature-settings",element:p.jsx($1,{})}),p.jsx(q,{path:"/plans-packages",element:p.jsx(W1,{})}),p.jsx(q,{path:"/business-details",element:p.jsx(K1,{})}),p.jsx(q,{path:"/invoices",element:p.jsx(Y1,{})}),p.jsx(q,{path:"/placeholder",element:p.jsx(Kx,{title:"Placeholder"})})]}),p.jsx(q,{path:"/workflows/create",element:p.jsx(F1,{})})]}),p.jsx(q,{path:"/:toolId",element:p.jsx(e1,{})}),p.jsx(q,{path:"*",element:p.jsx(Yx,{})})]}),re=p.jsxs(Wv,{children:[p.jsx(q,{path:"/",element:p.jsx(BW,{})}),p.jsx(q,{path:"/about",element:p.jsx(t1,{})}),p.jsx(q,{path:"/blog/:slug",element:p.jsx(i1,{})}),p.jsx(q,{path:"/blog",element:p.jsx(n1,{})}),p.jsx(q,{path:"/contact",element:p.jsx(s1,{})}),p.jsx(q,{path:"/login",element:p.jsx(zW,{onOpenForgotPasswordModal:()=>x(!0)})}),p.jsx(q,{path:"/signup",element:p.jsx(jW,{})}),p.jsx(q,{path:"/developer",element:p.jsx(r1,{})}),p.jsx(q,{path:"/faq",element:p.jsx(o1,{})}),p.jsx(q,{path:"/sitemap",element:p.jsx(a1,{})}),p.jsx(q,{path:"/invoice-generator",element:p.jsx(l1,{})}),p.jsx(q,{path:"/cv-generator",element:p.jsx(c1,{})}),p.jsx(q,{path:"/lesson-plan-creator",element:p.jsx(u1,{})}),p.jsx(q,{path:"/ai-question-generator",element:p.jsx(d1,{})}),p.jsx(q,{path:"/image-generator",element:p.jsx(h1,{})}),p.jsx(q,{path:"/pricing",element:p.jsx(f1,{})}),p.jsx(q,{path:"/api-pricing",element:p.jsx(p1,{})}),p.jsx(q,{path:"/premium-feature",element:p.jsx(m1,{})}),p.jsx(q,{path:"/payment",element:p.jsx(g1,{})}),p.jsx(q,{path:"/developer-access",element:p.jsx(y1,{})}),p.jsx(q,{path:"/how-to-use",element:p.jsx(w1,{})}),p.jsx(q,{path:"/education",element:p.jsx(_1,{})}),p.jsx(q,{path:"/business",element:p.jsx(b1,{})}),p.jsx(q,{path:"/privacy-policy",element:p.jsx(x1,{})}),p.jsx(q,{path:"/terms-of-service",element:p.jsx(T1,{})}),p.jsx(q,{path:"/cookies-policy",element:p.jsx(E1,{})}),p.jsx(q,{path:"/ceo",element:p.jsx(A1,{})}),p.jsx(q,{path:"/press",element:p.jsx(I1,{})}),p.jsx(q,{path:"/user-data-deletion",element:p.jsx(Xx,{})}),p.jsx(q,{path:"/legal",element:p.jsx(C1,{})}),p.jsx(q,{path:"/security-policy",element:p.jsx(S1,{})}),p.jsx(q,{path:"/features",element:p.jsx(P1,{})}),p.jsx(q,{path:"/api-reference",element:p.jsx(k1,{})}),p.jsx(q,{path:"/api-pdf",element:p.jsx(R1,{})}),p.jsx(q,{path:"/api-image",element:p.jsx(N1,{})}),p.jsx(q,{path:"/api-signature",element:p.jsx(M1,{})}),p.jsx(q,{element:p.jsx(dx,{}),children:p.jsx(q,{path:"/admin-dashboard",element:p.jsx(v1,{})})}),p.jsxs(q,{element:p.jsx(hx,{}),children:[p.jsxs(q,{element:p.jsx(Wx,{}),children:[p.jsx(q,{path:"/account-settings",element:p.jsx(D1,{})}),p.jsx(q,{path:"/workflows",element:p.jsx(L1,{})}),p.jsx(q,{path:"/security",element:p.jsx(V1,{})}),p.jsx(q,{path:"/team",element:p.jsx(O1,{})}),p.jsx(q,{path:"/last-tasks",element:p.jsx(U1,{})}),p.jsx(q,{path:"/signatures-overview",element:p.jsx(B1,{})}),p.jsx(q,{path:"/sent",element:p.jsx(z1,{})}),p.jsx(q,{path:"/inbox",element:p.jsx(j1,{})}),p.jsx(q,{path:"/signed",element:p.jsx(q1,{})}),p.jsx(q,{path:"/templates",element:p.jsx(H1,{})}),p.jsx(q,{path:"/contacts",element:p.jsx(G1,{})}),p.jsx(q,{path:"/signature-settings",element:p.jsx($1,{})}),p.jsx(q,{path:"/plans-packages",element:p.jsx(W1,{})}),p.jsx(q,{path:"/business-details",element:p.jsx(K1,{})}),p.jsx(q,{path:"/invoices",element:p.jsx(Y1,{})}),p.jsx(q,{path:"/placeholder",element:p.jsx(Kx,{title:"Placeholder"})})]}),p.jsx(q,{path:"/workflows/create",element:p.jsx(F1,{})})]}),p.jsx(q,{path:"/:toolId",element:p.jsx(e1,{})}),p.jsx(q,{path:"*",element:p.jsx(Yx,{})})]}),be=!0;return s?p.jsxs(T8,{children:[p.jsx(IW,{onOpenForgotPasswordModal:()=>x(!0),children:p.jsxs(mO,{children:[p.jsx(zG,{onOpenSearchModal:()=>l(!0),unreadCount:N,justReceivedNotification:L,onNotificationAnimationEnd:()=>R(!1),onOpenProfileImageModal:()=>o(!0),onOpenChangePasswordModal:()=>m(!0)}),p.jsx("main",{className:"pt-[60px] pb-[72px] bg-gray-50 dark:bg-soft-dark min-h-screen",children:p.jsx(P.Suspense,{fallback:p.jsx(nc,{}),children:te})}),p.jsx(CW,{})]})}),p.jsx(Zx,{isOpen:C,onClose:()=>D(!1),onOpen:()=>D(!0),showFab:be,isPwa:s}),p.jsx(Jx,{notification:G,onClose:()=>oe(null)}),p.jsx(ux,{isOpen:a,onClose:()=>l(!1)}),p.jsx(cx,{isOpen:r,onClose:()=>o(!1)}),p.jsx(fx,{isOpen:f,onClose:()=>m(!1)}),p.jsx(Qx,{isOpen:_,onClose:()=>x(!1)}),p.jsx(px,{}),p.jsx(qx,{}),p.jsx($x,{})]}):p.jsxs(kW.Provider,{value:I,children:[p.jsx(RW,{}),p.jsxs("div",{className:"flex flex-col min-h-screen text-gray-800 dark:text-gray-200",children:[p.jsx(BG,{isPwa:s,onOpenProfileImageModal:()=>o(!0),onOpenSearchModal:()=>l(!0),onOpenChangePasswordModal:()=>m(!0),onOpenQrCodeModal:()=>S(!0),unreadCount:N,justReceivedNotification:L,onNotificationAnimationEnd:()=>R(!1)}),p.jsx("main",{className:"flex-grow",children:p.jsx(P.Suspense,{fallback:p.jsx(nc,{}),children:re})}),p.jsx(Jx,{notification:G,onClose:()=>oe(null)}),F&&p.jsx(qG,{onOpenCalendarModal:()=>u(!0),onOpenProblemReportModal:()=>v(!0)}),p.jsx(cx,{isOpen:r,onClose:()=>o(!1)}),p.jsx(ux,{isOpen:a,onClose:()=>l(!1)}),p.jsx(W$,{isOpen:c,onClose:()=>u(!1)}),p.jsx(fx,{isOpen:f,onClose:()=>m(!1)}),p.jsx(Y$,{isOpen:y,onClose:()=>v(!1)}),p.jsx(Qx,{isOpen:_,onClose:()=>x(!1)}),p.jsx(vW,{isOpen:T,onClose:()=>S(!1)}),p.jsx(HG,{}),p.jsx(K$,{}),p.jsx(px,{}),p.jsx(qx,{}),p.jsx(Zx,{isOpen:C,onClose:()=>D(!1),onOpen:()=>D(!0),showFab:be,isPwa:s}),p.jsx($x,{})]})]})}function YW(){return p.jsx(kk,{children:p.jsx(_8,{children:p.jsx(x8,{children:p.jsx(b8,{children:p.jsx(KW,{})})})})})}var Sl={};Sl.d=(n,e)=>{for(var t in e)Sl.o(e,t)&&!Sl.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Sl.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Te=globalThis.pdfjsLib={};Sl.d(Te,{AbortException:()=>Ns,AnnotationEditorLayer:()=>Pi,AnnotationEditorParamsType:()=>Fe,AnnotationEditorType:()=>Ie,AnnotationEditorUIManager:()=>Ms,AnnotationLayer:()=>HY,AnnotationMode:()=>ls,ColorPicker:()=>Dn,DOMSVGFactory:()=>Hy,DrawLayer:()=>on,FeatureTest:()=>hn,GlobalWorkerOptions:()=>kl,ImageKind:()=>zu,InvalidPDFException:()=>gm,MissingPDFException:()=>ac,OPS:()=>Hn,OutputScale:()=>ym,PDFDataRangeTransport:()=>OS,PDFDateString:()=>xS,PDFWorker:()=>Dt,PasswordResponses:()=>ZW,PermissionFlag:()=>QW,PixelsPerInch:()=>ea,RenderingCancelledException:()=>Ly,TextLayer:()=>an,TouchManager:()=>Sh,UnexpectedResponseException:()=>Td,Util:()=>me,VerbosityLevel:()=>xh,XfaLayer:()=>BS,build:()=>EY,createValidAbsoluteUrl:()=>iK,fetchData:()=>Ih,getDocument:()=>mY,getFilenameFromUrl:()=>hK,getPdfFilenameFromUrl:()=>fK,getXfaPageViewport:()=>pK,isDataScheme:()=>Ch,isPdfFile:()=>Fy,noContextMenu:()=>Xn,normalizeUnicode:()=>cK,setLayerDimensions:()=>Dr,shadow:()=>ke,stopEvent:()=>Cn,version:()=>TY});const Xt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),_S=[1,0,0,1,0,0],mm=[.001,0,0,.001,0,0],JW=1e7,Zf=1.35,En={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ls={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},XW="pdfjs_internal_editor_",Ie={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Fe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},QW={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Wt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},zu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},St={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Xa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},xh={ERRORS:0,WARNINGS:1,INFOS:5},Hn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},ZW={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Th=xh.WARNINGS;function eK(n){Number.isInteger(n)&&(Th=n)}function tK(){return Th}function Eh(n){Th>=xh.INFOS&&console.log(`Info: ${n}`)}function Ce(n){Th>=xh.WARNINGS&&console.log(`Warning: ${n}`)}function We(n){throw new Error(n)}function It(n,e){n||We(e)}function nK(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function iK(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=lK(n)}catch{}const i=e?new URL(n,e):new URL(n);if(nK(i))return i}catch{}return null}function ke(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const qs=(function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e})();class J1 extends qs{constructor(e,t){super(e,"PasswordException"),this.code=t}}class ep extends qs{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class gm extends qs{constructor(e){super(e,"InvalidPDFException")}}class ac extends qs{constructor(e){super(e,"MissingPDFException")}}class Td extends qs{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class sK extends qs{constructor(e){super(e,"FormatError")}}class Ns extends qs{constructor(e){super(e,"AbortException")}}function bS(n){(typeof n!="object"||n?.length===void 0)&&We("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),o=n.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Ah(n){typeof n!="string"&&We("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function rK(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function My(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function oK(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function aK(){try{return new Function(""),!0}catch{return!1}}class hn{static get isLittleEndian(){return ke(this,"isLittleEndian",oK())}static get isEvalSupported(){return ke(this,"isEvalSupported",aK())}static get isOffscreenCanvasSupported(){return ke(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ke(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?ke(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):ke(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return ke(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const tp=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class me{static makeHexColor(e,t,i){return`#${tp[e]}${tp[t]}${tp[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,r]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(i+o)/2,l=Math.sqrt((i+o)**2-4*(i*o-r*s))/2,c=a+l||1,u=a-l||1;return[Math.sqrt(c),Math.sqrt(u)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[i,r,s,o]}static#e(e,t,i,s,r,o,a,l,c,u){if(c<=0||c>=1)return;const f=1-c,m=c*c,y=m*c,v=f*(f*(f*e+3*c*t)+3*m*i)+y*s,_=f*(f*(f*r+3*c*o)+3*m*a)+y*l;u[0]=Math.min(u[0],v),u[1]=Math.min(u[1],_),u[2]=Math.max(u[2],v),u[3]=Math.max(u[3],_)}static#t(e,t,i,s,r,o,a,l,c,u,f,m){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&this.#e(e,t,i,s,r,o,a,l,-f/u,m);return}const y=u**2-4*f*c;if(y<0)return;const v=Math.sqrt(y),_=2*c;this.#e(e,t,i,s,r,o,a,l,(-u+v)/_,m),this.#e(e,t,i,s,r,o,a,l,(-u-v)/_,m)}static bezierBoundingBox(e,t,i,s,r,o,a,l,c){return c?(c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],this.#t(e,i,r,a,t,s,o,l,3*(-e+3*(i-r)+a),6*(e-2*i+r),3*(i-e),c),this.#t(e,i,r,a,t,s,o,l,3*(-t+3*(s-o)+l),6*(t-2*s+o),3*(s-t),c),c}}function lK(n){return decodeURIComponent(escape(n))}let np=null,X1=null;function cK(n){return np||(np=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,X1=new Map([["ﬅ","ſt"]])),n.replaceAll(np,(e,t,i)=>t?t.normalize("NFKC"):X1.get(i))}function uK(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),bS(n)}const Dy="pdfjs_internal_id_";function dK(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(bS(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Si="http://www.w3.org/2000/svg";class ea{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Ih(n,e="text"){if(cl(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Lc{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,f,m,y;switch(s%=360,s<0&&(s+=360),s){case 180:u=-1,f=0,m=0,y=1;break;case 90:u=0,f=1,m=1,y=0;break;case 270:u=0,f=-1,m=-1,y=0;break;case 0:u=1,f=0,m=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(m=-m,y=-y);let v,_,x,T;u===0?(v=Math.abs(c-e[1])*i+r,_=Math.abs(l-e[0])*i+o,x=(e[3]-e[1])*i,T=(e[2]-e[0])*i):(v=Math.abs(l-e[0])*i+r,_=Math.abs(c-e[1])*i+o,x=(e[2]-e[0])*i,T=(e[3]-e[1])*i),this.transform=[u*i,f*i,m*i,y*i,v-u*i*l-m*i*c,_-f*i*l-y*i*c],this.width=x,this.height=T}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(s=>s*e);return ke(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Lc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){return me.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=me.applyTransform([e[0],e[1]],this.transform),i=me.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return me.applyInverseTransform([e,t],this.transform)}}class Ly extends qs{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Ch(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Fy(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function hK(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function fK(n,e="document.pdf"){if(typeof n!="string")return e;if(Ch(n))return Ce('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Q1{started=Object.create(null);times=[];time(e){e in this.started&&Ce(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ce(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function cl(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Xn(n){n.preventDefault()}function Cn(n){n.preventDefault(),n.stopPropagation()}class xS{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(o+=u,a+=f):c==="+"&&(o-=u,a-=f),new Date(Date.UTC(i,s,r,o,a,l))}}function pK(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Lc({viewBox:r,userUnit:1,scale:e,rotation:t})}function Vy(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ce(`Not a valid color format: "${n}"`),[0,0,0])}function mK(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,Vy(i))}e.remove()}function tt(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform();return[e,t,i,s,r,o]}function ni(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform().invertSelf();return[e,t,i,s,r,o]}function Dr(n,e,t=!1,i=!0){if(e instanceof Lc){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:o}=n,a=hn.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${r}px`,u=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=a?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(o.width=u,o.height=f):(o.width=f,o.height=u)}i&&n.setAttribute("data-main-rotation",e.rotation)}class ym{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Pl{#e=null;#t=null;#n;#i=null;#r=null;static#s=null;constructor(e){this.#n=e,Pl.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Xn,{signal:t}),e.addEventListener("pointerdown",Pl.#l,{signal:t});const i=this.#i=document.createElement("div");i.className="buttons",e.append(i);const s=this.#n.toolbarPosition;if(s){const{style:r}=e,o=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#a(e){this.#n._focusEventsAllowed=!1,Cn(e)}#u(e){this.#n._focusEventsAllowed=!0,Cn(e)}#c(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#a.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Xn,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#h(){const{editorType:e,_uiManager:t}=this.#n,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",Pl.#s[e]),this.#c(i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#i.append(i)}get#d(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#c(t),this.#i.prepend(t,this.#d),this.#r=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#c(t),this.#i.prepend(t,this.#d)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class gK{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Xn,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#r(e,t){let i=0,s=0;for(const r of e){const o=r.y+r.height;if(o<i)continue;const a=r.x+(t?r.width:0);if(o>i){s=a,i=o;continue}t?a>s&&(s=a):a<s&&(s=a)}return[t?1-s:s,i]}show(e,t,i){const[s,r]=this.#r(t,i),{style:o}=this.#t||=this.#i();e.append(this.#t),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#n._signal;e.addEventListener("contextmenu",Xn,{signal:i}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:i}),this.#e.append(e)}}function Ed(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}class yK{#e=0;get id(){return`${XW}${this.#e++}`}}class Oy{#e=uK();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ke(this,"_isSVGFittingCanvas",r)}async#i(e,t){this.#n||=new Map;let i=this.#n.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(i.url=t,s=await Ih(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=Oy._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,u)=>{a.onload=()=>{i.bitmap=a,i.isSvg=!0,c()},o.onload=async()=>{const f=i.svgUrl=o.result;a.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},a.onerror=o.onerror=u});o.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){Ce(s),i=null}return this.#n.set(e,i),i&&this.#n.set(i.id,i),i}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return this.#i(`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromBlob(e,t){const i=await t;return this.#i(e,i)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let i=this.#n.get(e);if(i?.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,i),this.#n.set(i.id,i),i}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=s.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class vK{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&e(),this.#t)return;const l={cmd:e,undo:t,post:i,type:r};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(o&&this.#e[this.#i].type===r){a&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}const c=this.#i+1;c===this.#n?this.#e.splice(0,1):(this.#i=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}cleanType(e){if(this.#i!==-1){for(let t=this.#i;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#i-t),this.#i=t;return}this.#e.length=0,this.#i=-1}}destroy(){this.#e=null}}class Fc{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=hn.platform;for(const[i,s,r={}]of e)for(const o of i){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(this.#e(t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:a=null}}=i;a&&!a(e,t)||(s.bind(e,...o,t)(),r||Cn(t))}}class Uy{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return mK(e),ke(this,"_colors",e)}convert(e){const t=Vy(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,o)=>r===t[o]))return Uy._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?me.makeHexColor(...t):e}}class Ms{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#r=null;#s=null;#l=null;#a=new vK;#u=null;#c=null;#h=0;#d=new Set;#f=null;#o=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#y=!1;#_=null;#v=null;#b=null;#T=null;#A=!1;#C=null;#P=new yK;#x=!1;#S=!1;#I=null;#R=null;#D=null;#F=null;#E=Ie.NONE;#w=new Set;#M=null;#z=null;#j=null;#q={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#V=[0,0];#L=null;#O=null;#H=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Ms.prototype,t=o=>o.#O.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ke(this,"_keyboardManager",new Fc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#O.contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#O.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,i,s,r,o,a,l,c,u,f,m,y){const v=this._signal=this.#e.signal;this.#O=e,this.#H=t,this.#r=i,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:v}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),s._on("setpreference",this.onSetPreference.bind(this),{signal:v}),s._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:v}),this.#te(),this.#re(),this.#K(),this.#s=r.annotationStorage,this.#_=r.filterFactory,this.#z=o,this.#T=a||null,this.#g=l,this.#m=c,this.#y=u,this.#F=f||null,this.viewParameters={realScale:ea.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=y!==!1}destroy(){this.#N?.resolve(),this.#N=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#w.clear(),this.#a.destroy(),this.#r?.destroy(),this.#C?.hide(),this.#C=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#F}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return ke(this,"hcmFilter",this.#z?this.#_.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ke(this,"direction",getComputedStyle(this.#O).direction)}get highlightColors(){return ke(this,"highlightColors",this.#T?new Map(this.#T.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ke(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=e}setMainHighlightColorPicker(e){this.#D=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#y=t;break}}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#O.focus()}findParent(e,t){for(const i of this.#i.values()){const{x:s,y:r,width:o,height:a}=i.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=r&&t<=r+a)return i}return null}disableUserSelect(e=!1){this.#H.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ea.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#U({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#W(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of this.#i.values())if(i.hasTextLayer(e))return i;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}=t,a=t.toString(),c=this.#U(t).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;t.empty();const f=this.#W(c),m=this.#E===Ie.NONE,y=()=>{f?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o,text:a}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Ie.HIGHLIGHT,y);return}y()}#Z(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=this.#U(e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#C||=new gK(this),this.#C.show(i,s,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#M&&(this.#C?.hide(),this.#M=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#M)return;const s=this.#U(e).closest(".textLayer");if(!s){this.#M&&(this.#C?.hide(),this.#M=null,this.#k({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#M=t,this.#k({hasSelectedText:!0}),!(this.#E!==Ie.HIGHLIGHT&&this.#E!==Ie.NONE)&&(this.#E===Ie.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#E===Ie.HIGHLIGHT?this.#W(s):null;r?.toggleDrawing();const o=new AbortController,a=this.combinedSignal(o),l=c=>{c.type==="pointerup"&&c.button!==0||(o.abort(),r?.toggleDrawing(!0),c.type==="pointerup"&&this.#$("main_toolbar"))};window.addEventListener("pointerup",l,{signal:a}),window.addEventListener("blur",l,{signal:a})}}#$(e=""){this.#E===Ie.HIGHLIGHT?this.highlightSelection(e):this.#g&&this.#Z()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#ne(){if(this.#b)return;this.#b=new AbortController;const e=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ie(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#w)if(t.div.contains(e)){this.#R=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[e,t]=this.#R;this.#R=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#K(){if(this.#I)return;this.#I=new AbortController;const e=this.combinedSignal(this.#I);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#se(){this.#I?.abort(),this.#I=null}#Y(){if(this.#u)return;this.#u=new AbortController;const e=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#J(){this.#u?.abort(),this.#u=null}#re(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#K(),this.#Y()}removeEditListeners(){this.#se(),this.#J()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of this.#o)if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of this.#o)if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of this.#w){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of this.#o)if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Ce(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;r.push(c)}const o=()=>{for(const l of r)this.#X(l);this.#Q(r)},a=()=>{for(const l of r)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){Ce(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==Ie.NONE&&!this.isEditorHandlingKeyboard&&Ms._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#k(e){Object.entries(e).some(([i,s])=>this.#q[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#q,e)}),this.#E===Ie.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#B([[Fe.HIGHLIGHT_FREE,!0]]))}#B(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ne(),this.#Y(),this.#k({isEditing:this.#E!==Ie.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ie(),this.#J(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#o){this.#o=e;for(const t of this.#o)this.#B(t.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#i.get(this.#h)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#i.set(e.pageIndex,e),this.#x?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(this.#E!==e&&!(this.#N&&(await this.#N.promise,!this.#N))){if(this.#N=Promise.withResolvers(),this.#E=e,e===Ie.NONE){this.setEditingState(!1),this.#ae(),this._editorUndoBar?.hide(),this.#N.resolve();return}this.setEditingState(!0),await this.#oe(),this.unselectAll();for(const s of this.#i.values())s.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),this.#N.resolve();return}for(const s of this.#n.values())s.annotationElementId===t?(this.setSelected(s),s.enterInEditMode()):s.unselect();this.#N.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#o){switch(e){case Fe.CREATE:this.currentLayer.addNewEditor();return;case Fe.HIGHLIGHT_DEFAULT_COLOR:this.#D?.updateColor(t);break;case Fe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#j||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const i of this.#w)i.updateParams(e,t);for(const i of this.#o)i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const r of this.#n.values())r.editorType===e&&r.show(t);(this.#j?.get(Fe.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#B([[Fe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#S!==e){this.#S=e;for(const t of this.#i.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#oe(){if(!this.#x){this.#x=!0;const e=[];for(const t of this.#i.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#ae(){if(this.unselectAll(),this.#x){this.#x=!1;for(const e of this.#i.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const i of this.#n.values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#n.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#d.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#d.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#d.has(e)}removeDeletedAnnotationElement(e){this.#d.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#X(e){const t=this.#i.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#B(e.propertiesToUpdate))}get#le(){let e=null;for(e of this.#w);return e}updateUI(e){this.#le===e&&this.#B(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#B(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#w.has(e)){this.#w.delete(e),e.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#w.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(e){this.#c?.commitOrRemove();for(const t of this.#w)t!==e&&t.unselect();this.#w.clear(),this.#w.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(e){return this.#w.has(e)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(e){e.unselect(),this.#w.delete(e),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#a.undo(),this.#k({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#a.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#a.add(e),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#a.cleanType(e)}#G(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#w],i=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const r of t)r.remove()},s=()=>{for(const r of t)this.#X(r)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Q(e){for(const t of this.#w)t.unselect();this.#w.clear();for(const t of e)t.isEmpty()||(this.#w.add(t),t.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#w)e.commit();this.#Q(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#E!==Ie.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const e of this.#w)e.unselect();this.#w.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#V[0]+=e,this.#V[1]+=t;const[s,r]=this.#V,o=[...this.#w],a=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#V[0]=this.#V[1]=0,this.addCommands({cmd:()=>{for(const l of o)this.#n.has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of o)this.#n.has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},a);for(const l of o)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#w)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:s,y:r,pageIndex:o},a]of e)a.newX=s,a.newY=r,a.newPageIndex=o,t||=s!==a.savedX||r!==a.savedY||o!==a.savedPageIndex;if(!t)return!1;const i=(s,r,o,a)=>{if(this.#n.has(s.id)){const l=this.#i.get(a);l?s._setParentAndPosition(l,r,o):(s.pageIndex=a,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:a}]of e)i(s,r,o,a)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:a}]of e)i(s,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const i of this.#f.keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#E}get imageManager(){return ke(this,"imageManager",new Oy)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(c,u,f,m)=>({x:(u-s)/o,y:1-(c+f-i)/r,width:m/o,height:f/r});break;case"180":a=(c,u,f,m)=>({x:1-(c+f-i)/r,y:1-(u+m-s)/o,width:f/r,height:m/o});break;case"270":a=(c,u,f,m)=>({x:1-(u+m-s)/o,y:(c-i)/r,width:m/o,height:f/r});break;default:a=(c,u,f,m)=>({x:(c-i)/r,y:(u-s)/o,width:f/r,height:m/o});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const f=t.getRangeAt(c);if(!f.collapsed)for(const{x:m,y,width:v,height:_}of f.getClientRects())v===0||_===0||l.push(a(m,y,v,_))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const i=this.#s.getRawValue(t);i&&(this.#E===Ie.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}}class ri{#e=null;#t=!1;#n=null;#i=null;#r=null;#s=null;#l=!1;#a=null;#u=null;#c=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(e){this.#u=e,this.#d=e._uiManager.useNewAltTextFlow,ri.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){ri._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#i=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",ri.#f.missing),t.setAttribute("data-l10n-id",ri.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#u._uiManager._signal;e.addEventListener("contextmenu",Xn,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#d&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#o}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(this.#l=!0,s(r))},{signal:i}),await this.#p(),e}get#o(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#h=await ri._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){const t=this.#a=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#a.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(this.#c=i,this.#h=s),!(this.#e===e&&this.#t===t)&&(r||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#n&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#o}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#a?.remove(),this.#a=null}async#p(){const e=this.#n;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",ri.#f[this.#o]),this.#i?.setAttribute("data-l10n-id",ri.#f[`${this.#o}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const s=100,r=this.#u._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:r}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:r})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class Sh{#e;#t=!1;#n=null;#i;#r;#s;#l;#a;#u=null;#c;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){this.#e=e,this.#n=i,this.#i=t,this.#r=s,this.#s=r,this.#l=o,this.#c=new AbortController,this.#a=AbortSignal.any([a,this.#c.signal]),e.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#a})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ke(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#d(e){if(this.#i?.()||e.touches.length<2)return;if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#a,this.#h.signal]),r=this.#e,o={signal:s,passive:!1};r.addEventListener("touchmove",this.#f.bind(this),o),r.addEventListener("touchend",this.#o.bind(this),o),r.addEventListener("touchcancel",this.#o.bind(this),o),this.#r?.()}if(Cn(e),e.touches.length!==2||this.#n?.()){this.#u=null;return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),this.#u={touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#f(e){if(!this.#u||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:o,screenY:a}=i,l=this.#u,{touch0X:c,touch0Y:u,touch1X:f,touch1Y:m}=l,y=f-c,v=m-u,_=o-s,x=a-r,T=Math.hypot(_,x)||1,S=Math.hypot(y,v)||1;if(!this.#t&&Math.abs(S-T)<=Sh.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=o,l.touch1Y=a,e.preventDefault(),!this.#t){this.#t=!0;return}const C=[(s+o)/2,(r+a)/2];this.#s?.(C,S,T)}#o(e){this.#h.abort(),this.#h=null,this.#l?.(),this.#u&&(e.preventDefault(),this.#u=null,this.#t=!1)}destroy(){this.#c?.abort(),this.#c=null}}class _e{#e=null;#t=null;#n=null;#i=!1;#r=null;#s="";#l=!1;#a=null;#u=null;#c=null;#h=null;#d="";#f=!1;#o=null;#p=!1;#g=!1;#m=!1;#y=null;#_=0;#v=0;#b=null;#T=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#C=_e._zIndex++;static _borderLineWidth=-1;static _colorManager=new Uy;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=_e.prototype._resizeWithKeyboard,t=Ms.TRANSLATE_SMALL,i=Ms.TRANSLATE_BIG;return ke(this,"_resizerKeyboardManager",new Fc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],_e.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ke(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new wK({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(_e._l10n??=e,_e._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),_e._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);_e._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){We("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(e){this.#A=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#U(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/o,this.fixAndSetPosition()}#P([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#P(this.parentDimensions,e,t)}translateInPage(e,t){this.#o||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#o||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,c]=this.getBaseTranslation();o+=l,a+=c;const{style:u}=i;u.left=`${(100*o).toFixed(2)}%`,u.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#o&&(this.#o[0]!==this.x||this.#o[1]!==this.y)}get _hasBeenResized(){return!!this.#o&&(this.#o[2]!==this.width||this.#o[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=_e,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:o,width:a,height:l}=this;if(a*=i,l*=s,r*=i,o*=s,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(i-a,r)),o=Math.max(0,Math.min(s-l,o));break;case 90:r=Math.max(0,Math.min(i-l,r)),o=Math.min(s,Math.max(a,o));break;case 180:r=Math.min(i,Math.max(a,r)),o=Math.min(s,Math.max(l,o));break;case 270:r=Math.min(i,Math.max(l,r)),o=Math.max(0,Math.min(s-a,o));break}this.x=r/=i,this.y=o/=s;const[c,u]=this.getBaseTranslation();r+=c,o+=u,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#x(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return _e.#x(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return _e.#x(e,t,360-this.parentRotation)}#S(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,this.#l||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!this.#l&&t.endsWith("%");if(s&&r)return;const[o,a]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!this.#l&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#I(){if(this.#a)return;this.#a=document.createElement("div"),this.#a.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");this.#a.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#R.bind(this,i),{signal:t}),s.addEventListener("contextmenu",Xn,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#a)}#R(e,t){t.preventDefault();const{isMac:i}=hn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#u=[t.screenX,t.screenY];const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#E.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Cn,{passive:!1,signal:o}),window.addEventListener("contextmenu",Xn,{signal:o}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,this.#F()};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})}#D(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*i,o*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#c)return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=this.#c;this.#c=null;const r=this.x,o=this.y,a=this.width,l=this.height;r===e&&o===t&&a===i&&l===s||this.addCommands({cmd:this.#D.bind(this,r,o,a,l),undo:this.#D.bind(this,e,t,i,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#E(e,t){const[i,s]=this.parentDimensions,r=this.x,o=this.y,a=this.width,l=this.height,c=_e.MIN_SIZE/i,u=_e.MIN_SIZE/s,f=this.#S(this.rotation),m=(Y,ie)=>[f[0]*Y+f[2]*ie,f[1]*Y+f[3]*ie],y=this.#S(360-this.rotation),v=(Y,ie)=>[y[0]*Y+y[2]*ie,y[1]*Y+y[3]*ie];let _,x,T=!1,S=!1;switch(e){case"topLeft":T=!0,_=(Y,ie)=>[0,0],x=(Y,ie)=>[Y,ie];break;case"topMiddle":_=(Y,ie)=>[Y/2,0],x=(Y,ie)=>[Y/2,ie];break;case"topRight":T=!0,_=(Y,ie)=>[Y,0],x=(Y,ie)=>[0,ie];break;case"middleRight":S=!0,_=(Y,ie)=>[Y,ie/2],x=(Y,ie)=>[0,ie/2];break;case"bottomRight":T=!0,_=(Y,ie)=>[Y,ie],x=(Y,ie)=>[0,0];break;case"bottomMiddle":_=(Y,ie)=>[Y/2,ie],x=(Y,ie)=>[Y/2,0];break;case"bottomLeft":T=!0,_=(Y,ie)=>[0,ie],x=(Y,ie)=>[Y,0];break;case"middleLeft":S=!0,_=(Y,ie)=>[0,ie/2],x=(Y,ie)=>[Y,ie/2];break}const C=_(a,l),D=x(a,l);let F=m(...D);const V=_e._round(r+F[0]),I=_e._round(o+F[1]);let E=1,A=1,N,M;if(t.fromKeyboard)({deltaX:N,deltaY:M}=t);else{const{screenX:Y,screenY:ie}=t,[W,H]=this.#u;[N,M]=this.screenToPageTranslation(Y-W,ie-H),this.#u[0]=Y,this.#u[1]=ie}if([N,M]=v(N/i,M/s),T){const Y=Math.hypot(a,l);E=A=Math.max(Math.min(Math.hypot(D[0]-C[0]-N,D[1]-C[1]-M)/Y,1/a,1/l),c/a,u/l)}else S?E=Math.max(c,Math.min(1,Math.abs(D[0]-C[0]-N)))/a:A=Math.max(u,Math.min(1,Math.abs(D[1]-C[1]-M)))/l;const L=_e._round(a*E),R=_e._round(l*A);F=m(...x(L,R));const G=V-F[0],oe=I-F[1];this.#o||=[this.x,this.y,this.width,this.height],this.width=L,this.height=R,this.x=G,this.y=oe,this.setDims(i*L,s*R),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new Pl(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(ri.initialize(_e._l10n),this.#n=new ri(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#V();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Ed(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new Sh({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#w.bind(this),onPinching:this.#M.bind(this),onPinchEnd:this.#z.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#w(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#M(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const o=this.#S(this.rotation),a=(V,I)=>[o[0]*V+o[2]*I,o[1]*V+o[3]*I],[l,c]=this.parentDimensions,u=this.x,f=this.y,m=this.width,y=this.height,v=_e.MIN_SIZE/l,_=_e.MIN_SIZE/c;r=Math.max(Math.min(r,1/m,1/y),v/m,_/y);const x=_e._round(m*r),T=_e._round(y*r);if(x===m&&T===y)return;this.#o||=[u,f,m,y];const S=a(m/2,y/2),C=_e._round(u+S[0]),D=_e._round(f+S[1]),F=a(x/2,T/2);this.x=C-F[0],this.y=D-F[1],this.width=x,this.height=T,this.setDims(l*x,c*T),this.fixAndSetPosition(),this._onResizing()}#z(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(e){const{isMac:t}=hn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#q(e);return}this.#j(e)}get isSelected(){return this._uiManager.isSelected(this)}#j(e){const{isMac:t}=hn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#q(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:r},a=c=>{s.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#j(c),i&&this._onStopDragging()};t&&(this.#_=e.clientX,this.#v=e.clientY,this.#r=e.pointerId,this.#s=e.pointerType,window.addEventListener("pointermove",c=>{i||(i=!0,this._onStartDragging());const{clientX:u,clientY:f,pointerId:m}=c;if(m!==this.#r){Cn(c);return}const[y,v]=this.screenToPageTranslation(u-this.#_,f-this.#v);this.#_=u,this.#v=f,this._uiManager.dragSelectedEditors(y,v)},o),window.addEventListener("touchmove",Cn,o),window.addEventListener("pointerdown",c=>{c.pointerType===this.#s&&(this.#T||c.isPrimary)&&a(c),Cn(c)},o));const l=c=>{if(!this.#r||this.#r===c.pointerId){a(c);return}Cn(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/s,u=t/s,f=this.x*r,m=this.y*o,y=this.width*r,v=this.height*o;switch(i){case 0:return[f+c+a,o-m-u-v+l,f+c+y+a,o-m-u+l];case 90:return[f+u+a,o-m+c+l,f+u+v+a,o-m+c+y+l];case 180:return[f-c-y+a,o-m+u+l,f-c+a,o-m+u+v+l];case 270:return[f-u-v+a,o-m-c-y+l,f-u+a,o-m-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,o]=e,a=r-i,l=o-s;switch(this.rotation){case 0:return[i,t-o,a,l];case 90:return[i,t-s,l,a];case 180:return[r,t-s,a,l];case 270:return[r,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&s>0&&e<r&&i>0}#V(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#V()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){We("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,s.#e=e.accessibilityData;const[r,o]=s.pageDimensions,[a,l,c,u]=s.getRectInCurrentCoords(e.rect,o);return s.x=a/r,s.y=l/o,s.width=c/r,s.height=u/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#U(),this.removeEditToolbar(),this.#b){for(const e of this.#b.values())clearTimeout(e);this.#b=null}this.parent=null,this.#T?.destroy(),this.#T=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#a.classList.remove("hidden"),Ed(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#a.children;if(!this.#t){this.#t=Array.from(t);const o=this.#L.bind(this),a=this.#O.bind(this),l=this._uiManager._signal;for(const c of this.#t){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",this.#H.bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",_e._l10nResizer[u])}}const i=this.#t[0];let s=0;for(const o of t){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(r!==s){if(r<s)for(let a=0;a<s-r;a++)this.#a.append(this.#a.firstChild);else if(r>s)for(let a=0;a<r-s;a++)this.#a.firstChild.before(this.#a.lastChild);let o=0;for(const a of t){const c=this.#t[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",_e._l10nResizer[c])}}this.#N(0),this.#m=!0,this.#a.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#L(e){_e._resizerKeyboardManager.exec(this,e)}#O(e){this.#m&&e.relatedTarget?.parentNode!==this.#a&&this.#U()}#H(e){this.#d=this.#m?e:""}#N(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#m&&this.#E(this.#d,{deltaX:e,deltaY:t,fromKeyboard:!0})}#U(){this.#m=!1,this.#N(-1),this.#F()}_stopResizingWithKeyboard(){this.#U(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#a?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#b||=new Map;const{action:i}=e;let s=this.#b.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#b.delete(i),this.#b.size===0&&(this.#b=null)},_e._telemetryTimeout),this.#b.set(i,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class wK extends _e{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Z1=3285377520,Mn=4294901760,ii=65535;class TS{constructor(e){this.h1=e?e&4294967295:Z1,this.h2=e?e&4294967295:Z1}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let _=0,x=e.length;_<x;_++){const T=e.charCodeAt(_);T<=255?t[i++]=T:(t[i++]=T>>>8,t[i++]=T&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(t.buffer,0,s);let a=0,l=0,c=this.h1,u=this.h2;const f=3432918353,m=461845907,y=f&ii,v=m&ii;for(let _=0;_<s;_++)_&1?(a=o[_],a=a*f&Mn|a*y&ii,a=a<<15|a>>>17,a=a*m&Mn|a*v&ii,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[_],l=l*f&Mn|l*y&ii,l=l<<15|l>>>17,l=l*m&Mn|l*v&ii,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(a=0,r){case 3:a^=t[s*4+2]<<16;case 2:a^=t[s*4+1]<<8;case 1:a^=t[s*4],a=a*f&Mn|a*y&ii,a=a<<15|a>>>17,a=a*m&Mn|a*v&ii,s&1?c^=a:u^=a}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Mn|e*36045&ii,t=t*4283543511&Mn|((t<<16|e>>>16)*2950163797&Mn)>>>16,e^=t>>>1,e=e*444984403&Mn|e*60499&ii,t=t*3301882366&Mn|((t<<16|e>>>16)*3120437893&Mn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const vm=Object.freeze({map:null,hash:"",transfer:void 0});class By{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=this.#n.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof _e)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=this.#n.get(e);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(t))i[r]!==o&&(s=!0,i[r]=o);else s=!0,this.#n.set(e,t);s&&this.#i(),t instanceof _e&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?My(this.#n):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ES(this)}get serializable(){if(this.#n.size===0)return vm;const e=new Map,t=new TS,i=[],s=Object.create(null);let r=!1;for(const[o,a]of this.#n){const l=a instanceof _e?a.serialize(!1,s):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),r||=!!l.bitmap)}if(r)for(const o of e.values())o.bitmap&&i.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:vm}get editorStats(){let e=null;const t=new Map;for(const i of this.#n.values()){if(!(i instanceof _e))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const o=e[r]||=new Map;for(const[a,l]of Object.entries(s)){if(a==="type")continue;let c=o.get(a);c||(c=new Map,o.set(a,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof _e)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class ES extends By{#e;constructor(e){super();const{map:t,hash:i,transfer:s}=e.serializable,r=structuredClone(t,s?{transfer:s}:null);this.#e={map:r,hash:i,transfer:s}}get print(){We("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return ke(this,"modifiedIds",{ids:new Set,hash:""})}}class _K{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(It(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=e,o=new FontFace(i,s,r);this.addNativeFontFace(o);try{await o.load(),this.#e.add(i),t?.(e)}catch{Ce(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}We("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw Ce(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return ke(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Xt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ke(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(It(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ke(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(D,F){return D.charCodeAt(F)<<24|D.charCodeAt(F+1)<<16|D.charCodeAt(F+2)<<8|D.charCodeAt(F+3)&255}function s(D,F,V,I){const E=D.substring(0,F),A=D.substring(F+V);return E+I+A}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function u(D,F){if(++c>30){Ce("Load test font never loaded."),F();return}if(l.font="30px "+D,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(u.bind(null,D,F))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=s(m,976,f.length,f);const v=16,_=1482184792;let x=i(m,v);for(r=0,o=f.length-3;r<o;r+=4)x=x-_+i(f,r)|0;r<f.length&&(x=x-_+i(f+"XXX",r)|0),m=s(m,v,4,rK(x));const T=`url(data:font/opentype;base64,${btoa(m)});`,S=`@font-face {font-family:"${f}";src:${T}}`;this.insertRule(S);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const D of[e.loadedName,f]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=D,C.append(F)}this._document.body.append(C),u(f,()=>{C.remove(),t.complete()})}}class bK{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${dK(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(o){Ce(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}const wu={DATA:1,ERROR:2},Tt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function eT(){}function gn(n){if(n instanceof Ns||n instanceof gm||n instanceof ac||n instanceof J1||n instanceof Td||n instanceof ep)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||We('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Ns(n.message);case"InvalidPDFException":return new gm(n.message);case"MissingPDFException":return new ac(n.message);case"PasswordException":return new J1(n.message,n.code);case"UnexpectedResponseException":return new Td(n.message,n.status);case"UnknownErrorException":return new ep(n.message,n.details)}return new ep(n.message,n.toString())}class ul{#e=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===wu.DATA)s.resolve(e.data);else if(e.callback===wu.ERROR)s.reject(gn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:wu.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:wu.ERROR,callbackId:e.callbackId,reason:gn(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[r].pullCall=u,l.postMessage({sourceName:o,targetName:a,stream:Tt.PULL,streamId:r,desiredSize:c.desiredSize}),u.promise},cancel:c=>{It(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[r].cancelCall=u,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Tt.CANCEL,streamId:r,reason:gn(c)}),u.promise}},i)}#n(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(c,u=1,f){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=u,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Tt.ENQUEUE,streamId:t,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Tt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){It(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Tt.ERROR,streamId:t,reason:gn(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:Tt.START_COMPLETE,streamId:t,reason:gn(c)})})}#i(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Tt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(gn(e.reason));break;case Tt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(gn(e.reason));break;case Tt.PULL:if(!a){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||eT).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,reason:gn(c)})});break;case Tt.ENQUEUE:if(It(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Tt.CLOSE:if(It(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#r(o,t);break;case Tt.ERROR:It(o,"error should have stream controller"),o.controller.error(gn(e.reason)),this.#r(o,t);break;case Tt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(gn(e.reason)),this.#r(o,t);break;case Tt.CANCEL:if(!a)break;const l=gn(e.reason);Promise.try(a.onCancel||eT,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:Tt.CANCEL_COMPLETE,streamId:t,reason:gn(c)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class AS{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){We("Abstract method `_createCanvas` called.")}}class xK extends AS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class IS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){We("Abstract method `_fetch` called.")}}class CS extends IS{async _fetch(e){const t=await Ih(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Ah(t)}}class SS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}class TK extends SS{#e;#t;#n;#i;#r;#s;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#r=t}get#a(){return this.#t||=new Map}get#u(){return this.#s||=new Map}get#c(){if(!this.#n){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const i=this.#r.createElementNS(Si,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#r.createElementNS(Si,"defs"),e.append(i),i.append(this.#n),this.#r.body.append(e)}return this.#n}#h(e){if(e.length===1){const l=e[0],c=new Array(256);for(let f=0;f<256;f++)c[f]=l[f]/255;const u=c.join(",");return[u,u,u]}const[t,i,s]=e,r=new Array(256),o=new Array(256),a=new Array(256);for(let l=0;l<256;l++)r[l]=t[l]/255,o[l]=i[l]/255,a[l]=s[l]/255;return[r.join(","),o.join(","),a.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(Ch(t)?Ce('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#a.get(e);if(t)return t;const[i,s,r]=this.#h(e),o=e.length===1?i:`${i}${s}${r}`;if(t=this.#a.get(o),t)return this.#a.set(e,t),t;const a=`g_${this.#i}_transfer_map_${this.#l++}`,l=this.#d(a);this.#a.set(e,l),this.#a.set(o,l);const c=this.#p(a);return this.#m(i,s,r,c),l}addHCMFilter(e,t){const i=`${e}-${t}`,s="base";let r=this.#u.get(s);if(r?.key===i||(r?(r.filter?.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},this.#u.set(s,r)),!e||!t))return r.url;const o=this.#_(e);e=me.makeHexColor(...o);const a=this.#_(t);if(t=me.makeHexColor(...a),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return r.url;const l=new Array(256);for(let y=0;y<=255;y++){const v=y/255;l[y]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const c=l.join(","),u=`g_${this.#i}_hcm_filter`,f=r.filter=this.#p(u);this.#m(c,c,c,f),this.#o(f);const m=(y,v)=>{const _=o[y]/255,x=a[y]/255,T=new Array(v+1);for(let S=0;S<=v;S++)T[S]=_+S/v*(x-_);return T.join(",")};return this.#m(m(0,5),m(1,5),m(2,5),f),r.url=this.#d(u),r.url}addAlphaFilter(e){let t=this.#a.get(e);if(t)return t;const[i]=this.#h([e]),s=`alpha_${i}`;if(t=this.#a.get(s),t)return this.#a.set(e,t),t;const r=`g_${this.#i}_alpha_map_${this.#l++}`,o=this.#d(r);this.#a.set(e,o),this.#a.set(s,o);const a=this.#p(r);return this.#y(i,a),o}addLuminosityFilter(e){let t=this.#a.get(e||"luminosity");if(t)return t;let i,s;if(e?([i]=this.#h([e]),s=`luminosity_${i}`):s="luminosity",t=this.#a.get(s),t)return this.#a.set(e,t),t;const r=`g_${this.#i}_luminosity_map_${this.#l++}`,o=this.#d(r);this.#a.set(e,o),this.#a.set(s,o);const a=this.#p(r);return this.#f(a),e&&this.#y(i,a),o}addHighlightHCMFilter(e,t,i,s,r){const o=`${t}-${i}-${s}-${r}`;let a=this.#u.get(e);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#u.set(e,a)),!t||!i))return a.url;const[l,c]=[t,i].map(this.#_.bind(this));let u=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[m,y]=[s,r].map(this.#_.bind(this));f<u&&([u,f,m,y]=[f,u,y,m]),this.#c.style.color="";const v=(T,S,C)=>{const D=new Array(256),F=(f-u)/C,V=T/255,I=(S-T)/(255*C);let E=0;for(let A=0;A<=C;A++){const N=Math.round(u+A*F),M=V+A*I;for(let L=E;L<=N;L++)D[L]=M;E=N+1}for(let A=E;A<256;A++)D[A]=D[E-1];return D.join(",")},_=`g_${this.#i}_hcm_${e}_filter`,x=a.filter=this.#p(_);return this.#o(x),this.#m(v(m[0],y[0],5),v(m[1],y[1],5),v(m[2],y[2],5),x),a.url=this.#d(_),a.url}destroy(e=!1){e&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#l=0)}#f(e){const t=this.#r.createElementNS(Si,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#o(e){const t=this.#r.createElementNS(Si,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#r.createElementNS(Si,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#g(e,t,i){const s=this.#r.createElementNS(Si,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)}#m(e,t,i,s){const r=this.#r.createElementNS(Si,"feComponentTransfer");s.append(r),this.#g(r,"feFuncR",e),this.#g(r,"feFuncG",t),this.#g(r,"feFuncB",i)}#y(e,t){const i=this.#r.createElementNS(Si,"feComponentTransfer");t.append(i),this.#g(i,"feFuncA",e)}#_(e){return this.#c.style.color=e,Vy(getComputedStyle(this.#c).getPropertyValue("color"))}}class PS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){We("Abstract method `_fetch` called.")}}class kS extends PS{async _fetch(e){const t=await Ih(e,"arraybuffer");return new Uint8Array(t)}}Xt&&Ce("Please use the `legacy` build in Node.js environments.");async function RS(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class EK extends SS{}class AK extends AS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class IK extends IS{async _fetch(e){return RS(e)}}class CK extends PS{async _fetch(e){return RS(e)}}const Yt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function wm(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class zy{getPattern(){We("Abstract method `getPattern` called.")}}class SK extends zy{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===Yt.STROKE||s===Yt.FILL){const o=t.current.getClippedPathBoundingBox(s,tt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),i=me.transform(i,[1,0,0,1,o[0],o[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),wm(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),r=e.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else wm(e,this._bbox),r=this._createGradient(e);return r}}function ip(n,e,t,i,s,r,o,a){const l=e.coords,c=e.colors,u=n.data,f=n.width*4;let m;l[t+1]>l[i+1]&&(m=t,t=i,i=m,m=r,r=o,o=m),l[i+1]>l[s+1]&&(m=i,i=s,s=m,m=o,o=a,a=m),l[t+1]>l[i+1]&&(m=t,t=i,i=m,m=r,r=o,o=m);const y=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,_=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY,T=(l[s]+e.offsetX)*e.scaleX,S=(l[s+1]+e.offsetY)*e.scaleY;if(v>=S)return;const C=c[r],D=c[r+1],F=c[r+2],V=c[o],I=c[o+1],E=c[o+2],A=c[a],N=c[a+1],M=c[a+2],L=Math.round(v),R=Math.round(S);let G,oe,Y,ie,W,H,te,re;for(let be=L;be<=R;be++){if(be<x){const ge=be<v?0:(v-be)/(v-x);G=y-(y-_)*ge,oe=C-(C-V)*ge,Y=D-(D-I)*ge,ie=F-(F-E)*ge}else{let ge;be>S?ge=1:x===S?ge=0:ge=(x-be)/(x-S),G=_-(_-T)*ge,oe=V-(V-A)*ge,Y=I-(I-N)*ge,ie=E-(E-M)*ge}let le;be<v?le=0:be>S?le=1:le=(v-be)/(v-S),W=y-(y-T)*le,H=C-(C-A)*le,te=D-(D-N)*le,re=F-(F-M)*le;const ee=Math.round(Math.min(G,W)),ye=Math.round(Math.max(G,W));let Ee=f*be+ee*4;for(let ge=ee;ge<=ye;ge++)le=(G-ge)/(G-W),le<0?le=0:le>1&&(le=1),u[Ee++]=oe-(oe-H)*le|0,u[Ee++]=Y-(Y-te)*le|0,u[Ee++]=ie-(ie-re)*le|0,u[Ee++]=255}}function PK(n,e,t){const i=e.coords,s=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(i.length/a)-1,c=a-1;for(r=0;r<l;r++){let u=r*a;for(let f=0;f<c;f++,u++)ip(n,t,i[u],i[u+1],i[u+a],s[u],s[u+1],s[u+a]),ip(n,t,i[u+a+1],i[u+1],i[u+a],s[u+a+1],s[u+1],s[u+a])}break;case"triangles":for(r=0,o=i.length;r<o;r+=3)ip(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class kK extends zy{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,u=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),y=c/f,v=u/m,_={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/y,scaleY:1/v},x=f+4,T=m+4,S=i.getCanvas("mesh",x,T),C=S.context,D=C.createImageData(f,m);if(t){const V=D.data;for(let I=0,E=V.length;I<E;I+=4)V[I]=t[0],V[I+1]=t[1],V[I+2]=t[2],V[I+3]=255}for(const V of this._figures)PK(D,V,_);return C.putImageData(D,2,2),{canvas:S.canvas,offsetX:a-2*y,offsetY:l-2*v,scaleX:y,scaleY:v}}getPattern(e,t,i,s){wm(e,this._bbox);let r;if(s===Yt.SHADING)r=me.singularValueDecompose2dScale(tt(e));else if(r=me.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=me.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,s===Yt.SHADING?null:this._background,t.cachedCanvases);return s!==Yt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class RK extends zy{getPattern(){return"hotpink"}}function NK(n){switch(n[0]){case"RadialAxial":return new SK(n);case"Mesh":return new kK(n);case"Dummy":return new RK}throw new Error(`Unknown IR type: ${n[0]}`)}const tT={COLORED:1,UNCOLORED:2};class jy{static MAX_PATTERN_SIZE=3e3;constructor(e,t,i,s,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Eh("TilingType: "+r);const u=t[0],f=t[1],m=t[2],y=t[3],v=m-u,_=y-f,x=me.singularValueDecompose2dScale(this.matrix),T=me.singularValueDecompose2dScale(this.baseTransform),S=x[0]*T[0],C=x[1]*T[1];let D=v,F=_,V=!1,I=!1;const E=Math.ceil(l*S),A=Math.ceil(c*C),N=Math.ceil(v*S),M=Math.ceil(_*C);E>=N?D=l:V=!0,A>=M?F=c:I=!0;const L=this.getSizeAndScale(D,this.ctx.canvas.width,S),R=this.getSizeAndScale(F,this.ctx.canvas.height,C),G=e.cachedCanvases.getCanvas("pattern",L.size,R.size),oe=G.context,Y=a.createCanvasGraphics(oe);if(Y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Y,s,o),oe.translate(-L.scale*u,-R.scale*f),Y.transform(L.scale,0,0,R.scale,0,0),oe.save(),this.clipBbox(Y,u,f,m,y),Y.baseTransform=tt(Y.ctx),Y.executeOperatorList(i),Y.endDrawing(),oe.restore(),V||I){const ie=G.canvas;V&&(D=l),I&&(F=c);const W=this.getSizeAndScale(D,this.ctx.canvas.width,S),H=this.getSizeAndScale(F,this.ctx.canvas.height,C),te=W.size,re=H.size,be=e.cachedCanvases.getCanvas("pattern-workaround",te,re),le=be.context,ee=V?Math.floor(v/l):0,ye=I?Math.floor(_/c):0;for(let Ee=0;Ee<=ee;Ee++)for(let ge=0;ge<=ye;ge++)le.drawImage(ie,te*Ee,re*ge,te,re,0,0,te,re);return{canvas:be.canvas,scaleX:W.scale,scaleY:H.scale,offsetX:u,offsetY:f}}return{canvas:G.canvas,scaleX:L.scale,scaleY:R.scale,offsetX:u,offsetY:f}}getSizeAndScale(e,t,i){const s=Math.max(jy.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const o=s-t,a=r-i;e.ctx.rect(t,i,o,a),e.current.updateRectMinMax(tt(e.ctx),[t,i,s,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case tT.COLORED:const o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case tT.UNCOLORED:const a=me.makeHexColor(i[0],i[1],i[2]);s.fillStyle=a,s.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new sK(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,s){let r=i;s!==Yt.SHADING&&(r=me.transform(r,t.baseTransform),this.matrix&&(r=me.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}}function MK({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=hn.isLittleEndian?4278190080:255,[l,c]=o?[r,a]:[a,r],u=i>>3,f=i&7,m=n.length;t=new Uint32Array(t.buffer);let y=0;for(let v=0;v<s;v++){for(const x=e+u;e<x;e++){const T=e<m?n[e]:255;t[y++]=T&128?c:l,t[y++]=T&64?c:l,t[y++]=T&32?c:l,t[y++]=T&16?c:l,t[y++]=T&8?c:l,t[y++]=T&4?c:l,t[y++]=T&2?c:l,t[y++]=T&1?c:l}if(f===0)continue;const _=e<m?n[e++]:255;for(let x=0;x<f;x++)t[y++]=_&1<<7-x?c:l}return{srcPos:e,destPos:y}}const nT=16,iT=100,DK=15,sT=10,rT=1e3,yn=16;function LK(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,o,a,l){e.transform(i,s,r,o,a,l),this.__originalTransform(i,s,r,o,a,l)},n.setTransform=function(i,s,r,o,a,l){e.setTransform(i,s,r,o,a,l),this.__originalSetTransform(i,s,r,o,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,o,a){e.bezierCurveTo(t,i,s,r,o,a),this.__originalBezierCurveTo(t,i,s,r,o,a)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class FK{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function _u(n,e,t,i,s,r,o,a,l,c){const[u,f,m,y,v,_]=tt(n);if(f===0&&m===0){const S=o*u+v,C=Math.round(S),D=a*y+_,F=Math.round(D),V=(o+l)*u+v,I=Math.abs(Math.round(V)-C)||1,E=(a+c)*y+_,A=Math.abs(Math.round(E)-F)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(y),C,F),n.drawImage(e,t,i,s,r,0,0,I,A),n.setTransform(u,f,m,y,v,_),[I,A]}if(u===0&&y===0){const S=a*m+v,C=Math.round(S),D=o*f+_,F=Math.round(D),V=(a+c)*m+v,I=Math.abs(Math.round(V)-C)||1,E=(o+l)*f+_,A=Math.abs(Math.round(E)-F)||1;return n.setTransform(0,Math.sign(f),Math.sign(m),0,C,F),n.drawImage(e,t,i,s,r,0,0,A,I),n.setTransform(u,f,m,y,v,_),[A,I]}n.drawImage(e,t,i,s,r,o,a,l,c);const x=Math.hypot(u,f),T=Math.hypot(m,y);return[x*l,T*c]}function VK(n){const{width:e,height:t}=n;if(e>rT||t>rT)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let o=new Uint8Array(r*(t+1)),a,l,c;const u=e+7&-8;let f=new Uint8Array(u*t),m=0;for(const T of n.data){let S=128;for(;S>0;)f[m++]=T&S?0:255,S>>=1}let y=0;for(m=0,f[m]!==0&&(o[0]=1,++y),l=1;l<e;l++)f[m]!==f[m+1]&&(o[l]=f[m]?2:1,++y),m++;for(f[m]!==0&&(o[l]=2,++y),a=1;a<t;a++){m=a*u,c=a*r,f[m-u]!==f[m]&&(o[c]=f[m]?1:8,++y);let T=(f[m]?4:0)+(f[m-u]?8:0);for(l=1;l<e;l++)T=(T>>2)+(f[m+1]?4:0)+(f[m-u+1]?8:0),s[T]&&(o[c+l]=s[T],++y),m++;if(f[m-u]!==f[m]&&(o[c+l]=f[m]?2:4,++y),y>i)return null}for(m=u*(t-1),c=a*r,f[m]!==0&&(o[c]=8,++y),l=1;l<e;l++)f[m]!==f[m+1]&&(o[c+l]=f[m]?4:8,++y),m++;if(f[m]!==0&&(o[c+l]=4,++y),y>i)return null;const v=new Int32Array([0,r,-1,0,-r,0,0,0,1]),_=new Path2D;for(a=0;y&&a<=t;a++){let T=a*r;const S=T+e;for(;T<S&&!o[T];)T++;if(T===S)continue;_.moveTo(T%r,a);const C=T;let D=o[T];do{const F=v[D];do T+=F;while(!o[T]);const V=o[T];V!==5&&V!==10?(D=V,o[T]=0):(D=V&51*D>>4,o[T]&=D>>2|D<<2),_.lineTo(T%r,T/r|0),o[T]||--y}while(C!==T);--a}return f=null,o=null,function(T){T.save(),T.scale(1/e,-1/t),T.translate(0,-t),T.fill(_),T.beginPath(),T.restore()}}class oT{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_S,this.textMatrixScale=1,this.fontMatrix=mm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Wt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=me.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=me.applyTransform(t,e),s=me.applyTransform(t.slice(2),e),r=me.applyTransform([t[0],t[3]],e),o=me.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],r[0],o[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],o[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],o[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],o[1])}updateScalingPathMinMax(e,t){me.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,r,o,a,l,c,u){const f=me.bezierBoundingBox(t,i,s,r,o,a,l,c,u);u||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Yt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Yt.STROKE){t||We("Stroke bounding box must include transform.");const s=me.singularValueDecompose2dScale(t),r=s[0]*this.lineWidth/2,o=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=o,i[2]+=r,i[3]+=o}return i}updateClipFromPath(){const e=me.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Yt.FILL,t=null){return me.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function aT(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%yn,r=(t-s)/yn,o=s===0?r:r+1,a=n.createImageData(i,yn);let l=0,c;const u=e.data,f=a.data;let m,y,v,_;if(e.kind===zu.GRAYSCALE_1BPP){const x=u.byteLength,T=new Uint32Array(f.buffer,0,f.byteLength>>2),S=T.length,C=i+7>>3,D=4294967295,F=hn.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(v=m<r?yn:s,c=0,y=0;y<v;y++){const V=x-l;let I=0;const E=V>C?i:V*8-7,A=E&-8;let N=0,M=0;for(;I<A;I+=8)M=u[l++],T[c++]=M&128?D:F,T[c++]=M&64?D:F,T[c++]=M&32?D:F,T[c++]=M&16?D:F,T[c++]=M&8?D:F,T[c++]=M&4?D:F,T[c++]=M&2?D:F,T[c++]=M&1?D:F;for(;I<E;I++)N===0&&(M=u[l++],N=128),T[c++]=M&N?D:F,N>>=1}for(;c<S;)T[c++]=0;n.putImageData(a,0,m*yn)}}else if(e.kind===zu.RGBA_32BPP){for(y=0,_=i*yn*4,m=0;m<r;m++)f.set(u.subarray(l,l+_)),l+=_,n.putImageData(a,0,y),y+=yn;m<o&&(_=i*s*4,f.set(u.subarray(l,l+_)),n.putImageData(a,0,y))}else if(e.kind===zu.RGB_24BPP)for(v=yn,_=i*v,m=0;m<o;m++){for(m>=r&&(v=s,_=i*v),c=0,y=_;y--;)f[c++]=u[l++],f[c++]=u[l++],f[c++]=u[l++],f[c++]=255;n.putImageData(a,0,m*yn)}else throw new Error(`bad image kind: ${e.kind}`)}function lT(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%yn,r=(t-s)/yn,o=s===0?r:r+1,a=n.createImageData(i,yn);let l=0;const c=e.data,u=a.data;for(let f=0;f<o;f++){const m=f<r?yn:s;({srcPos:l}=MK({src:c,srcPos:l,dest:u,width:i,height:m,nonBlackColor:0})),n.putImageData(a,0,f*yn)}}function Qa(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function bu(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Xt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function cT(n,e){if(e)return!0;const t=me.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ea.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const OK=["butt","round","square"],UK=["miter","round","bevel"],BK={},uT={};class Po{constructor(e,t,i,s,r,{optionalContentConfig:o,markedContentStack:a=null},l,c){this.ctx=e,this.current=new oT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new FK(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const l=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...tt(this.compositeCtx))}this.ctx.save(),bu(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=tt(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const c=l-a>sT&&typeof i=="function",u=c?Date.now()+DK:0;let f=0;const m=this.commonObjs,y=this.objs;let v;for(;;){if(s!==void 0&&a===s.nextBreakPoint)return s.breakIt(a,i),a;if(v=o[a],v!==Hn.dependency)this[v].apply(this,r[a]);else for(const _ of r[a]){const x=_.startsWith("g_")?m:y;if(!x.has(_))return x.get(_,i),a}if(a++,a===l)return a;if(c&&++f>sT){if(Date.now()>u)return i(),a;f=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=i,l=s,c="prescale1",u,f;for(;r>2&&a>1||o>2&&l>1;){let m=a,y=l;r>2&&a>1&&(m=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/m),o>2&&l>1&&(y=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/y),u=this.cachedCanvases.getCanvas(c,m,y),f=u.context,f.clearRect(0,0,m,y),f.drawImage(e,0,0,a,l,0,0,m,y),e=u.canvas,a=m,l=y,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,o=this.current.patternFill,a=tt(t);let l,c,u,f;if((e.bitmap||e.data)&&e.count>1){const E=e.bitmap||e.data.buffer;c=JSON.stringify(o?a:[a.slice(0,4),r]),l=this._cachedBitmapsMap.get(E),l||(l=new Map,this._cachedBitmapsMap.set(E,l));const A=l.get(c);if(A&&!o){const N=Math.round(Math.min(a[0],a[2])+a[4]),M=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:A,offsetX:N,offsetY:M}}u=A}u||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),lT(f.context,e));let m=me.transform(a,[1/i,0,0,-1/s,0,0]);m=me.transform(m,[1,0,0,1,0,-s]);const[y,v,_,x]=me.getAxialAlignedBoundingBox([0,0,i,s],m),T=Math.round(_-y)||1,S=Math.round(x-v)||1,C=this.cachedCanvases.getCanvas("fillCanvas",T,S),D=C.context,F=y,V=v;D.translate(-F,-V),D.transform(...m),u||(u=this._scaleImage(f.canvas,ni(D)),u=u.img,l&&o&&l.set(c,u)),D.imageSmoothingEnabled=cT(tt(D),e.interpolate),_u(D,u,0,0,u.width,u.height,0,0,i,s),D.globalCompositeOperation="source-in";const I=me.transform(ni(D),[1,0,0,1,-F,-V]);return D.fillStyle=o?r.getPattern(t,this,I,Yt.FILL):r,D.fillRect(0,0,i,s),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,C.canvas)),{canvas:C.canvas,offsetX:Math.round(F),offsetY:Math.round(V)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=OK[e]}setLineJoin(e){this.ctx.lineJoin=UK[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...tt(this.suspendedCtx)),Qa(this.suspendedCtx,r),LK(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qa(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],o=s[1],a=s[2]-r,l=s[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,i,a,l,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,o,a,l,c,u,f){let m=e.canvas,y=l-u,v=c-f;if(o){const x=me.makeHexColor(...o);if(y<0||v<0||y+i>m.width||v+s>m.height){const T=this.cachedCanvases.getCanvas("maskExtension",i,s),S=T.context;S.drawImage(m,-y,-v),S.globalCompositeOperation="destination-atop",S.fillStyle=x,S.fillRect(0,0,i,s),S.globalCompositeOperation="source-over",m=T.canvas,y=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(y,v,i,s),e.clip(T),e.globalCompositeOperation="destination-atop",e.fillStyle=x,e.fillRect(y,v,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const _=new Path2D;_.rect(l,c,i,s),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(m,y,v,i,s,l,c,i,s),t.restore()}save(){this.inSMaskMode?(Qa(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Qa(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,r,o){this.ctx.transform(e,t,i,s,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const s=this.ctx,r=this.current;let o=r.x,a=r.y,l,c;const u=tt(s),f=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,m=f?i.slice(0):null;for(let y=0,v=0,_=e.length;y<_;y++)switch(e[y]|0){case Hn.rectangle:o=t[v++],a=t[v++];const x=t[v++],T=t[v++],S=o+x,C=a+T;s.moveTo(o,a),x===0||T===0?s.lineTo(S,C):(s.lineTo(S,a),s.lineTo(S,C),s.lineTo(o,C)),f||r.updateRectMinMax(u,[o,a,S,C]),s.closePath();break;case Hn.moveTo:o=t[v++],a=t[v++],s.moveTo(o,a),f||r.updatePathMinMax(u,o,a);break;case Hn.lineTo:o=t[v++],a=t[v++],s.lineTo(o,a),f||r.updatePathMinMax(u,o,a);break;case Hn.curveTo:l=o,c=a,o=t[v+4],a=t[v+5],s.bezierCurveTo(t[v],t[v+1],t[v+2],t[v+3],o,a),r.updateCurvePathMinMax(u,l,c,t[v],t[v+1],t[v+2],t[v+3],o,a,m),v+=6;break;case Hn.curveTo2:l=o,c=a,s.bezierCurveTo(o,a,t[v],t[v+1],t[v+2],t[v+3]),r.updateCurvePathMinMax(u,l,c,o,a,t[v],t[v+1],t[v+2],t[v+3],m),o=t[v+2],a=t[v+3],v+=4;break;case Hn.curveTo3:l=o,c=a,o=t[v+2],a=t[v+3],s.bezierCurveTo(t[v],t[v+1],o,a,o,a),r.updateCurvePathMinMax(u,l,c,t[v],t[v+1],o,a,o,a,m),v+=4;break;case Hn.closePath:s.closePath();break}f&&r.updateScalingPathMinMax(u,m),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,ni(t),Yt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,ni(t),Yt.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=BK}eoClip(){this.pendingClip=uT}beginText(){this.current.textMatrix=_S,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:l,path:c}of e)i.addPath(c,new DOMMatrix(r).preMultiplySelf(s).translate(o,a).scale(l,-l));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||mm,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ce("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",o=i.systemFontInfo?.css||`"${r}", ${i.fallbackName}`;let a="normal";i.black?a="900":i.bold&&(a="bold");const l=i.italic?"italic":"normal";let c=t;t<nT?c=nT:t>iT&&(c=iT),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${a} ${c}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,r,o){this.current.textMatrix=[e,t,i,s,r,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s}paintChar(e,t,i,s,r){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,f=c&Wt.FILL_STROKE_MASK,m=!!(c&Wt.ADD_TO_PATH_FLAG),y=a.patternFill&&!l.missingFile,v=a.patternStroke&&!l.missingFile;let _;if((l.disableFontFace||m||y||v)&&(_=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||y||v){if(o.save(),o.translate(t,i),o.scale(u,-u),f===Wt.FILL||f===Wt.FILL_STROKE)if(s){const x=o.getTransform();o.setTransform(...s),o.fill(this.#n(_,x,s))}else o.fill(_);if(f===Wt.STROKE||f===Wt.FILL_STROKE)if(r){const x=o.getTransform();o.setTransform(...r),o.stroke(this.#n(_,x,r))}else o.lineWidth/=u,o.stroke(_);o.restore()}else(f===Wt.FILL||f===Wt.FILL_STROKE)&&o.fillText(e,t,i),(f===Wt.STROKE||f===Wt.FILL_STROKE)&&o.strokeText(e,t,i);m&&(this.pendingTextPaths||=[]).push({transform:tt(o),x:t,y:i,fontSize:u,path:_})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return ke(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,f=e.length,m=i.vertical,y=m?1:-1,v=i.defaultVMetrics,_=s*t.fontMatrix[0],x=t.textRenderingMode===Wt.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(u,-1):r.scale(u,1);let T,S;if(t.patternFill){r.save();const I=t.fillColor.getPattern(r,this,ni(r),Yt.FILL);T=tt(r),r.restore(),r.fillStyle=I}if(t.patternStroke){r.save();const I=t.strokeColor.getPattern(r,this,ni(r),Yt.STROKE);S=tt(r),r.restore(),r.strokeStyle=I}let C=t.lineWidth;const D=t.textMatrixScale;if(D===0||C===0){const I=t.textRenderingMode&Wt.FILL_STROKE_MASK;(I===Wt.STROKE||I===Wt.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=D;if(o!==1&&(r.scale(o,o),C/=o),r.lineWidth=C,i.isInvalidPDFjsFont){const I=[];let E=0;for(const A of e)I.push(A.unicode),E+=A.width;r.fillText(I.join(""),0,0),t.x+=E*_*u,r.restore(),this.compose();return}let F=0,V;for(V=0;V<f;++V){const I=e[V];if(typeof I=="number"){F+=y*I*s/1e3;continue}let E=!1;const A=(I.isSpace?l:0)+a,N=I.fontChar,M=I.accent;let L,R,G=I.width;if(m){const Y=I.vmetric||v,ie=-(I.vmetric?Y[1]:G*.5)*_,W=Y[2]*_;G=Y?-Y[0]:G,L=ie/o,R=(F+W)/o}else L=F/o,R=0;if(i.remeasure&&G>0){const Y=r.measureText(N).width*1e3/s*o;if(G<Y&&this.isFontSubpixelAAEnabled){const ie=G/Y;E=!0,r.save(),r.scale(ie,1),L/=ie}else G!==Y&&(L+=(G-Y)/2e3*s/o)}if(this.contentVisible&&(I.isInFont||i.missingFile)){if(x&&!M)r.fillText(N,L,R);else if(this.paintChar(N,L,R,T,S),M){const Y=L+s*M.offset.x/o,ie=R-s*M.offset.y/o;this.paintChar(M.fontChar,Y,ie,T,S)}}const oe=m?G*_-A*c:G*_+A*c;F+=oe,E&&r.restore()}m?t.y-=F:t.x+=F*u,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,o=i.fontDirection,a=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,u=i.textHScale*o,f=i.fontMatrix||mm,m=e.length,y=i.textRenderingMode===Wt.INVISIBLE;let v,_,x,T;if(!(y||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(u,o),v=0;v<m;++v){if(_=e[v],typeof _=="number"){T=a*_*r/1e3,this.ctx.translate(T,0),i.x+=T*u;continue}const S=(_.isSpace?c:0)+l,C=s.charProcOperatorList[_.operatorListId];if(!C){Ce(`Type3 character "${_.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=_,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(C),this.restore()),x=me.applyTransform([_.width,0],f)[0]*r+S,t.translate(x,0),i.x+=x*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,o){this.ctx.rect(i,s,r-i,o-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],s=this.baseTransform||tt(this.ctx),r={createCanvasGraphics:o=>new Po(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new jy(e,i,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=me.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=me.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=NK(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,ni(t),Yt.SHADING);const s=ni(t);if(s){const{width:r,height:o}=t.canvas,[a,l,c,u]=me.getAxialAlignedBoundingBox([0,0,r,o],s);this.ctx.fillRect(a,l,c-a,u-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){We("Should not call beginInlineImage")}beginImageData(){We("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=tt(this.ctx),t)){const i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(tt(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Eh("TODO: Support non-isolated groups."),e.knockout&&Ce("Knockout groups not supported.");const i=tt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=me.getAxialAlignedBoundingBox(e.bbox,tt(t));const r=[0,0,t.canvas.width,t.canvas.height];s=me.intersect(s,r)||[0,0,0,0];const o=Math.floor(s[0]),a=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-o,1),c=Math.max(Math.ceil(s[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(u,l,c),m=f.context;m.translate(-o,-a),m.transform(...i),e.smask?this.smaskStack.push({canvas:f.canvas,context:m,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),Qa(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=tt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=me.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(this.#e(),bu(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;const[l,c]=me.singularValueDecompose2dScale(tt(this.ctx)),{viewportScale:u}=this,f=Math.ceil(o*this.outputScaleX*u),m=Math.ceil(a*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,m);const{canvas:y,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),bu(this.ctx)}else bu(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new oT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=VK(e)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(e),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=tt(a);a.transform(t,i,s,r,0,0);const c=this._createMaskCanvas(e);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,f=o.length;u<f;u+=2){const m=me.transform(l,[t,i,s,r,o[u],o[u+1]]),[y,v]=me.applyTransform([0,0],m);a.drawImage(c.canvas,y,v)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:o,width:a,height:l,transform:c}=r,u=this.cachedCanvases.getCanvas("maskCanvas",a,l),f=u.context;f.save();const m=this.getObject(o,r);lT(f,m),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,ni(t),Yt.FILL):i,f.fillRect(0,0,a,l),f.restore(),t.save(),t.transform(...c),t.scale(1,-1),_u(t,u.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ce("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){Ce("Dependent image isn't ready yet");return}const o=r.width,a=r.height,l=[];for(let c=0,u=s.length;c<u;c+=2)l.push({transform:[t,0,0,i,s[c],s[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;if(this.save(),!Xt){const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none")}s.scale(1/t,-1/i);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;aT(l,e),r=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(r,ni(s));s.imageSmoothingEnabled=cT(tt(s),e.interpolate),_u(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,o).context;aT(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),_u(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===uT?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=tt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let o,a;if(i===0&&s===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)o=a=1/l;else{const u=l*e;o=a=u<1?1/u:1}else if(e===0)o=1/l,a=1/c;else{const u=l*e,f=c*e;o=u<1?1/u:1,a=f<1?1/f:1}}else{const l=Math.abs(t*r-i*s),c=Math.hypot(t,i),u=Math.hypot(s,r);if(e===0)o=u/l,a=c/l;else{const f=e*l;o=u>f?u/f:1,a=c>f?c/f:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&r===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(s,r),o.length>0){const a=Math.max(s,r);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in Hn)Po.prototype[n]!==void 0&&(Po.prototype[Hn[n]]=Po.prototype[n]);class kl{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class zK{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return My(this.#e)}has(e){return this.#e.has(e)}}const mo=Symbol("INTERNAL");class jK{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){this.#e=!!(e&En.DISPLAY),this.#t=!!(e&En.PRINT),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==mo&&We("Internal method `_setVisible` called."),this.#n=i,this.#i=t}}class qK{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=En.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(const i of e.groups)this.#t.set(i.id,new jK(t,i));if(e.baseState==="OFF")for(const i of this.#t.values())i._setVisible(mo,!1);for(const i of e.on)this.#t.get(i)._setVisible(mo,!0);for(const i of e.off)this.#t.get(i)._setVisible(mo,!1);this.#n=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let o;if(Array.isArray(r))o=this.#r(r);else if(this.#t.has(r))o=this.#t.get(r).visible;else return Ce(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Eh("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ce(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ce(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ce(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ce(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ce(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ce(`Unknown optional content policy ${e.policy}.`),!0}return Ce(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const s=this.#t.get(e);if(!s){Ce(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const r of s.rbGroups)for(const o of r)o!==e&&this.#t.get(o)?._setVisible(mo,!1,!0);s._setVisible(mo,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=this.#t.get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?My(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new TS;for(const[t,i]of this.#t)e.update(`${t}:${i.visible}`);return this.#e=e.hexdigest()}}class HK{constructor(e,{disableRange:t=!1,disableStream:i=!1}){It(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,r?.length>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});It(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){It(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new GK(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new $K(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class GK{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=Fy(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class $K{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function WK(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let u=a(t);return u=unescape(u),u=l(u),u=c(u),r(u)}if(t=o(n),t){const u=c(t);return r(u)}if(t=i("filename","i").exec(n),t){t=t[1];let u=a(t);return u=c(u),r(u)}function i(u,f){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(u,f){if(u){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const m=new TextDecoder(u,{fatal:!0}),y=Ah(f);f=m.decode(y),e=!1}catch{}}return f}function r(u){return e&&/[\x80-\xff]/.test(u)&&(u=s("utf-8",u),e&&(u=s("iso-8859-1",u))),u}function o(u){const f=[];let m;const y=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=y.exec(u))!==null;){let[,_,x,T]=m;if(_=parseInt(_,10),_ in f){if(_===0)break;continue}f[_]=[x,T]}const v=[];for(let _=0;_<f.length&&_ in f;++_){let[x,T]=f[_];T=a(T),x&&(T=unescape(T),_===0&&(T=l(T))),v.push(T)}return v.join("")}function a(u){if(u.startsWith('"')){const f=u.slice(1).split('\\"');for(let m=0;m<f.length;++m){const y=f[m].indexOf('"');y!==-1&&(f[m]=f[m].slice(0,y),f.length=m+1),f[m]=f[m].replaceAll(/\\(.)/g,"$1")}u=f.join('"')}return u}function l(u){const f=u.indexOf("'");if(f===-1)return u;const m=u.slice(0,f),v=u.slice(f+1).replace(/^[^']*'/,"");return s(m,v)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,m,y,v){if(y==="q"||y==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,x){return String.fromCharCode(parseInt(x,16))}),s(m,v);try{v=atob(v)}catch{}return s(m,v)})}return""}function NS(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Ph(n){try{return new URL(n).origin}catch{}return null}function MS({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function DS(n){const e=n.get("Content-Disposition");if(e){let t=WK(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Fy(t))return t}return null}function kh(n,e){return n===404||n===0&&e.startsWith("file:")?new ac('Missing PDF "'+e+'".'):new Td(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function LS(n){return n===200||n===206}function FS(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function VS(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ce(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class dT{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=NS(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return It(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new KK(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new YK(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class KK{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,FS(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Ph(r.url),!LS(r.status))throw kh(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:l}=MS({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=DS(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ns("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:VS(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class YK{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const o=s.url;fetch(o,FS(r,this._withCredentials,this._abortController)).then(a=>{const l=Ph(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!LS(a.status))throw kh(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:VS(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const sp=200,rp=206;function JK(n){const e=n.response;return typeof e!="string"?e:Ah(e).buffer}class XK{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=NS(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=rp):s.expectedStatus=sp,t.responseType="arraybuffer",It(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||sp;if(!(r===sp&&i.expectedStatus===rp)&&r!==i.expectedStatus){i.onError(s.status);return}const a=JK(s);if(r===rp){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?i.onDone({begin:parseInt(c[1],10),chunk:a}):(Ce('Missing or invalid "Content-Range" header.'),i.onError(0))}else a?i.onDone({begin:0,chunk:a}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class QK{constructor(e){this._source=e,this._manager=new XK(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return It(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ZK(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new eY(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class ZK{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ph(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...c]=a.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=MS({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=DS(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=kh(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class eY{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Ph(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=kh(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const tY=/^[a-z][a-z0-9\-+.]+:/i;function nY(n){if(tY.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class iY{constructor(e){this.source=e,this.url=nY(e.url),It(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return It(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new sY(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new rY(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class sY{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new ac(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ns("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class rY{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const oY=1e5,mn=30,aY=.8;class an{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#l=0;#a=0;#u=null;#c=null;#h=0;#d=0;#f=Object.create(null);#o=[];#p=null;#g=[];#m=new WeakMap;#y=null;static#_=new Map;static#v=new Map;static#b=new WeakMap;static#T=null;static#A=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#d=i.scale*(globalThis.devicePixelRatio||1),this.#h=i.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:r,pageX:o,pageY:a}=i.rawDims;this.#y=[1,0,0,-1,-o,a+r],this.#a=s,this.#l=r,an.#R(),Dr(t,i),this.#e.promise.finally(()=>{an.#A.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=hn.platform;return ke(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:i})=>{if(i){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#f,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#u=this.#p.getReader(),an.#A.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==this.#h&&(t?.(),this.#h=s,Dr(this.#c,{rotation:s})),i!==this.#d){t?.(),this.#d=i;const r={div:null,properties:null,ctx:an.#S(this.#r)};for(const o of this.#g)r.properties=this.#m.get(o),r.div=o,this.#x(r)}}cancel(){const e=new Ns("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#o}#C(e){if(this.#n)return;this.#s.ctx??=an.#S(this.#r);const t=this.#g,i=this.#o;for(const s of e){if(t.length>oY){Ce("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const r=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id!==null&&this.#t.setAttribute("id",`${s.id}`),r.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}i.push(s.str),this.#P(s)}}#P(e){const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);const s=me.transform(this.#y,e.transform);let r=Math.atan2(s[1],s[0]);const o=this.#f[e.fontName];o.vertical&&(r+=Math.PI/2);let a=this.#i&&o.fontSubstitution||o.fontFamily;a=an.fontFamilyMap.get(a)||a;const l=Math.hypot(s[2],s[3]),c=l*an.#D(a,this.#r);let u,f;r===0?(u=s[4],f=s[5]-c):(u=s[4]+c*Math.sin(r),f=s[5]-c*Math.cos(r));const m="calc(var(--scale-factor)*",y=t.style;this.#t===this.#c?(y.left=`${(100*u/this.#a).toFixed(2)}%`,y.top=`${(100*f/this.#l).toFixed(2)}%`):(y.left=`${m}${u.toFixed(2)}px)`,y.top=`${m}${f.toFixed(2)}px)`),y.fontSize=`${m}${(an.#T*l).toFixed(2)}px)`,y.fontFamily=a,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);_!==x&&Math.max(_,x)/Math.min(_,x)>1.5&&(v=!0)}if(v&&(i.canvasWidth=o.vertical?e.height:e.width),this.#m.set(t,i),this.#s.div=t,this.#s.properties=i,this.#x(this.#s),i.hasText&&this.#t.append(t),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#t.append(_)}}#x(e){const{div:t,properties:i,ctx:s}=e,{style:r}=t;let o="";if(an.#T>1&&(o=`scale(${1/an.#T})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:a}=r,{canvasWidth:l,fontSize:c}=i;an.#I(s,c*this.#d,a);const{width:u}=s.measureText(t.textContent);u>0&&(o=`scaleX(${l*this.#d/u}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(r.transform=o)}static cleanup(){if(!(this.#A.size>0)){this.#_.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#S(e=null){let t=this.#v.get(e||="");if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#b.set(t,{size:0,family:""})}return t}static#I(e,t,i){const s=this.#b.get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)}static#R(){if(this.#T!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#T=e.getBoundingClientRect().height,e.remove()}static#D(e,t){const i=this.#_.get(e);if(i)return i;const s=this.#S(t);s.canvas.width=s.canvas.height=mn,this.#I(s,mn,e);const r=s.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const u=o/(o+a);return this.#_.set(e,u),s.canvas.width=s.canvas.height=0,u}s.strokeStyle="red",s.clearRect(0,0,mn,mn),s.strokeText("g",0,0);let l=s.getImageData(0,0,mn,mn).data;a=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){a=Math.ceil(u/4/mn);break}s.clearRect(0,0,mn,mn),s.strokeText("A",0,mn),l=s.getImageData(0,0,mn,mn).data,o=0;for(let u=0,f=l.length;u<f;u+=4)if(l[u]>0){o=mn-Math.floor(u/4/mn);break}s.canvas.width=s.canvas.height=0;const c=o?o/(o+a):aY;return this.#_.set(e,c),c}}class lc{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(lc.shouldBuildText(a))r?.attributes?.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const l of r.children)s(l)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const lY=65536,cY=100,uY=5e3,dY=Xt?AK:xK,hY=Xt?IK:CS,fY=Xt?EK:TK,pY=Xt?CK:kS;function mY(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new qy,{docId:t}=e,i=n.url?gY(n.url):null,s=n.data?yY(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof OS?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:lY;let u=n.worker instanceof Dt?n.worker:null;const f=n.verbosity,m=typeof n.docBaseUrl=="string"&&!Ch(n.docBaseUrl)?n.docBaseUrl:null,y=typeof n.cMapUrl=="string"?n.cMapUrl:null,v=n.cMapPacked!==!1,_=n.CMapReaderFactory||hY,x=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,T=n.StandardFontDataFactory||pY,S=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,D=n.isEvalSupported!==!1,F=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Xt,V=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Xt&&(hn.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,E=typeof n.disableFontFace=="boolean"?n.disableFontFace:Xt,A=n.fontExtraProperties===!0,N=n.enableXfa===!0,M=n.ownerDocument||globalThis.document,L=n.disableRange===!0,R=n.disableStream===!0,G=n.disableAutoFetch===!0,oe=n.pdfBug===!0,Y=n.CanvasFactory||dY,ie=n.FilterFactory||fY,W=n.enableHWA===!0,H=l?l.length:n.length??NaN,te=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Xt&&!E,re=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:_===CS&&T===kS&&y&&x&&cl(y,document.baseURI)&&cl(x,document.baseURI),be=null;eK(f);const le={canvasFactory:new Y({ownerDocument:M,enableHWA:W}),filterFactory:new ie({docId:t,ownerDocument:M}),cMapReaderFactory:re?null:new _({baseUrl:y,isCompressed:v}),standardFontDataFactory:re?null:new T({baseUrl:x})};if(!u){const Ee={verbosity:f,port:kl.workerPort};u=Ee.port?Dt.fromPort(Ee):new Dt(Ee),e._worker=u}const ee={docId:t,apiVersion:"4.10.38",data:s,password:a,disableAutoFetch:G,rangeChunkSize:c,length:H,docBaseUrl:m,enableXfa:N,evaluatorOptions:{maxImageSize:C,disableFontFace:E,ignoreErrors:S,isEvalSupported:D,isOffscreenCanvasSupported:F,isImageDecoderSupported:V,canvasMaxAreaInBytes:I,fontExtraProperties:A,useSystemFonts:te,cMapUrl:re?y:null,standardFontDataUrl:re?x:null}},ye={disableFontFace:E,fontExtraProperties:A,ownerDocument:M,pdfBug:oe,styleElement:be,loadingParams:{disableAutoFetch:G,enableXfa:N}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ee=u.messageHandler.sendWithPromise("GetDocRequest",ee,s?[s.buffer]:null);let ge;if(l)ge=new HK(l,{disableRange:L,disableStream:R});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Se;if(Xt)if(cl(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Se=dT}else Se=iY;else Se=cl(i)?dT:QK;ge=new Se({url:i,length:H,httpHeaders:r,withCredentials:o,rangeChunkSize:c,disableRange:L,disableStream:R})}return Ee.then(Se=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const pe=new ul(t,Se,u.port),mt=new bY(pe,e,ge,ye,le);e._transport=mt,pe.send("Ready",null)})}).catch(e._capability.reject),e}function gY(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Xt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function yY(n){if(Xt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Ah(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hT(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}class qy{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${qy.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class OS{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){We("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class vY{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ke(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class wY{#e=null;#t=!1;constructor(e,t,i,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new Q1:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new US,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new Lc({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ke(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=ls.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:f=!1}){this._stats?.time("Overall");const m=this._transport.getRenderingIntent(i,s,u,f),{renderingIntent:y,cacheKey:v}=m;this.#t=!1,this.#i(),a||=this._transport.getOptionalContentConfig(y);let _=this._intentStates.get(v);_||(_=Object.create(null),this._intentStates.set(v,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const x=!!(y&En.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const T=D=>{_.renderTasks.delete(S),(this._maybeCleanupAfterRender||x)&&(this.#t=!0),this.#n(!x),D?(S.capability.reject(D),this._abortOperatorList({intentState:_,reason:D instanceof Error?D:new Error(D)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new vo({callback:T,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c});(_.renderTasks||=new Set).add(S);const C=S.task;return Promise.all([_.displayReadyCapability.promise,a]).then(([D,F])=>{if(this.destroyed){T();return}if(this._stats?.time("Rendering"),!(F.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:D,optionalContentConfig:F}),S.operatorListChanged()}).catch(T),C}getOperatorList({intent:e="display",annotationMode:t=ls.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,i,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>lc.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){o.read().then(function({value:l,done:c}){if(c){i(a);return}a.lang??=l.lang,Object.assign(a.styles,l.styles),a.items.push(...l.items),r()},s)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#n(!1);return e&&t&&(this._stats&&=new Q1),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},uY),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},o).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:f,done:m})=>{if(m){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),u())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const m of c.renderTasks)m.operatorListChanged();this.#n(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};u()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Ly){let s=cY;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Ns(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}class _Y{#e=new Map;#t=Promise.resolve();postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if(i?.signal instanceof AbortSignal){const{signal:r}=i;if(r.aborted){Ce("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}class Dt{static#e=0;static#t=!1;static#n;static{Xt&&(this.#t=!0,kl.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(t,i);return i.origin===s.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:i=tK()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Dt.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(Dt.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}#i(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new ul("main","worker",e),this._messageHandler.on("ready",function(){}),this.#i()}_initialize(){if(Dt.#t||Dt.#r){this._setupFakeWorker();return}let{workerSrc:e}=Dt;try{Dt._isSameOrigin(window.location.href,e)||(e=Dt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new ul("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",a=>{if(r.abort(),this.destroyed||!a){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,this.#i()}),i.on("ready",a=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;i.send("test",a,[a.buffer])};o();return}catch{Eh("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Dt.#t||(Ce("Setting up fake worker."),Dt.#t=!0),Dt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new _Y;this._port=t;const i=`fake${Dt.#e++}`,s=new ul(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new ul(i,i+"_worker",t),this.#i()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Dt.#n?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Dt(e)}static get workerSrc(){if(kl.workerSrc)return kl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#r(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return ke(this,"_setupFakeWorkerGlobal",(async()=>this.#r?this.#r:(await import(this.workerSrc)).WorkerMessageHandler)())}}class bY{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#r=null;constructor(e,t,i,s,r){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new US,this.fontLoader=new _K({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){const i=this.#e.get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return ke(this,"annotationStorage",new By)}getRenderingIntent(e,t=ls.ENABLE,i=null,s=!1,r=!1){let o=En.DISPLAY,a=vm;switch(e){case"any":o=En.ANY;break;case"display":break;case"print":o=En.PRINT;break;default:Ce(`getRenderingIntent - invalid intent: ${e}`)}const l=o&En.PRINT&&i instanceof ES?i:this.annotationStorage;switch(t){case ls.DISABLE:o+=En.ANNOTATIONS_DISABLE;break;case ls.ENABLE:break;case ls.ENABLE_FORMS:o+=En.ANNOTATIONS_FORMS;break;case ls.ENABLE_STORAGE:o+=En.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ce(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=En.IS_EDITING),r&&(o+=En.OPLIST);const{ids:c,hash:u}=l.modifiedIds,f=[o,a.hash,u];return{renderingIntent:o,cacheKey:f.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),an.cleanup(),this._networkStream?.cancelAllRequests(new Ns("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{It(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){s.close();return}It(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this._fullReader;return(!s||!r)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(i,s)=>{It(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){s.close();return}It(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new vY(i,this))}),e.on("DocException",i=>{t._capability.reject(gn(i))}),e.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!t.onPassword)throw gn(i);const s=r=>{r instanceof Error?this.#r.reject(r):this.#r.resolve({password:r})};t.onPassword(s,i.code)}catch(s){this.#r.reject(s)}return this.#r.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:a,pdfBug:l}=this._params;if("error"in r){const m=r.error;Ce(`Error during font loading: ${m}`),this.commonObjs.resolve(i,m);break}const c=l&&globalThis.FontInspector?.enabled?(m,y)=>globalThis.FontInspector.fontAdded(m,y):null,u=new bK(r,{disableFontFace:o,fontExtraProperties:a,inspectFont:c});this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!a&&u.data&&(u.data=null),this.commonObjs.resolve(i,u)});break;case"CopyLocalImage":const{imageRef:f}=r;It(f,"The imageRef must be defined.");for(const m of this.#t.values())for(const[,y]of m.objs)if(y?.ref===f)return y.dataLen?(this.commonObjs.resolve(i,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,o])=>{if(this.destroyed)return;const a=this.#t.get(s);if(!a.objs.has(i)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(r){case"Image":a.objs.resolve(i,o),o?.dataLen>JW&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ce("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=this.#n.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,e);const o=new wY(t,r,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,s),s}getPageIndex(e){return hT(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new qK(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new zK(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),an.cleanup()}}cachedPageNumber(e){if(!hT(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}}const Za=Symbol("INITIAL_DATA");class US{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Za}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const i=this.#e[e];if(!i||i.data===Za)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=this.#e[e];return!!t&&t.data!==Za}delete(e){const t=this.#e[e];return!t||t.data===Za?!1:(delete this.#e[e],!0)}resolve(e,t=null){const i=this.#t(e);i.data=t,i.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Za&&(yield[e,t])}}}class xY{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class vo{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:f=!1,pageColors:m=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new xY(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(vo.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");vo.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:o}=this.params;this.gfx=new Po(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),vo.#t.delete(this._canvas),this.callback(e||new Ly(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),vo.#t.delete(this._canvas),this.callback())))}}const TY="4.10.38",EY="f9bea397f";function fT(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function el(n){return Math.max(0,Math.min(255,255*n))}class pT{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=el(e),[e,e,e]}static G_HTML([e]){const t=fT(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(el)}static RGB_HTML(e){return`#${e.map(fT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[el(1-Math.min(1,e+s)),el(1-Math.min(1,i+s)),el(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,o=1-i,a=Math.min(s,r,o);return["CMYK",s,r,o,a]}}class AY{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){We("Abstract method `_createSVG` called.")}}class Hy extends AY{_createSVG(e){return document.createElementNS(Si,e)}}class BS{static setupStorage(e,t,i,s,r){const o=s.getValue(t,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?e.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{s.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of i.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&r.addLinkAttributes(e,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(e,o.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const a=r!=="richText",l=e.div;if(l.append(o),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const f=document.createTextNode(s.value);o.append(f),a&&lc.shouldBuildText(s.name)&&c.push(f)}return{textDivs:c}}const u=[[s,-1,o]];for(;u.length>0;){const[f,m,y]=u.at(-1);if(m+1===f.children.length){u.pop();continue}const v=f.children[++u.at(-1)[1]];if(v===null)continue;const{name:_}=v;if(_==="#text"){const T=document.createTextNode(v.value);c.push(T),y.append(T);continue}const x=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,_):document.createElement(_);if(y.append(x),v.attributes&&this.setAttributes({html:x,element:v,storage:t,intent:r,linkService:i}),v.children?.length>0)u.push([v,-1,x]);else if(v.value){const T=document.createTextNode(v.value);a&&lc.shouldBuildText(_)&&c.push(T),x.append(T)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Vc=1e3,IY=9,Lr=new WeakSet;function _s(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class CY{static create(e){switch(e.data.annotationType){case St.LINK:return new zS(e);case St.TEXT:return new SY(e);case St.WIDGET:switch(e.data.fieldType){case"Tx":return new PY(e);case"Btn":return e.data.radioButton?new jS(e):e.data.checkBox?new RY(e):new NY(e);case"Ch":return new MY(e);case"Sig":return new kY(e)}return new Wr(e);case St.POPUP:return new _m(e);case St.FREETEXT:return new qS(e);case St.LINE:return new LY(e);case St.SQUARE:return new FY(e);case St.CIRCLE:return new VY(e);case St.POLYLINE:return new HS(e);case St.CARET:return new UY(e);case St.INK:return new Gy(e);case St.POLYGON:return new OY(e);case St.HIGHLIGHT:return new GS(e);case St.UNDERLINE:return new BY(e);case St.SQUIGGLY:return new zY(e);case St.STRIKEOUT:return new jY(e);case St.STAMP:return new $S(e);case St.FILEATTACHMENT:return new qY(e);default:return new xt(e)}}}class xt{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return xt._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}}}=this;i?.splice(0,4,...e);const{width:c,height:u}=_s(e);t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+l)/o}%`,s===0?(t.width=`${100*c/r}%`,t.height=`${100*u/o}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Wr||(r.tabIndex=Vc);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof _m){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,r),r}const{width:a,height:l}=_s(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(_>0||x>0){const S=`calc(${_}px * var(--scale-factor)) / calc(${x}px * var(--scale-factor))`;o.borderRadius=S}else if(this instanceof jS){const S=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=S}switch(t.borderStyle.style){case Xa.SOLID:o.borderStyle="solid";break;case Xa.DASHED:o.borderStyle="dashed";break;case Xa.BEVELED:Ce("Unimplemented border style: beveled");break;case Xa.INSET:Ce("Unimplemented border style: inset");break;case Xa.UNDERLINE:o.borderBottomStyle="solid";break}const T=t.borderColor||null;T?(this.#t=!0,o.borderColor=me.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const c=me.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:u,pageHeight:f,pageX:m,pageY:y}=s.rawDims;o.left=`${100*(c[0]-m)/u}%`,o.top=`${100*(c[1]-y)/f}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(o.width=`${100*a/u}%`,o.height=`${100*l/f}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:o}=_s(this.data.rect);let a,l;e%180===0?(a=100*r/i,l=100*o/s):(a=100*o/i,l=100*r/s),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],o=r[0],a=r.slice(1);s.target.style[i]=pT[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[i]:pT[`${o}_rgb`](a)})};return ke(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||i[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const o=i[s];if(o){const a={detail:{[s]:r},target:e};o(a),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,x,T,S]=e.subarray(2,6);if(s===_&&r===x&&t===T&&i===S)return}const{style:o}=this.container;let a;if(this.#t){const{borderColor:_,borderWidth:x}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const l=s-t,c=r-i,{svgFactory:u}=this,f=u.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const m=u.createElement("defs");f.append(m);const y=u.createElement("clipPath"),v=`clippath_${this.data.id}`;y.setAttribute("id",v),y.setAttribute("clipPathUnits","objectBoundingBox"),m.append(y);for(let _=2,x=e.length;_<x;_+=8){const T=e[_],S=e[_+1],C=e[_+2],D=e[_+3],F=u.createElement("rect"),V=(C-t)/l,I=(r-S)/c,E=(T-C)/l,A=(S-D)/c;F.setAttribute("x",V),F.setAttribute("y",I),F.setAttribute("width",E),F.setAttribute("height",A),y.append(F),a?.push(`<rect vector-effect="non-scaling-stroke" x="${V}" y="${I}" width="${E}" height="${A}"/>`)}this.#t&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(f),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:e}=this,t=this.#n=new _m({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){We("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:o,exportValues:a}of s){if(r===-1||o===t)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!Lr.has(c)){Ce(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==t&&Lr.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class zS extends xt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(this.#t(i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(this.#n(i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,i=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const r=i.get(s);r&&(e[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ce('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();const{fields:s,refs:r,include:o}=t,a=[];if(s.length!==0||r.length!==0){const u=new Set(r);for(const f of s){const m=this._fieldObjects[f]||[];for(const{id:y}of m)u.add(y)}for(const f of Object.values(this._fieldObjects))for(const m of f)u.has(m.id)===o&&a.push(m)}else for(const u of Object.values(this._fieldObjects))a.push(...u);const l=this.annotationStorage,c=[];for(const u of a){const{id:f}=u;switch(c.push(f),u.type){case"text":{const y=u.defaultValue||"";l.setValue(f,{value:y});break}case"checkbox":case"radiobutton":{const y=u.defaultValue===u.exportValues;l.setValue(f,{value:y});break}case"combobox":case"listbox":{const y=u.defaultValue||"";l.setValue(f,{value:y});break}default:continue}const m=document.querySelector(`[data-element-id="${f}"]`);if(m){if(!Lr.has(m)){Ce(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class SY extends xt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Wr extends xt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return hn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(i,o=>{if(i==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}})})}_setEventListeners(e,t,i,s){for(const[r,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,r,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":me.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||IY,r=e.style;let o;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),u=Math.round(c/(Zf*s))||1,f=c/u;o=Math.min(s,l(f/Zf))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,l(c/Zf))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=me.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class PY extends Wr{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=i),r.setValue(o.id,{[s]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let r=s.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&r.length>o&&(r=r.slice(0,o));let a=s.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const l={userValue:r,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",a??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Lr.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Vc,this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",u=>{e.setValue(t,{value:u.target.value}),this.setPropertyOnSiblings(i,"value",u.target.value,"value"),l.formattedValue=null}),i.addEventListener("resetform",u=>{const f=this.data.defaultFieldValue??"";i.value=l.userValue=f,l.formattedValue=null});let c=u=>{const{formattedValue:f}=l;f!=null&&(u.target.value=f),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",f=>{if(l.focused)return;const{target:m}=f;l.userValue&&(m.value=l.userValue),l.lastCommittedValue=m.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),i.addEventListener("updatefromsandbox",f=>{this.showElementAndHideCanvas(f.target);const m={value(y){l.userValue=y.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),y.target.value=l.userValue},formattedValue(y){const{formattedValue:v}=y.detail;l.formattedValue=v,v!=null&&y.target!==document.activeElement&&(y.target.value=v),e.setValue(t,{formattedValue:v})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{const{charLimit:v}=y.detail,{target:_}=y;if(v===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",v);let x=l.userValue;!x||x.length<=v||(x=x.slice(0,v),_.value=l.userValue=x,e.setValue(t,{value:x}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(m,f)}),i.addEventListener("keydown",f=>{l.commitKey=1;let m=-1;if(f.key==="Escape"?m=0:f.key==="Enter"&&!this.data.multiLine?m=2:f.key==="Tab"&&(l.commitKey=3),m===-1)return;const{value:y}=f.target;l.lastCommittedValue!==y&&(l.lastCommittedValue=y,l.userValue=y,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:m,selStart:f.target.selectionStart,selEnd:f.target.selectionEnd}}))});const u=c;c=null,i.addEventListener("blur",f=>{if(!l.focused||!f.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:m}=f.target;l.userValue=m,l.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:l.commitKey,selStart:f.target.selectionStart,selEnd:f.target.selectionEnd}}),u(f)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",f=>{l.lastCommittedValue=null;const{data:m,target:y}=f,{value:v,selectionStart:_,selectionEnd:x}=y;let T=_,S=x;switch(f.inputType){case"deleteWordBackward":{const C=v.substring(0,_).match(/\w*[^\w]*$/);C&&(T-=C[0].length);break}case"deleteWordForward":{const C=v.substring(_).match(/^[^\w]*\w*/);C&&(S+=C[0].length);break}case"deleteContentBackward":_===x&&(T-=1);break;case"deleteContentForward":_===x&&(S+=1);break}f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,change:m||"",willCommit:!1,selStart:T,selEnd:S}})}),this._setEventListeners(i,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],f=>f.target.value)}if(c&&i.addEventListener("blur",c),this.data.comb){const f=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${f}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class kY extends Wr{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class RY extends Wr{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Lr.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Vc,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,i)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class jS extends Wr{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,i))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(Lr.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=Vc,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const u=o===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const m=u&&f.id===i;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class NY extends zS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class MY extends Wr{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Lr.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Vc;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",u=>{const f=this.data.defaultFieldValue;for(const m of s.options)m.selected=m.value===f});for(const u of this.data.options){const f=document.createElement("option");f.textContent=u.displayValue,f.value=u.exportValue,i.value.includes(u.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let o=null;if(r){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),s.prepend(u),o=()=>{u.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=u=>{const f=u?"value":"textContent",{options:m,multiple:y}=s;return y?Array.prototype.filter.call(m,v=>v.selected).map(v=>v[f]):m.selectedIndex===-1?null:m[m.selectedIndex][f]};let l=a(!1);const c=u=>{const f=u.target.options;return Array.prototype.map.call(f,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",u=>{const f={value(m){o?.();const y=m.detail.value,v=new Set(Array.isArray(y)?y:[y]);for(const _ of s.options)_.selected=v.has(_.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(m){s.multiple=!0},remove(m){const y=s.options,v=m.detail.remove;y[v].selected=!1,s.remove(v),y.length>0&&Array.prototype.findIndex.call(y,x=>x.selected)===-1&&(y[0].selected=!0),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},clear(m){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(m){const{index:y,displayValue:v,exportValue:_}=m.detail.insert,x=s.children[y],T=document.createElement("option");T.textContent=v,T.value=_,x?x.before(T):s.append(T),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},items(m){const{items:y}=m.detail;for(;s.length!==0;)s.remove(0);for(const v of y){const{displayValue:_,exportValue:x}=v,T=document.createElement("option");T.textContent=_,T.value=x,s.append(T)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(m)}),l=a(!1)},indices(m){const y=new Set(m.detail.indices);for(const v of m.target.options)v.selected=y.has(v.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(f,u)}),s.addEventListener("input",u=>{const f=a(!0),m=a(!1);e.setValue(t,{value:f}),u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:m,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):s.addEventListener("input",function(u){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class _m extends xt{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:xt._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new DY({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Dy}${i}`).join(",")),this.container}}class DY{#e=this.#C.bind(this);#t=this.#I.bind(this);#n=this.#S.bind(this);#i=this.#x.bind(this);#r=null;#s=null;#l=null;#a=null;#u=null;#c=null;#h=null;#d=!1;#f=null;#o=null;#p=null;#g=null;#m=null;#y=null;#_=!1;constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:c,parentRect:u,open:f}){this.#s=e,this.#m=s,this.#l=o,this.#g=a,this.#c=l,this.#r=t,this.#p=c,this.#h=u,this.#u=i,this.#a=xS.toDateObject(r),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",this.#i),m.addEventListener("mouseenter",this.#n),m.addEventListener("mouseleave",this.#t),m.classList.add("popupTriggerArea");for(const m of i)m.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,f&&this.#x()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#r){const r=e.style.outlineColor=me.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=me.makeHexColor(...this.#r.map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=this.#m,e.append(t),this.#a){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#a.valueOf()})),t.append(r)}const s=this.#v;if(s)BS.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(this.#l);e.append(r)}this.#s.append(e)}get#v(){const e=this.#g,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#b(){return this.#v?.attributes?.style?.fontSize||0}get#T(){return this.#v?.attributes?.style?.color||null}#A(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#T,fontSize:this.#b?`calc(${this.#b}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,o=s.length;r<o;++r){const a=s[r];i.append(document.createTextNode(a)),r<o-1&&i.append(document.createElement("br"))}return i}#C(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#d)&&this.#x()}updateEdited({rect:e,popupContent:t}){this.#y||={contentsObj:this.#l,richText:this.#g},e&&(this.#o=null),t&&(this.#g=this.#A(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#y&&({contentsObj:this.#l,richText:this.#g}=this.#y,this.#y=null,this.#f?.remove(),this.#f=null,this.#o=null)}#P(){if(this.#o!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=this.#c;let o=!!this.#h,a=o?this.#h:this.#p;for(const v of this.#u)if(!a||me.intersect(v.data.rect,a)!==null){a=v.data.rect,o=!0;break}const l=me.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),u=o?a[2]-a[0]+5:0,f=l[0]+u,m=l[1];this.#o=[100*(f-s)/t,100*(m-r)/i];const{style:y}=this.#s;y.left=`${this.#o[0]}%`,y.top=`${this.#o[1]}%`}#x(){this.#d=!this.#d,this.#d?(this.#S(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#e)):(this.#I(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#e))}#S(){this.#f||this.render(),this.isVisible?this.#d&&this.#s.classList.add("focused"):(this.#P(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#I(){this.#s.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#s.hidden=!0)}maybeShow(){this.#_&&(this.#f||this.#S(),this.#_=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class qS extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ie.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class LY extends xt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:i}=_s(e.rect),s=this.svgFactory.create(t,i,!0),r=this.#e=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class FY extends xt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:i}=_s(e.rect),s=this.svgFactory.create(t,i,!0),r=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",t-r),o.setAttribute("height",i-r),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class VY extends xt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:i}=_s(e.rect),s=this.svgFactory.create(t,i,!0),r=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",i/2),o.setAttribute("rx",t/2-r/2),o.setAttribute("ry",i/2-r/2),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class HS extends xt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:i,popupRef:s}}=this;if(!t)return this.container;const{width:r,height:o}=_s(e),a=this.svgFactory.create(r,o,!0);let l=[];for(let u=0,f=t.length;u<f;u+=2){const m=t[u]-e[0],y=e[3]-t[u+1];l.push(`${m},${y}`)}l=l.join(" ");const c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class OY extends HS{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class UY extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Gy extends xt{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ie.HIGHLIGHT:Ie.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:i,borderStyle:s,popupRef:r}}=this,{transform:o,width:a,height:l}=this.#n(t,e),c=this.svgFactory.create(a,l,!0),u=this.#e=this.svgFactory.createElement("svg:g");c.append(u),u.setAttribute("stroke-width",s.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let f=0,m=i.length;f<m;f++){const y=this.svgFactory.createElement(this.svgElementName);this.#t.push(y),y.setAttribute("points",i[f].join(",")),u.append(y)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:i,rect:s}=e,r=this.#e;if(t>=0&&r.setAttribute("stroke-width",t||1),i)for(let o=0,a=this.#t.length;o<a;o++)this.#t[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:a,height:l}=this.#n(this.data.rotation,s);r.parentElement.setAttribute("viewBox",`0 0 ${a} ${l}`),r.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class GS extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ie.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class BY extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class zY extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class jY extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class $S extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ie.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class qY extends xt{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#t.bind(this)),this.#e=i;const{isMac:s}=hn.platform;return e.addEventListener("keydown",r=>{r.key==="Enter"&&(s?r.metaKey:r.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class HY{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a}){this.div=e,this.#e=t,this.#t=i,this.#i=a||null,this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}async#r(e,t){const i=e.firstChild||e,s=i.id=`${Dy}${t}`,r=await this.#i?.getAriaAttributes(s);if(r)for(const[o,a]of r)i.setAttribute(o,a);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1)}async render(e){const{annotations:t}=e,i=this.div;Dr(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Hy,annotationStorage:e.annotationStorage||new By,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const a=o.annotationType===St.POPUP;if(a){const u=s.get(o.id);if(!u)continue;r.elements=u}else{const{width:u,height:f}=_s(o.rect);if(u<=0||f<=0)continue}r.data=o;const l=CY.create(r);if(!l.isRenderable)continue;if(!a&&o.popupRef){const u=s.get(o.popupRef);u?u.push(l):s.set(o.popupRef,[l])}const c=l.render();o.hidden&&(c.style.visibility="hidden"),await this.#r(c,o.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#s()}update({viewport:e}){const t=this.div;this.viewport=e,Dr(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;const e=this.div;for(const[t,i]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}}const xu=/\r\n?|\n/g;class Pt extends _e{#e;#t="";#n=`${this.id}-editor`;#i=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Pt.prototype,t=r=>r.isEmpty(),i=Ms.TRANSLATE_SMALL,s=Ms.TRANSLATE_BIG;return ke(this,"_keyboardManager",new Fc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Ie.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Pt._defaultColor||_e._defaultLineColor,this.#r=e.fontSize||Pt._defaultFontSize}static initialize(e,t){_e.initialize(e,t);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Fe.FREETEXT_SIZE:Pt._defaultFontSize=t;break;case Fe.FREETEXT_COLOR:Pt._defaultColor=t;break}}updateParams(e,t){switch(e){case Fe.FREETEXT_SIZE:this.#s(t);break;case Fe.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Fe.FREETEXT_SIZE,Pt._defaultFontSize],[Fe.FREETEXT_COLOR,Pt._defaultColor||_e._defaultLineColor]]}get propertiesToUpdate(){return[[Fe.FREETEXT_SIZE,this.#r],[Fe.FREETEXT_COLOR,this.#e]]}#s(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-this.#r)*this.parentScale),this.#r=s,this.#u()},i=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=s=>{this.#e=this.editorDiv.style.color=s},i=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Pt._internalPadding*e,-(Pt._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ie.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(Pt.#c(i)),t=i);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:r}=this,o=r.style.display,a=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",s.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=o,r.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#a().trimEnd();if(e===t)return;const i=s=>{if(this.#t=s,!s){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Pt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Ed(this,this.div,["dblclick","keydown"]),this.width){const[s,r]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[a,l]=this.getInitialTranslation();[a,l]=this.pageTranslationToScreen(a,l);const[c,u]=this.pageDimensions,[f,m]=this.pageTranslation;let y,v;switch(this.rotation){case 0:y=e+(o[0]-f)/c,v=t+this.height-(o[1]-m)/u;break;case 90:y=e+(o[0]-f)/c,v=t-(o[1]-m)/u,[a,l]=[l,-a];break;case 180:y=e-this.width+(o[0]-f)/c,v=t-(o[1]-m)/u,[a,l]=[-a,-l];break;case 270:y=e+(o[0]-f-this.height*u)/c,v=t+(o[1]-m-this.width*c)/u,[a,l]=[-l,a];break}this.setAt(y*s,v*r,a,l)}else this.setAt(e*s,t*r,this.width*s,this.height*r);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(xu,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const s=Pt.#f(t.getData("text")||"").replaceAll(xu,`
`);if(!s)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const o=r.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:a,startOffset:l}=o,c=[],u=[];if(a.nodeType===Node.TEXT_NODE){const y=a.parentElement;if(u.push(a.nodeValue.slice(l).replaceAll(xu,"")),y!==this.editorDiv){let v=c;for(const _ of this.editorDiv.childNodes){if(_===y){v=u;continue}v.push(Pt.#c(_))}}c.push(a.nodeValue.slice(0,l).replaceAll(xu,""))}else if(a===this.editorDiv){let y=c,v=0;for(const _ of this.editorDiv.childNodes)v++===l&&(y=u),y.push(Pt.#c(_))}this.#t=`${c.join(`
`)}${s}${u.join(`
`)}`,this.#h();const f=new Range;let m=c.reduce((y,v)=>y+v.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const v=y.nodeValue.length;if(m<=v){f.setStart(y,m),f.setEnd(y,m);break}m-=v}r.removeAllRanges(),r.addRange(f)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#t.replaceAll(" "," ")}static#f(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,i){let s=null;if(e instanceof qS){const{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:l,rotation:c,id:u,popupRef:f},textContent:m,textPosition:y,parent:{page:{pageNumber:v}}}=e;if(!m||m.length===0)return null;s=e={annotationType:Ie.FREETEXT,color:Array.from(a),fontSize:o,value:m.join(`
`),position:y,pageIndex:v-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:f}}const r=await super.deserialize(e,t,i);return r.#r=e.fontSize,r.#e=me.makeHexColor(...e.color),r.#t=Pt.#f(e.value),r.annotationElementId=e.id||null,r._initialData=s,r}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Pt._internalPadding*this.parentScale,i=this.getRect(t,t),s=_e._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),r={annotationType:Ie.FREETEXT,color:s,fontSize:this.#r,value:this.#d(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?r:this.annotationElementId&&!this.#o(r)?null:(r.id=this.annotationElementId,r)}#o(e){const{value:t,fontSize:i,color:s,pageIndex:r}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((o,a)=>o!==s[a])||e.pageIndex!==r}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:i}=t;i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,t.replaceChildren();for(const r of this.#t.split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),t.append(o)}const s=Pt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ae{static PRECISION=1e-4;toSVGPath(){We("Abstract method `toSVGPath` must be implemented.")}get box(){We("Abstract getter `box` must be implemented.")}serialize(e,t){We("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,o){o||=new Float32Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*s,o[a+1]=i+e[a+1]*r;return o}static _rescaleAndSwap(e,t,i,s,r,o){o||=new Float32Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*s,o[a+1]=i+e[a]*r;return o}static _translate(e,t,i,s){s||=new Float32Array(e.length);for(let r=0,o=e.length;r<o;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,o){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+o)/6,(i+r)/2,(s+o)/2]}}class mr{#e;#t=[];#n;#i;#r=[];#s=new Float32Array(18);#l;#a;#u;#c;#h;#d;#f=[];static#o=8;static#p=2;static#g=mr.#o+mr.#p;constructor({x:e,y:t},i,s,r,o,a=0){this.#e=i,this.#d=r*s,this.#i=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#c=mr.#o*s,this.#u=mr.#g*s,this.#h=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#m(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[i,s,r,o]=this.#e;return[(this.#l+(e[0]-t[0])/2-i)/r,(this.#a+(e[1]-t[1])/2-s)/o,(this.#l+(t[0]-e[0])/2-i)/r,(this.#a+(t[1]-e[1])/2-s)/o]}add({x:e,y:t}){this.#l=e,this.#a=t;const[i,s,r,o]=this.#e;let[a,l,c,u]=this.#s.subarray(8,12);const f=e-c,m=t-u,y=Math.hypot(f,m);if(y<this.#u)return!1;const v=y-this.#c,_=v/y,x=_*f,T=_*m;let S=a,C=l;a=c,l=u,c+=x,u+=T,this.#f?.push(e,t);const D=-T/v,F=x/v,V=D*this.#d,I=F*this.#d;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([c+V,u+I],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([c-V,u-I],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([a+V,l+I],2),this.#r.push(NaN,NaN,NaN,NaN,(a+V-i)/r,(l+I-s)/o),this.#s.set([a-V,l-I],14),this.#t.push(NaN,NaN,NaN,NaN,(a-V-i)/r,(l-I-s)/o)),this.#s.set([S,C,a,l,c,u],6),!this.isEmpty()):(this.#s.set([S,C,a,l,c,u],6),Math.abs(Math.atan2(C-l,S-a)-Math.atan2(T,x))<Math.PI/2?([a,l,c,u]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((a+c)/2-i)/r,((l+u)/2-s)/o),[a,l,S,C]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((S+a)/2-i)/r,((C+l)/2-s)/o),!0):([S,C,a,l,c,u]=this.#s.subarray(0,6),this.#r.push(((S+5*a)/6-i)/r,((C+5*l)/6-s)/o,((5*a+c)/6-i)/r,((5*l+u)/6-s)/o,((a+c)/2-i)/r,((l+u)/2-s)/o),[c,u,a,l,S,C]=this.#s.subarray(12,18),this.#t.push(((S+5*a)/6-i)/r,((C+5*l)/6-s)/o,((5*a+c)/6-i)/r,((5*l+u)/6-s)/o,((a+c)/2-i)/r,((l+u)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#v(i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#_(i),i.join(" ")}#y(){const[e,t,i,s]=this.#e,[r,o,a,l]=this.#m();return`M${(this.#s[2]-e)/i} ${(this.#s[3]-t)/s} L${(this.#s[4]-e)/i} ${(this.#s[5]-t)/s} L${r} ${o} L${a} ${l} L${(this.#s[16]-e)/i} ${(this.#s[17]-t)/s} L${(this.#s[14]-e)/i} ${(this.#s[15]-t)/s} Z`}#_(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,i,s,r]=this.#e,o=this.#s.subarray(4,6),a=this.#s.subarray(16,18),[l,c,u,f]=this.#m();e.push(`L${(o[0]-t)/s} ${(o[1]-i)/r} L${l} ${c} L${u} ${f} L${(a[0]-t)/s} ${(a[1]-i)/r}`)}newFreeDrawOutline(e,t,i,s,r,o){return new WS(e,t,i,s,r,o)}getOutlines(){const e=this.#r,t=this.#t,i=this.#s,[s,r,o,a]=this.#e,l=new Float32Array((this.#f?.length??0)+2);for(let f=0,m=l.length-2;f<m;f+=2)l[f]=(this.#f[f]-s)/o,l[f+1]=(this.#f[f+1]-r)/a;if(l[l.length-2]=(this.#l-s)/o,l[l.length-1]=(this.#a-r)/a,isNaN(i[6])&&!this.isEmpty())return this.#b(l);const c=new Float32Array(this.#r.length+24+this.#t.length);let u=e.length;for(let f=0;f<u;f+=2){if(isNaN(e[f])){c[f]=c[f+1]=NaN;continue}c[f]=e[f],c[f+1]=e[f+1]}u=this.#A(c,u);for(let f=t.length-6;f>=6;f-=6)for(let m=0;m<6;m+=2){if(isNaN(t[f+m])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[f+m],c[u+1]=t[f+m+1],u+=2}return this.#T(c,u),this.newFreeDrawOutline(c,l,this.#e,this.#h,this.#n,this.#i)}#b(e){const t=this.#s,[i,s,r,o]=this.#e,[a,l,c,u]=this.#m(),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/o],0),this.newFreeDrawOutline(f,e,this.#e,this.#h,this.#n,this.#i)}#T(e,t){const i=this.#t;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#A(e,t){const i=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[r,o,a,l]=this.#e,[c,u,f,m]=this.#m();return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/l],t),t+=24}}class WS extends ae{#e;#t=new Float32Array(4);#n;#i;#r;#s;#l;constructor(e,t,i,s,r,o){super(),this.#l=e,this.#r=t,this.#e=i,this.#s=s,this.#n=r,this.#i=o,this.lastPoint=[NaN,NaN],this.#a(o);const[a,l,c,u]=this.#t;for(let f=0,m=e.length;f<m;f+=2)e[f]=(e[f]-a)/c,e[f+1]=(e[f+1]-l)/u;for(let f=0,m=t.length;f<m;f+=2)t[f]=(t[f]-a)/c,t[f+1]=(t[f+1]-l)/u}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,i=this.#l.length;t<i;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,s],r){const o=i-e,a=s-t;let l,c;switch(r){case 0:l=ae._rescale(this.#l,e,s,o,-a),c=ae._rescale(this.#r,e,s,o,-a);break;case 90:l=ae._rescaleAndSwap(this.#l,e,t,o,a),c=ae._rescaleAndSwap(this.#r,e,t,o,a);break;case 180:l=ae._rescale(this.#l,i,t,-o,a),c=ae._rescale(this.#r,i,t,-o,a);break;case 270:l=ae._rescaleAndSwap(this.#l,i,s,-o,-a),c=ae._rescaleAndSwap(this.#r,i,s,-o,-a);break}return{outline:Array.from(l),points:[Array.from(c)]}}#a(e){const t=this.#l;let i=t[4],s=t[5],r=i,o=s,a=i,l=s,c=i,u=s;const f=e?Math.max:Math.min;for(let y=6,v=t.length;y<v;y+=6){if(isNaN(t[y]))r=Math.min(r,t[y+4]),o=Math.min(o,t[y+5]),a=Math.max(a,t[y+4]),l=Math.max(l,t[y+5]),u<t[y+5]?(c=t[y+4],u=t[y+5]):u===t[y+5]&&(c=f(c,t[y+4]));else{const _=me.bezierBoundingBox(i,s,...t.slice(y,y+6));r=Math.min(r,_[0]),o=Math.min(o,_[1]),a=Math.max(a,_[2]),l=Math.max(l,_[3]),u<_[3]?(c=_[2],u=_[3]):u===_[3]&&(c=f(c,_[2]))}i=t[y+4],s=t[y+5]}const m=this.#t;m[0]=r-this.#n,m[1]=o-this.#n,m[2]=a-r+2*this.#n,m[3]=l-o+2*this.#n,this.lastPoint=[c,u]}get box(){return this.#t}newOutliner(e,t,i,s,r,o=0){return new mr(e,t,i,s,r,o)}getNewOutline(e,t){const[i,s,r,o]=this.#t,[a,l,c,u]=this.#e,f=r*c,m=o*u,y=i*c+a,v=s*u+l,_=this.newOutliner({x:this.#r[0]*f+y,y:this.#r[1]*m+v},this.#e,this.#s,e,this.#i,t??this.#n);for(let x=2;x<this.#r.length;x+=2)_.add({x:this.#r[x]*f+y,y:this.#r[x+1]*m+v});return _.getOutlines()}}class bm{#e;#t;#n=[];#i=[];constructor(e,t=0,i=0,s=!0){let r=1/0,o=-1/0,a=1/0,l=-1/0;const c=10**-4;for(const{x,y:T,width:S,height:C}of e){const D=Math.floor((x-t)/c)*c,F=Math.ceil((x+S+t)/c)*c,V=Math.floor((T-t)/c)*c,I=Math.ceil((T+C+t)/c)*c,E=[D,V,I,!0],A=[F,V,I,!1];this.#n.push(E,A),r=Math.min(r,D),o=Math.max(o,F),a=Math.min(a,V),l=Math.max(l,I)}const u=o-r+2*i,f=l-a+2*i,m=r-i,y=a-i,v=this.#n.at(s?-1:-2),_=[v[0],v[2]];for(const x of this.#n){const[T,S,C]=x;x[0]=(T-m)/u,x[1]=(S-y)/f,x[2]=(C-y)/f}this.#e=new Float32Array([m,y,u,f]),this.#t=_}getOutlines(){this.#n.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#u(t)),this.#l(t)):(this.#a(t),e.push(...this.#u(t)));return this.#r(e)}#r(e){const t=[],i=new Set;for(const o of e){const[a,l,c]=o;t.push([a,l,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],c=t[o+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[a,l,c,u,f]=o;i.delete(o);let m=a,y=l;for(r=[a,c],s.push(r);;){let v;if(i.has(u))v=u;else if(i.has(f))v=f;else break;i.delete(v),[a,l,c,u,f]=v,m!==a&&(r.push(m,y,a,y===l?l:c),m=a),y=y===l?c:l}r.push(m,y)}return new GY(s,this.#e,this.#t)}#s(e){const t=this.#i;let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,o=t[r][0];if(o===e)return r;o<e?i=r+1:s=r-1}return s+1}#l([,e,t]){const i=this.#s(e);this.#i.splice(i,0,[e,t])}#a([,e,t]){const i=this.#s(e);for(let s=i;s<this.#i.length;s++){const[r,o]=this.#i[s];if(r!==e)break;if(r===e&&o===t){this.#i.splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=this.#i[s];if(r!==e)break;if(r===e&&o===t){this.#i.splice(s,1);return}}}#u(e){const[t,i,s]=e,r=[[t,i,s]],o=this.#s(s);for(let a=0;a<o;a++){const[l,c]=this.#i[a];for(let u=0,f=r.length;u<f;u++){const[,m,y]=r[u];if(!(c<=m||y<=l)){if(m>=l){if(y>c)r[u][1]=c;else{if(f===1)return[];r.splice(u,1),u--,f--}continue}r[u][2]=l,y>c&&r.push([t,c,y])}}}return r}}class GY extends ae{#e;#t;constructor(e,t,i){super(),this.#t=e,this.#e=t,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[i,s]=t;e.push(`M${i} ${s}`);for(let r=2;r<t.length;r+=2){const o=t[r],a=t[r+1];o===i?(e.push(`V${a}`),s=a):a===s&&(e.push(`H${o}`),i=o)}e.push("Z")}return e.join(" ")}serialize([e,t,i,s],r){const o=[],a=i-e,l=s-t;for(const c of this.#t){const u=new Array(c.length);for(let f=0;f<c.length;f+=2)u[f]=e+c[f]*a,u[f+1]=s-c[f+1]*l;o.push(u)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class xm extends mr{newFreeDrawOutline(e,t,i,s,r,o){return new $Y(e,t,i,s,r,o)}}class $Y extends WS{newOutliner(e,t,i,s,r,o=0){return new xm(e,t,i,s,r,o)}}class Dn{#e=null;#t=null;#n;#i=null;#r=!1;#s=!1;#l=null;#a;#u=null;#c=null;#h;static#d=null;static get _keyboardManager(){return ke(this,"_keyboardManager",new Fc([[["Escape","mac+Escape"],Dn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Dn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Dn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Dn.prototype._moveToPrevious],[["Home","mac+Home"],Dn.prototype._moveToBeginning],[["End","mac+End"],Dn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#h=Fe.HIGHLIGHT_COLOR,this.#l=e):(this.#s=!0,this.#h=Fe.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#a=this.#c._eventBus,this.#n=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Dn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#c._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const i=this.#t=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#n,e.append(i),e}renderMainDropdown(){const e=this.#i=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",Xn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of this.#c.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",Dn.#d[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.setAttribute("aria-selected",s===this.#n),r.addEventListener("click",this.#o.bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#o(e,t){t.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#o(t,e)}_moveToNext(e){if(!this.#y){this.#g(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#y&&this._hideDropdownFromKeyboard();return}this.#y||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#y){this.#g(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#y){this.#g(e);return}this.#i.lastChild?.focus()}#p(e){Dn._keyboardManager.exec(this,e)}#g(e){if(this.#y){this.hideDropdown();return}if(this.#r=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#i){this.#i.classList.remove("hidden");return}const t=this.#i=this.#f();this.#e.append(t)}#m(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#y(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#y){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;const t=this.#c.highlightColors.values();for(const i of this.#i.children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}}class yt extends _e{#e=null;#t=0;#n;#i=null;#r=null;#s=null;#l=null;#a=0;#u=null;#c=null;#h=null;#d=!1;#f=null;#o;#p=null;#g="";#m;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ie.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=yt.prototype;return ke(this,"_keyboardManager",new Fc([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||yt._defaultColor,this.#m=e.thickness||yt._defaultThickness,this.#o=e.opacity||yt._defaultOpacity,this.#n=e.boxes||null,this.#y=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#d=!0,this.#v(e),this.#P()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#a=e.focusOffset,this.#_(),this.#P(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){const e=new bm(this.#n,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new bm(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{lastPoint:i}=this.#s;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#c=e;const s=1.5;if(this.#s=e.getNewOutline(this.#m/2+s,.0025),t>=0)this.#h=t,this.#i=i,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const u=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:yt.#x(this.#c.box,(u-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:yt.#x(this.#s.box,u),path:{d:this.#s.toSVGPath()}})}const[r,o,a,l]=e.box;switch(this.rotation){case 0:this.x=r,this.y=o,this.width=a,this.height=l;break;case 90:{const[u,f]=this.parentDimensions;this.x=o,this.y=1-r,this.width=a*f/u,this.height=l*u/f;break}case 180:this.x=1-r,this.y=1-o,this.width=a,this.height=l;break;case 270:{const[u,f]=this.parentDimensions;this.x=1-o,this.y=r,this.width=a*f/u,this.height=l*u/f;break}}const{lastPoint:c}=this.#s;this.#f=[(c[0]-r)/a,(c[1]-o)/l]}static initialize(e,t){_e.initialize(e,t),yt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Fe.HIGHLIGHT_DEFAULT_COLOR:yt._defaultColor=t;break;case Fe.HIGHLIGHT_THICKNESS:yt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case Fe.HIGHLIGHT_COLOR:this.#b(t);break;case Fe.HIGHLIGHT_THICKNESS:this.#T(t);break}}static get defaultPropertiesToUpdate(){return[[Fe.HIGHLIGHT_DEFAULT_COLOR,yt._defaultColor],[Fe.HIGHLIGHT_THICKNESS,yt._defaultThickness]]}get propertiesToUpdate(){return[[Fe.HIGHLIGHT_COLOR,this.color||yt._defaultColor],[Fe.HIGHLIGHT_THICKNESS,this.#m||yt._defaultThickness],[Fe.HIGHLIGHT_FREE,this.#d]]}#b(e){const t=(r,o)=>{this.color=r,this.#o=o,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:r,"fill-opacity":o}}),this.#r?.updateColor(r)},i=this.color,s=this.#o;this.addCommands({cmd:t.bind(this,e,yt._defaultOpacity),undo:t.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#T(e){const t=this.#m,i=s=>{this.#m=s,this.#A(s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#r=new Dn({editor:this}),e.addColorPicker(this.#r)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#P(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#P(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#A(e){if(!this.#d)return;this.#v({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#P(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#i}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#o},rootClass:{highlight:!0,free:this.#d},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#d),this.#u&&(this.#u.style.clipPath=this.#i))}static#x([e,t,i,s],r){switch(r){case 90:return[1-t-s,e,s,i];case 180:return[1-e-i,1-t-s,i,s];case 270:return[t,1-e-i,s,i]}return[e,t,i,s]}rotate(e){const{drawLayer:t}=this.parent;let i;this.#d?(e=(e-this.rotation+360)%360,i=yt.#x(this.#c.box,e)):i=yt.#x([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:i,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:yt.#x(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#S.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),Ed(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#S(e){yt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#I(!0);break;case 1:case 3:this.#I(!1);break}}#I(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#a)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#d||this.#I(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#R(){return this.#d?this.rotation:0}#D(){if(this.#d)return null;const[e,t]=this.pageDimensions,[i,s]=this.pageTranslation,r=this.#n,o=new Float32Array(r.length*8);let a=0;for(const{x:l,y:c,width:u,height:f}of r){const m=l*e+i,y=(1-c)*t+s;o[a]=o[a+4]=m,o[a+1]=o[a+3]=y,o[a+2]=o[a+6]=m+u*e,o[a+5]=o[a+7]=y-f*t,a+=8}return o}#F(e){return this.#c.serialize(e,this.#R())}static startHighlighting(e,t,{target:i,x:s,y:r}){const{x:o,y:a,width:l,height:c}=i.getBoundingClientRect(),u=new AbortController,f=e.combinedSignal(u),m=y=>{u.abort(),this.#w(e,y)};window.addEventListener("blur",m,{signal:f}),window.addEventListener("pointerup",m,{signal:f}),window.addEventListener("pointerdown",Cn,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Xn,{signal:f}),i.addEventListener("pointermove",this.#E.bind(this,e),{signal:f}),this._freeHighlight=new xm({x:s,y:r},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#E(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#w(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,i){let s=null;if(e instanceof GS){const{data:{quadPoints:v,rect:_,rotation:x,id:T,color:S,opacity:C,popupRef:D},parent:{page:{pageNumber:F}}}=e;s=e={annotationType:Ie.HIGHLIGHT,color:Array.from(S),opacity:C,quadPoints:v,boxes:null,pageIndex:F-1,rect:_.slice(0),rotation:x,id:T,deleted:!1,popupRef:D}}else if(e instanceof Gy){const{data:{inkLists:v,rect:_,rotation:x,id:T,color:S,borderStyle:{rawWidth:C},popupRef:D},parent:{page:{pageNumber:F}}}=e;s=e={annotationType:Ie.HIGHLIGHT,color:Array.from(S),thickness:C,inkLists:v,boxes:null,pageIndex:F-1,rect:_.slice(0),rotation:x,id:T,deleted:!1,popupRef:D}}const{color:r,quadPoints:o,inkLists:a,opacity:l}=e,c=await super.deserialize(e,t,i);c.color=me.makeHexColor(...r),c.#o=l||1,a&&(c.#m=e.thickness),c.annotationElementId=e.id||null,c._initialData=s;const[u,f]=c.pageDimensions,[m,y]=c.pageTranslation;if(o){const v=c.#n=[];for(let _=0;_<o.length;_+=8)v.push({x:(o[_]-m)/u,y:1-(o[_+1]-y)/f,width:(o[_+2]-o[_])/u,height:(o[_+1]-o[_+5])/f});c.#_(),c.#P(),c.rotate(c.rotation)}else if(a){c.#d=!0;const v=a[0],_={x:v[0]-m,y:f-(v[1]-y)},x=new xm(_,[0,0,u,f],1,c.#m/2,!0,.001);for(let C=0,D=v.length;C<D;C+=2)_.x=v[C]-m,_.y=f-(v[C+1]-y),x.add(_);const{id:T,clipPathId:S}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);c.#v({highlightOutlines:x.getOutlines(),highlightId:T,clipPathId:S}),c.#P()}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),i=_e._colorManager.convert(this.color),s={annotationType:Ie.HIGHLIGHT,color:i,opacity:this.#o,thickness:this.#m,quadPoints:this.#D(),outlines:this.#F(t),pageIndex:this.pageIndex,rect:t,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#M(s)?null:(s.id=this.annotationElementId,s)}#M(e){const{color:t}=this._initialData;return e.color.some((i,s)=>i!==t[s])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class WY{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){We("Not implemented")}}class we extends _e{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#l=null;static#a=null;static#u=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#c(e),this.#f())}#c({drawOutlines:e,drawId:t,drawingOptions:i}){this.#e=e,this._drawingOptions||=i,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#g(e.box)}#h(e,t){const{id:i}=t.drawLayer.draw(we._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(e,t){const i=new Set(Object.keys(e));for(const[s,r]of Object.entries(t))i.has(s)?Object.assign(e[s],r):e[s]=r;return e}static getDefaultDrawingOptions(e){We("Not implemented")}static get typesMap(){We("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,t),this._currentParent&&(we.#n.updateProperty(i,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)e.push([i,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[i,s]of this.constructor.typesMap)e.push([i,t[s]]);return e}_updateProperty(e,t,i){const s=this._drawingOptions,r=s[t],o=a=>{s.updateProperty(t,a);const l=this.#e.updateProperty(t,a);l&&this.#g(l),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#g(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#d()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#o([e,t,i,s]){const{parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[t,1-e,i*(o/r),s*(r/o)];case 180:return[1-e,1-t,i,s];case 270:return[1-t,e,i*(o/r),s*(r/o)];default:return[e,t,i,s]}}#p(){const{x:e,y:t,width:i,height:s,parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[1-t,e,i*(r/o),s*(o/r)];case 180:return[1-e,1-t,i,s];case 270:return[t,1-e,i*(r/o),s*(o/r)];default:return[e,t,i,s]}}#g(e){if([this.x,this.y,this.width,this.height]=this.#o(e),this.div){this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}this._onResized()}#m(){const{x:e,y:t,width:i,height:s,rotation:r,parentRotation:o,parentDimensions:[a,l]}=this;switch((r*4+o)/90){case 1:return[1-t-s,e,s,i];case 2:return[1-e-i,1-t-s,i,s];case 3:return[t,1-e-i,s,i];case 4:return[e,t-i*(a/l),s*(l/a),i*(a/l)];case 5:return[1-t,e,i*(a/l),s*(l/a)];case 6:return[1-e-s*(l/a),1-t,s*(l/a),i*(a/l)];case 7:return[t-i*(a/l),1-e-s*(l/a),i*(a/l),s*(l/a)];case 8:return[e-i,t-s,i,s];case 9:return[1-t,e-i,s,i];case 10:return[1-e,1-t,i,s];case 11:return[t-s,1-e,s,i];case 12:return[e-s*(l/a),t,s*(l/a),i*(a/l)];case 13:return[1-t-i*(a/l),e-s*(l/a),i*(a/l),s*(l/a)];case 14:return[1-e,1-t-i*(a/l),s*(l/a),i*(a/l)];case 15:return[t,1-e,i*(a/l),s*(l/a)];default:return[e,t,i,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties({bbox:this.#m()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,i,s,r){We("Not implemented")}static startDrawing(e,t,i,s){const{target:r,offsetX:o,offsetY:a,pointerId:l,pointerType:c}=s;if(we.#l&&we.#l!==c)return;const{viewport:{rotation:u}}=e,{width:f,height:m}=r.getBoundingClientRect(),y=we.#i=new AbortController,v=e.combinedSignal(y);if(we.#s||=l,we.#l??=c,window.addEventListener("pointerup",_=>{we.#s===_.pointerId?this._endDraw(_):we.#a?.delete(_.pointerId)},{signal:v}),window.addEventListener("pointercancel",_=>{we.#s===_.pointerId?this._currentParent.endDrawingSession():we.#a?.delete(_.pointerId)},{signal:v}),window.addEventListener("pointerdown",_=>{we.#l===_.pointerType&&((we.#a||=new Set).add(_.pointerId),we.#n.isCancellable()&&(we.#n.removeLastElement(),we.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Xn,{signal:v}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),r.addEventListener("touchmove",_=>{_.timeStamp===we.#u&&Cn(_)},{signal:v}),e.toggleDrawing(),t._editorUndoBar?.hide(),we.#n){e.drawLayer.updateProperties(this._currentDrawId,we.#n.startNew(o,a,f,m,u));return}t.updateUIForDefaultProperties(this),we.#n=this.createDrawerInstance(o,a,f,m,u),we.#r=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(we.#r.toSVGProperties(),we.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(we.#u=-1,!we.#n)return;const{offsetX:t,offsetY:i,pointerId:s}=e;if(we.#s===s){if(we.#a?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,we.#n.add(t,i)),we.#u=e.timeStamp,Cn(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,we.#n=null,we.#r=null,we.#l=null,we.#u=NaN),we.#i&&(we.#i.abort(),we.#i=null,we.#s=NaN,we.#a=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,we.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=we.#n,s=this._currentDrawId,r=i.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,i.setLastElement(r))},undo:()=>{t.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:Fe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Fe.DRAW_STEP),!we.#n.isEmpty()){const{pageDimensions:[i,s],scale:r}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:we.#n.getOutlines(i*r,s*r,r,this._INNER_MARGIN),drawingOptions:we.#r,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,i,s,r,o){We("Not implemented")}static async deserialize(e,t,i){const{rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:a}}=t.viewport,l=this.deserializeDraw(o,a,s,r,this._INNER_MARGIN,e),c=await super.deserialize(e,t,i);return c.createDrawingOptions(e),c.#c({drawOutlines:l}),c.#f(),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){const[t,i]=this.pageTranslation,[s,r]=this.pageDimensions;return this.#e.serialize([t,i,s,r],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class KY{#e=new Float64Array(6);#t;#n;#i;#r;#s;#l="";#a=0;#u=new Rh;#c;#h;constructor(e,t,i,s,r,o){this.#c=i,this.#h=s,this.#i=r,this.#r=o,[e,t]=this.#d(e,t);const a=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#n=[{line:a,points:this.#s}],this.#e.set(a,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#d(e,t){return ae._normalizePoint(e,t,this.#c,this.#h,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#d(e,t);const[i,s,r,o]=this.#e.subarray(2,6),a=e-r,l=t-o;return Math.hypot(this.#c*a,this.#h*l)<=2?null:(this.#s.push(e,t),isNaN(i)?(this.#e.set([r,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([i,s,r,o,e,t],0),this.#t.push(...ae.createBezierPoints(i,s,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){this.#c=i,this.#h=s,this.#i=r,[e,t]=this.#d(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const a=this.#n.at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),this.#n.push({line:o,points:this.#s}),this.#e.set(o,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#s=e.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#l="";for(let e=0,t=this.#n.length;e<t;e++){const{line:i,points:s}=this.#n[e];this.#t=i,this.#s=s,this.#a=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=ae.svgRound(this.#t[4]),t=ae.svgRound(this.#t[5]);if(this.#s.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#s.length<=6){const s=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,s)} M ${e} ${t}`,this.#a=6}if(this.#s.length===4){const s=ae.svgRound(this.#t[10]),r=ae.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${s} ${r}`,this.#a=12,this.#l}const i=[];this.#a===0&&(i.push(`M ${e} ${t}`),this.#a=6);for(let s=this.#a,r=this.#t.length;s<r;s+=6){const[o,a,l,c,u,f]=this.#t.slice(s,s+6).map(ae.svgRound);i.push(`C${o} ${a} ${l} ${c} ${u} ${f}`)}return this.#l+=i.join(" "),this.#a=this.#t.length,this.#l}getOutlines(e,t,i,s){const r=this.#n.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#u.build(this.#n,e,t,i,this.#i,this.#r,s),this.#e=null,this.#t=null,this.#n=null,this.#l=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Rh extends ae{#e;#t=0;#n;#i;#r;#s;#l;#a;#u;build(e,t,i,s,r,o,a){this.#r=t,this.#s=i,this.#l=s,this.#a=r,this.#u=o,this.#n=a??0,this.#i=e,this.#d()}setLastElement(e){return this.#i.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#i){if(e.push(`M${ae.svgRound(t[4])} ${ae.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${ae.svgRound(t[10])} ${ae.svgRound(t[11])}`);continue}for(let i=6,s=t.length;i<s;i+=6){const[r,o,a,l,c,u]=t.subarray(i,i+6).map(ae.svgRound);e.push(`C${r} ${o} ${a} ${l} ${c} ${u}`)}}return e.join("")}serialize([e,t,i,s],r){const o=[],a=[],[l,c,u,f]=this.#h();let m,y,v,_,x,T,S,C,D;switch(this.#a){case 0:D=ae._rescale,m=e,y=t+s,v=i,_=-s,x=e+l*i,T=t+(1-c-f)*s,S=e+(l+u)*i,C=t+(1-c)*s;break;case 90:D=ae._rescaleAndSwap,m=e,y=t,v=i,_=s,x=e+c*i,T=t+l*s,S=e+(c+f)*i,C=t+(l+u)*s;break;case 180:D=ae._rescale,m=e+i,y=t,v=-i,_=s,x=e+(1-l-u)*i,T=t+c*s,S=e+(1-l)*i,C=t+(c+f)*s;break;case 270:D=ae._rescaleAndSwap,m=e+i,y=t+s,v=-i,_=-s,x=e+(1-c-f)*i,T=t+(1-l-u)*s,S=e+(1-c)*i,C=t+(1-l)*s;break}for(const{line:F,points:V}of this.#i)o.push(D(F,m,y,v,_,r?new Array(F.length):null)),a.push(D(V,m,y,v,_,r?new Array(V.length):null));return{lines:o,points:a,rect:[x,T,S,C]}}static deserialize(e,t,i,s,r,{paths:{lines:o,points:a},rotation:l,thickness:c}){const u=[];let f,m,y,v,_;switch(l){case 0:_=ae._rescale,f=-e/i,m=t/s+1,y=1/i,v=-1/s;break;case 90:_=ae._rescaleAndSwap,f=-t/s,m=-e/i,y=1/s,v=1/i;break;case 180:_=ae._rescale,f=e/i+1,m=-t/s,y=-1/i,v=1/s;break;case 270:_=ae._rescaleAndSwap,f=t/s+1,m=e/i+1,y=-1/s,v=-1/i;break}if(!o){o=[];for(const T of a){const S=T.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1],NaN,NaN,NaN,NaN,T[2],T[3]]));continue}const C=new Float32Array(3*(S-2));o.push(C);let[D,F,V,I]=T.subarray(0,4);C.set([NaN,NaN,NaN,NaN,D,F],0);for(let E=4;E<S;E+=2){const A=T[E],N=T[E+1];C.set(ae.createBezierPoints(D,F,V,I,A,N),(E-2)*3),[D,F,V,I]=[V,I,A,N]}}}for(let T=0,S=o.length;T<S;T++)u.push({line:_(o[T].map(C=>C??NaN),f,m,y,v),points:_(a[T].map(C=>C??NaN),f,m,y,v)});const x=new Rh;return x.build(u,i,s,1,l,c,r),x}#c(e=this.#u){const t=this.#n+e/2*this.#l;return this.#a%180===0?[t/this.#r,t/this.#s]:[t/this.#s,t/this.#r]}#h(){const[e,t,i,s]=this.#e,[r,o]=this.#c(0);return[e+r,t+o,i-2*r,s-2*o]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#i){if(s.length<=12){for(let a=4,l=s.length;a<l;a+=6){const[c,u]=s.subarray(a,a+2);e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],u),e[2]=Math.max(e[2],c),e[3]=Math.max(e[3],u)}continue}let r=s[4],o=s[5];for(let a=6,l=s.length;a<l;a+=6){const[c,u,f,m,y,v]=s.subarray(a,a+6);me.bezierBoundingBox(r,o,c,u,f,m,y,v,e),r=y,o=v}}const[t,i]=this.#c();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,i]=this.#c();this.#u=e;const[s,r]=this.#c(),[o,a]=[s-t,r-i],l=this.#e;return l[0]-=o,l[1]-=a,l[2]+=2*o,l[3]+=2*a,l}updateParentDimensions([e,t],i){const[s,r]=this.#c();this.#r=e,this.#s=t,this.#l=i;const[o,a]=this.#c(),l=o-s,c=a-r,u=this.#e;return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ae.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ae.svgRound(e)} ${ae.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let i=0,s=0,r=0,o=0,a=0,l=0;switch(this.#t){case 90:s=t/e,r=-e/t,a=e;break;case 180:i=-1,o=-1,a=e,l=t;break;case 270:s=-t/e,r=e/t,l=t;break;default:return""}return`matrix(${i} ${s} ${r} ${o} ${ae.svgRound(a)} ${ae.svgRound(l)})`}getPathResizingSVGProperties([e,t,i,s]){const[r,o]=this.#c(),[a,l,c,u]=this.#e;if(Math.abs(c-r)<=ae.PRECISION||Math.abs(u-o)<=ae.PRECISION){const _=e+i/2-(a+c/2),x=t+s/2-(l+u/2);return{path:{"transform-origin":`${ae.svgRound(e)} ${ae.svgRound(t)}`,transform:`${this.rotationTransform} translate(${_} ${x})`}}}const f=(i-2*r)/(c-2*r),m=(s-2*o)/(u-2*o),y=c/i,v=u/s;return{path:{"transform-origin":`${ae.svgRound(a)} ${ae.svgRound(l)}`,transform:`${this.rotationTransform} scale(${y} ${v}) translate(${ae.svgRound(r)} ${ae.svgRound(o)}) scale(${f} ${m}) translate(${ae.svgRound(-r)} ${ae.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,i,s]){const[r,o]=this.#c(),a=this.#e,[l,c,u,f]=a;if(a[0]=e,a[1]=t,a[2]=i,a[3]=s,Math.abs(u-r)<=ae.PRECISION||Math.abs(f-o)<=ae.PRECISION){const x=e+i/2-(l+u/2),T=t+s/2-(c+f/2);for(const{line:S,points:C}of this.#i)ae._translate(S,x,T,S),ae._translate(C,x,T,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ae.svgRound(e)} ${ae.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*r)/(u-2*r),y=(s-2*o)/(f-2*o),v=-m*(l+r)+e+r,_=-y*(c+o)+t+o;if(m!==1||y!==1||v!==0||_!==0)for(const{line:x,points:T}of this.#i)ae._rescale(x,v,_,m,y,x),ae._rescale(T,v,_,m,y,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ae.svgRound(e)} ${ae.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],i){const[s,r]=i,o=this.#e,a=e-o[0],l=t-o[1];if(this.#r===s&&this.#s===r)for(const{line:c,points:u}of this.#i)ae._translate(c,a,l,c),ae._translate(u,a,l,u);else{const c=this.#r/s,u=this.#s/r;this.#r=s,this.#s=r;for(const{line:f,points:m}of this.#i)ae._rescale(f,a,l,c,u,f),ae._rescale(m,a,l,c,u,m);o[2]*=c,o[3]*=u}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ae.svgRound(e)} ${ae.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ae.svgRound(e[0])} ${ae.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class $y extends WY{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:_e._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new $y(this.#e);return e.updateAll(this),e}}class Wy extends we{static _type="ink";static _editorType=Ie.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){_e.initialize(e,t),this._defaultDrawingOptions=new $y(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return ke(this,"typesMap",new Map([[Fe.INK_THICKNESS,"stroke-width"],[Fe.INK_COLOR,"stroke"],[Fe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,s,r){return new KY(e,t,i,s,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,s,r,o){return Rh.deserialize(e,t,i,s,r,o)}static async deserialize(e,t,i){let s=null;if(e instanceof Gy){const{data:{inkLists:o,rect:a,rotation:l,id:c,color:u,opacity:f,borderStyle:{rawWidth:m},popupRef:y},parent:{page:{pageNumber:v}}}=e;s=e={annotationType:Ie.INK,color:Array.from(u),thickness:m,opacity:f,paths:{points:o},boxes:null,pageIndex:v-1,rect:a.slice(0),rotation:l,id:c,deleted:!1,popupRef:y}}const r=await super.deserialize(e,t,i);return r.annotationElementId=e.id||null,r._initialData=s,r}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=Wy.getDefaultDrawingOptions({stroke:me.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:i,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":a}}=this,l={annotationType:Ie.INK,color:_e._colorManager.convert(r),opacity:o,thickness:a,paths:{lines:t,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:i,opacity:s,pageIndex:r}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((o,a)=>o!==t[a])||e.thickness!==i||e.opacity!==s||e.pageIndex!==r}renderAnnotationElement(e){const{points:t,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Ky extends _e{#e=null;#t=null;#n=null;#i=null;#r=null;#s="";#l=null;#a=null;#u=!1;#c=!1;static _type="stamp";static _editorType=Ie.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#i=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){_e.initialize(e,t)}static get supportedTypes(){return ke(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return ke(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(Ie.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#u=e.isSvg),e.file&&(this.#s=e.file.name),this.#o()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:r,height:o}=e||this.copyCanvas(null,null,!0).imageData,a=await i.guess({name:"altText",request:{data:s,width:r,height:o,channels:s.length/(r*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const l=a.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(i=>this.#h(i,!0)).finally(()=>this.#d());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#h(s)).finally(()=>this.#d());return}if(this.#r){const i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(s=>this.#h(s)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=Ky.supportedTypesStr;const t=this._uiManager._signal;this.#n=new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}i()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#a&&(clearTimeout(this.#a),this.#a=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#o():this.#f(),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#a!==null&&clearTimeout(this.#a);const e=200;this.#a=setTimeout(()=>{this.#a=null,this.#g()},e)}#o(){const{div:e}=this;let{width:t,height:i}=this.#e;const[s,r]=this.pageDimensions,o=.75;if(this.width)t=this.width*s,i=this.height*r;else if(t>o*s||i>o*r){const u=Math.min(o*s/t,o*r/i);t*=u,i*=u}const[a,l]=this.parentDimensions;this.setDims(t*a/s,i*l/r),this._uiManager.enableWaiting(!1);const c=this.#l=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=i/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&c.setAttribute("aria-label",this.#s)}copyCanvas(e,t,i=!1){e||(e=224);const{width:s,height:r}=this.#e,o=new ym;let a=this.#e,l=s,c=r,u=null;if(t){if(s>t||r>t){const V=Math.min(t/s,t/r);l=Math.floor(s*V),c=Math.floor(r*V)}u=document.createElement("canvas");const m=u.width=Math.ceil(l*o.sx),y=u.height=Math.ceil(c*o.sy);this.#u||(a=this.#p(m,y));const v=u.getContext("2d");v.filter=this._uiManager.hcmFilter;let _="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",x="#42414d");const T=15,S=T*o.sx,C=T*o.sy,D=new OffscreenCanvas(S*2,C*2),F=D.getContext("2d");F.fillStyle=_,F.fillRect(0,0,S*2,C*2),F.fillStyle=x,F.fillRect(0,0,S,C),F.fillRect(S,C,S,C),v.fillStyle=v.createPattern(D,"repeat"),v.fillRect(0,0,m,y),v.drawImage(a,0,0,a.width,a.height,0,0,m,y)}let f=null;if(i){let m,y;if(o.symmetric&&a.width<e&&a.height<e)m=a.width,y=a.height;else if(a=this.#e,s>e||r>e){const x=Math.min(e/s,e/r);m=Math.floor(s*x),y=Math.floor(r*x),this.#u||(a=this.#p(m,y))}const _=new OffscreenCanvas(m,y).getContext("2d",{willReadFrequently:!0});_.drawImage(a,0,0,a.width,a.height,0,0,m,y),f={width:m,height:y,data:_.getImageData(0,0,m,y).data}}return{canvas:u,width:l,height:c,imageData:f}}#p(e,t){const{width:i,height:s}=this.#e;let r=i,o=s,a=this.#e;for(;r>2*e||o>2*t;){const l=r,c=o;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(r,o);u.getContext("2d").drawImage(a,0,0,l,c,0,0,r,o),a=u.transferToImageBitmap()}return a}#g(){const[e,t]=this.parentDimensions,{width:i,height:s}=this,r=new ym,o=Math.ceil(i*e*r.sx),a=Math.ceil(s*t*r.sy),l=this.#l;if(!l||l.width===o&&l.height===a)return;l.width=o,l.height=a;const c=this.#u?this.#e:this.#p(o,a),u=l.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(c,0,0,c.width,c.height,0,0,o,a)}getImageForAltText(){return this.#l}#m(e){if(e){if(this.#u){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#u){const[t,i]=this.pageDimensions,s=Math.round(this.width*t*ea.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*ea.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,r);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,r),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,i){let s=null;if(e instanceof $S){const{data:{rect:v,rotation:_,id:x,structParent:T,popupRef:S},container:C,parent:{page:{pageNumber:D}}}=e,F=C.querySelector("canvas"),V=i.imageManager.getFromCanvas(C.id,F);F.remove();const I=(await t._structTree.getAriaAttributes(`${Dy}${x}`))?.get("aria-label")||"";s=e={annotationType:Ie.STAMP,bitmapId:V.id,bitmap:V.bitmap,pageIndex:D-1,rect:v.slice(0),rotation:_,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:T,popupRef:S}}const r=await super.deserialize(e,t,i),{rect:o,bitmap:a,bitmapUrl:l,bitmapId:c,isSvg:u,accessibilityData:f}=e;c&&i.imageManager.isValidId(c)?(r.#t=c,a&&(r.#e=a)):r.#i=l,r.#u=u;const[m,y]=r.pageDimensions;return r.width=(o[2]-o[0])/m,r.height=(o[3]-o[1])/y,r.annotationElementId=e.id||null,f&&(r.altTextData=f),r._initialData=s,r.#c=!!s,r}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Ie.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#u,structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=this.#m(!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:r}=this.serializeAltText(!1);if(!s&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const a=this.#y(i);if(a.isSame)return null;a.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,t===null)return i;t.stamps||=new Map;const o=this.#u?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:i}),i.bitmap=this.#m(!1);else if(this.#u){const a=t.stamps.get(this.#t);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#m(!1))}return i}#y(e){const{pageIndex:t,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===t,r=(e.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Pi{#e;#t=!1;#n=null;#i=null;#r=null;#s=new Map;#l=!1;#a=!1;#u=!1;#c=null;#h=null;#d=null;#f=null;#o;static _initialized=!1;static#p=new Map([Pt,Wy,Ky,yt].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:u}){const f=[...Pi.#p.values()];if(!Pi._initialized){Pi._initialized=!0;for(const m of f)m.initialize(u,e)}e.registerEditorTypes(f),this.#o=e,this.pageIndex=t,this.div=i,this.#e=r,this.#n=o,this.viewport=c,this.#d=l,this.drawLayer=a,this._structTree=s,this.#o.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===Ie.NONE}updateToolbar(e){this.#o.updateToolbar(e)}updateMode(e=this.#o.getMode()){switch(this.#v(),e){case Ie.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ie.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ie.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of Pi.#p.values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#o.setEditingState(e)}addCommands(e){this.#o.addCommands(e)}cleanUndoStack(e){this.#o.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of this.#s.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#o.removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!this.#n){this.#u=!1;return}const t=this.#n.getEditableAnnotations();for(const i of t){if(i.hide(),this.#o.isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}this.#u=!1}disable(){this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const r of s){const{id:o}=r.data;if(this.#o.isDeletedAnnotationElement(o))continue;let a=t.get(o);if(a){a.resetAnnotationElement(r),a.show(!1),r.show();continue}a=e.get(o),a&&(this.#o.addChangedExistingAnnotation(a),a.renderAnnotationElement(r)&&a.show(!1)),r.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Pi.#p.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#a=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#o.getActive()!==e&&this.#o.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const e=this.#o.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#g.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#g(e){this.#o.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:i}=hn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#o.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),yt.startHighlighting(this,this.#o.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#o._signal}),e.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const e=this.#o.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#i?.abort(),this.#i=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#o.isDeletedAnnotationElement(t)&&this.#o.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#a&&e.annotationElementId&&this.#o.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#o.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#o.addDeletedAnnotationElement(e.annotationElementId),_e.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#o.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#u),this.#o.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#o._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return this.#o.getId()}get#m(){return Pi.#p.get(this.#o.getMode())}combinedSignal(e){return this.#o.combinedSignal(e)}#y(e){const t=this.#m;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#o.updateToolbar(e),this.#o.updateMode(e);const{offsetX:i,offsetY:s}=this.#_(),r=this.getNextId(),o=this.#y({parent:this,id:r,x:i,y:s,uiManager:this.#o,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Pi.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#o)||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=this.#y({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#o,isCentered:t,...i});return r&&this.add(r),r}#_(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),c=(r+a)/2-e,u=(o+l)/2-t,[f,m]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:f,offsetY:m}}addNewEditor(){this.createAndAddNewEditor(this.#_(),!0)}setSelected(e){this.#o.setSelected(e)}toggleSelected(e){this.#o.toggleSelected(e)}unselect(e){this.#o.unselect(e)}pointerup(e){const{isMac:t}=hn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#l&&(this.#l=!1,!(this.#m?.isDrawer&&this.#m.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#o.getMode()===Ie.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#o.getMode()===Ie.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=hn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#m?.isDrawer){this.startDrawingSession(e);return}const i=this.#o.getActive();this.#t=!i||i.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#c){this.#m.startDrawing(this,this.#o,!1,e);return}this.#o.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#o.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#m.startDrawing(this,this.#o,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#c?(this.#o.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#m.endDrawing(e)):null}findNewParent(e,t,i){const s=this.#o.findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#o.removeLayer(this)}#v(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Dr(this.div,e);for(const t of this.#o.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#o.commitOrRemove(),this.#v();const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Dr(this.div,{rotation:i}),t!==i)for(const s of this.#s.values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#o.viewParameters.realScale}}class on{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(const t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return ke(this,"_svgFactory",new Hy)}static#r(e,[t,i,s,r]){const{style:o}=e;o.top=`${100*i}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*r}%`}#s(){const e=on._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const i=on._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=on._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s}#a(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)}draw(e,t=!1,i=!1){const s=this.#t++,r=this.#s(),o=on._svgFactory.createElement("defs");r.append(o);const a=on._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(s,a);const c=i?this.#l(o,l):null,u=on._svgFactory.createElement("use");return r.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(r,e),this.#n.set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=this.#t++,s=this.#s(),r=on._svgFactory.createElement("defs");s.append(r);const o=on._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=on._svgFactory.createElement("mask");r.append(f),l=`mask_p${this.pageIndex}_${i}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const m=on._svgFactory.createElement("rect");f.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const y=on._svgFactory.createElement("use");f.append(y),y.setAttribute("href",`#${a}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const c=on._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return s.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#n.set(i,s),i}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:i,bbox:s,rootClass:r,path:o}=t,a=typeof e=="number"?this.#n.get(e):e;if(a){if(i&&this.#a(a,i),s&&on.#r(a,s),r){const{classList:l}=a;for(const[c,u]of Object.entries(r))l.toggle(c,u)}if(o){const c=a.firstChild.firstChild;this.#a(c,o)}}}updateParent(e,t){if(t===this)return;const i=this.#n.get(e);i&&(t.#e.append(i),this.#n.delete(e),t.#n.set(e,i))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(const e of this.#n.values())e.remove();this.#n.clear(),this.#i.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:bm};var YY=Te.AbortException,JY=Te.AnnotationEditorLayer,XY=Te.AnnotationEditorParamsType,QY=Te.AnnotationEditorType,ZY=Te.AnnotationEditorUIManager,eJ=Te.AnnotationLayer,tJ=Te.AnnotationMode,nJ=Te.ColorPicker,iJ=Te.DOMSVGFactory,sJ=Te.DrawLayer,rJ=Te.FeatureTest,KS=Te.GlobalWorkerOptions,oJ=Te.ImageKind,aJ=Te.InvalidPDFException,lJ=Te.MissingPDFException,cJ=Te.OPS,uJ=Te.OutputScale,dJ=Te.PDFDataRangeTransport,hJ=Te.PDFDateString,fJ=Te.PDFWorker,pJ=Te.PasswordResponses,mJ=Te.PermissionFlag,gJ=Te.PixelsPerInch,yJ=Te.RenderingCancelledException,vJ=Te.TextLayer,wJ=Te.TouchManager,_J=Te.UnexpectedResponseException,bJ=Te.Util,xJ=Te.VerbosityLevel,TJ=Te.XfaLayer,EJ=Te.build,AJ=Te.createValidAbsoluteUrl,IJ=Te.fetchData,CJ=Te.getDocument,SJ=Te.getFilenameFromUrl,PJ=Te.getPdfFilenameFromUrl,kJ=Te.getXfaPageViewport,RJ=Te.isDataScheme,NJ=Te.isPdfFile,MJ=Te.noContextMenu,DJ=Te.normalizeUnicode,LJ=Te.setLayerDimensions,FJ=Te.shadow,VJ=Te.stopEvent,YS=Te.version;const DX=Object.freeze(Object.defineProperty({__proto__:null,AbortException:YY,AnnotationEditorLayer:JY,AnnotationEditorParamsType:XY,AnnotationEditorType:QY,AnnotationEditorUIManager:ZY,AnnotationLayer:eJ,AnnotationMode:tJ,ColorPicker:nJ,DOMSVGFactory:iJ,DrawLayer:sJ,FeatureTest:rJ,GlobalWorkerOptions:KS,ImageKind:oJ,InvalidPDFException:aJ,MissingPDFException:lJ,OPS:cJ,OutputScale:uJ,PDFDataRangeTransport:dJ,PDFDateString:hJ,PDFWorker:fJ,PasswordResponses:pJ,PermissionFlag:mJ,PixelsPerInch:gJ,RenderingCancelledException:yJ,TextLayer:vJ,TouchManager:wJ,UnexpectedResponseException:_J,Util:bJ,VerbosityLevel:xJ,XfaLayer:TJ,build:EJ,createValidAbsoluteUrl:AJ,fetchData:IJ,getDocument:CJ,getFilenameFromUrl:SJ,getPdfFilenameFromUrl:PJ,getXfaPageViewport:kJ,isDataScheme:RJ,isPdfFile:NJ,noContextMenu:MJ,normalizeUnicode:DJ,setLayerDimensions:LJ,shadow:FJ,stopEvent:VJ,version:YS},Symbol.toStringTag,{value:"Module"}));KS.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${YS}/build/pdf.worker.mjs`;const JS=document.getElementById("root");if(!JS)throw new Error("Could not find root element to mount to");const OJ=AP.createRoot(JS);OJ.render(p.jsx(Ad.StrictMode,{children:p.jsx(Ek,{children:p.jsx(YW,{})})}));export{z8 as $,cO as A,sc as B,lO as C,Mc as D,C8 as E,j8 as F,Ay as G,wf as H,SX as I,M8 as J,RX as K,Be as L,PX as M,uO as N,E_ as O,AX as P,$b as Q,aO as R,gd as S,cr as T,R8 as U,ZJ as V,CX as W,QJ as X,$n as Y,sX as Z,fe as _,ia as a,gh as a0,rO as a1,TW as a2,tO as a3,H8 as a4,Ty as a5,hO as a6,yh as a7,eO as a8,bC as a9,mX as aA,gX as aB,yX as aC,L8 as aD,iX as aE,eX as aF,N8 as aG,yC as aH,fx as aI,vh as aJ,Ey as aK,vf as aL,nO as aM,bX as aN,xX as aO,nX as aP,E8 as aQ,ya as aR,Sm as aS,B8 as aT,U8 as aU,IC as aV,xC as aW,NX as aX,q8 as aY,W8 as aZ,DX as a_,G8 as aa,Qp as ab,dX as ac,wX as ad,uX as ae,IX as af,fs as ag,TC as ah,Z8 as ai,Q8 as aj,hX as ak,fX as al,pX as am,_X as an,vX as ao,iO as ap,rX as aq,mC as ar,JJ as as,dt as at,Vt as au,oX as av,lX as aw,cX as ax,aX as ay,EC as az,MX as b,Nc as c,Ti as d,A_ as e,CC as f,VG as g,xy as h,tX as i,p as j,Ad as k,kX as l,mS as m,TX as n,EX as o,Ki as p,sO as q,P as r,BJ as s,kW as t,Nn as u,_f as v,oO as w,va as x,AC as y,XJ as z};
