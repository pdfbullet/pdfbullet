import{u as I,r as n,j as e,Y as E,p as T,f as U,aH as O,at as _,S as z,L as k,ap as K,aq as Z}from"./main-CCvC7wqh.js";import"./react-Ckhrjn13.js";const H=({isOpen:l,onClose:i,mode:m})=>{const{user:w,saveFaceDescriptor:b,loginWithFace:p}=I(),[u,t]=n.useState("LOADING_MODELS"),[y,s]=n.useState("Initializing..."),[x,c]=n.useState(""),[g,N]=n.useState(""),o=n.useRef(null),h=n.useRef(null),f=n.useRef(null),r=n.useRef(!1),j=n.useCallback(()=>{h.current?.getTracks().forEach(a=>a.stop()),h.current=null,f.current&&(clearInterval(f.current),f.current=null),t("LOADING_MODELS"),s("Initializing..."),c(""),N("")},[]),S=n.useCallback(async()=>{if(c(""),t("LOADING_MODELS"),s("Initializing..."),typeof faceapi>"u"){c("Face recognition library could not be loaded. Please check your connection.");return}if(!r.current)try{await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("/models"),faceapi.nets.faceLandmark68Net.loadFromUri("/models"),faceapi.nets.faceRecognitionNet.loadFromUri("/models")]),r.current=!0}catch{c("Could not load AI models. Please check your connection and refresh.");return}try{const a=await navigator.permissions.query({name:"camera"});a.state==="granted"?t(m==="register"?"CAMERA_ACTIVE":"NEEDS_EMAIL"):a.state==="denied"?t("PERMS_DENIED"):t("NEEDS_PERMS")}catch{t("NEEDS_PERMS")}},[m]);n.useEffect(()=>(l?S():j(),j),[l,S,j]);const L=async()=>{s("Initializing..."),c("");try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(d=>d.stop()),t(m==="register"?"CAMERA_ACTIVE":"NEEDS_EMAIL")}catch{t("PERMS_DENIED")}},v=n.useCallback(async()=>{if(!(h.current||!o.current)){s("Initializing...");try{const a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});h.current=a,o.current&&(o.current.srcObject=a)}catch{c("Failed to start camera. Please ensure permissions are granted."),t("PERMS_DENIED")}}},[]);n.useEffect(()=>{u==="CAMERA_ACTIVE"&&v()},[u,v]);const A=async a=>{if(!o.current||o.current.paused||typeof faceapi>"u")return;const d=await faceapi.detectAllFaces(o.current,new faceapi.TinyFaceDetectorOptions).withFaceLandmarks().withFaceDescriptors();if(d.length===0){s("No face detected");return}if(d.length>1){s("Multiple faces detected");return}a(d[0].descriptor)},D=()=>{s("Hold still, capturing..."),A(async a=>{s("Saving your face data...");try{await b(Array.from(a)),t("SUCCESS"),setTimeout(i,2e3)}catch(d){c(d.message||"Could not save face data."),t("NEEDS_PERMS")}})},F=async a=>{if(a?.preventDefault(),!g.trim()){c("Email is required.");return}c("");try{const C=await _.collection("users").where("email","==",g.trim()).limit(1).get();if(C.empty)throw new Error("No account found with this email.");const M=C.docs[0].data();if(!M.faceDescriptor)throw new Error("Face Login is not set up for this account.");const R=new Float32Array(M.faceDescriptor);t("CAMERA_ACTIVE"),o.current?.addEventListener("play",()=>{s("Position your face in the oval"),f.current=window.setInterval(async()=>{s("Verifying..."),await A(async B=>{if(faceapi.euclideanDistance(R,B)<.5){f.current&&clearInterval(f.current),s("Face matched! Logging in...");try{await p(g),t("SUCCESS"),setTimeout(i,1500)}catch(G){c(G.message),t("NEEDS_EMAIL")}}else s("Face not recognized. Trying again...")})},2500)})}catch(d){c(d.message)}},P=()=>{switch(u){case"LOADING_MODELS":return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-red mx-auto"}),e.jsx("p",{className:"mt-4",children:"Loading AI models..."})]});case"NEEDS_PERMS":return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(O,{className:"h-12 w-12 mx-auto text-blue-500 mb-4"}),e.jsx("h3",{className:"font-bold text-lg",children:"Camera Access Required"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"This feature needs your permission to use the camera for face recognition."}),e.jsx("button",{onClick:L,className:"mt-6 w-full bg-brand-red text-white font-bold py-2.5 rounded-md",children:"Enable Camera"})]});case"PERMS_DENIED":return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(U,{className:"h-12 w-12 mx-auto text-red-500 mb-4"}),e.jsx("h3",{className:"font-bold text-lg",children:"Camera Access Denied"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"You've denied camera access. Please enable it in your browser's site settings to use this feature."}),e.jsx("button",{onClick:i,className:"mt-6 w-full bg-gray-600 text-white font-bold py-2.5 rounded-md",children:"Close"})]});case"NEEDS_EMAIL":return e.jsxs("form",{onSubmit:F,className:"p-6 space-y-4",children:[e.jsx("h3",{className:"font-bold text-center",children:"Continue with Face ID"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"face-login-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Enter your account email"}),e.jsx("input",{type:"email",id:"face-login-email",value:g,onChange:a=>N(a.target.value),required:!0,className:"w-full mt-1 p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-black",placeholder:"you@example.com"})]}),x&&e.jsx("p",{className:"text-sm text-red-500",children:x}),e.jsx("button",{type:"submit",className:"w-full bg-brand-red text-white font-bold py-2.5 rounded-md hover:bg-brand-red-dark",children:"Continue"})]});case"CAMERA_ACTIVE":return e.jsxs("div",{className:"p-6 text-center",children:[e.jsxs("div",{className:"relative w-64 h-48 mx-auto bg-black rounded-lg overflow-hidden border border-gray-300 dark:border-gray-700",children:[e.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover transform -scale-x-100"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-40 h-56 border-4 border-white/50 rounded-[50%]"})})]}),e.jsx("p",{className:"mt-4 font-semibold h-5",children:y}),m==="register"&&e.jsx("button",{onClick:D,className:"w-full mt-4 bg-brand-red text-white font-bold py-2 rounded-md",children:"Capture Face"})]});case"SUCCESS":return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h3",{className:"font-bold text-green-600",children:"Success!"}),e.jsx("p",{children:m==="register"?"Face login has been set up.":"You have been logged in."})]});default:return null}};return l?m==="signup_redirect"?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4",onClick:i,children:e.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-sm rounded-lg shadow-xl p-6 text-center",onClick:a=>a.stopPropagation(),children:[e.jsx(E,{className:"h-10 w-10 mx-auto text-brand-red mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Set Up Face Login After Sign Up"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Please sign up with another method first. You can then enable Face Login from your ",e.jsx("strong",{children:"Account Settings"})," page."]}),e.jsx("button",{onClick:i,className:"mt-4 w-full bg-brand-red text-white font-bold py-2 px-4 rounded-md",children:"Got it"})]})}):e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center p-4",onClick:i,children:e.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-sm rounded-lg shadow-xl",onClick:a=>a.stopPropagation(),children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold",children:m==="register"?"Set Up Face Login":"Continue with Face ID"}),e.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-800",children:e.jsx(T,{className:"h-6 w-6"})})]}),P()]})}):null},Y=[{code:"AF",name:"Afghanistan",flag:"ğŸ‡¦ğŸ‡«"},{code:"AL",name:"Albania",flag:"ğŸ‡¦ğŸ‡±"},{code:"DZ",name:"Algeria",flag:"ğŸ‡©ğŸ‡¿"},{code:"AD",name:"Andorra",flag:"ğŸ‡¦ğŸ‡©"},{code:"AO",name:"Angola",flag:"ğŸ‡¦ğŸ‡´"},{code:"AG",name:"Antigua & Barbuda",flag:"ğŸ‡¦ğŸ‡¬"},{code:"AR",name:"Argentina",flag:"ğŸ‡¦ğŸ‡·"},{code:"AM",name:"Armenia",flag:"ğŸ‡¦ğŸ‡²"},{code:"AU",name:"Australia",flag:"ğŸ‡¦ğŸ‡º"},{code:"AT",name:"Austria",flag:"ğŸ‡¦ğŸ‡¹"},{code:"AZ",name:"Azerbaijan",flag:"ğŸ‡¦ğŸ‡¿"},{code:"BS",name:"Bahamas",flag:"ğŸ‡§ğŸ‡¸"},{code:"BH",name:"Bahrain",flag:"ğŸ‡§ğŸ‡­"},{code:"BD",name:"Bangladesh",flag:"ğŸ‡§ğŸ‡©"},{code:"BB",name:"Barbados",flag:"ğŸ‡§ğŸ‡§"},{code:"BY",name:"Belarus",flag:"ğŸ‡§ğŸ‡¾"},{code:"BE",name:"Belgium",flag:"ğŸ‡§ğŸ‡ª"},{code:"BZ",name:"Belize",flag:"ğŸ‡§ğŸ‡¿"},{code:"BJ",name:"Benin",flag:"ğŸ‡§ğŸ‡¯"},{code:"BT",name:"Bhutan",flag:"ğŸ‡§ğŸ‡¹"},{code:"BO",name:"Bolivia",flag:"ğŸ‡§ğŸ‡´"},{code:"BA",name:"Bosnia & Herzegovina",flag:"ğŸ‡§ğŸ‡¦"},{code:"BW",name:"Botswana",flag:"ğŸ‡§ğŸ‡¼"},{code:"BR",name:"Brazil",flag:"ğŸ‡§ğŸ‡·"},{code:"BN",name:"Brunei",flag:"ğŸ‡§ğŸ‡³"},{code:"BG",name:"Bulgaria",flag:"ğŸ‡§ğŸ‡¬"},{code:"BF",name:"Burkina Faso",flag:"ğŸ‡§ğŸ‡«"},{code:"BI",name:"Burundi",flag:"ğŸ‡§ğŸ‡®"},{code:"CV",name:"Cape Verde",flag:"ğŸ‡¨ğŸ‡»"},{code:"KH",name:"Cambodia",flag:"ğŸ‡°ğŸ‡­"},{code:"CM",name:"Cameroon",flag:"ğŸ‡¨ğŸ‡²"},{code:"CA",name:"Canada",flag:"ğŸ‡¨ğŸ‡¦"},{code:"CF",name:"Central African Republic",flag:"ğŸ‡¨ğŸ‡«"},{code:"TD",name:"Chad",flag:"ğŸ‡¹ğŸ‡©"},{code:"CL",name:"Chile",flag:"ğŸ‡¨ğŸ‡±"},{code:"CN",name:"China",flag:"ğŸ‡¨ğŸ‡³"},{code:"CO",name:"Colombia",flag:"ğŸ‡¨ğŸ‡´"},{code:"KM",name:"Comoros",flag:"ğŸ‡°ğŸ‡²"},{code:"CG",name:"Congo",flag:"ğŸ‡¨ğŸ‡¬"},{code:"CR",name:"Costa Rica",flag:"ğŸ‡¨ğŸ‡·"},{code:"HR",name:"Croatia",flag:"ğŸ‡­ğŸ‡·"},{code:"CU",name:"Cuba",flag:"ğŸ‡¨ğŸ‡º"},{code:"CY",name:"Cyprus",flag:"ğŸ‡¨ğŸ‡¾"},{code:"CZ",name:"Czech Republic",flag:"ğŸ‡¨ğŸ‡¿"},{code:"DK",name:"Denmark",flag:"ğŸ‡©ğŸ‡°"},{code:"DJ",name:"Djibouti",flag:"ğŸ‡©ğŸ‡¯"},{code:"DM",name:"Dominica",flag:"ğŸ‡©ğŸ‡²"},{code:"DO",name:"Dominican Republic",flag:"ğŸ‡©ğŸ‡´"},{code:"EC",name:"Ecuador",flag:"ğŸ‡ªğŸ‡¨"},{code:"EG",name:"Egypt",flag:"ğŸ‡ªğŸ‡¬"},{code:"SV",name:"El Salvador",flag:"ğŸ‡¸ğŸ‡»"},{code:"GQ",name:"Equatorial Guinea",flag:"ğŸ‡¬ğŸ‡¶"},{code:"ER",name:"Eritrea",flag:"ğŸ‡ªğŸ‡·"},{code:"EE",name:"Estonia",flag:"ğŸ‡ªğŸ‡ª"},{code:"SZ",name:"Eswatini",flag:"ğŸ‡¸ğŸ‡¿"},{code:"ET",name:"Ethiopia",flag:"ğŸ‡ªğŸ‡¹"},{code:"FJ",name:"Fiji",flag:"ğŸ‡«ğŸ‡¯"},{code:"FI",name:"Finland",flag:"ğŸ‡«ğŸ‡®"},{code:"FR",name:"France",flag:"ğŸ‡«ğŸ‡·"},{code:"GA",name:"Gabon",flag:"ğŸ‡¬ğŸ‡¦"},{code:"GM",name:"Gambia",flag:"ğŸ‡¬ğŸ‡²"},{code:"GE",name:"Georgia",flag:"ğŸ‡¬ğŸ‡ª"},{code:"DE",name:"Germany",flag:"ğŸ‡©ğŸ‡ª"},{code:"GH",name:"Ghana",flag:"ğŸ‡¬ğŸ‡­"},{code:"GR",name:"Greece",flag:"ğŸ‡¬ğŸ‡·"},{code:"GD",name:"Grenada",flag:"ğŸ‡¬ğŸ‡©"},{code:"GT",name:"Guatemala",flag:"ğŸ‡¬ğŸ‡¹"},{code:"GN",name:"Guinea",flag:"ğŸ‡¬ğŸ‡³"},{code:"GY",name:"Guyana",flag:"ğŸ‡¬ğŸ‡¾"},{code:"HT",name:"Haiti",flag:"ğŸ‡­ğŸ‡¹"},{code:"HN",name:"Honduras",flag:"ğŸ‡­ğŸ‡³"},{code:"HU",name:"Hungary",flag:"ğŸ‡­ğŸ‡º"},{code:"IS",name:"Iceland",flag:"ğŸ‡®ğŸ‡¸"},{code:"IN",name:"India",flag:"ğŸ‡®ğŸ‡³"},{code:"ID",name:"Indonesia",flag:"ğŸ‡®ğŸ‡©"},{code:"IR",name:"Iran",flag:"ğŸ‡®ğŸ‡·"},{code:"IQ",name:"Iraq",flag:"ğŸ‡®ğŸ‡¶"},{code:"IE",name:"Ireland",flag:"ğŸ‡®ğŸ‡ª"},{code:"IL",name:"Israel",flag:"ğŸ‡®ğŸ‡±"},{code:"IT",name:"Italy",flag:"ğŸ‡®ğŸ‡¹"},{code:"JM",name:"Jamaica",flag:"ğŸ‡¯ğŸ‡²"},{code:"JP",name:"Japan",flag:"ğŸ‡¯ğŸ‡µ"},{code:"JO",name:"Jordan",flag:"ğŸ‡¯ğŸ‡´"},{code:"KZ",name:"Kazakhstan",flag:"ğŸ‡°ğŸ‡¿"},{code:"KE",name:"Kenya",flag:"ğŸ‡°ğŸ‡ª"},{code:"KW",name:"Kuwait",flag:"ğŸ‡°ğŸ‡¼"},{code:"KG",name:"Kyrgyzstan",flag:"ğŸ‡°ğŸ‡¬"},{code:"LA",name:"Laos",flag:"ğŸ‡±ğŸ‡¦"},{code:"LV",name:"Latvia",flag:"ğŸ‡±ğŸ‡»"},{code:"LB",name:"Lebanon",flag:"ğŸ‡±ğŸ‡§"},{code:"LS",name:"Lesotho",flag:"ğŸ‡±ğŸ‡¸"},{code:"LR",name:"Liberia",flag:"ğŸ‡±ğŸ‡·"},{code:"LY",name:"Libya",flag:"ğŸ‡±ğŸ‡¾"},{code:"LI",name:"Liechtenstein",flag:"ğŸ‡±ğŸ‡®"},{code:"LT",name:"Lithuania",flag:"ğŸ‡±ğŸ‡¹"},{code:"LU",name:"Luxembourg",flag:"ğŸ‡±ğŸ‡º"},{code:"MG",name:"Madagascar",flag:"ğŸ‡²ğŸ‡¬"},{code:"MW",name:"Malawi",flag:"ğŸ‡²ğŸ‡¼"},{code:"MY",name:"Malaysia",flag:"ğŸ‡²ğŸ‡¾"},{code:"MV",name:"Maldives",flag:"ğŸ‡²ğŸ‡»"},{code:"ML",name:"Mali",flag:"ğŸ‡²ğŸ‡±"},{code:"MT",name:"Malta",flag:"ğŸ‡²ğŸ‡¹"},{code:"MR",name:"Mauritania",flag:"ğŸ‡²ğŸ‡·"},{code:"MU",name:"Mauritius",flag:"ğŸ‡²ğŸ‡º"},{code:"MX",name:"Mexico",flag:"ğŸ‡²ğŸ‡½"},{code:"MD",name:"Moldova",flag:"ğŸ‡²ğŸ‡©"},{code:"MC",name:"Monaco",flag:"ğŸ‡²ğŸ‡¨"},{code:"MN",name:"Mongolia",flag:"ğŸ‡²ğŸ‡³"},{code:"ME",name:"Montenegro",flag:"ğŸ‡²ğŸ‡ª"},{code:"MA",name:"Morocco",flag:"ğŸ‡²ğŸ‡¦"},{code:"MZ",name:"Mozambique",flag:"ğŸ‡²ğŸ‡¿"},{code:"MM",name:"Myanmar",flag:"ğŸ‡²ğŸ‡²"},{code:"NA",name:"Namibia",flag:"ğŸ‡³ğŸ‡¦"},{code:"NP",name:"Nepal",flag:"ğŸ‡³ğŸ‡µ"},{code:"NL",name:"Netherlands",flag:"ğŸ‡³ğŸ‡±"},{code:"NZ",name:"New Zealand",flag:"ğŸ‡³ğŸ‡¿"},{code:"NI",name:"Nicaragua",flag:"ğŸ‡³ğŸ‡®"},{code:"NE",name:"Niger",flag:"ğŸ‡³ğŸ‡ª"},{code:"NG",name:"Nigeria",flag:"ğŸ‡³ğŸ‡¬"},{code:"MK",name:"North Macedonia",flag:"ğŸ‡²ğŸ‡°"},{code:"NO",name:"Norway",flag:"ğŸ‡³ğŸ‡´"},{code:"OM",name:"Oman",flag:"ğŸ‡´ğŸ‡²"},{code:"PK",name:"Pakistan",flag:"ğŸ‡µğŸ‡°"},{code:"PA",name:"Panama",flag:"ğŸ‡µğŸ‡¦"},{code:"PY",name:"Paraguay",flag:"ğŸ‡µğŸ‡¾"},{code:"PE",name:"Peru",flag:"ğŸ‡µğŸ‡ª"},{code:"PH",name:"Philippines",flag:"ğŸ‡µğŸ‡­"},{code:"PL",name:"Poland",flag:"ğŸ‡µğŸ‡±"},{code:"PT",name:"Portugal",flag:"ğŸ‡µğŸ‡¹"},{code:"QA",name:"Qatar",flag:"ğŸ‡¶ğŸ‡¦"},{code:"RO",name:"Romania",flag:"ğŸ‡·ğŸ‡´"},{code:"RU",name:"Russia",flag:"ğŸ‡·ğŸ‡º"},{code:"RW",name:"Rwanda",flag:"ğŸ‡·ğŸ‡¼"},{code:"SA",name:"Saudi Arabia",flag:"ğŸ‡¸ğŸ‡¦"},{code:"SN",name:"Senegal",flag:"ğŸ‡¸ğŸ‡³"},{code:"RS",name:"Serbia",flag:"ğŸ‡·ğŸ‡¸"},{code:"SL",name:"Sierra Leone",flag:"ğŸ‡¸ğŸ‡±"},{code:"SG",name:"Singapore",flag:"ğŸ‡¸ğŸ‡¬"},{code:"SK",name:"Slovakia",flag:"ğŸ‡¸ğŸ‡°"},{code:"SI",name:"Slovenia",flag:"ğŸ‡¸ğŸ‡®"},{code:"SO",name:"Somalia",flag:"ğŸ‡¸ğŸ‡´"},{code:"ZA",name:"South Africa",flag:"ğŸ‡¿ğŸ‡¦"},{code:"KR",name:"South Korea",flag:"ğŸ‡°ğŸ‡·"},{code:"ES",name:"Spain",flag:"ğŸ‡ªğŸ‡¸"},{code:"LK",name:"Sri Lanka",flag:"ğŸ‡±ğŸ‡°"},{code:"SD",name:"Sudan",flag:"ğŸ‡¸ğŸ‡©"},{code:"SE",name:"Sweden",flag:"ğŸ‡¸ğŸ‡ª"},{code:"CH",name:"Switzerland",flag:"ğŸ‡¨ğŸ‡­"},{code:"SY",name:"Syria",flag:"ğŸ‡¸ğŸ‡¾"},{code:"TW",name:"Taiwan",flag:"ğŸ‡¹ğŸ‡¼"},{code:"TZ",name:"Tanzania",flag:"ğŸ‡¹ğŸ‡¿"},{code:"TH",name:"Thailand",flag:"ğŸ‡¹ğŸ‡­"},{code:"TG",name:"Togo",flag:"ğŸ‡¹ğŸ‡¬"},{code:"TN",name:"Tunisia",flag:"ğŸ‡¹ğŸ‡³"},{code:"TR",name:"Turkey",flag:"ğŸ‡¹ğŸ‡·"},{code:"UG",name:"Uganda",flag:"ğŸ‡ºğŸ‡¬"},{code:"UA",name:"Ukraine",flag:"ğŸ‡ºğŸ‡¦"},{code:"AE",name:"United Arab Emirates",flag:"ğŸ‡¦ğŸ‡ª"},{code:"GB",name:"United Kingdom",flag:"ğŸ‡¬ğŸ‡§"},{code:"US",name:"United States",flag:"ğŸ‡ºğŸ‡¸"},{code:"UY",name:"Uruguay",flag:"ğŸ‡ºğŸ‡¾"},{code:"UZ",name:"Uzbekistan",flag:"ğŸ‡ºğŸ‡¿"},{code:"VE",name:"Venezuela",flag:"ğŸ‡»ğŸ‡ª"},{code:"VN",name:"Vietnam",flag:"ğŸ‡»ğŸ‡³"},{code:"YE",name:"Yemen",flag:"ğŸ‡¾ğŸ‡ª"},{code:"ZM",name:"Zambia",flag:"ğŸ‡¿ğŸ‡²"},{code:"ZW",name:"Zimbabwe",flag:"ğŸ‡¿ğŸ‡¼"}],X=()=>{const{user:l,updateUserProfile:i,deleteCurrentUser:m}=I(),[w,b]=n.useState(""),[p,u]=n.useState(""),[t,y]=n.useState(""),[s,x]=n.useState(!1),[c,g]=n.useState(""),[N,o]=n.useState(!1);n.useEffect(()=>{l&&(b(l.firstName||""),u(l.lastName||""),y(l.country||""))},[l]);const h=async r=>{r.preventDefault(),x(!0),g("");try{await i({firstName:w,lastName:p,country:t}),g("Profile updated successfully!"),setTimeout(()=>g(""),3e3)}catch{g("Failed to update profile.")}finally{x(!1)}},f=async()=>{if(window.confirm("Are you sure you want to permanently delete your account? This action cannot be undone."))try{await m()}catch{alert("Failed to delete account. Please try again or contact support.")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full space-y-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-800 dark:text-gray-100",children:"My account"}),e.jsxs("div",{className:"bg-white dark:bg-surface-dark p-8 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(E,{className:"h-6 w-6"})," Personal information"]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),e.jsx("input",{type:"text",id:"firstName",value:w,onChange:r=>b(r.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),e.jsx("input",{type:"text",id:"lastName",value:p,onChange:r=>u(r.target.value),className:"w-full p-2 border rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Country"}),e.jsxs("select",{id:"country",value:t,onChange:r=>y(r.target.value),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Select country"}),Y.map(r=>e.jsxs("option",{value:r.name,children:[r.flag," ",r.name]},r.code))]})]}),c&&e.jsx("p",{className:`mt-2 text-sm ${c.includes("success")?"text-green-600":"text-red-500"}`,children:c}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",disabled:s,className:"bg-brand-red text-white font-bold py-2 px-6 rounded-md disabled:bg-red-300",children:s?"Saving...":"Save"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-surface-dark p-8 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"h-6 w-6"})," Subscription"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{children:["You are on the ",e.jsx("span",{className:"font-bold",children:l?.isPremium?"Premium":"Free"})," plan."]}),e.jsx(k,{to:"/pricing",className:"text-brand-red font-semibold hover:underline",children:"Manage subscription"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-surface-dark p-8 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(E,{className:"h-6 w-6"})," Face Login"]}),l?.faceDescriptor?e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Face Login is enabled for your account."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Set up passwordless login using your face. This will register your face data to your account on this device."}),e.jsx("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700",children:"Set up Face Login"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-surface-dark p-8 rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(K,{className:"h-6 w-6"})," API Access"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{children:["Your API plan is: ",e.jsx("span",{className:"font-bold",children:l?.apiPlan||"free"}),"."]}),e.jsx(k,{to:"/api-pricing",className:"text-brand-red font-semibold hover:underline",children:"Manage API Plan"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-surface-dark p-8 rounded-lg shadow-lg border-2 border-red-500/50",children:[e.jsxs("h2",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"h-6 w-6"})," Danger Zone"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Delete your account"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Once you delete your account, there is no going back. Please be certain."})]}),e.jsx("button",{onClick:f,className:"bg-red-600 text-white font-bold py-2 px-4 rounded-md hover:bg-red-700",children:"Delete My Account"})]})]})]}),e.jsx(H,{mode:"register",isOpen:N,onClose:()=>o(!1)})]})};export{X as default};
