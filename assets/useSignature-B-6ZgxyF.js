import{u as C,r as s,j as e}from"./main-CKNZpjee.js";import w from"./html2canvas.esm-B0tyYwQk.js";const E=({isOpen:i,onClose:o,onSave:b})=>{const{user:d}=C(),[t,n]=s.useState("signature"),[a,p]=s.useState(d?.username||"PDFBullet"),[x,v]=s.useState(""),h=["Pacifico","Dancing Script","Caveat","Great Vibes","Homemade Apple","Kalam"],[g,k]=s.useState(h[0]),[m,N]=s.useState("#000000"),j=["#000000","#0D6EFD","#DC3545","#198754"];s.useEffect(()=>{i&&d?.username&&!a&&p(d.username)},[i,d,a]),s.useEffect(()=>{const r=a.trim().split(/\s+/),c=r[0]?r[0][0]:"",y=r.length>1?r[r.length-1][0]:"";v((c+y).toUpperCase())},[a]);const f=async(r,c,y)=>{if(!r)return"";const l=document.createElement("div");l.innerText=r,l.style.fontFamily=`'${c}', cursive`,l.style.color=y,l.style.fontSize="96px",l.style.padding="30px",l.style.display="inline-block",document.body.appendChild(l);try{return(await w(l,{backgroundColor:null,scale:2})).toDataURL("image/png")}finally{document.body.removeChild(l)}},S=async()=>{const r=await f(a,g,m),c=await f(x,g,m);b(r,c)};return i?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:o,role:"dialog","aria-modal":"true","aria-labelledby":"signature-details-title",children:e.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-3xl rounded-lg shadow-xl overflow-hidden",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{id:"signature-details-title",className:"text-xl font-bold text-center text-gray-800 dark:text-gray-100",children:"Set your signature details"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full-name",className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Full name:"}),e.jsx("input",{type:"text",id:"full-name",value:a,onChange:r=>p(r.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-brand-red focus:border-brand-red text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"initials",className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Initials:"}),e.jsx("input",{type:"text",id:"initials",value:x,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-100"})]})]}),e.jsx("div",{className:"mt-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"-mb-px flex space-x-6",children:[e.jsx("button",{onClick:()=>n("signature"),className:`py-3 px-1 border-b-2 font-semibold text-sm ${t==="signature"?"border-brand-red text-brand-red":"border-transparent text-gray-500 hover:text-brand-red"}`,children:"Signature"}),e.jsx("button",{onClick:()=>n("initials"),className:`py-3 px-1 border-b-2 font-semibold text-sm ${t==="initials"?"border-brand-red text-brand-red":"border-transparent text-gray-500 hover:text-brand-red"}`,children:"Initials"}),e.jsx("button",{onClick:()=>n("stamp"),className:`py-3 px-1 border-b-2 font-semibold text-sm ${t==="stamp"?"border-brand-red text-brand-red":"border-transparent text-gray-500 hover:text-brand-red"}`,children:"Company Stamp"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:t!=="stamp"?h.map(r=>e.jsx("div",{className:`p-4 rounded-md border-2 ${g===r?"border-brand-red bg-red-50 dark:bg-red-900/20":"border-gray-200 dark:border-gray-700"}`,children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"signature-font",value:r,checked:g===r,onChange:()=>k(r),className:"h-5 w-5 text-brand-red focus:ring-brand-red"}),e.jsx("div",{style:{fontFamily:r,color:m},className:"ml-4 text-3xl text-gray-800 dark:text-gray-100",children:t==="signature"?a||"Signature":x||"IN"})]})},r)):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"Company stamp feature coming soon."})}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsx("span",{className:"text-sm font-bold mr-3",children:"Color:"}),j.map(r=>e.jsx("button",{onClick:()=>N(r),className:`w-6 h-6 rounded-full border-2 transition-transform ${m===r?"border-brand-red scale-125":"border-transparent"}`,style:{backgroundColor:r}},r))]})]})]}),e.jsxs("footer",{className:"flex justify-end items-center gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-b-lg",children:[e.jsx("button",{onClick:o,className:"text-sm font-semibold text-gray-600 dark:text-gray-300 hover:underline",children:"Cancel"}),e.jsx("button",{onClick:S,className:"bg-brand-red hover:bg-brand-red-dark text-white font-bold py-2 px-6 rounded-md transition-colors",children:"Apply"})]})]})}):null},u="pdfbullet_user_signature",A=()=>{const[i,o]=s.useState(null);s.useEffect(()=>{try{const t=localStorage.getItem(u);if(t)if(t.startsWith("data:image/png;base64,")){const n={signature:t,initials:null};o(n),localStorage.setItem(u,JSON.stringify(n))}else o(JSON.parse(t))}catch(t){console.error("Failed to load signature from localStorage",t)}},[]);const b=s.useCallback((t,n)=>{try{const a={signature:t,initials:n};localStorage.setItem(u,JSON.stringify(a)),o(a)}catch(a){console.error("Failed to save signature to localStorage",a)}},[]),d=s.useCallback(()=>{try{localStorage.removeItem(u),o(null)}catch(t){console.error("Failed to delete signature from localStorage",t)}},[]);return{signature:i,saveSignature:b,deleteSignature:d}};export{E as S,A as u};
