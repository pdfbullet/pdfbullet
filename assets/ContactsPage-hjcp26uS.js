import{a as P,r as i,m as F,j as e,B as T,aG as B,P as z,af as J,y as R,D as U}from"./main-DVb4ZCxP.js";import{u as $,S as G}from"./useSignature-y3lsP09f.js";import{read as H,utils as u,writeFile as K}from"./xlsx-DGuHH-KN.js";import"./react-Ckhrjn13.js";import"./html2canvas.esm-B0tyYwQk.js";const V=({className:r})=>e.jsx("div",{className:`p-2 bg-blue-600 rounded-md inline-block ${r}`,children:e.jsx("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),j="pdfbullet_contacts_v1",Y=()=>{const[r,m]=i.useState([]);i.useEffect(()=>{try{const s=localStorage.getItem(j);if(s)m(JSON.parse(s));else{const a=[{id:1,name:"Bishal Mishra",email:"bishal@example.com",phone:"123-456-7890"},{id:2,name:"Anam Mishra",email:"anam@example.com",phone:"987-654-3210"}];localStorage.setItem(j,JSON.stringify(a)),m(a)}}catch(s){console.error("Failed to load contacts from localStorage",s)}},[]);const c=s=>{try{localStorage.setItem(j,JSON.stringify(s)),m(s)}catch(a){console.error("Failed to save contacts to localStorage",a)}};return{contacts:r,addContact:s=>{const a={...s,id:Date.now()};c([...r,a])},deleteContacts:s=>{const a=r.filter(x=>!s.includes(x.id));c(a)},setContacts:m}},te=()=>{const r=P(),{saveSignature:m}=$(),{contacts:c,deleteContacts:y,setContacts:f}=Y(),[s,a]=i.useState(!1),[x,w]=i.useState(""),[l,p]=i.useState([]),h=i.useMemo(()=>c.filter(t=>t.name.toLowerCase().includes(x.toLowerCase())||t.email.toLowerCase().includes(x.toLowerCase())),[c,x]),S=t=>{t.target.checked?p(h.map(n=>n.id)):p([])},C=t=>{p(n=>n.includes(t)?n.filter(d=>d!==t):[...n,t])},k=()=>{window.confirm(`Are you sure you want to delete ${l.length} selected contact(s)?`)&&(y(l),p([]))},v=i.useCallback(t=>{const n=t[0],d=new FileReader;d.onload=g=>{const b=new Uint8Array(g.target?.result),N=H(b,{type:"array"}),D=N.SheetNames[0],M=N.Sheets[D],O=u.sheet_to_json(M).map((o,L)=>({id:Date.now()+L,name:o.Name||o.name||"",email:o.Email||o.email||"",phone:String(o.Phone||o.phone||"")})).filter(o=>o.name&&o.email);f(o=>[...o,...O])},d.readAsArrayBuffer(n)},[f]),{getRootProps:I,getInputProps:_}=F({onDrop:v,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]}}),A=()=>{const t=l.length>0?c.filter(g=>l.includes(g.id)):c,n=u.json_to_sheet(t.map(({id:g,...b})=>b)),d=u.book_new();u.book_append_sheet(d,n,"Contacts"),K(d,"pdfbullet_contacts.xlsx")},E=(t,n)=>{m(t,n),a(!1),r("/sign-pdf")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full bg-white dark:bg-surface-dark rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-7 w-auto"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Signature"})]})]}),e.jsx("button",{onClick:()=>a(!0),className:"w-full sm:w-auto bg-brand-red hover:bg-brand-red-dark text-white font-bold py-2 px-6 rounded-md transition-colors",children:"New signature"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:"Contacts list"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:max-w-xs",children:[e.jsx("input",{type:"text",placeholder:"Search contact",value:x,onChange:t=>w(t.target.value),className:"w-full pl-4 pr-10 py-2 border rounded-md"}),e.jsx(B,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>alert("Add contact functionality is coming soon!"),className:"flex items-center gap-2 py-2 px-4 border rounded-md text-sm font-semibold",children:[e.jsx(z,{className:"h-4 w-4"})," Add contact"]}),e.jsxs("div",{...I(),className:"inline-block",children:[e.jsx("input",{..._()}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 py-2 px-4 border rounded-md text-sm font-semibold",children:[e.jsx(J,{className:"h-4 w-4"})," Import contacts"]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-10",children:e.jsx("input",{type:"checkbox",onChange:S,checked:l.length===h.length&&h.length>0})}),e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Email"}),e.jsx("th",{className:"px-4 py-3",children:"Phone"})]})}),e.jsx("tbody",{children:h.map(t=>e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:l.includes(t.id),onChange:()=>C(t.id)})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-gray-800 dark:text-gray-100",children:t.name}),e.jsx("td",{className:"px-4 py-3",children:t.email}),e.jsx("td",{className:"px-4 py-3",children:t.phone||"-"})]},t.id))})]})}),h.length===0&&e.jsx("p",{className:"text-center py-8 text-gray-500",children:"No contacts found."}),l.length>0&&e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 text-sm font-semibold text-red-600",children:[e.jsx(R,{className:"h-4 w-4"})," Delete (",l.length,")"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 text-sm font-semibold text-blue-600",children:[e.jsx(U,{className:"h-4 w-4"})," Export (",l.length,")"]})]})]})]}),e.jsx(G,{isOpen:s,onClose:()=>a(!1),onSave:E})]})};export{te as default};
